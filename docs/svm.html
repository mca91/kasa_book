<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>14&nbsp; Support Vector Machines – Kausalanalyse und maschinelles Lernen mit R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./trees.html" rel="next">
<link href="./RegReg.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="site_libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script><script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script><link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="site_libs/rglWebGL-binding-1.3.1/rglWebGL.js"></script><link href="site_libs/rglwidgetClass-1.3.1/rgl.css" rel="stylesheet">
<script src="site_libs/rglwidgetClass-1.3.1/rglClass.min.js"></script><script src="site_libs/CanvasMatrix4-1.3.1/CanvasMatrix.min.js"></script><meta name="robots" content="noindex">
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.js" integrity="sha512-aoZChv+8imY/U1O7KIHXvO87EOzCuKO0GhFtpD6G2Cyjo/xPeTgdf3/bchB10iB+AojMTDkMHDPLKNxPJVqDcw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
<style>
  .panel-tabset .tab-content {
    border: 0;
    padding: 1em 0 0 0;
  }
  
  .panel-tabset .nav-item a {
    border-radius: 5px 5px 0 0;
  }
  
  .scientific_borders {
    border: 0;
    border-top: 2px solid black !important; 
    border-bottom: 2px solid black !important;
  }
  .table:not(.gt_table) > :not(caption)>*>* {
    border-bottom-width: 0;
  }
  .table:not(.gt_table) > thead {
    border-bottom: 1px solid black;
  }
  .soft-box-shadow {
    border: 1px solid rgba(233,236,239,.9) !important;
    border-radius: .5rem !important;
    background-color: rgba(250,250,250,.9) !important;
    box-shadow: 0px 1px 2px rgba(0,0,0,.1),
                0px 3px 7px rgba(0,0,0,.1),
                0px 12px 30px rgba(0,0,0,.08);
    margin-top: 2rem !important;
    margin-bottom: 2.5rem !important;
    padding: .25rem !important;
  }
  .obs-soft-box-shadow {
    border: 1px solid rgba(233,236,239,.9) !important;
    border-radius: .5rem !important;
    background-color: white !important;
    box-shadow: 0px 1px 2px rgba(0,0,0,.1),
                0px 3px 7px rgba(0,0,0,.1),
                0px 12px 30px rgba(0,0,0,.08);
    margin-top: 2rem !important;
    margin-bottom: 2.5rem !important;
    padding: .25rem !important;
  }
  
</style>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    
    var gt_tables = document.querySelectorAll(".gt_table");
    gt_tables.forEach(function(table) {
      table.classList.remove("table-striped");
    });
    
    var tables = document.querySelectorAll("table.table:not(.gt_table)");
    tables.forEach(function(table) {
      table.classList.remove("table-striped");
      table.classList.add("scientific_borders");
    });
    
    document.querySelectorAll("div.sourceCode").forEach(function(block) {
      block.classList.add("soft-box-shadow");
    });
    
    document.querySelectorAll("div.bg-white").forEach(function(block) {
      block.classList.remove("bg-white");
    });
    
const elements = document.querySelectorAll('[id^="qwebr-interactive-area"]');

    elements.forEach(element => {
        element.classList.add('box-shadow');
    });
    
    document.querySelectorAll('[id^="webr"]').forEach(function(block) {
      block.classList.add("box-shadow");
    });
    
        document.querySelectorAll('.card-header').forEach(function(block) {
      block.classList.add("box-shadow");
    });
    
  });
</script><style>
.qwebr-code-output-stdout {background-color: powderblue;}

.qwebr-button-run {
 width = 100%; 
}

.centered-caption {
   text-align: center;
}
</style>
<script src="https://cdn.jsdelivr.net/npm/quizdown@latest/public/build/quizdown.js"></script><script>quizdown.init();</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="custom_styles.css">
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./RegReg.html">Machine Learning</a></li><li class="breadcrumb-item"><a href="./svm.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Support Vector Machines</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a><a href="./index.html">Kausalanalyse mit R</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Lesemodus umschalten">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Grundlagen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_Einfuehrung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistische Programmierung mit R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reproduzierbarkeit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Simulation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Kausale Inferenz</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Matching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Matching</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedEffects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Panel-Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IV.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">IV-Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DiD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Difference-in-Differences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EventStudies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Event Studies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RDD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Regression Discontiniuty Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SyntheticControl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Synthetic Control</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RegReg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Regularisierte Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./svm.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Support Vector Machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./trees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Baum-basierte Methoden</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Machine Learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Neuronale Netzwerke</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Übungsaufgaben</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lineare Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ex_RR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reproduzierbarkeit</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ex_simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulation mit R</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Literatur.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatur</span></a>
  </div>
</li>
    </ul>
</div>
    <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title"><a href="./index.html">Übersicht</a></h2>
   
  <ul>
<li>
<a href="#trennende-hyper-ebenen" id="toc-trennende-hyper-ebenen" class="nav-link active" data-scroll-target="#trennende-hyper-ebenen"><span class="header-section-number">14.1</span> Trennende Hyper-Ebenen</a>
  <ul>
<li><a href="#trennebenen" id="toc-trennebenen" class="nav-link" data-scroll-target="#trennebenen"><span class="header-section-number">14.1.1</span> Trennebenen</a></li>
  <li><a href="#maximal-margin-classifier" id="toc-maximal-margin-classifier" class="nav-link" data-scroll-target="#maximal-margin-classifier"><span class="header-section-number">14.1.2</span> Maximal Margin Classifier</a></li>
  </ul>
</li>
  <li><a href="#sec-scv" id="toc-sec-scv" class="nav-link" data-scroll-target="#sec-scv"><span class="header-section-number">14.2</span> Support Vector Classifier</a></li>
  <li>
<a href="#support-vector-machines" id="toc-support-vector-machines" class="nav-link" data-scroll-target="#support-vector-machines"><span class="header-section-number">14.3</span> Support Vector Machines</a>
  <ul>
<li><a href="#der-kernel-trick" id="toc-der-kernel-trick" class="nav-link" data-scroll-target="#der-kernel-trick"><span class="header-section-number">14.3.1</span> Der Kernel-Trick</a></li>
  <li><a href="#overfitting" id="toc-overfitting" class="nav-link" data-scroll-target="#overfitting"><span class="header-section-number">14.3.2</span> Overfitting</a></li>
  </ul>
</li>
  <li><a href="#beispiel-vorhersage-von-kaufentscheidungen" id="toc-beispiel-vorhersage-von-kaufentscheidungen" class="nav-link" data-scroll-target="#beispiel-vorhersage-von-kaufentscheidungen"><span class="header-section-number">14.4</span> Beispiel: Vorhersage von Kaufentscheidungen</a></li>
  <li><a href="#zusammenfassung" id="toc-zusammenfassung" class="nav-link" data-scroll-target="#zusammenfassung"><span class="header-section-number">14.5</span> Zusammenfassung</a></li>
  </ul></nav>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./RegReg.html">Machine Learning</a></li><li class="breadcrumb-item"><a href="./svm.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Support Vector Machines</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Support Vector Machines</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>Support Vector Machines (SVM) sind eine Methode die sich besonders für Klassifikation von Beobachtungen bei komplexen, nicht-linearen Zusammenhängen in hoch-dimensionalen Datensätzen eignet. Anders als baum-basierte Methoden, die auf der Zerlegung des Regressorraums anhand binärer Entscheidungsregeln basieren (vgl. <a href="trees.html" class="quarto-xref"><span>Kapitel 15</span></a>), verwenden SVMs einen <em>geometrischen</em> Ansatz, der auf der Maximierung von Abständen beruht.</p>
<p>Das Ziel eines SVM-Modells ist es, eine Hyperebene (<em>separating hyperplane</em>) zu finden, die zwei (oder mehr) Klassen optimal voneinander trennt, indem der Abstand (<em>margin</em>) zwischen einer bestimmten Anzahl nächstgelegener Datenpunkten der verschiedenen Klassen maximiert wird. Diese Datenpunkte, die der Trennfläche am nächsten liegen, definieren die Klassifikationsregel des Modells und werden als Support-Vektoren (<em>support vectors</em>) bezeichnet. Bei einer hochgradig nicht-linearen Entscheidungsgrenzen können die ursprünglichen Beobachtungen mit einer <em>Kernel-Funktion</em> in einen höherdimensionalen Raum abgebildet werden in dem die Klassen <em>linear</em> trennbar sind.</p>
<p>Im Gegensatz zu Baum-basierten Modellen sind SVMs oft weniger intuitiv interpretierbar, da aus der angepassten Entscheidungsgrenze nicht unmittelbar die Relevanz der Regressoren abgeleitet werden kann.</p>
<p>In diesem Kapitel beschreiben wir die theoretischen Grundlagen von SVMs für Klassifikation von Beobachtungen hinsichtlich einer binären Outcome-Variable. Für technische Details und Beispiele empfehlen wir eine Aufarbeitung mit Kapitel 9 in <span class="citation" data-cites="Jamesetal2017">James u.&nbsp;a. (<a href="Literatur.html#ref-Jamesetal2017" role="doc-biblioref">2017</a>)</span>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> erläutern die Anwendung in R mit <code>parsnip</code>.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;<span class="citation" data-cites="Hastieetal2013">Hastie, Tibshirani, und Friedman (<a href="Literatur.html#ref-Hastieetal2013" role="doc-biblioref">2013</a>)</span> geben eine ausführlichere, jedoch formal anspruchsvollere Erläuterung der hier behandelten Methoden.</p></div></div><section id="trennende-hyper-ebenen" class="level2 page-columns page-full" data-number="14.1"><h2 data-number="14.1" class="anchored" data-anchor-id="trennende-hyper-ebenen">
<span class="header-section-number">14.1</span> Trennende Hyper-Ebenen</h2>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/">purrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lsvm_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, mean <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, mean <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    klasse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, mean <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, mean <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    klasse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir betrachten zunächst ein Klassifikationsproblem mit zwei Prädiktoren <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span> für die binäre Outcome-Variable <span class="math inline">\(Y\)</span>. Die nächste Abbildung stellt diese Beobachtungen <em>im Prädiktorraum</em> graphisch dar. Mit <code><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function()</a></code> fügen wir dem Plot drei mögliche Trenneben hinzu, welche die Klassen perfekt seprarieren.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span></span>
<span><span class="co"># Visualisiere den Datensatz mit ggplot2</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">lsvm_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, color <span class="op">=</span> <span class="va">klasse</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"X1"</span>, y <span class="op">=</span> <span class="st">"X2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Mögliche Trennebenen</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span>  <span class="op">-</span><span class="fl">1.5</span> <span class="op">*</span> <span class="va">x</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span>  <span class="op">-</span><span class="fl">2.5</span> <span class="op">*</span> <span class="va">x</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span>  <span class="op">-</span><span class="fl">.4</span> <span class="op">*</span> <span class="va">x</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">lims</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full"><p><img src="svm_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="margin-caption">Perfekt linear speparierbare Beobachtungen</figcaption></figure>
</div>
</div>
</div>
<section id="trennebenen" class="level3" data-number="14.1.1"><h3 data-number="14.1.1" class="anchored" data-anchor-id="trennebenen">
<span class="header-section-number">14.1.1</span> Trennebenen</h3>
<p>SVM für Klassifikation basiert auf der Idee, eine Trennhyperebene <span class="math display">\[\begin{align}
  \boldsymbol{w}'\boldsymbol{X} + b = 0 \label{eq:sepplane}
\end{align}\]</span> im Prädiktorraum zu finden, welche die Datenpunkten hinsichtlich ihrer Klasse möglichst gut trennt.</p>
<p>Definiere die abhängige Variable als <span class="math display">\[\begin{align*}
  y =
  \begin{cases}
    -1, &amp; \textup{wenn Beob. $i$ Klasse A hat,}\\
     1, &amp; \textup{wenn Beob. $i$ Klasse B hat}
  \end{cases}
\end{align*}\]</span></p>
<p>Wähle <span class="math inline">\(\boldsymbol{w}\)</span> und <span class="math inline">\(b\)</span> so, dass die Ungleichung</p>
<p><span class="math display">\[\begin{align}
  y_i(\boldsymbol{w}'\boldsymbol{X}_i + b) \geq 0 \label{eq:sepcond}
\end{align}\]</span></p>
<p>erfüllt ist, d.h.</p>
<p><span class="math display">\[\begin{align*}
\boldsymbol{w}'\boldsymbol{X}_i + b \geq 0  &amp; \quad \textup{für} \quad y_i = 1,\\
  \boldsymbol{w}'\boldsymbol{X}_i + b \leq 0  &amp; \quad \textup{für} \quad y_i = -1.
\end{align*}\]</span></p>
<p>In unserem Beispiel mit zwei Regressoren <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span> ist <span class="math inline">\(\boldsymbol{w} = (w_1,\,w_2)'\)</span> und <span class="math inline">\(\boldsymbol{X}=(X_1,\,X_2)'\)</span>. Der Prädiktorrraum ist also zwei-dimensional. Jede Hyperebene in diesem Raum ist ein-dimensional, kann also formal durch eine Geraden-Gleichung der Form <span class="math display">\[\begin{align}
  x_2 = \alpha_1\cdot x_1 + \alpha_0 \label{eq:gg}
\end{align}\]</span> dargestellt werden: Durch Umformen von <span class="math inline">\(\eqref{eq:sepplane}\)</span> erhalten wir <span class="math display">\[\begin{align}
  &amp;\, w_1 \cdot x_1 + w_2 \cdot x_2 + b = 0 \notag \\
  \\
\Leftrightarrow &amp;\, x_2 = -\left(\frac{w_1}{w_2}\right) \cdot x_1 - \frac{b}{w_2} \label{eq:ggt}
\end{align}\]</span></p>
<p>In Abbildung XYZ erkennen wir, dass die Beobachtungen durch eine Gerade mit negativer Steigung perfekt separiert werden können.</p>
<p>Wenn die Daten perfekt separierbar sind (und die Regressoren kontinuierlich sind) gibt es unendlich viele Ebenen, die Bedingung <span class="math inline">\(\eqref{eq:sepcond}\)</span> erfüllen. <em>Welche</em> Hyperebene (also welche Parameter <span class="math inline">\(\boldsymbol{w},\,b\)</span>) gewählt werden sollen, muss durch weitere Bedingungen festgelegt werden.</p>
</section><section id="maximal-margin-classifier" class="level3 page-columns page-full" data-number="14.1.2"><h3 data-number="14.1.2" class="anchored" data-anchor-id="maximal-margin-classifier">
<span class="header-section-number">14.1.2</span> Maximal Margin Classifier</h3>
<p>Ein <em>Maximal Margin Classifier</em> (MMC) wählt die trennende Ebene wie folgt: Bestimme <span class="math inline">\(\{\boldsymbol{w},b\}\)</span> und <span class="math inline">\(M\)</span> unter der Bedingung <span class="math inline">\(\sum_{j=1}^k w_j^2 = 1\)</span> so, dass für sämtliche Beobachtungen gilt, dass</p>
<p><span class="math display">\[\begin{align*}
    Y_i(\boldsymbol{w}'\boldsymbol{X}_i + b) \geq M, \quad \forall i \in \{1, \dots, n\},
\end{align*}\]</span></p>
<p>wobei <span class="math inline">\(M\)</span>, der <em>minimale Abstand aller Beobachtungen zur trennenden Ebene</em> – die <em>Margin</em> – maximiert wird.</p>
<p>Beobachtungen, die exakt die Distanz <span class="math inline">\(M\)</span> zur Trennebene haben, sind die <em>Support-Vektoren</em> (SV). Beachte: Ausschließlich die SV definieren die angepasste Entschiedungsgrenze des MMC.</p>
<p>Wir trainieren nun einen MMC für <code>klasse</code> in <code>lsvm_data</code> mit <code><a href="https://rdrr.io/pkg/e1071/man/svm.html">e1071::svm()</a></code>. Mit <code>kernel = "linear"</code> legen wir fest, dass eine lineare Entscheidungsgrenze im zwei-dimensionalen Raum von <span class="math inline">\((X_1,X_2)\)</span> gefunden werden soll. Die Parameter <code>cost = 1e8</code> und <code>scale = F</code> erzwingen wir eine “harte” Margin (mehr dazu im Abschnitt zu SVMs unten) sowie keine Skalierung der Daten. Mit <code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code> lesen wir die trainierten Koeffizienten aus.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Trainiere das Modell</span></span>
<span><span class="va">model_mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm</a></span><span class="op">(</span></span>
<span>  <span class="va">klasse</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, </span>
<span>  data <span class="op">=</span> <span class="va">lsvm_data</span>, </span>
<span>  kernel <span class="op">=</span> <span class="st">"linear"</span>, </span>
<span>  cost <span class="op">=</span> <span class="fl">1e8</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">F</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Trainierte Koeffizienten des MMC auslesen</span></span>
<span><span class="op">(</span></span>
<span>  <span class="va">coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_mm</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"w1"</span>, <span class="st">"w2"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          b          w1          w2 
 0.06210578 -0.52107776 -0.69398704 </code></pre>
</div>
</div>
<p>Zur Vereinfachung der graphischen Darstellung normieren wir den Vektor der Koeffizienten <code>c("w1", "w2")</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Koeffizienten normieren</span></span>
<span><span class="va">nrm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">coefs</span><span class="op">[</span><span class="st">"w1"</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">coefs</span><span class="op">[</span><span class="st">"w2"</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="co"># Euklidische Norm</span></span>
<span><span class="va">coefs</span> <span class="op">&lt;-</span> <span class="va">coefs</span> <span class="op">/</span> <span class="va">nrm</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mit den angepassten Koeffizienten in <code>coefs</code> können wir anhand der Umformung <span class="math inline">\(\eqref{eq:ggt}\)</span> die mit MMC ermittelte trennende Gerade berechnen. Wir definieren <span class="math inline">\(\alpha_0\)</span> und <span class="math inline">\(\alpha_1\)</span> wie in <span class="math inline">\(\eqref{eq:gg}\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Koeffizienten der trennenden Geraden berechnen</span></span>
<span><span class="co"># alpha0</span></span>
<span><span class="op">(</span></span>
<span>  <span class="va">alpha0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">-</span><span class="va">coefs</span><span class="op">[</span><span class="st">"b"</span><span class="op">]</span> <span class="op">/</span> <span class="va">coefs</span><span class="op">[</span><span class="st">"w2"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08949127</code></pre>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># alpha1  </span></span>
<span><span class="op">(</span></span>
<span>  <span class="va">alpha1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">-</span><span class="va">coefs</span><span class="op">[</span><span class="st">"w1"</span><span class="op">]</span> <span class="op">/</span> <span class="va">coefs</span><span class="op">[</span><span class="st">"w2"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.7508465</code></pre>
</div>
</div>
<p>Der Eintrag <code>SV</code> des im Objekt <code>model_mm</code> gespeicherten Outputs von <code><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm()</a></code> enthält die Support-Vektoren des MMC.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Support-Vektoren auslesen</span></span>
<span><span class="op">(</span></span>
<span>  <span class="va">sv</span> <span class="op">&lt;-</span> <span class="va">model_mm</span><span class="op">$</span><span class="va">SV</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
      x1     x2
   &lt;dbl&gt;  &lt;dbl&gt;
1 0.416  -1.66 
2 3.01   -0.732
3 0.0518  1.49 </code></pre>
</div>
</div>
<p>Mit <code><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function()</a></code> zeichnen wir nun die ermittelte Trennlinie in den Punkteplot der Regressoren ein. Wir ergänzen die Grafik um die Marginallinien und Hervorhebungen der in <code>sv</code> gespeicherten Support-Vektoren.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Beobachtungen in MMC-Trennlinien einzeichnen</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">lsvm_data</span>, </span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, color <span class="op">=</span> <span class="va">klasse</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"X1"</span>, y <span class="op">=</span> <span class="st">"X2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Trennlinie</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span></span>
<span>      fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">alpha0</span> <span class="op">+</span> <span class="va">alpha1</span> <span class="op">*</span> <span class="va">x</span>, col <span class="op">=</span> <span class="st">"black"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Marginallinien</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span><span class="op">(</span><span class="va">coefs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">nrm</span><span class="op">)</span><span class="op">/</span><span class="va">coefs</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="va">alpha1</span> <span class="op">*</span> <span class="va">x</span>, </span>
<span>                  col <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span><span class="op">(</span><span class="va">coefs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">/</span><span class="va">nrm</span><span class="op">)</span><span class="op">/</span><span class="va">coefs</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="va">alpha1</span> <span class="op">*</span> <span class="va">x</span>, </span>
<span>                  col <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Support-Vektoren</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">sv</span>, </span>
<span>      mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span><span class="op">)</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>      shape <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      inherit.aes <span class="op">=</span> <span class="cn">F</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Beobachtungen</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">lims</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.8</span>, <span class="fl">3.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-mmctmsv" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-mmctmsv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="svm_files/figure-html/fig-mmctmsv-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-mmctmsv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;14.1: Maximal Margin Classifier: Trennebene, Margin und SV
</figcaption></figure>
</div>
</div>
</div>
<p>Die Grafik zeigt, dass der MMC in <code>model_mm</code> tatsächlich eine perfekte Klassifzierung der Datenpunkte erreicht: Die gewählte Trennlinie (schwarze Linie) maximiert die jeweils durch die Marginallinien (getrichelte Linien) definierte Margin. Der MMC wird lediglich durch die 3 schwarz umrandeten Beobachtungen (die Support-Vektoren) definiert.</p>
<p>Wir können die Genauigkeit der Klassifikation von <code>model_mm</code> für die Trainingsdaten mit <code><a href="https://yardstick.tidymodels.org/reference/accuracy.html">yardstick::accuracy</a></code> auswerten.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/yardstick">yardstick</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Genauigkeit der Klassifizierung für Trainingsdaten</span></span>
<span><span class="va">model_mm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span></span>
<span>    estimate <span class="op">=</span> <span class="va">.</span>, </span>
<span>    truth <span class="op">=</span> <span class="va">lsvm_data</span><span class="op">$</span><span class="va">klasse</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://yardstick.tidymodels.org/reference/accuracy.html">accuracy</a></span><span class="op">(</span><span class="va">truth</span>, <span class="va">estimate</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .metric  .estimator .estimate
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
1 accuracy binary             1</code></pre>
</div>
</div>
<p>Ein Nachteil des MMC ist, dass das training der separierenden Grenze empfindlich gegenüber Ausreißern und hoher Varianz in den Daten ist: Da der MMC die Trennlinie so positioniert, dass der Abstand (die “Margin”) zu den nächstgelegenen Trainingsdatenpunkten maximal wird, können selbst wenige ungewöhnliche Beobachtungen die Lage der Grenze stark beeinflussen, was die Robustheit des Classifier beeinträchtigt und zu einer schlechteren Generalisierung auf neue Daten führen kann.</p>
<p><a href="#fig-mmcsens" class="quarto-xref">Abbildung&nbsp;<span>14.2</span></a> illustriert die Sensibilität des MMC durch Hinzufügen <em>nur einer</em> zusätzlichen ungewöhnlichen Beobachtung der Klasse 1 mit <span class="math inline">\(X_1 = -.5\)</span> und <span class="math inline">\(X_2 = 3\)</span><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>: Das Optimierungskalkül des MMC führt zu einer deutlich verschobenen Trennlinie im Vergleich zu ABZ.</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;Der Code hierfür ist <code>lsvm_data %&gt;% add_row(tibble(x1 = -.5, x2 = 3, klasse = factor(1)))</code>.</p></div></div><div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-mmcsens" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-mmcsens-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="svm_files/figure-html/fig-mmcsens-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-mmcsens-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;14.2: Effekt von Ausreißern auf Maximum Margin Classifier
</figcaption></figure>
</div>
</div>
</div>
<p>Eine Erweitung des MMC, die dieses Problem adressiert ist der <em>(Soft Margin) Support Vector Classifier</em> (SVC). Der Ausreißer lässt bestimmte Fehlklassifizierungen zu, um eine bessere Balance zwischen Genauigkeit auf dem Trainingsdatensatz und Generalisierungsfähigkeit des Modells zu finden.</p>
</section></section><section id="sec-scv" class="level2 page-columns page-full" data-number="14.2"><h2 data-number="14.2" class="anchored" data-anchor-id="sec-scv">
<span class="header-section-number">14.2</span> Support Vector Classifier</h2>
<p>Ein MMC strebt eine strikte Trennung der Datenklassen durch eine Hyperebene mit einer “harten” Margin, deren Grenzen durch die Support-Vektoren definierten werden (<em>hard margin</em>). Ein SVC erlaubt eine “weiche” Margin (<em>soft margin</em>) die zu weniger Empfindlichkeit der ermittelten Enscheidungsgrenze gegenüber Rauschen und Ausreißern führt. Diese weiche Margin lässt zu, dass Beobachtungen innerhalb der Margin liegen und erlaubt auch Fehlklassifikationenen. Die <em>Support-Vektoren</em> des SVC sind sämtliche Beobachtungen, di im Bereich der Margin liegen.</p>
<p>Wie beim MMC ist es das Ziel des SVC, die Parameter <span class="math inline">\(\{\boldsymbol{w}, b\}\)</span> so zu bestimmen, dass die Margin maximiert wird, jedoch dürfen einige Datenpunkte innerhalb der Margin oder sogar auf der <em>falschen Seite</em> der trennenden Hyperebene (Fehlerklassifizierung) liegen. Ein SVC kann so eine (nicht perfekt) trennende Hyperbene finden, wenn das Optimierungskalkühl des MMC aufgrund der Überlappung der Klassen unlösbar ist.</p>
<p>Hierzu wird die Ebene unter Berücksichtigung einer weiteren Bedingung für die Optimierung ermittelt, die auf <em>Slack-Variablen</em> <span class="math inline">\(\epsilon_i \geq 0\)</span> basiert,</p>
<p><span class="math display">\[\begin{align}
  \sum_{i=1}^{n} \epsilon_i \leq C. \label{eq:svcreg}
\end{align}\]</span></p>
<p>Die <span class="math inline">\(\epsilon_i\)</span> sind größer 0 für Beobachtungen, welche die Margin verletzen, wobei die Größe von <span class="math inline">\(\epsilon_i\)</span> die Intensität der Verletzung misst. Für eine Beobachtung <span class="math inline">\(i\)</span> innerhalb der Margin, aber auf der <em>korrekten</em> Seite der Trennebene ist <span class="math inline">\(0\leq\epsilon_i&lt;1\)</span>. Liegt die Beobachtung auf der <em>falschen</em> Seite der Ebene, ist <span class="math inline">\(\epsilon_i&gt;1\)</span>.</p>
<p><span class="math inline">\(C\geq0\)</span> ist ein Regularisierungsparameter, der die Balance zwischen der Maximierung der Margin und der Anzahl der tolerierten Fehlklassifikationen regelt.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> Ein hoher Wert von <span class="math inline">\(C\)</span> ermöglicht mehr Verletzungen der Margin und mehr Fehlklassifikationen, was meist zu einer breiteren Margin führt. Ein kleinerer Wert von <span class="math inline">\(C\)</span> hingegen erzielt eine kleinere Margin mit weniger Verletzungen und Fehlklassifikationen. <span class="math inline">\(C\)</span> ist also ein Tuning-Parameter der einen Bias-Varianz-Tradeoff regelt: Für kleine <span class="math inline">\(C\)</span> (kleine Margins) wird die trennende Ebene gut an die Trainingsdaten angepasst, hat also wenig Verzerrung aber tendentiell größere Varianz. Für große <span class="math inline">\(C\)</span> (breite Margin) ist die Varianz beim Bestimmen der trennenden Ebene tendentiell kleiner, jedoch kann die Verzerrung groß sein. Diese Abwägung ist wichtig für die Güte der Klassifizierung neuer Beobachtung. In empirischen Anwendungen wird <span class="math inline">\(C\)</span> mit Cross-Validation bestimmt.</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;Für <span class="math inline">\(C=0\)</span> muss <span class="math inline">\(\sum_{i=1}^{n} \epsilon_i = 0\)</span> sein. Der SVC entspricht dann dem MMC.</p></div></div><p><strong>Nicht perfekt separierbare Klassen</strong></p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># nicht exakt separierbare Daten einlesen</span></span>
<span><span class="va">lsvm_nonsep_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"datasets/lsvm_nonsep_data.RDS"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">lsvm_nonsep_data</span>, </span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, color <span class="op">=</span> <span class="va">klasse</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">"X1"</span>, </span>
<span>      y <span class="op">=</span> <span class="st">"X2"</span>, </span>
<span>      title <span class="op">=</span> <span class="st">"Nicht perfekt separierbare Klassen"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Beobachtungen</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-mmcnonsep" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-mmcnonsep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="svm_files/figure-html/fig-mmcnonsep-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-mmcnonsep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;14.3: Nicht perfekt separierbare Klassen
</figcaption></figure>
</div>
</div>
</div>
<p>Ein MMC kann für den in <a href="#fig-mmcnonsep" class="quarto-xref">Abbildung&nbsp;<span>14.3</span></a> gezeigten Datensatz <code>lsvm_nonsep_data</code> keine Lösung finden: Der Algorithmus iteriert bis zu einer maximalen Anzahl an Durchläufen.</p>
<p>Ein SVC hingegen kann angepasst werden: Mit <code>cost = 1</code> räumen wir ein “Budget” für Verletzungen der Margin und Fehlklassifikationen ein.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;Der Parameter <code>cost</code> in <code><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm()</a></code> ist ein Langrange-Multiplikator und verhält sich daher invers zu <span class="math inline">\(C\)</span> in <span class="math inline">\(\eqref{eq:svcreg}\)</span>: Große Werte für <code>cost</code> führen zu viel Regularisierung (kleine Margin) und umgekehrt.</p></div></div><div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Trainiere ein SVC-Modell</span></span>
<span><span class="va">model_svc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm</a></span><span class="op">(</span></span>
<span>  <span class="va">klasse</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, </span>
<span>  data <span class="op">=</span> <span class="va">lsvm_nonsep_data</span>, </span>
<span>  kernel <span class="op">=</span> <span class="st">"linear"</span>, </span>
<span>  cost <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  scale <span class="op">=</span> <span class="cn">F</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_svc</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm(formula = klasse ~ x1 + x2, data = lsvm_nonsep_data, kernel = "linear", 
    cost = 1, scale = F)


Parameters:
   SVM-Type:  C-classification 
 SVM-Kernel:  linear 
       cost:  1 

Number of Support Vectors:  36</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Trainierte Koeffizienten des SVC auslesen</span></span>
<span><span class="op">(</span></span>
<span>  <span class="va">coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_svc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"w1"</span>, <span class="st">"w2"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        b        w1        w2 
-1.998007 -1.525909 -1.336617 </code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nrm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">coefs</span><span class="op">[</span><span class="st">"w1"</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">coefs</span><span class="op">[</span><span class="st">"w2"</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">coefs</span> <span class="op">&lt;-</span> <span class="va">coefs</span> <span class="op">/</span> <span class="va">nrm</span></span>
<span></span>
<span></span>
<span><span class="va">alpha0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">-</span><span class="va">coefs</span><span class="op">[</span><span class="st">"b"</span><span class="op">]</span> <span class="op">/</span> <span class="va">coefs</span><span class="op">[</span><span class="st">"w2"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">alpha1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">-</span><span class="va">coefs</span><span class="op">[</span><span class="st">"w1"</span><span class="op">]</span> <span class="op">/</span> <span class="va">coefs</span><span class="op">[</span><span class="st">"w2"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sv</span> <span class="op">&lt;-</span> <span class="va">model_svc</span><span class="op">$</span><span class="va">SV</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Analog zu <code>model_mmc</code> können wir die trennende Gerade gemeinsam mit den Margins sowie den SV graphisch darstellen.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">lsvm_nonsep_data</span>, </span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, color <span class="op">=</span> <span class="va">klasse</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"X1"</span>, y <span class="op">=</span> <span class="st">"X2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Trennlinie</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span></span>
<span>      fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">alpha0</span> <span class="op">+</span> <span class="va">alpha1</span> <span class="op">*</span> <span class="va">x</span>, col <span class="op">=</span> <span class="st">"black"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Marginallinien</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span><span class="op">(</span><span class="va">coefs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">nrm</span><span class="op">)</span><span class="op">/</span><span class="va">coefs</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="va">alpha1</span> <span class="op">*</span> <span class="va">x</span>, </span>
<span>                  col <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span><span class="op">(</span><span class="va">coefs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">/</span><span class="va">nrm</span><span class="op">)</span><span class="op">/</span><span class="va">coefs</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="va">alpha1</span> <span class="op">*</span> <span class="va">x</span>, </span>
<span>                  col <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Support-Vektoren</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">sv</span>, </span>
<span>      mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span><span class="op">)</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>      shape <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      inherit.aes <span class="op">=</span> <span class="cn">F</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Beobachtungen</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-smsvc" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-smsvc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="svm_files/figure-html/fig-smsvc-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-smsvc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;14.4: Soft Margin Support Vector Classifier
</figcaption></figure>
</div>
</div>
</div>
<p>Aufgrund der <em>Soft Margin</em> des SVC werden hier Fehlklassifikationen in Kauf genommen. Beachte, dass sowohl Beobachtungen auf und innerhalb der Margin als auch <em>fehlklassifizierte</em> Beobachtungen die Support-Vektoren der trennenden Geraden sind in <a href="#fig-smsvc" class="quarto-xref">Abbildung&nbsp;<span>14.4</span></a> sind.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Genauigkeit der Klassifizierung für Trainingsdaten</span></span>
<span><span class="va">model_svc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span></span>
<span>    estimate <span class="op">=</span> <span class="va">.</span>, </span>
<span>    truth <span class="op">=</span> <span class="va">lsvm_nonsep_data</span><span class="op">$</span><span class="va">klasse</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://yardstick.tidymodels.org/reference/accuracy.html">accuracy</a></span><span class="op">(</span><span class="va">truth</span>, <span class="va">estimate</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .metric  .estimator .estimate
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
1 accuracy binary          0.85</code></pre>
</div>
</div>
<p><strong>Nicht-lineare und unscharfe Entscheidungsgrenzen</strong></p>
<p>In empirischen Anwendungen gibt es selten exakt lineare Entscheidungsgrenzen. Wir präsentieren nun ein Beispiel für eine nicht-lineare Entscheidungsgrenze, bei der SVC dennoch eine hilfreiche Approximation der Entscheidungsgrenze liefern kann und diskutieren anschließend Support Vector Machines als Generalisierung von SVC zur Anpassung nicht-linearer Grenzen.</p>
<p>Der Datensatz <code>data_wavy</code> enthält gleichverteilte Beobachtungen <span class="math inline">\((X_1, X_2)\)</span> die gemäß der sinuidalen Entscheidungsgrenze</p>
<p><span class="math display">\[\begin{align*}
  g(x_1) =  x_1 + 3\cdot \sin(1.2 \cdot x_1),
\end{align*}\]</span></p>
<p>in zwei Klassen eingeteilt sind: Beoabchtungen gehören zu Klasse 1, wenn <span class="math inline">\(x_2 + \varepsilon &gt; g(x_1)\)</span> und ansonsten zu Klasse 2. Der (normalverteilte) Fehlerterm <span class="math inline">\(\varepsilon\)</span> führt zu einer unscharfen Trennung der Klassen, d.h. der Trainingsdatensatz ist selbst bei Abgleich mit der (nachfolgend als unbekannt angenommenen) Funktion <span class="math inline">\(g(x_1)\)</span> nicht vollständig korrekt klassifizierbar. Wir suchen dennoch einen Classifier, der <span class="math inline">\(g(x_1)\)</span> gut approximiert, also den deterministischen Teil der Entscheidungsregel möglichst gut lernt.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># data_wavy einlesen</span></span>
<span><span class="va">data_wavy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"datasets/data_wavy.RDS"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Zunächst plotten wir die Beobachtungen in <code>data_wavy</code> gemeinsam mit der deterministischen Entscheidungsgrenze <span class="math inline">\(g(x_1)\)</span>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualisiere den Datensatz mit ggplot2</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_wavy</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">x1</span>, </span>
<span>    y <span class="op">=</span> <span class="va">x2</span>, </span>
<span>    color <span class="op">=</span> <span class="va">klasse</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"X1"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"X2"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># deterministische Entscheidungsgrenze</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="fl">1.2</span><span class="op">)</span>, </span>
<span>    lwd <span class="op">=</span> <span class="fl">1.25</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-datawavy" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-datawavy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="svm_files/figure-html/fig-datawavy-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-datawavy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;14.5: <code>data_wavy</code>: Beobachtungen mit nicht-linearer Entscheidungsgrenze
</figcaption></figure>
</div>
</div>
</div>
<p>Ein SVC kann die nicht-lineare Entscheidungsgrenze nicht abbilden, erreicht jedoch aufgrund der groben Teilbarkeit des Regressorraums hinsichtlich der Klassen durch eine (von links unten nach rechts oben verlaufende) Grade eine akzeptable Fehlklassifikationrate. Wir zeigen dies mit R.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Trainiere SV Classifier mit Cost-Kriterium</span></span>
<span><span class="va">svc_wavy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm</a></span><span class="op">(</span></span>
<span>  <span class="va">klasse</span> <span class="op">~</span> <span class="va">.</span>, </span>
<span>  data <span class="op">=</span> <span class="va">data_wavy</span>, </span>
<span>  kernel <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  cost <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">F</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">svc_wavy</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm(formula = klasse ~ ., data = data_wavy, kernel = "linear", cost = 1, 
    scale = F)


Parameters:
   SVM-Type:  C-classification 
 SVM-Kernel:  linear 
       cost:  1 

Number of Support Vectors:  849</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Erzeuge einen Grid für die Vorhersagen</span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html">expand_grid</a></span><span class="op">(</span></span>
<span>  x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">data_wavy</span><span class="op">$</span><span class="va">x1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">data_wavy</span><span class="op">$</span><span class="va">x1</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>,</span>
<span>  x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">data_wavy</span><span class="op">$</span><span class="va">x2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">data_wavy</span><span class="op">$</span><span class="va">x2</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="va">grid</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Vorhersagen auf dem Grid</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    klasse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">svc_wavy</span>, <span class="va">grid</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Daten + Entscheidungsgrenze mit ggplot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">grid</span>, </span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, color <span class="op">=</span> <span class="va">klasse</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">data_wavy</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, color <span class="op">=</span> <span class="va">klasse</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="fl">1.2</span><span class="op">)</span>, </span>
<span>    col <span class="op">=</span> <span class="st">"#00BFC4"</span>, </span>
<span>    lwd <span class="op">=</span> <span class="fl">1.25</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"X1"</span>, y <span class="op">=</span> <span class="st">"X2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-svcwavy" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-svcwavy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="svm_files/figure-html/fig-svcwavy-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-svcwavy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;14.6: <code>data_wavy</code>: Mit SVC trainierte und deerministische Entscheidungsgrenze
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Anteil falscher Klassifzikationen für data_wavy</span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">svc_wavy</span><span class="op">)</span> <span class="op">==</span> <span class="va">data_wavy</span><span class="op">$</span><span class="va">klasse</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1835</code></pre>
</div>
</div>
<p>Diese Fehlerrate kann durch Verfahren, die nicht-lineare Entscheidungsgrenzen lernen können, deutlich verringert werden. Der nächste Abschnitt erläutert eine entsprechende Erweiterung des SVC: <em>Support Vector Machines</em>.</p>
</section><section id="support-vector-machines" class="level2 page-columns page-full" data-number="14.3"><h2 data-number="14.3" class="anchored" data-anchor-id="support-vector-machines">
<span class="header-section-number">14.3</span> Support Vector Machines</h2>
<p>Sei <span class="math inline">\(S\)</span> die <em>Indexmenge</em> der zu findenden Support-Vektoren für den SVC. Mann kann zeigen <span class="citation" data-cites="Hastieetal2013">(vgl. <a href="Literatur.html#ref-Hastieetal2013" role="doc-biblioref">Hastie, Tibshirani, und Friedman 2013</a>)</span>, dass die zu lernende Entscheidungsregel des SVC die Form</p>
<p><span class="math display">\[\begin{align}
  f(x) = b + \alpha_i \sum_{i\in S} \langle\boldsymbol{x},\boldsymbol{x}_j\rangle \label{eq:svck}
\end{align}\]</span></p>
<p>hat, wobei <span class="math inline">\(\langle\boldsymbol{x}_i,\boldsymbol{x}_j\rangle\)</span> das <em>innere Produkt</em> der Vektoren <span class="math inline">\(\boldsymbol{x}_i\)</span> und <span class="math inline">\(\boldsymbol{x}_j\)</span> meint,</p>
<p><span class="math display">\[\begin{align*}
  \langle\boldsymbol{x}_i,\boldsymbol{x}_j\rangle := \sum_{l=1}^k x_{i,l} x_{j,l}.
\end{align*}\]</span></p>
<p>Die Funktion <span class="math inline">\(\langle\boldsymbol{x}_i,\boldsymbol{x}_j\rangle\)</span> ist ein Beispiel für eine <em>Kernel-Funktion</em> <span class="math inline">\(K(\boldsymbol{x}_i,\boldsymbol{x}_j)\)</span>, der <em>lineare Kernel</em>. Ein Kernel <span class="math inline">\(K\)</span> berechnet die “Ähnlichkeit” zwischen zwei Datenpunkten. Mit <span class="math inline">\(K(\boldsymbol{x}_i,\boldsymbol{x}_j)=\langle\boldsymbol{x}_i,\boldsymbol{x}_j\rangle\)</span> wird die lineare Übereinstimmung der Vektoren <span class="math inline">\(\boldsymbol{x}_i\)</span> und <span class="math inline">\(\boldsymbol{x}_j\)</span> im ursprünglichen Regressorraum gemessen und damit eine lineare Klassifikationsregel <span class="math inline">\(f(x)\)</span> gesucht.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;Geometrisch wird die Ähnlichkeit durch den Winkel zwischen den Regressor-Vektoren gemessen: <span class="math inline">\(\langle\boldsymbol{x}_i \boldsymbol{x}_j\rangle = \|\boldsymbol{x}_i\| \|\boldsymbol{x}_j\| \cos(\theta)\)</span>, wobei <span class="math inline">\(\theta\)</span> der Winkel zwischen <span class="math inline">\(\boldsymbol{x}_i\)</span> und <span class="math inline">\(\boldsymbol{x}_j\)</span> ist.</p></div><div id="fn6"><p><sup>6</sup>&nbsp;Der Kernel Trick ist hilfreich, weil die explizite Transformation der Daten rechenaufwendig oder sogar unlösbar sein kann. Kernel-Funktionen hingegen können schnell berechnet werden.</p></div></div><p>Eine <em>Support Vector Machine</em> (SVM) ersetzt das innere Produkt in <span class="math inline">\(\eqref{eq:svck}\)</span> durch einen <em>nicht-linearen</em> Kernel <span class="math inline">\(K\)</span>. Dadurch können SVMs auch hochgradig nicht-lineare Entscheidungsgrenzen lernen: Um die nicht-lineare Beziehungen in den Daten zu modellieren, werden die Regressoren mit einem <span class="math inline">\(K\)</span> implizit so transformiert, dass sie in einem (möglicherweise hoch-dimensionalen) Raum einfacher hinsichtlich ihrer Klasse getrennt werden können. Diese Transformation muss jedoch dank des Kernels nicht explizit berechnet werden — dies ist der <em>Kernel Trick</em>.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<p>Typische nicht-lineare Kernel-Funktionen sind</p>
<ul>
<li>
<p><strong>Radialer Kernel</strong></p>
<p><span class="math display">\[\begin{align*}
  K(\boldsymbol{x}_i,\boldsymbol{x}_j) = \exp\bigg(-\gamma \sum_{l=1}^k (x_{lj} - x_{li})^2\bigg)
\end{align*}\]</span></p>
</li>
<li>
<p><strong>Polynomialer Kernel</strong> (Ordnung <span class="math inline">\(d\)</span>)</p>
<p><span class="math display">\[\begin{align*}
  K(\boldsymbol{x}_i,\boldsymbol{x}_j) = \bigg(c + \sum_{l=1}^k x_{lj} \cdot x_{li} \bigg)^d, \quad c\in\mathbb{R},\ d&gt;1
\end{align*}\]</span></p>
</li>
<li>
<p><strong>Sigmoidaler Kernel</strong></p>
<p><span class="math display">\[\begin{align*}
  K(\boldsymbol{x}_i,\boldsymbol{x}_j) = \tanh\bigg(\gamma\sum_{l=1}^k x_{lj} \cdot x_{li} + c \bigg), \quad c\in\mathbb{R}
\end{align*}\]</span></p>
</li>
</ul>
<p>Zusätzlich zu dem Tuning-Parameter <span class="math inline">\(C\)</span> müssen also für das Training einer Entscheidungsgrenze die Skalierungs- bzw. Positions-Parameter <span class="math inline">\(\gamma\)</span> und <span class="math inline">\(c\)</span> für den Kernel gewählt werden. Letzteres erfolgt in empirischen Anwendungen häufig mit Cross Validation.</p>
<section id="der-kernel-trick" class="level3 page-columns page-full" data-number="14.3.1"><h3 data-number="14.3.1" class="anchored" data-anchor-id="der-kernel-trick">
<span class="header-section-number">14.3.1</span> Der Kernel-Trick</h3>
<p>Um den Kernel Trick zu veranschaulichen, betrachten wir ein binäres Klassifikationsproblem mit einer nicht-linearen Entscheidungsgrenze im Regressorraum für <span class="math inline">\((X_1,X_2)\in\mathbb{R}^2\)</span>, bei dem die Klassenzugehörigkeit der Beobachtungen konzentrisch ist. Wir lesen hierzu den Datensatz <code>data_concentric</code> ein.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># konzentrische Daten einlesen</span></span>
<span><span class="va">data_concentric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"datasets/data_concentric.RDS"</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Für einen Verständnis der Verteilung der Klassenzugehörigkeit im Regressorraum visualisieren wir den Datensatz <code>data_concentric</code> mit <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># `data_concentric` visualisieren</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_concentric</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X1</span>, y <span class="op">=</span> <span class="va">X2</span>, color <span class="op">=</span> <span class="va">klasse</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Seitenverhältnis auf 1 setzten</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-dataconc" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-dataconc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="svm_files/figure-html/fig-dataconc-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dataconc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;14.7: Konzentrisch angeordnete Klassenzugehörigkeit
</figcaption></figure>
</div>
</div>
</div>
<p>Die Klassen der in <a href="#fig-dataconc" class="quarto-xref">Abbildung&nbsp;<span>14.7</span></a> gezeigten Beobachtungen sind aufgrund der konzentrischen Verteilung nicht linear separierbar – die Entscheidungsgrenze hat eine kreisförmige Struktur. Der <em>Kernel-Trick</em> nutz hier eine implizite Daten abbildung in einen höherdimensionalen Raum, in dem die Klassen leichter zu trennen sind.</p>
<p>Wir suchen hierfür einen Kernel <span class="math inline">\(K(\boldsymbol{x}_i, \boldsymbol{x}_j)\)</span>, der “ähnliche” Funktionswerte annimmt, wenn die Datenpunkte <span class="math inline">\(i\)</span> und <span class="math inline">\(j\)</span> zu derselben Klasse gehören. Für die in der Abbildung gezeigte Verteilung empfiehlt sich der <em>polynomiale Kernel</em> mit dem Grad <span class="math inline">\(d = 2\)</span>. Dieser Kernel berechnet die Ähnlichkeit zwischen zwei Datenpunkten <span class="math inline">\(\boldsymbol{x}_i\)</span> und <span class="math inline">\(\boldsymbol{x}_j\)</span> im Regressorraum als</p>
<p><span class="math display">\[\begin{align*}
  K(\boldsymbol{x}_i, \boldsymbol{x}_j) = \left( \sum_{l=1}^k x_{li} \cdot x_{lj} \right)^2.
\end{align*}\]</span></p>
<p>Der polynomiale Kernel entspricht einer quadratischen Beziehung zwischen den Datenpunkten und ist so in der Lage, kreisförmige oder konzentrische Zusammenhänge im Regressorraum zu erfassen. Die Trennbarkeit der Beobachtungen aufgrund ähnlicher Werte des Kernels für Beobachtungen der selben Klasse kann hierbei durch eine explizite Transformation der Datenpunkte in einen höherdimensionalen Raum dargestellt werden. In unserem zwei-dimensionalen Beispiel ist diese Transformation</p>
<p><span class="math display">\[\begin{align}
  \begin{pmatrix}
    x = x_1\\ y = x_2
  \end{pmatrix}
  \rightarrow
  \begin{pmatrix}
    x = x_1\\
    y = x_2\\
    z = x_1^2 + x_2^2.
  \end{pmatrix}
  \label{eq:polykerntrans}
\end{align}\]</span></p>
<p>Die Abbildung <span class="math inline">\(\eqref{eq:polykerntrans}\)</span> projiziert die Daten in den drei-dimensionalen Raum <span class="math inline">\(\mathbb{R}^3\)</span>, wobei die zusätzliche Koordinate <span class="math inline">\(z = x_1^2 + x_2^2\)</span> die (quadratische) Distanz einer Beobachtung vom Ursprung darstellt. In diesem transformierten Raum sind konzentrisch angeordnete Klassen anhand des Wertes von <span class="math inline">\(z\)</span> linear separierbar, was geometrisch einer trennenden Hyperebene entspricht. Durch die Wahl des polynomialen Kernels wird so eine nicht-lineare Trennlinie im ursprünglichen Regressor-Raum <span class="math inline">\(\mathbb{R}^2\)</span> modelliert, welche die kreisförmige Entscheidungsgrenze erfassen kann.</p>
<p>Um dies grafisch zu veranschaulichen, transformieren wir die Datenpunkte in <code>data_concentric</code> gemäß der Funktion <span class="math inline">\(\eqref{eq:polykerntrans}\)</span> nach <span class="math inline">\(\mathbb{R}^3\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Funktion: Explizite Transformation durch </span></span>
<span><span class="co"># polynomiellen Kernel mit d = 2</span></span>
<span><span class="va">poly_transform</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">X1</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">X2</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="va">X_trans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span>, z <span class="op">=</span> <span class="va">X1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">X2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">X_trans</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Transformation furchführen</span></span>
<span><span class="va">X_transformed</span> <span class="op">&lt;-</span> <span class="fu">poly_transform</span><span class="op">(</span></span>
<span>  <span class="va">data_concentric</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Transformierte Beobachtungen</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span><span class="va">X_transformed</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
       X1      X2     z
    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1  0.0380  0.535  0.288
2  0.863  -0.208  0.788
3 -0.514  -0.380  0.409
4 -0.936  -0.0886 0.883
5 -0.794   0.557  0.940</code></pre>
</div>
</div>
<p>Im nächsten Schritt berechnen wir für die transformierten Daten <code>X_transformed</code> unter Verwendung der Klassen in <code>data_concentric$klasse</code> einen SVC, also eine SVM mit linearem Kernel: Wir suchen eine trennende Ebene für die transformierten Daten <code>X_transformed</code> in <span class="math inline">\(\mathbb{R}^3\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># SVM mit einem linearen Kernel </span></span>
<span><span class="co"># auf den transformierten Daten trainieren</span></span>
<span><span class="va">svm_model_poly_trans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">X_transformed</span>, </span>
<span>  y <span class="op">=</span> <span class="va">data_concentric</span><span class="op">$</span><span class="va">klasse</span>, </span>
<span>  kernel <span class="op">=</span> <span class="st">"linear"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">svm_model_poly_trans</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm.default(x = X_transformed, y = data_concentric$klasse, kernel = "linear")


Parameters:
   SVM-Type:  C-classification 
 SVM-Kernel:  linear 
       cost:  1 

Number of Support Vectors:  27</code></pre>
</div>
</div>
<p>Die interaktive <a href="#fig-polytrans3d" class="quarto-xref">Abbildung&nbsp;<span>14.8</span></a> zeigt</p>
<ul>
<li>die transformierten Datenpunkte in <span class="math inline">\(\mathbb{R}^3\)</span>,</li>
<li>die mit dem Modell-Objekt <code>svm_model_poly_trans</code> berechnete trennende Hyperebene (grün) und</li>
<li>die Support-Vektore der Hyperebene (grau hinterlegt).</li>
</ul>
<div class="cell page-columns page-full">
<div id="fig-polytrans3d" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored no-overflow-x page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-polytrans3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="rgl98047" style="width:100%;height:464px;" class="rglWebGL html-widget" role="img" aria-labelledby="rgl98047-aria"></div>
<script type="application/json" data-for="rgl98047">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmode":"modulate","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":7,"objects":{"13":{"id":13,"type":"spheres","material":{},"vertices":"0","colors":"1","radii":[[0.03288200497627258]],"centers":"2","ignoreExtent":false,"fastTransparency":true,"flags":32771},"15":{"id":15,"type":"text","material":{"lit":false,"margin":0,"floating":true,"edge":[0,1,1]},"vertices":"3","colors":"4","texts":[["X1"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"5","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"16":{"id":16,"type":"text","material":{"lit":false,"margin":1,"floating":true,"edge":[1,1,1]},"vertices":"6","colors":"7","texts":[["X2"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"8","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"17":{"id":17,"type":"text","material":{"lit":false,"margin":2,"floating":true,"edge":[1,1,1]},"vertices":"9","colors":"10","texts":[["f(X1, X2)"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"11","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"20":{"id":20,"type":"surface","material":{"alpha":0.4980392158031464,"isTransparent":true},"vertices":"12","colors":"14","dim":[[30,30]],"centers":"15","normals":"13","ignoreExtent":false,"flipped":true,"flags":32811},"21":{"id":21,"type":"points","material":{"lit":false,"size":10},"vertices":"16","colors":"17","centers":"18","ignoreExtent":false,"flags":34816},"11":{"id":11,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"10":{"id":10,"type":"background","material":{},"colors":"19","centers":"20","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"12":{"id":12,"type":"background","material":{"lit":false,"back":"lines"},"colors":"21","centers":"22","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"14":{"id":14,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":"23","colors":"24","axes":{"mode":["pretty","pretty","pretty"],"step":[1,1,1],"nticks":[5,5,5],"marklen":[15,15,15],"expand":[1.029999971389771,1.029999971389771,1.029999971389771]},"draw_front":true,"flags":32769},"7":{"id":7,"type":"subscene","par3d":{"antialias":4,"FOV":60,"ignoreExtent":false,"listeners":7,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,8.801183700561523],"modelMatrix":[[1.018179535865784,0,0,0.01403184700757265],[0,0.1726543009281158,0.9732725024223328,-1.943954586982727],[0,-0.9791709184646606,0.1716142594814301,-9.141620635986328],[0,0,0,1]],"projMatrix":[[2.474358558654785,0,0,0],[0,2.474358558654785,0,0],[0,0,-2,-13.20177555084229],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.1736482232809067,0.9848077297210693,0],[0,-0.9848077297210693,0.1736482232809067,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1.018179535865784,0.994276225566864,0.9882868528366089],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":0.699999988079071,"bbox":[-1.98377001285553,1.956207513809204,-2.015036344528198,2.019661903381348,-0.03264695033431053,4.026503086090088],"windowRect":[1512,44,1768,300],"family":"sans","font":1,"cex":1,"useFreeType":true,"fontname":"/Users/martin/Library/Caches/org.R-project.R/R/renv/cache/v5/R-4.3/aarch64-apple-darwin20/rgl/1.3.1/54f8dcdef54a2c7737c0eec27d394dfd/rgl/fonts/FreeSans.ttf","maxClipPlanes":6,"glVersion":2.1,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[12,14,13,15,16,17,20,21,11],"subscenes":[],"flags":36155}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":672,"height":480,"buffer":{"accessors":[{"bufferView":0,"componentType":5126,"count":400,"type":"VEC3"},{"bufferView":1,"componentType":5121,"count":400,"type":"VEC4","normalized":true},{"bufferView":2,"componentType":5126,"count":400,"type":"VEC3"},{"bufferView":3,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":4,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":5,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":6,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":7,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":8,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":9,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":10,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":11,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":12,"componentType":5126,"count":900,"type":"VEC3"},{"bufferView":13,"componentType":5126,"count":900,"type":"VEC3"},{"bufferView":14,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":15,"componentType":5126,"count":841,"type":"VEC3"},{"bufferView":16,"componentType":5126,"count":27,"type":"VEC3"},{"bufferView":17,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":18,"componentType":5126,"count":27,"type":"VEC3"},{"bufferView":19,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":20,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":21,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":22,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":23,"componentType":5126,"count":13,"type":"VEC3"},{"bufferView":24,"componentType":5121,"count":1,"type":"VEC4"}],"bufferViews":[{"buffer":0,"byteLength":4800,"byteOffset":0},{"buffer":0,"byteLength":1600,"byteOffset":4800},{"buffer":0,"byteLength":4800,"byteOffset":6400},{"buffer":0,"byteLength":12,"byteOffset":11200},{"buffer":0,"byteLength":4,"byteOffset":11212},{"buffer":0,"byteLength":12,"byteOffset":11216},{"buffer":0,"byteLength":12,"byteOffset":11228},{"buffer":0,"byteLength":4,"byteOffset":11240},{"buffer":0,"byteLength":12,"byteOffset":11244},{"buffer":0,"byteLength":12,"byteOffset":11256},{"buffer":0,"byteLength":4,"byteOffset":11268},{"buffer":0,"byteLength":12,"byteOffset":11272},{"buffer":0,"byteLength":10800,"byteOffset":11284},{"buffer":0,"byteLength":10800,"byteOffset":22084},{"buffer":0,"byteLength":16,"byteOffset":32884},{"buffer":0,"byteLength":10092,"byteOffset":32900},{"buffer":0,"byteLength":324,"byteOffset":42992},{"buffer":0,"byteLength":16,"byteOffset":43316},{"buffer":0,"byteLength":324,"byteOffset":43332},{"buffer":0,"byteLength":16,"byteOffset":43656},{"buffer":0,"byteLength":3,"byteOffset":43672},{"buffer":0,"byteLength":4,"byteOffset":43675},{"buffer":0,"byteLength":3,"byteOffset":43679},{"buffer":0,"byteLength":156,"byteOffset":43684},{"buffer":0,"byteLength":4,"byteOffset":43840}],"buffers":[{"byteLength":43844,"bytes":"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\nPz7z9GxAO3Nov3ykqb/aLiVAMk47P2VF5b8OmG9AQJWsv4ruqj4A9vY/7iXiPtWduz9n/BVA\nV+bmPz7YWj4IL1NAbW/SvmMM+T/JGH1A6XnCP6AgZb/YAUdAPf7JP0TDMr9Alj5AyuSZv52I\nqL7+5MY/WwDCPllU+T96BXxADQGsv70Utz2wKOg/V83RPjmMnb+yaNc/eX/Pv5UOiD/kfnBA\nvVWuP0r7hD/EzDtAPH+avvWjxj/d9R9Au4Kgv7hsvj88SXJAlSeMvfmhlj/i3bE/AL/E/wC/\nxP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/\nAL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/\nxP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/\nAL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/\nxP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/\nAL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/\nxP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/\nAL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/\nxP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/\nAL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/\nxP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/\nAL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/\nxP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/\nAL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/\nxP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP8Av8T/AL/E/wC/xP/4dm3/+HZt//h2bf/4dm3/\n+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2\nbf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/\n+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2\nbf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/\n+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2\nbf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/\n+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2\nbf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/\n+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2\nbf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/\n+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2\nbf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/\n+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2\nbf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/\n+HZt//h2bf/4dm3/+HZt//h2bf/4dm3/+HZt/+R2Gz1d8Ag/XD2TPmD3XD+oBlW+Xs5JPy2e\n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\nDphvQECVrL+K7qo+APb2P+4l4j7Vnbs/Z/wVQFfm5j8+2Fo+CC9TQG1v0r5jDPk/yRh9QOl5\nwj+gIGW/2AFHQD3+yT9EwzK/QJY+QMrkmb+diKi+/uTGP1sAwj5ZVPk/egV8QA0BrL+9FLc9\nsCjoP1fN0T45jJ2/smjXP3l/z7+VDog/5H5wQL1Vrj9K+4Q/xMw7QDx/mr71o8Y/3fUfQLuC\noL+4bL4/PElyQJUnjL35oZY/4t2xPwAAwH8AAIBAAACAPwAAAAEAAMB/AACAQAAAgD8AAMB/\nAACAQAAAgD8AAAABAADAfwAAgEAAAIA/AADAfwAAgEAAAIA/AAAAAQAAwH8AAIBAAACAP/DJ\n+b8Hsf2/zTKNPwSv6L8Hsf2/K12NPxiU178Hsf2/ioeNPy15xr8Hsf2/6LGNP0Fetb8Hsf2/\nRtyNP1VDpL8Hsf2/pQaOP2kok78Hsf2/AzGOP34Ngr8Hsf2/YVuOPyTlYb8Hsf2/wIWOP0yv\nP78Hsf2/HrCOP3V5Hb8Hsf2/fNqOPzuH9r4Hsf2/2wSPP4wbsr4Hsf2/OS+PP7pfW74Hsf2/\nl1mPP7gQpb0Hsf2/9oOPPwg8WT0Hsf2/VK6PP2AmPz4Hsf2/stiPP9/+oz4Hsf2/EQOQP45q\n6D4Hsf2/by2QPx5rFj8Hsf2/zVeQP/agOD8Hsf2/LIKQP83WWj8Hsf2/iqyQP6UMfT8Hsf2/\n6NaQPz6hjz8Hsf2/RwGRPyq8oD8Hsf2/pSuRPxbXsT8Hsf2/A1aRPwHywj8Hsf2/YoCRP+0M\n1D8Hsf2/wKqRP9kn5T8Hsf2/HtWRP8VC9j8Hsf2/ff+RP/DJ+b/WLOy/C5yMPwSv6L/WLOy/\nacaMPxiU17/WLOy/x/CMPy15xr/WLOy/JhuNP0Fetb/WLOy/hEWNP1VDpL/WLOy/4m+NP2ko\nk7/WLOy/QZqNP34Ngr/WLOy/n8SNPyTlYb/WLOy//e6NP0yvP7/WLOy/XBmOP3V5Hb/WLOy/\nukOOPzuH9r7WLOy/GG6OP4wbsr7WLOy/d5iOP7pfW77WLOy/1cKOP7gQpb3WLOy/M+2OPwg8\nWT3WLOy/khePP2AmPz7WLOy/8EGPP9/+oz7WLOy/TmyPP45q6D7WLOy/rZaPPx5rFj/WLOy/\nC8GPP/agOD/WLOy/aeuPP83WWj/WLOy/yBWQP6UMfT/WLOy/JkCQPz6hjz/WLOy/hGqQPyq8\noD/WLOy/45SQPxbXsT/WLOy/Qb+QPwHywj/WLOy/n+mQP+0M1D/WLOy//hORP9kn5T/WLOy/\nXD6RP8VC9j/WLOy/umiRP/DJ+b+kqNq/SQWMPwSv6L+kqNq/py+MPxiU17+kqNq/BVqMPy15\nxr+kqNq/ZISMP0Fetb+kqNq/wq6MP1VDpL+kqNq/INmMP2kok7+kqNq/fwONP34Ngr+kqNq/\n3S2NPyTlYb+kqNq/O1iNP0yvP7+kqNq/moKNP3V5Hb+kqNq/+KyNPzuH9r6kqNq/VteNP4wb\nsr6kqNq/tQGOP7pfW76kqNq/EyyOP7gQpb2kqNq/cVaOPwg8WT2kqNq/0ICOP2AmPz6kqNq/\nLquOP9/+oz6kqNq/jNWOP45q6D6kqNq/6/+OPx5rFj+kqNq/SSqPP/agOD+kqNq/p1SPP83W\nWj+kqNq/Bn+PP6UMfT+kqNq/ZKmPPz6hjz+kqNq/wtOPPyq8oD+kqNq/If6PPxbXsT+kqNq/\nfyiQPwHywj+kqNq/3VKQP+0M1D+kqNq/PH2QP9kn5T+kqNq/mqeQP8VC9j+kqNq/+NGQP/DJ\n+b9yJMm/hm6LPwSv6L9yJMm/5ZiLPxiU179yJMm/Q8OLPy15xr9yJMm/oe2LP0Fetb9yJMm/\nABiMP1VDpL9yJMm/XkKMP2kok79yJMm/vGyMP34Ngr9yJMm/G5eMPyTlYb9yJMm/ecGMP0yv\nP79yJMm/1+uMP3V5Hb9yJMm/NhaNPzuH9r5yJMm/lECNP4wbsr5yJMm/8mqNP7pfW75yJMm/\nUZWNP7gQpb1yJMm/r7+NPwg8WT1yJMm/DeqNP2AmPz5yJMm/bBSOP9/+oz5yJMm/yj6OP45q\n6D5yJMm/KGmOPx5rFj9yJMm/h5OOP/agOD9yJMm/5b2OP83WWj9yJMm/Q+iOP6UMfT9yJMm/\nohKPPz6hjz9yJMm/AD2PPyq8oD9yJMm/XmePPxbXsT9yJMm/vZGPPwHywj9yJMm/G7yPP+0M\n1D9yJMm/eeaPP9kn5T9yJMm/2BCQP8VC9j9yJMm/NjuQP/DJ+b9BoLe/xNeKPwSv6L9BoLe/\nIgKLPxiU179BoLe/gSyLPy15xr9BoLe/31aLP0Fetb9BoLe/PYGLP1VDpL9BoLe/nKuLP2ko\nk79BoLe/+tWLP34Ngr9BoLe/WACMPyTlYb9BoLe/tyqMP0yvP79BoLe/FVWMP3V5Hb9BoLe/\nc3+MPzuH9r5BoLe/0qmMP4wbsr5BoLe/MNSMP7pfW75BoLe/jv6MP7gQpb1BoLe/7SiNPwg8\nWT1BoLe/S1ONP2AmPz5BoLe/qX2NP9/+oz5BoLe/CKiNP45q6D5BoLe/ZtKNPx5rFj9BoLe/\nxPyNP/agOD9BoLe/IyeOP83WWj9BoLe/gVGOP6UMfT9BoLe/33uOPz6hjz9BoLe/PqaOPyq8\noD9BoLe/nNCOPxbXsT9BoLe/+vqOPwHywj9BoLe/WSWPP+0M1D9BoLe/t0+PP9kn5T9BoLe/\nFXqPP8VC9j9BoLe/dKSPP/DJ+b8PHKa/AkGKPwSv6L8PHKa/YGuKPxiU178PHKa/vpWKPy15\nxr8PHKa/HcCKP0Fetb8PHKa/e+qKP1VDpL8PHKa/2RSLP2kok78PHKa/OD+LP34Ngr8PHKa/\nlmmLPyTlYb8PHKa/9JOLP0yvP78PHKa/U76LP3V5Hb8PHKa/seiLPzuH9r4PHKa/DxOMP4wb\nsr4PHKa/bj2MP7pfW74PHKa/zGeMP7gQpb0PHKa/KpKMPwg8WT0PHKa/ibyMP2AmPz4PHKa/\n5+aMP9/+oz4PHKa/RRGNP45q6D4PHKa/pDuNPx5rFj8PHKa/AmaNP/agOD8PHKa/YJCNP83W\nWj8PHKa/v7qNP6UMfT8PHKa/HeWNPz6hjz8PHKa/ew+OPyq8oD8PHKa/2jmOPxbXsT8PHKa/\nOGSOPwHywj8PHKa/lo6OP+0M1D8PHKa/9biOP9kn5T8PHKa/U+OOP8VC9j8PHKa/sQ2PP/DJ\n+b/dl5S/QKqJPwSv6L/dl5S/ntSJPxiU17/dl5S//P6JPy15xr/dl5S/WymKP0Fetb/dl5S/\nuVOKP1VDpL/dl5S/F36KP2kok7/dl5S/dqiKP34Ngr/dl5S/1NKKPyTlYb/dl5S/Mv2KP0yv\nP7/dl5S/kSeLP3V5Hb/dl5S/71GLPzuH9r7dl5S/TXyLP4wbsr7dl5S/rKaLP7pfW77dl5S/\nCtGLP7gQpb3dl5S/aPuLPwg8WT3dl5S/xyWMP2AmPz7dl5S/JVCMP9/+oz7dl5S/g3qMP45q\n6D7dl5S/4qSMPx5rFj/dl5S/QM+MP/agOD/dl5S/nvmMP83WWj/dl5S//SONP6UMfT/dl5S/\nW06NPz6hjz/dl5S/uXiNPyq8oD/dl5S/GKONPxbXsT/dl5S/ds2NPwHywj/dl5S/1PeNP+0M\n1D/dl5S/MyKOP9kn5T/dl5S/kUyOP8VC9j/dl5S/73aOP/DJ+b+sE4O/fROJPwSv6L+sE4O/\n3D2JPxiU17+sE4O/OmiJPy15xr+sE4O/mJKJP0Fetb+sE4O/97yJP1VDpL+sE4O/VeeJP2ko\nk7+sE4O/sxGKP34Ngr+sE4O/EjyKPyTlYb+sE4O/cGaKP0yvP7+sE4O/zpCKP3V5Hb+sE4O/\nLbuKPzuH9r6sE4O/i+WKP4wbsr6sE4O/6Q+LP7pfW76sE4O/SDqLP7gQpb2sE4O/pmSLPwg8\nWT2sE4O/BI+LP2AmPz6sE4O/Y7mLP9/+oz6sE4O/weOLP45q6D6sE4O/Hw6MPx5rFj+sE4O/\nfjiMP/agOD+sE4O/3GKMP83WWj+sE4O/Oo2MP6UMfT+sE4O/mbeMPz6hjz+sE4O/9+GMPyq8\noD+sE4O/VQyNPxbXsT+sE4O/tDaNPwHywj+sE4O/EmGNP+0M1D+sE4O/cIuNP9kn5T+sE4O/\nz7WNP8VC9j+sE4O/LeCNP/DJ+b/0HmO/u3yIPwSv6L/0HmO/GaeIPxiU17/0HmO/eNGIPy15\nxr/0HmO/1vuIP0Fetb/0HmO/NCaJP1VDpL/0HmO/k1CJP2kok7/0HmO/8XqJP34Ngr/0HmO/\nT6WJPyTlYb/0HmO/rs+JP0yvP7/0HmO/DPqJP3V5Hb/0HmO/aiSKPzuH9r70HmO/yU6KP4wb\nsr70HmO/J3mKP7pfW770HmO/haOKP7gQpb30HmO/5M2KPwg8WT30HmO/QviKP2AmPz70HmO/\noCKLP9/+oz70HmO//0yLP45q6D70HmO/XXeLPx5rFj/0HmO/u6GLP/agOD/0HmO/GsyLP83W\nWj/0HmO/ePaLP6UMfT/0HmO/1iCMPz6hjz/0HmO/NUuMPyq8oD/0HmO/k3WMPxbXsT/0HmO/\n8Z+MPwHywj/0HmO/UMqMP+0M1D/0HmO/rvSMP9kn5T/0HmO/DB+NP8VC9j/0HmO/a0mNP/DJ\n+b+RFkC/+eWHPwSv6L+RFkC/VxCIPxiU17+RFkC/tTqIPy15xr+RFkC/FGWIP0Fetb+RFkC/\nco+IP1VDpL+RFkC/0LmIP2kok7+RFkC/L+SIP34Ngr+RFkC/jQ6JPyTlYb+RFkC/6ziJP0yv\nP7+RFkC/SmOJP3V5Hb+RFkC/qI2JPzuH9r6RFkC/BriJP4wbsr6RFkC/ZeKJP7pfW76RFkC/\nwwyKP7gQpb2RFkC/ITeKPwg8WT2RFkC/gGGKP2AmPz6RFkC/3ouKP9/+oz6RFkC/PLaKP45q\n6D6RFkC/m+CKPx5rFj+RFkC/+QqLP/agOD+RFkC/VzWLP83WWj+RFkC/tl+LP6UMfT+RFkC/\nFIqLPz6hjz+RFkC/crSLPyq8oD+RFkC/0d6LPxbXsT+RFkC/LwmMPwHywj+RFkC/jTOMP+0M\n1D+RFkC/7F2MP9kn5T+RFkC/SoiMP8VC9j+RFkC/qLKMP/DJ+b8uDh2/N0+HPwSv6L8uDh2/\nlXmHPxiU178uDh2/86OHPy15xr8uDh2/Us6HP0Fetb8uDh2/sPiHP1VDpL8uDh2/DiOIP2ko\nk78uDh2/bU2IP34Ngr8uDh2/y3eIPyTlYb8uDh2/KaKIP0yvP78uDh2/iMyIP3V5Hb8uDh2/\n5vaIPzuH9r4uDh2/RCGJP4wbsr4uDh2/o0uJP7pfW74uDh2/AXaJP7gQpb0uDh2/X6CJPwg8\nWT0uDh2/vsqJP2AmPz4uDh2/HPWJP9/+oz4uDh2/eh+KP45q6D4uDh2/2UmKPx5rFj8uDh2/\nN3SKP/agOD8uDh2/lZ6KP83WWj8uDh2/9MiKP6UMfT8uDh2/UvOKPz6hjz8uDh2/sB2LPyq8\noD8uDh2/D0iLPxbXsT8uDh2/bXKLPwHywj8uDh2/y5yLP+0M1D8uDh2/KseLP9kn5T8uDh2/\niPGLP8VC9j8uDh2/5huMP/DJ+b+UC/S+dLiGPwSv6L+UC/S+0+KGPxiU17+UC/S+MQ2HPy15\nxr+UC/S+jzeHP0Fetb+UC/S+7mGHP1VDpL+UC/S+TIyHP2kok7+UC/S+qraHP34Ngr+UC/S+\nCeGHPyTlYb+UC/S+ZwuIP0yvP7+UC/S+xTWIP3V5Hb+UC/S+JGCIPzuH9r6UC/S+goqIP4wb\nsr6UC/S+4LSIP7pfW76UC/S+P9+IP7gQpb2UC/S+nQmJPwg8WT2UC/S++zOJP2AmPz6UC/S+\nWl6JP9/+oz6UC/S+uIiJP45q6D6UC/S+FrOJPx5rFj+UC/S+dd2JP/agOD+UC/S+0weKP83W\nWj+UC/S+MTKKP6UMfT+UC/S+kFyKPz6hjz+UC/S+7oaKPyq8oD+UC/S+TLGKPxbXsT+UC/S+\nq9uKPwHywj+UC/S+CQaLP+0M1D+UC/S+ZzCLP9kn5T+UC/S+xlqLP8VC9j+UC/S+JIWLP/DJ\n+b/O+q2+siGGPwSv6L/O+q2+EEyGPxiU17/O+q2+b3aGPy15xr/O+q2+zaCGP0Fetb/O+q2+\nK8uGP1VDpL/O+q2+ivWGP2kok7/O+q2+6B+HP34Ngr/O+q2+RkqHPyTlYb/O+q2+pXSHP0yv\nP7/O+q2+A5+HP3V5Hb/O+q2+YcmHPzuH9r7O+q2+wPOHP4wbsr7O+q2+Hh6IP7pfW77O+q2+\nfEiIP7gQpb3O+q2+23KIPwg8WT3O+q2+OZ2IP2AmPz7O+q2+l8eIP9/+oz7O+q2+9vGIP45q\n6D7O+q2+VByJPx5rFj/O+q2+skaJP/agOD/O+q2+EXGJP83WWj/O+q2+b5uJP6UMfT/O+q2+\nzcWJPz6hjz/O+q2+LPCJPyq8oD/O+q2+ihqKPxbXsT/O+q2+6ESKPwHywj/O+q2+R2+KP+0M\n1D/O+q2+pZmKP9kn5T/O+q2+A8SKP8VC9j/O+q2+Yu6KP/DJ+b8O1E++8IqFPwSv6L8O1E++\nTrWFPxiU178O1E++rN+FPy15xr8O1E++CwqGP0Fetb8O1E++aTSGP1VDpL8O1E++x16GP2ko\nk78O1E++JomGP34Ngr8O1E++hLOGPyTlYb8O1E++4t2GP0yvP78O1E++QQiHP3V5Hb8O1E++\nnzKHPzuH9r4O1E++/VyHP4wbsr4O1E++XIeHP7pfW74O1E++urGHP7gQpb0O1E++GNyHPwg8\nWT0O1E++dwaIP2AmPz4O1E++1TCIP9/+oz4O1E++M1uIP45q6D4O1E++koWIPx5rFj8O1E++\n8K+IP/agOD8O1E++TtqIP83WWj8O1E++rQSJP6UMfT8O1E++Cy+JPz6hjz8O1E++aVmJPyq8\noD8O1E++yIOJPxbXsT8O1E++Jq6JPwHywj8O1E++hNiJP+0M1D8O1E++4wKKP9kn5T8O1E++\nQS2KP8VC9j8O1E++n1eKP/DJ+b8CZYe9LvSEPwSv6L8CZYe9jB6FPxiU178CZYe96kiFPy15\nxr8CZYe9SXOFP0Fetb8CZYe9p52FP1VDpL8CZYe9BciFP2kok78CZYe9ZPKFP34Ngr8CZYe9\nwhyGPyTlYb8CZYe9IEeGP0yvP78CZYe9f3GGP3V5Hb8CZYe93ZuGPzuH9r4CZYe9O8aGP4wb\nsr4CZYe9mvCGP7pfW74CZYe9+BqHP7gQpb0CZYe9VkWHPwg8WT0CZYe9tW+HP2AmPz4CZYe9\nE5qHP9/+oz4CZYe9ccSHP45q6D4CZYe90O6HPx5rFj8CZYe9LhmIP/agOD8CZYe9jEOIP83W\nWj8CZYe9622IP6UMfT8CZYe9SZiIPz6hjz8CZYe9p8KIPyq8oD8CZYe9Bu2IPxbXsT8CZYe9\nZBeJPwHywj8CZYe9wkGJP+0M1D8CZYe9IWyJP9kn5T8CZYe9f5aJP8VC9j8CZYe93cCJP/DJ\n+b8Y3pA9a12EPwSv6L8Y3pA9yoeEPxiU178Y3pA9KLKEPy15xr8Y3pA9htyEP0Fetb8Y3pA9\n5QaFP1VDpL8Y3pA9QzGFP2kok78Y3pA9oVuFP34Ngr8Y3pA9AIaFPyTlYb8Y3pA9XrCFP0yv\nP78Y3pA9vNqFP3V5Hb8Y3pA9GwWGPzuH9r4Y3pA9eS+GP4wbsr4Y3pA911mGP7pfW74Y3pA9\nNoSGP7gQpb0Y3pA9lK6GPwg8WT0Y3pA98tiGP2AmPz4Y3pA9UQOHP9/+oz4Y3pA9ry2HP45q\n6D4Y3pA9DViHPx5rFj8Y3pA9bIKHP/agOD8Y3pA9yqyHP83WWj8Y3pA9KNeHP6UMfT8Y3pA9\nhwGIPz6hjz8Y3pA95SuIPyq8oD8Y3pA9Q1aIPxbXsT8Y3pA9ooCIPwHywj8Y3pA9AKuIP+0M\n1D8Y3pA9XtWIP9kn5T8Y3pA9vf+IP8VC9j8Y3pA9GyqJP/DJ+b+ZkFQ+qcaDPwSv6L+ZkFQ+\nB/GDPxiU17+ZkFQ+ZhuEPy15xr+ZkFQ+xEWEP0Fetb+ZkFQ+InCEP1VDpL+ZkFQ+gZqEP2ko\nk7+ZkFQ+38SEP34Ngr+ZkFQ+Pe+EPyTlYb+ZkFQ+nBmFP0yvP7+ZkFQ++kOFP3V5Hb+ZkFQ+\nWG6FPzuH9r6ZkFQ+t5iFP4wbsr6ZkFQ+FcOFP7pfW76ZkFQ+c+2FP7gQpb2ZkFQ+0heGPwg8\nWT2ZkFQ+MEKGP2AmPz6ZkFQ+jmyGP9/+oz6ZkFQ+7ZaGP45q6D6ZkFQ+S8GGPx5rFj+ZkFQ+\nqeuGP/agOD+ZkFQ+CBaHP83WWj+ZkFQ+ZkCHP6UMfT+ZkFQ+xGqHPz6hjz+ZkFQ+I5WHPyq8\noD+ZkFQ+gb+HPxbXsT+ZkFQ+3+mHPwHywj+ZkFQ+PhSIP+0M1D+ZkFQ+nD6IP9kn5T+ZkFQ+\n+miIP8VC9j+ZkFQ+WZOIP/DJ+b8TWbA+5y+DPwSv6L8TWbA+RVqDPxiU178TWbA+o4SDPy15\nxr8TWbA+Aq+DP0Fetb8TWbA+YNmDP1VDpL8TWbA+vgOEP2kok78TWbA+HS6EP34Ngr8TWbA+\ne1iEPyTlYb8TWbA+2YKEP0yvP78TWbA+OK2EP3V5Hb8TWbA+lteEPzuH9r4TWbA+9AGFP4wb\nsr4TWbA+UyyFP7pfW74TWbA+sVaFP7gQpb0TWbA+D4GFPwg8WT0TWbA+bquFP2AmPz4TWbA+\nzNWFP9/+oz4TWbA+KgCGP45q6D4TWbA+iSqGPx5rFj8TWbA+51SGP/agOD8TWbA+RX+GP83W\nWj8TWbA+pKmGP6UMfT8TWbA+AtSGPz6hjz8TWbA+YP6GPyq8oD8TWbA+vyiHPxbXsT8TWbA+\nHVOHPwHywj8TWbA+e32HP+0M1D8TWbA+2qeHP9kn5T8TWbA+ONKHP8VC9j8TWbA+lvyHP/DJ\n+b/aafY+JZmCPwSv6L/aafY+g8OCPxiU17/aafY+4e2CPy15xr/aafY+QBiDP0Fetb/aafY+\nnkKDP1VDpL/aafY+/GyDP2kok7/aafY+W5eDP34Ngr/aafY+ucGDPyTlYb/aafY+F+yDP0yv\nP7/aafY+dhaEP3V5Hb/aafY+1ECEPzuH9r7aafY+MmuEP4wbsr7aafY+kZWEP7pfW77aafY+\n77+EP7gQpb3aafY+TeqEPwg8WT3aafY+rBSFP2AmPz7aafY+Cj+FP9/+oz7aafY+aGmFP45q\n6D7aafY+x5OFPx5rFj/aafY+Jb6FP/agOD/aafY+g+iFP83WWj/aafY+4hKGP6UMfT/aafY+\nQD2GPz6hjz/aafY+nmeGPyq8oD/aafY+/ZGGPxbXsT/aafY+W7yGPwHywj/aafY+ueaGP+0M\n1D/aafY+GBGHP9kn5T/aafY+djuHP8VC9j/aafY+1GWHP/DJ+b9QPR4/YgKCPwSv6L9QPR4/\nwSyCPxiU179QPR4/H1eCPy15xr9QPR4/fYGCP0Fetb9QPR4/3KuCP1VDpL9QPR4/OtaCP2ko\nk79QPR4/mACDP34Ngr9QPR4/9yqDPyTlYb9QPR4/VVWDP0yvP79QPR4/s3+DP3V5Hb9QPR4/\nEqqDPzuH9r5QPR4/cNSDP4wbsr5QPR4/zv6DP7pfW75QPR4/LSmEP7gQpb1QPR4/i1OEPwg8\nWT1QPR4/6X2EP2AmPz5QPR4/SKiEP9/+oz5QPR4/ptKEP45q6D5QPR4/BP2EPx5rFj9QPR4/\nYyeFP/agOD9QPR4/wVGFP83WWj9QPR4/H3yFP6UMfT9QPR4/fqaFPz6hjz9QPR4/3NCFPyq8\noD9QPR4/OvuFPxbXsT9QPR4/mSWGPwHywj9QPR4/90+GP+0M1D9QPR4/VXqGP9kn5T9QPR4/\ntKSGP8VC9j9QPR4/Es+GP/DJ+b+0RUE/oGuBPwSv6L+0RUE//pWBPxiU17+0RUE/XcCBPy15\nxr+0RUE/u+qBP0Fetb+0RUE/GRWCP1VDpL+0RUE/eD+CP2kok7+0RUE/1mmCP34Ngr+0RUE/\nNJSCPyTlYb+0RUE/k76CP0yvP7+0RUE/8eiCP3V5Hb+0RUE/TxODPzuH9r60RUE/rj2DP4wb\nsr60RUE/DGiDP7pfW760RUE/apKDP7gQpb20RUE/ybyDPwg8WT20RUE/J+eDP2AmPz60RUE/\nhRGEP9/+oz60RUE/5DuEP45q6D60RUE/QmaEPx5rFj+0RUE/oJCEP/agOD+0RUE//7qEP83W\nWj+0RUE/XeWEP6UMfT+0RUE/uw+FPz6hjz+0RUE/GjqFPyq8oD+0RUE/eGSFPxbXsT+0RUE/\n1o6FPwHywj+0RUE/NbmFP+0M1D+0RUE/k+OFP9kn5T+0RUE/8Q2GP8VC9j+0RUE/UDiGP/DJ\n+b8XTmQ/3tSAPwSv6L8XTmQ/PP+APxiU178XTmQ/mimBPy15xr8XTmQ/+VOBP0Fetb8XTmQ/\nV36BP1VDpL8XTmQ/taiBP2kok78XTmQ/FNOBP34Ngr8XTmQ/cv2BPyTlYb8XTmQ/0CeCP0yv\nP78XTmQ/L1KCP3V5Hb8XTmQ/jXyCPzuH9r4XTmQ/66aCP4wbsr4XTmQ/StGCP7pfW74XTmQ/\nqPuCP7gQpb0XTmQ/BiaDPwg8WT0XTmQ/ZVCDP2AmPz4XTmQ/w3qDP9/+oz4XTmQ/IaWDP45q\n6D4XTmQ/gM+DPx5rFj8XTmQ/3vmDP/agOD8XTmQ/PCSEP83WWj8XTmQ/m06EP6UMfT8XTmQ/\n+XiEPz6hjz8XTmQ/V6OEPyq8oD8XTmQ/ts2EPxbXsT8XTmQ/FPiEPwHywj8XTmQ/ciKFP+0M\n1D8XTmQ/0UyFP9kn5T8XTmQ/L3eFP8VC9j8XTmQ/jaGFP/DJ+b89q4M/HD6APwSv6L89q4M/\nemiAPxiU1789q4M/2JKAPy15xr89q4M/N72AP0Fetb89q4M/leeAP1VDpL89q4M/8xGBP2ko\nk789q4M/UjyBP34Ngr89q4M/sGaBPyTlYb89q4M/DpGBP0yvP789q4M/bbuBP3V5Hb89q4M/\ny+WBPzuH9r49q4M/KRCCP4wbsr49q4M/iDqCP7pfW749q4M/5mSCP7gQpb09q4M/RI+CPwg8\nWT09q4M/o7mCP2AmPz49q4M/AeSCP9/+oz49q4M/Xw6DP45q6D49q4M/vjiDPx5rFj89q4M/\nHGODP/agOD89q4M/eo2DP83WWj89q4M/2beDP6UMfT89q4M/N+KDPz6hjz89q4M/lQyEPyq8\noD89q4M/9DaEPxbXsT89q4M/UmGEPwHywj89q4M/sIuEP+0M1D89q4M/D7aEP9kn5T89q4M/\nbeCEP8VC9j89q4M/ywqFP/DJ+b9vL5U/s05/PwSv6L9vL5U/b6N/PxiU179vL5U/LPh/Py15\nxr9vL5U/dCaAP0Fetb9vL5U/01CAP1VDpL9vL5U/MXuAP2kok79vL5U/j6WAP34Ngr9vL5U/\n7s+APyTlYb9vL5U/TPqAP0yvP79vL5U/qiSBP3V5Hb9vL5U/CU+BPzuH9r5vL5U/Z3mBP4wb\nsr5vL5U/xaOBP7pfW75vL5U/JM6BP7gQpb1vL5U/gviBPwg8WT1vL5U/4CKCP2AmPz5vL5U/\nP02CP9/+oz5vL5U/nXeCP45q6D5vL5U/+6GCPx5rFj9vL5U/WsyCP/agOD9vL5U/uPaCP83W\nWj9vL5U/FiGDP6UMfT9vL5U/dUuDPz6hjz9vL5U/03WDPyq8oD9vL5U/MaCDPxbXsT9vL5U/\nkMqDPwHywj9vL5U/7vSDP+0M1D9vL5U/TB+EP9kn5T9vL5U/q0mEP8VC9j9vL5U/CXSEP/DJ\n+b+gs6Y/LiF+PwSv6L+gs6Y/63V+PxiU17+gs6Y/p8p+Py15xr+gs6Y/ZB9/P0Fetb+gs6Y/\nIXR/P1VDpL+gs6Y/3ch/P2kok7+gs6Y/zQ6AP34Ngr+gs6Y/KzmAPyTlYb+gs6Y/imOAP0yv\nP7+gs6Y/6I2AP3V5Hb+gs6Y/RriAPzuH9r6gs6Y/peKAP4wbsr6gs6Y/Aw2BP7pfW76gs6Y/\nYTeBP7gQpb2gs6Y/wGGBPwg8WT2gs6Y/HoyBP2AmPz6gs6Y/fLaBP9/+oz6gs6Y/2+CBP45q\n6D6gs6Y/OQuCPx5rFj+gs6Y/lzWCP/agOD+gs6Y/9l+CP83WWj+gs6Y/VIqCP6UMfT+gs6Y/\nsrSCPz6hjz+gs6Y/Ed+CPyq8oD+gs6Y/bwmDPxbXsT+gs6Y/zTODPwHywj+gs6Y/LF6DP+0M\n1D+gs6Y/ioiDP9kn5T+gs6Y/6LKDP8VC9j+gs6Y/R92DP/DJ+b/SN7g/qvN8PwSv6L/SN7g/\nZkh9PxiU17/SN7g/I519Py15xr/SN7g/4PF9P0Fetb/SN7g/nEZ+P1VDpL/SN7g/WZt+P2ko\nk7/SN7g/FvB+P34Ngr/SN7g/0kR/PyTlYb/SN7g/j5l/P0yvP7/SN7g/TO5/P3V5Hb/SN7g/\nhCGAPzuH9r7SN7g/4kuAP4wbsr7SN7g/QXaAP7pfW77SN7g/n6CAP7gQpb3SN7g//cqAPwg8\nWT3SN7g/XPWAP2AmPz7SN7g/uh+BP9/+oz7SN7g/GEqBP45q6D7SN7g/d3SBPx5rFj/SN7g/\n1Z6BP/agOD/SN7g/M8mBP83WWj/SN7g/kvOBP6UMfT/SN7g/8B2CPz6hjz/SN7g/TkiCPyq8\noD/SN7g/rXKCPxbXsT/SN7g/C52CPwHywj/SN7g/aceCP+0M1D/SN7g/yPGCP9kn5T/SN7g/\nJhyDP8VC9j/SN7g/hEaDP/DJ+b8EvMk/JcZ7PwSv6L8EvMk/4hp8PxiU178EvMk/nm98Py15\nxr8EvMk/W8R8P0Fetb8EvMk/GBl9P1VDpL8EvMk/1G19P2kok78EvMk/kcJ9P34Ngr8EvMk/\nThd+PyTlYb8EvMk/Cmx+P0yvP78EvMk/x8B+P3V5Hb8EvMk/hBV/PzuH9r4EvMk/QGp/P4wb\nsr4EvMk//b5/P7pfW74EvMk/3QmAP7gQpb0EvMk/OzSAPwg8WT0EvMk/ml6AP2AmPz4EvMk/\n+IiAP9/+oz4EvMk/VrOAP45q6D4EvMk/td2APx5rFj8EvMk/EwiBP/agOD8EvMk/cTKBP83W\nWj8EvMk/0FyBP6UMfT8EvMk/LoeBPz6hjz8EvMk/jLGBPyq8oD8EvMk/69uBPxbXsT8EvMk/\nSQaCPwHywj8EvMk/pzCCP+0M1D8EvMk/BluCP9kn5T8EvMk/ZIWCP8VC9j8EvMk/wq+CP/DJ\n+b81QNs/oZh6PwSv6L81QNs/Xe16PxiU1781QNs/GkJ7Py15xr81QNs/15Z7P0Fetb81QNs/\nk+t7P1VDpL81QNs/UEB8P2kok781QNs/DZV8P34Ngr81QNs/yel8PyTlYb81QNs/hj59P0yv\nP781QNs/Q5N9P3V5Hb81QNs//+d9PzuH9r41QNs/vDx+P4wbsr41QNs/eZF+P7pfW741QNs/\nNeZ+P7gQpb01QNs/8jp/Pwg8WT01QNs/r49/P2AmPz41QNs/a+R/P9/+oz41QNs/lByAP45q\n6D41QNs/8kaAPx5rFj81QNs/UXGAP/agOD81QNs/r5uAP83WWj81QNs/DcaAP6UMfT81QNs/\nbPCAPz6hjz81QNs/yhqBPyq8oD81QNs/KEWBPxbXsT81QNs/h2+BPwHywj81QNs/5ZmBP+0M\n1D81QNs/Q8SBP9kn5T81QNs/ou6BP8VC9j81QNs/ABmCP/DJ+b9nxOw/HGt5PwSv6L9nxOw/\n2b95PxiU179nxOw/lRR6Py15xr9nxOw/Uml6P0Fetb9nxOw/D756P1VDpL9nxOw/yxJ7P2ko\nk79nxOw/iGd7P34Ngr9nxOw/Rbx7PyTlYb9nxOw/ARF8P0yvP79nxOw/vmV8P3V5Hb9nxOw/\ne7p8PzuH9r5nxOw/Nw99P4wbsr5nxOw/9GN9P7pfW75nxOw/sbh9P7gQpb1nxOw/bQ1+Pwg8\nWT1nxOw/KmJ+P2AmPz5nxOw/57Z+P9/+oz5nxOw/owt/P45q6D5nxOw/YGB/Px5rFj9nxOw/\nHbV/P/agOD9nxOw/7QSAP83WWj9nxOw/Sy+AP6UMfT9nxOw/qVmAPz6hjz9nxOw/CISAPyq8\noD9nxOw/Zq6APxbXsT9nxOw/xNiAPwHywj9nxOw/IwOBP+0M1D9nxOw/gS2BP9kn5T9nxOw/\n31eBP8VC9j9nxOw/PoKBP/DJ+b+ZSP4/mD14PwSv6L+ZSP4/VJJ4PxiU17+ZSP4/Eed4Py15\nxr+ZSP4/zjt5P0Fetb+ZSP4/ipB5P1VDpL+ZSP4/R+V5P2kok7+ZSP4/BDp6P34Ngr+ZSP4/\nwI56PyTlYb+ZSP4/feN6P0yvP7+ZSP4/Ojh7P3V5Hb+ZSP4/9ox7PzuH9r6ZSP4/s+F7P4wb\nsr6ZSP4/cDZ8P7pfW76ZSP4/LIt8P7gQpb2ZSP4/6d98Pwg8WT2ZSP4/pjR9P2AmPz6ZSP4/\nYol9P9/+oz6ZSP4/H959P45q6D6ZSP4/3DJ+Px5rFj+ZSP4/mId+P/agOD+ZSP4/Vdx+P83W\nWj+ZSP4/EjF/P6UMfT+ZSP4/zoV/Pz6hjz+ZSP4/i9p/Pyq8oD+ZSP4/pBeAPxbXsT+ZSP4/\nAkKAPwHywj+ZSP4/YGyAP+0M1D+ZSP4/v5aAP9kn5T+ZSP4/HcGAP8VC9j+ZSP4/e+uAPyZs\nHrxpnwk979d/PxdtHrylnwk98Nd/PwpuHrzenwk979d/PxptHryjnwk979d/PxdtHrylnwk9\n8Nd/PwZuHrzenwk979d/PxttHryjnwk979d/PxttHrylnwk98Nd/PwZuHrzenwk979d/Pxlt\nHryknwk98Nd/PxltHryjnwk98Nd/PwhuHrzdnwk979d/PxhtHryjnwk979d/PxltHryknwk9\n8Nd/PwhuHrzdnwk979d/PxhtHryjnwk979d/PxltHryknwk98Nd/PwhuHrzdnwk979d/Pxpt\nHryjnwk98Nd/PxltHryjnwk98Nd/PwhuHrzenwk98Nd/PxltHryjnwk98Nd/PxhtHryjnwk9\n8Nd/PwduHrzenwk98Nd/PxZtHryjnwk979d/PxttHrylnwk98Nd/PwpuHrzenwk979d/PxZt\nHryjnwk979d/PxdtHrylnwk98Nd/PwZuHrzenwk979d/PyhsHrxlnwk98Nd/P59sHryCnwk9\n79d/PwtuHryfnwk979d/P5NtHryCnwk979d/P59sHryCnwk979d/PwduHryfnwk979d/P5Jt\nHryCnwk979d/P6NsHryCnwk979d/PwduHryfnwk979d/P5BtHryBnwk979d/P6JsHryBnwk9\n79d/PwhuHryfnwk979d/P5BtHryCnwk979d/P6BsHryCnwk979d/PwhuHryfnwk979d/P5Bt\nHryCnwk979d/P6BsHryCnwk979d/PwhuHryfnwk979d/P5JtHryBnwk979d/P6FsHryCnwk9\n79d/PwduHryenwk979d/P49tHryBnwk979d/P6JsHryBnwk979d/PwhuHryenwk979d/P45t\nHryCnwk979d/P6NsHryCnwk979d/PwtuHryfnwk979d/P45tHryCnwk979d/P59sHryCnwk9\n79d/PxdtHrygnwk979d/PxhtHrybnwk979d/P6BsHrx+nwk98Nd/P5RtHrx9nwk979d/Pwtu\nHryanwk979d/P6BsHrx+nwk98Nd/P5BtHrx+nwk98Nd/PwpuHryanwk979d/P6RsHrx9nwk9\n79d/P5BtHrx+nwk98Nd/PwluHryanwk979d/P6RsHrx9nwk979d/P5FtHrx9nwk979d/Pwpu\nHrybnwk979d/P6JsHrx+nwk979d/P5FtHrx9nwk979d/PwpuHrybnwk979d/P6JsHrx+nwk9\n79d/P5FtHrx9nwk979d/PwpuHryanwk979d/P6FsHrx9nwk979d/P5FtHrx9nwk979d/Pwhu\nHryanwk979d/P6JsHrx9nwk979d/P5FtHrx9nwk979d/PwduHrybnwk98Nd/P6RsHrx9nwk9\n79d/P5NtHrx9nwk979d/PwduHrybnwk98Nd/P6BsHrx+nwk98Nd/PylsHrxhnwk979d/Pwdu\nHrzZnwk98Nd/P49tHry8nwk98Nd/PxttHryenwk979d/P5JtHry7nwk979d/P49tHry8nwk9\n8Nd/PxhtHryfnwk98Nd/P5NtHry8nwk979d/P5JtHry7nwk979d/PxhtHryfnwk98Nd/P5Bt\nHry8nwk979d/P5FtHry8nwk979d/PxltHryfnwk979d/P5BtHry8nwk979d/P5BtHry8nwk9\n79d/PxltHryfnwk979d/P5BtHry8nwk979d/P5BtHry8nwk979d/PxltHryfnwk979d/P5Ft\nHry8nwk979d/P5BtHry7nwk979d/PxhtHryenwk979d/P49tHry7nwk979d/P5BtHry7nwk9\n79d/PxltHryenwk979d/P49tHry8nwk98Nd/P5NtHry8nwk979d/PxxtHryfnwk979d/P49t\nHry8nwk98Nd/P49tHry8nwk98Nd/PxhtHrygnwk98Nd/PxhtHrygnwk98Nd/P49tHry8nwk9\n79d/P5JtHry8nwk979d/PxttHryfnwk979d/P49tHry8nwk979d/P45tHry8nwk979d/Pxpt\nHryfnwk979d/P5NtHry8nwk979d/P45tHry8nwk979d/PxltHryenwk979d/P5FtHry8nwk9\n79d/P5BtHry8nwk979d/PxhtHryfnwk979d/P5BtHry8nwk979d/P5BtHry8nwk979d/Pxht\nHryfnwk979d/P5BtHry8nwk979d/P5BtHry8nwk979d/PxptHryenwk979d/P5BtHry8nwk9\n79d/P5FtHry7nwk979d/PxhtHryfnwk979d/P49tHry8nwk979d/P49tHry7nwk979d/PxZt\nHryfnwk979d/P5NtHry8nwk979d/P5NtHry8nwk979d/PxZtHryfnwk979d/P49tHry8nwk9\n79d/PwZuHrzanwk979d/PyhsHrxhnwk979d/P6BsHrx+nwk98Nd/PwtuHrybnwk979d/P5Nt\nHrx9nwk979d/P6BsHrx+nwk98Nd/PwhuHrybnwk98Nd/P5JtHrx+nwk979d/P6RsHrx+nwk9\n79d/PwhuHrybnwk98Nd/P5FtHrx9nwk979d/P6JsHrx9nwk979d/PwhuHrybnwk979d/P5Jt\nHrx+nwk979d/P6JsHrx+nwk979d/PwhuHrybnwk979d/P5JtHrx+nwk979d/P6JsHrx+nwk9\n79d/PwhuHrybnwk979d/P5JtHrx9nwk979d/P6JsHrx9nwk979d/PwhuHryanwk979d/P5Bt\nHrx9nwk979d/P6JsHrx9nwk979d/PwluHryanwk979d/P49tHrx+nwk98Nd/P6RsHrx9nwk9\n79d/PwtuHryanwk979d/P49tHrx+nwk98Nd/P6BsHrx+nwk98Nd/PxhtHrybnwk979d/Pxdt\nHrygnwk98Nd/P6BsHryCnwk98Nd/P5NtHryBnwk979d/PwpuHryenwk979d/P6BsHryCnwk9\n8Nd/P49tHryCnwk98Nd/PwpuHryenwk979d/P6RsHryBnwk979d/P49tHryCnwk98Nd/Pwdu\nHryenwk979d/P6JsHryBnwk979d/P5BtHryBnwk979d/PwhuHryfnwk979d/P6FsHryCnwk9\n79d/P5BtHryBnwk979d/PwhuHryfnwk979d/P6FsHryCnwk979d/P5BtHryBnwk979d/Pwlu\nHryenwk979d/P6FsHryBnwk979d/P5BtHryBnwk979d/PwduHryenwk979d/P6FsHryBnwk9\n79d/P49tHryBnwk979d/PwduHryfnwk98Nd/P6RsHryBnwk979d/P5JtHryBnwk979d/Pwdu\nHryfnwk98Nd/P6BsHryCnwk98Nd/PylsHrxlnwk98Nd/PwduHrzbnwk98Nd/P45tHry8nwk9\n79d/PxptHryfnwk979d/P5NtHry8nwk979d/P45tHry8nwk979d/PxZtHryfnwk979d/P5Nt\nHry8nwk979d/P5NtHry8nwk979d/PxZtHryfnwk979d/P49tHry8nwk979d/P5BtHry7nwk9\n79d/PxhtHryfnwk979d/P5BtHry8nwk979d/P5BtHry8nwk979d/PxhtHryfnwk979d/P5Bt\nHry8nwk979d/P5BtHry8nwk979d/PxhtHryfnwk979d/P5FtHry7nwk979d/P49tHry7nwk9\n79d/PxltHryenwk979d/P5BtHry8nwk979d/P5FtHry7nwk979d/PxhtHryfnwk979d/P49t\nHry8nwk979d/P5JtHry8nwk979d/PxttHryfnwk979d/P49tHry8nwk979d/P45tHry8nwk9\n79d/PxdtHrygnwk98Nd/PxhtHryenwk98Nd/P49tHry6nwk98Nd/P5NtHry7nwk979d/Pxxt\nHrydnwk979d/P49tHry6nwk98Nd/P49tHry7nwk98Nd/PxttHrydnwk979d/P5JtHry5nwk9\n79d/P49tHry7nwk98Nd/PxhtHrycnwk979d/P5JtHry6nwk979d/P5BtHry6nwk979d/Pxlt\nHrycnwk979d/P5BtHry6nwk979d/P5BtHry6nwk979d/PxltHrycnwk979d/P5BtHry6nwk9\n79d/P5BtHry6nwk979d/PxltHrycnwk979d/P5BtHry5nwk979d/P5BtHry6nwk979d/Pxlt\nHrydnwk979d/P5BtHry6nwk979d/P5BtHry6nwk979d/PxhtHryenwk98Nd/P5RtHry6nwk9\n79d/P5JtHry6nwk979d/PxhtHryenwk98Nd/P49tHry6nwk98Nd/PwduHrzZnwk98Nd/Pyds\nHrxlnwk979d/P59sHryCnwk979d/PwtuHryfnwk979d/P5NtHryCnwk979d/P59sHryCnwk9\n79d/PwduHryfnwk979d/P5JtHryCnwk979d/P6NsHryCnwk979d/PwduHryfnwk979d/P49t\nHryBnwk979d/P6FsHryBnwk979d/PwduHryenwk979d/P49tHryBnwk979d/P6BsHryBnwk9\n79d/PwduHryenwk979d/P49tHryBnwk979d/P6BsHryBnwk979d/PwduHryenwk979d/P5Bt\nHryBnwk979d/P6FsHryCnwk979d/PwhuHryenwk979d/P5BtHryCnwk979d/P6FsHryCnwk9\n79d/PwluHryfnwk979d/P45tHryCnwk979d/P6RsHryCnwk979d/PwtuHryfnwk979d/P45t\nHryCnwk979d/P59sHryCnwk979d/PxZtHryfnwk979d/PxhtHryenwk98Nd/P59sHryAnwk9\n79d/P5RtHrx/nwk979d/PwtuHrydnwk979d/P59sHryAnwk979d/P49tHryAnwk979d/Pwpu\nHrydnwk979d/P6RsHryAnwk979d/P49tHryAnwk979d/PwluHrycnwk979d/P6JsHrx/nwk9\n79d/P5BtHrx/nwk979d/PwhuHrycnwk979d/P6BsHrx/nwk979d/P5BtHrx/nwk979d/Pwhu\nHrycnwk979d/P6BsHrx/nwk979d/P5BtHrx/nwk979d/PwluHrycnwk979d/P6FsHrx/nwk9\n79d/P5FtHrx/nwk979d/PwhuHrycnwk979d/P6JsHrx/nwk979d/P5FtHrx/nwk979d/PwZu\nHrydnwk979d/P6RsHryAnwk979d/P5NtHryAnwk979d/PwZuHrydnwk979d/P59sHryAnwk9\n79d/PyhsHrxjnwk98Nd/PwduHrzXnwk98Nd/P49tHry7nwk98Nd/PxttHrydnwk979d/P5Jt\nHry5nwk979d/P49tHry7nwk98Nd/PxhtHryenwk98Nd/P5RtHry6nwk979d/P5JtHry6nwk9\n79d/PxhtHryenwk98Nd/P5BtHry6nwk979d/P5FtHry6nwk979d/PxltHrycnwk979d/P5Bt\nHry6nwk979d/P5BtHry6nwk979d/PxltHrycnwk979d/P5BtHry6nwk979d/P5BtHry6nwk9\n79d/PxltHrycnwk979d/P5FtHry6nwk979d/P5BtHry6nwk979d/PxhtHrycnwk979d/P5Bt\nHry5nwk979d/P5BtHry6nwk979d/PxltHrydnwk979d/P49tHry6nwk98Nd/P5NtHry7nwk9\n79d/PxxtHrydnwk979d/P49tHry6nwk98Nd/P49tHry7nwk98Nd/PxhtHryenwk98Nd/PxZt\nHryfnwk979d/P49tHry8nwk979d/P5JtHry8nwk979d/PxttHryenwk979d/P49tHry8nwk9\n79d/P45tHry8nwk979d/PxttHryenwk979d/P5NtHry8nwk979d/P45tHry8nwk979d/Pxht\nHryenwk979d/P5FtHry6nwk979d/P49tHry7nwk979d/PxhtHryenwk979d/P5BtHry7nwk9\n79d/P49tHry7nwk979d/PxhtHryenwk979d/P5BtHry7nwk979d/P49tHry7nwk979d/Pxlt\nHrydnwk979d/P5FtHry8nwk979d/P49tHry7nwk979d/PxltHryenwk979d/P5BtHry8nwk9\n79d/P5BtHry7nwk979d/PxdtHryenwk979d/P5NtHry8nwk979d/P5JtHry8nwk979d/Pxdt\nHryenwk979d/P49tHry8nwk979d/PwVuHrzZnwk979d/PydsHrxknwk98Nd/P59sHryBnwk9\n79d/PwpuHryenwk979d/P5JtHryAnwk979d/P59sHryBnwk979d/PwZuHryenwk979d/P5Jt\nHryAnwk979d/P6NsHryBnwk979d/PwZuHryenwk979d/P5BtHryAnwk979d/P6JsHryAnwk9\n79d/PwhuHryenwk979d/P5FtHryAnwk979d/P6BsHryAnwk979d/PwhuHryenwk979d/P5Ft\nHryAnwk979d/P6BsHryAnwk979d/PwhuHryenwk979d/P5JtHryAnwk979d/P6FsHryAnwk9\n79d/PwhuHryenwk979d/P5BtHryAnwk979d/P6JsHryAnwk979d/PwhuHryenwk979d/P45t\nHryAnwk979d/P6NsHryAnwk979d/PwpuHryenwk979d/P45tHryAnwk979d/P59sHryBnwk9\n79d/PxdtHryfnwk979d/PxdtHryfnwk979d/P59sHryBnwk98Nd/P5JtHryAnwk979d/Pwlu\nHrydnwk979d/P59sHryBnwk98Nd/P45tHryCnwk98Nd/PwpuHrydnwk979d/P6NsHryAnwk9\n79d/P45tHryCnwk98Nd/PwhuHryenwk979d/P6JsHryCnwk98Nd/P5BtHryBnwk979d/Pwhu\nHryenwk979d/P6FsHryBnwk979d/P5BtHryBnwk979d/PwhuHryenwk979d/P6FsHryBnwk9\n79d/P5BtHryBnwk979d/PwpuHryenwk98Nd/P6FsHryBnwk979d/P5FtHryBnwk979d/Pwdu\nHryenwk979d/P6BsHryBnwk979d/P5BtHryBnwk979d/PwZuHryenwk98Nd/P6JsHryAnwk9\n79d/P5JtHryBnwk979d/PwZuHryenwk98Nd/P59sHryBnwk98Nd/PydsHrxknwk979d/PwZu\nHrzZnwk979d/P45tHry7nwk98Nd/PxptHryenwk979d/P5JtHry7nwk979d/P45tHry7nwk9\n8Nd/PxdtHryfnwk98Nd/P5JtHry7nwk979d/P5NtHry7nwk98Nd/PxdtHryfnwk98Nd/P5Ft\nHry8nwk979d/P5BtHry6nwk97td/PxltHryenwk979d/P5BtHry7nwk979d/P5FtHry7nwk9\n79d/PxltHryenwk979d/P5BtHry7nwk979d/P5FtHry7nwk979d/PxltHryenwk979d/P5Ft\nHry7nwk979d/P5FtHry8nwk98Nd/PxhtHryenwk979d/P5BtHry7nwk979d/P5BtHry7nwk9\n79d/PxhtHryenwk979d/P45tHry8nwk98Nd/P5JtHry6nwk979d/PxptHryenwk979d/P45t\nHry8nwk98Nd/P45tHry7nwk98Nd/PxdtHryfnwk979d/PxdtHryfnwk979d/P45tHry8nwk9\n8Nd/P5JtHry6nwk979d/PxptHryenwk979d/P45tHry8nwk98Nd/P45tHry7nwk98Nd/Pxpt\nHryenwk979d/P5JtHry7nwk979d/P45tHry7nwk98Nd/PxhtHryenwk979d/P5FtHry6nwk9\n7td/P5FtHry7nwk979d/PxltHryenwk979d/P5BtHry7nwk979d/P5FtHry7nwk979d/Pxlt\nHryenwk979d/P5BtHry7nwk979d/P5FtHry7nwk979d/PxptHryenwk98Nd/P5BtHry7nwk9\n79d/P5BtHry7nwk979d/PxhtHryenwk979d/P5FtHry8nwk979d/P5FtHry8nwk98Nd/Pxdt\nHryfnwk98Nd/P5JtHry7nwk979d/P5NtHry7nwk98Nd/PxdtHryfnwk98Nd/P45tHry8nwk9\n8Nd/PwVuHrzZnwk979d/PydsHrxknwk98Nd/P6BsHryCnwk98Nd/PwpuHryenwk979d/P5Nt\nHryBnwk98Nd/P6BsHryCnwk98Nd/PwZuHryfnwk98Nd/P5JtHryAnwk979d/P6NsHryBnwk9\n79d/PwZuHryfnwk98Nd/P49tHryAnwk979d/P6JsHryAnwk98Nd/PwhuHryenwk979d/P5Ft\nHryBnwk979d/P6FsHryBnwk979d/PwhuHryenwk979d/P5FtHryBnwk979d/P6FsHryBnwk9\n79d/PwhuHryenwk979d/P5FtHryAnwk979d/P6FsHryAnwk979d/PwhuHryenwk979d/P5Ft\nHryBnwk98Nd/P6BsHryAnwk979d/PwhuHrydnwk979d/P45tHryBnwk98Nd/P6NsHryBnwk9\n79d/PwpuHryenwk979d/P45tHryBnwk98Nd/P6BsHryCnwk98Nd/PxdtHryfnwk98Nd/PxZt\nHryenwk979d/P55sHryBnwk979d/P5JtHryBnwk979d/PwpuHryfnwk979d/P55sHryBnwk9\n79d/P45tHryBnwk979d/PwpuHryfnwk979d/P6NsHryBnwk979d/P45tHryBnwk979d/Pwdu\nHryenwk979d/P6FsHryAnwk979d/P5BtHryBnwk979d/PwduHryenwk979d/P6BsHryAnwk9\n79d/P5BtHryBnwk979d/PwduHryenwk979d/P6BsHryAnwk979d/P5BtHryBnwk979d/Pwhu\nHryenwk979d/P6BsHryBnwk979d/P5BtHryBnwk979d/PwduHryenwk979d/P6BsHryBnwk9\n79d/P5BtHryAnwk979d/PwVuHryfnwk979d/P6RsHryBnwk979d/P5JtHryBnwk979d/PwVu\nHryfnwk979d/P55sHryBnwk979d/PydsHrxknwk979d/PwduHrzZnwk98Nd/P45tHry6nwk9\n79d/PxttHrydnwk979d/P5NtHry6nwk979d/P45tHry6nwk979d/PxdtHrydnwk979d/P5Nt\nHry6nwk979d/P5NtHry6nwk979d/PxdtHrydnwk979d/P5FtHry6nwk979d/P5JtHry5nwk9\n79d/PxhtHrycnwk979d/P5BtHry5nwk979d/P5BtHry5nwk979d/PxhtHrycnwk979d/P5Bt\nHry5nwk979d/P5BtHry5nwk979d/PxhtHrycnwk979d/P5FtHry6nwk979d/P5BtHry6nwk9\n79d/PxptHrydnwk979d/P5FtHry6nwk979d/P5FtHry5nwk979d/PxltHrydnwk979d/P49t\nHry6nwk979d/P5NtHry6nwk979d/PxttHrydnwk979d/P49tHry6nwk979d/P45tHry6nwk9\n79d/PxdtHryenwk98Nd/PxhtHryenwk98Nd/P49tHry6nwk98Nd/P5NtHry7nwk979d/Pxxt\nHrydnwk979d/P49tHry6nwk98Nd/P49tHry7nwk98Nd/PxttHrydnwk979d/P5JtHry5nwk9\n79d/P49tHry7nwk98Nd/PxhtHrycnwk979d/P5JtHry6nwk979d/P5BtHry6nwk979d/Pxlt\nHrycnwk979d/P5BtHry6nwk979d/P5BtHry6nwk979d/PxltHrycnwk979d/P5BtHry6nwk9\n79d/P5BtHry6nwk979d/PxltHrycnwk979d/P5BtHry5nwk979d/P5BtHry6nwk979d/Pxlt\nHrydnwk979d/P5BtHry6nwk979d/P5BtHry6nwk979d/PxhtHryenwk98Nd/P5RtHry6nwk9\n79d/P5JtHry6nwk979d/PxhtHryenwk98Nd/P49tHry6nwk98Nd/PwduHrzZnwk98Nd/Pyds\nHrxlnwk979d/P59sHryCnwk979d/PwtuHryfnwk979d/P5NtHryCnwk979d/P59sHryCnwk9\n79d/PwduHryfnwk979d/P5JtHryCnwk979d/P6NsHryCnwk979d/PwduHryfnwk979d/P49t\nHryBnwk979d/P6FsHryBnwk979d/PwduHryenwk979d/P49tHryBnwk979d/P6BsHryBnwk9\n79d/PwduHryenwk979d/P49tHryBnwk979d/P6BsHryBnwk979d/PwduHryenwk979d/P5Bt\nHryBnwk979d/P6FsHryCnwk979d/PwhuHryenwk979d/P5BtHryCnwk979d/P6FsHryCnwk9\n79d/PwluHryfnwk979d/P45tHryCnwk979d/P6RsHryCnwk979d/PwtuHryfnwk979d/P45t\nHryCnwk979d/P59sHryCnwk979d/PxZtHryfnwk979d/PyhsHryenwk98Nd/P2NsHryOnwk9\n79d/P89tHryOnwk979d/PwtuHrydnwk979d/P59sHryAnwk979d/P49tHryAnwk979d/Pwpu\nHrydnwk979d/P6RsHryAnwk979d/P49tHryAnwk979d/PwluHrycnwk979d/P6JsHrx/nwk9\n79d/P5BtHrx/nwk979d/PwhuHrycnwk979d/P6BsHrx/nwk979d/P5BtHrx/nwk979d/Pwhu\nHrycnwk979d/P6BsHrx/nwk979d/P5BtHrx/nwk979d/PwluHrycnwk979d/P6FsHrx/nwk9\n79d/P5FtHrx/nwk979d/PwhuHrycnwk979d/P6JsHrx/nwk979d/P5FtHrx/nwk979d/PwZu\nHrydnwk979d/P6RsHryAnwk979d/P5NtHryAnwk979d/PwZuHrydnwk979d/P59sHryAnwk9\n79d/PyhsHrxjnwk98Nd/P59sHry9nwk98Nd/P9tsHryunwk98Nd/P1dtHrytnwk979d/Pwpu\nHry7nwk979d/P1NtHryvnwk98Nd/P9xsHryunwk98Nd/P85tHrzLnwk979d/P5JtHry7nwk9\n79d/PxhtHryfnwk98Nd/P5BtHry8nwk979d/P5FtHry8nwk979d/PxltHryfnwk979d/P5Bt\nHry8nwk979d/P5BtHry8nwk979d/PxltHryfnwk979d/P5BtHry8nwk979d/P5BtHry8nwk9\n79d/PxltHryfnwk979d/P5FtHry8nwk979d/P5BtHry7nwk979d/PxhtHryenwk979d/P49t\nHry7nwk979d/P5BtHry7nwk979d/PxltHryenwk979d/P49tHry8nwk98Nd/P5NtHry8nwk9\n79d/PxxtHryfnwk979d/P49tHry8nwk98Nd/P49tHry8nwk98Nd/PxhtHrygnwk98Nd/Pxht\nHrygnwk98Nd/PxZtHryfnwk979d/P1dtHryQnwk979d/P89tHryQnwk979d/P1JtHryunwk9\n79d/PxZtHryenwk979d/P1ZtHryQnwk979d/P89tHryunwk979d/P45tHryfnwk979d/P91s\nHryQnwk979d/P5FtHry8nwk979d/P5BtHry8nwk979d/PxhtHryfnwk979d/P5BtHry8nwk9\n79d/P5BtHry8nwk979d/PxhtHryfnwk979d/P5BtHry8nwk979d/P5BtHry8nwk979d/Pxpt\nHryenwk979d/P5BtHry8nwk979d/P5FtHry7nwk979d/PxhtHryfnwk979d/P49tHry8nwk9\n79d/P49tHry7nwk979d/PxZtHryfnwk979d/P5NtHry8nwk979d/P5NtHry8nwk979d/PxZt\nHryfnwk979d/P49tHry8nwk979d/PwZuHrzanwk979d/PxdtHrybnwk979d/PxdtHrybnwk9\n8Nd/P5NtHryanwk979d/P5NtHryanwk979d/PxdtHrybnwk98Nd/P49tHrybnwk98Nd/P1Zt\nHryMnwk979d/P1dtHryMnwk979d/P8ttHryqnwk98Nd/PxltHryanwk979d/P95sHryMnwk9\n79d/P8xtHryqnwk979d/P5JtHrybnwk979d/P95sHryMnwk979d/PwhuHrybnwk979d/P5Jt\nHrx+nwk979d/P6JsHrx+nwk979d/PwhuHrybnwk979d/P5JtHrx9nwk979d/P6JsHrx9nwk9\n79d/PwhuHryanwk979d/P5BtHrx9nwk979d/P6JsHrx9nwk979d/PwluHryanwk979d/P49t\nHrx+nwk98Nd/P6RsHrx9nwk979d/PwtuHryanwk979d/P49tHrx+nwk98Nd/P6BsHrx+nwk9\n8Nd/PxhtHrybnwk979d/PxdtHryfnwk98Nd/PxhtHryfnwk98Nd/P5NtHryfnwk979d/P5Jt\nHryenwk979d/PxhtHryfnwk98Nd/P49tHrygnwk98Nd/P5NtHryfnwk979d/PxttHryenwk9\n79d/P49tHrygnwk98Nd/P5BtHryenwk979d/P95sHryQnwk979d/P5FtHryBnwk979d/P8xt\nHryQnwk979d/P91sHryQnwk979d/PwluHryBnwk979d/P8xtHryQnwk979d/P2VsHryQnwk9\n79d/P8xtHryQnwk979d/PwluHryenwk979d/P6FsHryBnwk979d/P5BtHryBnwk979d/Pwdu\nHryenwk979d/P6FsHryBnwk979d/P49tHryBnwk979d/PwduHryfnwk98Nd/P6RsHryBnwk9\n79d/P5JtHryBnwk979d/PwduHryfnwk98Nd/P6BsHryCnwk98Nd/PylsHrxlnwk98Nd/Pxdt\nHrygnwk98Nd/PxZtHryfnwk979d/P5JtHryfnwk979d/P5NtHryenwk979d/PxZtHryfnwk9\n79d/P45tHryfnwk979d/P5JtHryenwk979d/PxttHryfnwk979d/P45tHryfnwk979d/P5Bt\nHryenwk979d/PxltHryenwk979d/P5BtHryenwk979d/P5BtHryenwk979d/PxhtHryfnwk9\n79d/P8xtHrytnwk979d/P5BtHry8nwk979d/P9xsHrytnwk979d/P1RtHrytnwk979d/Pwhu\nHry7nwk979d/P5BtHryenwk979d/P91sHryQnwk979d/P5BtHry8nwk979d/P5FtHry7nwk9\n79d/PxhtHryfnwk979d/P49tHry8nwk979d/P5JtHry8nwk979d/PxttHryfnwk979d/P49t\nHry8nwk979d/P45tHry8nwk979d/PxdtHrygnwk98Nd/PxhtHrybnwk979d/PxhtHrybnwk9\n8Nd/P5NtHrybnwk979d/P5NtHryanwk979d/PxhtHrybnwk98Nd/P49tHrybnwk98Nd/P5Jt\nHrybnwk979d/PxttHryanwk979d/P49tHrybnwk98Nd/P5BtHryanwk979d/PxptHryanwk9\n79d/P5FtHrybnwk979d/P5FtHrybnwk979d/PxptHryanwk979d/P5FtHrybnwk979d/P5Ft\nHrybnwk979d/PxptHryanwk979d/P1VtHryMnwk979d/P85tHryMnwk979d/P8xtHrypnwk9\n79d/PxltHryanwk979d/P95sHryMnwk979d/P8xtHrypnwk979d/P5FtHryanwk979d/P9xs\nHryNnwk98Nd/P5RtHry4nwk979d/P5NtHry3nwk979d/PxhtHrybnwk98Nd/P5BtHry4nwk9\n8Nd/PwduHrzWnwk979d/PxdtHrybnwk979d/PxdtHrybnwk979d/P5RtHrx+nwk98Nd/P5Rt\nHrx+nwk98Nd/PxdtHrybnwk979d/P49tHrx+nwk979d/P5RtHrx+nwk98Nd/Px1tHrybnwk9\n8Nd/P49tHrx+nwk979d/P5JtHrx+nwk98Nd/PxptHrybnwk979d/P5FtHrx9nwk979d/P5Ft\nHrx9nwk979d/PxptHrybnwk979d/P5FtHrx9nwk979d/P5FtHrx9nwk979d/PxptHrybnwk9\n79d/P5FtHrx9nwk979d/P5JtHrx9nwk979d/P5FtHry5nwk98Nd/P5JtHry4nwk98Nd/P6Ns\nHrx+nwk98Nd/P5JtHrx+nwk98Nd/PwluHrybnwk98Nd/P6BsHrx+nwk979d/PxxtHrybnwk9\n8Nd/PwtuHrzVnwk98Nd/PxdtHrybnwk979d/PxhtHrybnwk979d/PwduHrzWnwk979d/PwAA\nAAAAAIA/AAAAAP/+/j56PPG/7u70v5v8jD+OIeC/7u70v/kmjT+iBs+/7u70v1hRjT+3672/\n7u70v7Z7jT/L0Ky/7u70vxSmjT/ftZu/7u70v3PQjT/0moq/7u70v9H6jT8QAHO/7u70vy8l\njj84ylC/7u70v45Pjj9glC6/7u70v+x5jj+JXgy/7u70v0qkjj9kUdS+7u70v6nOjj+05Y++\n7u70vwf5jj8L9Ba+7u70v2Ujjz/QymG87u70v8RNjz9idfU97u70vyJ4jz8IyYE+7u70v4Ci\njz+2NMY+7u70v9/Mjz8yUAU/7u70vz33jz8Khic/7u70v5shkD/hu0k/7u70v/pLkD+58Ws/\n7u70v1h2kD/IE4c/7u70v7agkD+0Lpg/7u70vxXLkD+gSak/7u70v3P1kD+MZLo/7u70v9Ef\nkT93f8s/7u70vzBKkT9jmtw/7u70v450kT9Pte0/7u70v+yekT96PPG/vWrjv9lljD+OIeC/\nvWrjvzeQjD+iBs+/vWrjv5W6jD+3672/vWrjv/TkjD/L0Ky/vWrjv1IPjT/ftZu/vWrjv7E5\njT/0moq/vWrjvw9kjT8QAHO/vWrjv22OjT84ylC/vWrjv8y4jT9glC6/vWrjvyrjjT+JXgy/\nvWrjv4gNjj9kUdS+vWrjv+c3jj+05Y++vWrjv0Vijj8L9Ba+vWrjv6OMjj/QymG8vWrjvwG3\njj9idfU9vWrjv2Dhjj8IyYE+vWrjv74Ljz+2NMY+vWrjvx02jz8yUAU/vWrjv3tgjz8Khic/\nvWrjv9mKjz/hu0k/vWrjvzi1jz+58Ws/vWrjv5bfjz/IE4c/vWrjv/QJkD+0Lpg/vWrjv1M0\nkD+gSak/vWrjv7FekD+MZLo/vWrjvw+JkD93f8s/vWrjv22zkD9jmtw/vWrjv8zdkD9Pte0/\nvWrjvyoIkT96PPG/iubRvxfPiz+OIeC/iubRv3X5iz+iBs+/iubRv9MjjD+3672/iubRvzJO\njD/L0Ky/iubRv5B4jD/ftZu/iubRv+6ijD/0moq/iubRv03NjD8QAHO/iubRv6v3jD84ylC/\niubRvwkijT9glC6/iubRv2hMjT+JXgy/iubRv8Z2jT9kUdS+iubRvyShjT+05Y++iubRv4PL\njT8L9Ba+iubRv+H1jT/QymG8iubRvz8gjj9idfU9iubRv55Kjj8IyYE+iubRv/x0jj+2NMY+\niubRv1qfjj8yUAU/iubRv7nJjj8Khic/iubRvxf0jj/hu0k/iubRv3Uejz+58Ws/iubRv9RI\njz/IE4c/iubRvzJzjz+0Lpg/iubRv5Cdjz+gSak/iubRv+/Hjz+MZLo/iubRv03yjz93f8s/\niubRv6sckD9jmtw/iubRvwpHkD9Pte0/iubRv2hxkD96PPG/WWLAv1Q4iz+OIeC/WWLAv7Ni\niz+iBs+/WWLAvxGNiz+3672/WWLAv2+3iz/L0Ky/WWLAv87hiz/ftZu/WWLAvywMjD/0moq/\nWWLAv4o2jD8QAHO/WWLAv+lgjD84ylC/WWLAv0eLjD9glC6/WWLAv6W1jD+JXgy/WWLAvwTg\njD9kUdS+WWLAv2IKjT+05Y++WWLAv8A0jT8L9Ba+WWLAvx9fjT/QymG8WWLAv32JjT9idfU9\nWWLAv9uzjT8IyYE+WWLAvzrejT+2NMY+WWLAv5gIjj8yUAU/WWLAv/Yyjj8Khic/WWLAv1Vd\njj/hu0k/WWLAv7OHjj+58Ws/WWLAvxGyjj/IE4c/WWLAv3Dcjj+0Lpg/WWLAv84Gjz+gSak/\nWWLAvywxjz+MZLo/WWLAv4tbjz93f8s/WWLAv+mFjz9jmtw/WWLAv0ewjz9Pte0/WWLAv6ba\njz96PPG/KN6uv5Khij+OIeC/KN6uv/DLij+iBs+/KN6uv0/2ij+3672/KN6uv60giz/L0Ky/\nKN6uvwtLiz/ftZu/KN6uv2p1iz/0moq/KN6uv8ifiz8QAHO/KN6uvybKiz84ylC/KN6uv4X0\niz9glC6/KN6uv+MejD+JXgy/KN6uv0FJjD9kUdS+KN6uv6BzjD+05Y++KN6uv/6djD8L9Ba+\nKN6uv1zIjD/QymG8KN6uv7vyjD9idfU9KN6uvxkdjT8IyYE+KN6uv3dHjT+2NMY+KN6uv9Zx\njT8yUAU/KN6uvzScjT8Khic/KN6uv5LGjT/hu0k/KN6uv/HwjT+58Ws/KN6uv08bjj/IE4c/\nKN6uv61Fjj+0Lpg/KN6uvwxwjj+gSak/KN6uv2qajj+MZLo/KN6uv8jEjj93f8s/KN6uvyfv\njj9jmtw/KN6uv4UZjz9Pte0/KN6uv+NDjz96PPG/9lmdv9AKij+OIeC/9lmdvy41ij+iBs+/\n9lmdv41fij+3672/9lmdv+uJij/L0Ky/9lmdv0m0ij/ftZu/9lmdv6jeij/0moq/9lmdvwYJ\niz8QAHO/9lmdv2Qziz84ylC/9lmdv8Ndiz9glC6/9lmdvyGIiz+JXgy/9lmdv3+yiz9kUdS+\n9lmdv93ciz+05Y++9lmdvzwHjD8L9Ba+9lmdv5oxjD/QymG89lmdv/lbjD9idfU99lmdv1eG\njD8IyYE+9lmdv7WwjD+2NMY+9lmdvxTbjD8yUAU/9lmdv3IFjT8Khic/9lmdv9AvjT/hu0k/\n9lmdvy9ajT+58Ws/9lmdv42EjT/IE4c/9lmdv+uujT+0Lpg/9lmdv0nZjT+gSak/9lmdv6gD\njj+MZLo/9lmdvwYujj93f8s/9lmdv2VYjj9jmtw/9lmdv8OCjj9Pte0/9lmdvyGtjj96PPG/\nxNWLvw50iT+OIeC/xNWLv2yeiT+iBs+/xNWLv8rIiT+3672/xNWLvynziT/L0Ky/xNWLv4cd\nij/ftZu/xNWLv+VHij/0moq/xNWLv0Ryij8QAHO/xNWLv6Kcij84ylC/xNWLvwDHij9glC6/\nxNWLv1/xij+JXgy/xNWLv70biz9kUdS+xNWLvxtGiz+05Y++xNWLv3pwiz8L9Ba+xNWLv9ia\niz/QymG8xNWLvzbFiz9idfU9xNWLv5Xviz8IyYE+xNWLv/MZjD+2NMY+xNWLv1FEjD8yUAU/\nxNWLv7BujD8Khic/xNWLvw6ZjD/hu0k/xNWLv2zDjD+58Ws/xNWLv8vtjD/IE4c/xNWLvykY\njT+0Lpg/xNWLv4dCjT+gSak/xNWLv+ZsjT+MZLo/xNWLv0SXjT93f8s/xNWLv6LBjT9jmtw/\nxNWLvwHsjT9Pte0/xNWLv18Wjj96PPG/JqN0v0vdiD+OIeC/JqN0v6oHiT+iBs+/JqN0vwgy\niT+3672/JqN0v2ZciT/L0Ky/JqN0v8WGiT/ftZu/JqN0vyOxiT/0moq/JqN0v4HbiT8QAHO/\nJqN0v+AFij84ylC/JqN0vz4wij9glC6/JqN0v5xaij+JXgy/JqN0v/uEij9kUdS+JqN0v1mv\nij+05Y++JqN0v7fZij8L9Ba+JqN0vxYEiz/QymG8JqN0v3Quiz9idfU9JqN0v9JYiz8IyYE+\nJqN0vzGDiz+2NMY+JqN0v4+tiz8yUAU/JqN0v+3Xiz8Khic/JqN0v0wCjD/hu0k/JqN0v6os\njD+58Ws/JqN0vwhXjD/IE4c/JqN0v2eBjD+0Lpg/JqN0v8WrjD+gSak/JqN0vyPWjD+MZLo/\nJqN0v4IAjT93f8s/JqN0v+AqjT9jmtw/JqN0vz5VjT9Pte0/JqN0v51/jT96PPG/wppRv4lG\niD+OIeC/wppRv+dwiD+iBs+/wppRv0abiD+3672/wppRv6TFiD/L0Ky/wppRvwLwiD/ftZu/\nwppRv2EaiT/0moq/wppRv79EiT8QAHO/wppRvx1viT84ylC/wppRv3yZiT9glC6/wppRv9rD\niT+JXgy/wppRvzjuiT9kUdS+wppRv5cYij+05Y++wppRv/VCij8L9Ba+wppRv1Ntij/QymG8\nwppRv7KXij9idfU9wppRvxDCij8IyYE+wppRv27sij+2NMY+wppRv80Wiz8yUAU/wppRvytB\niz8Khic/wppRv4lriz/hu0k/wppRv+iViz+58Ws/wppRv0bAiz/IE4c/wppRv6Tqiz+0Lpg/\nwppRvwMVjD+gSak/wppRv2E/jD+MZLo/wppRv79pjD93f8s/wppRvx6UjD9jmtw/wppRv3y+\njD9Pte0/wppRv9rojD96PPG/YJIuv8evhz+OIeC/YJIuvyXahz+iBs+/YJIuv4QEiD+3672/\nYJIuv+IuiD/L0Ky/YJIuv0BZiD/ftZu/YJIuv5+DiD/0moq/YJIuv/2tiD8QAHO/YJIuv1vY\niD84ylC/YJIuv7kCiT9glC6/YJIuvxgtiT+JXgy/YJIuv3ZXiT9kUdS+YJIuv9WBiT+05Y++\nYJIuvzOsiT8L9Ba+YJIuv5HWiT/QymG8YJIuv/AAij9idfU9YJIuv04rij8IyYE+YJIuv6xV\nij+2NMY+YJIuvwuAij8yUAU/YJIuv2mqij8Khic/YJIuv8fUij/hu0k/YJIuvyX/ij+58Ws/\nYJIuv4Qpiz/IE4c/YJIuv+JTiz+0Lpg/YJIuv0F+iz+gSak/YJIuv5+oiz+MZLo/YJIuv/3S\niz93f8s/YJIuv1z9iz9jmtw/YJIuv7onjD9Pte0/YJIuvxhSjD96PPG//IkLvwUZhz+OIeC/\n/IkLv2NDhz+iBs+//IkLv8Fthz+3672//IkLvyCYhz/L0Ky//IkLv37Chz/ftZu//IkLv9zs\nhz/0moq//IkLvzsXiD8QAHO//IkLv5lBiD84ylC//IkLv/driD9glC6//IkLv1aWiD+JXgy/\n/IkLv7TAiD9kUdS+/IkLvxLriD+05Y++/IkLv3EViT8L9Ba+/IkLv88/iT/QymG8/IkLvy1q\niT9idfU9/IkLv4yUiT8IyYE+/IkLv+q+iT+2NMY+/IkLv0jpiT8yUAU//IkLv6cTij8Khic/\n/IkLvwU+ij/hu0k//IkLv2Noij+58Ws//IkLv8KSij/IE4c//IkLvyC9ij+0Lpg//IkLv37n\nij+gSak//IkLv90Riz+MZLo//IkLvzs8iz93f8s//IkLv5lmiz9jmtw//IkLv/iQiz9Pte0/\n/IkLv1a7iz96PPG/MgPRvkKChj+OIeC/MgPRvqGshj+iBs+/MgPRvv/Whj+3672/MgPRvl0B\nhz/L0Ky/MgPRvrwrhz/ftZu/MgPRvhpWhz/0moq/MgPRvniAhz8QAHO/MgPRvteqhz84ylC/\nMgPRvjXVhz9glC6/MgPRvpP/hz+JXgy/MgPRvvIpiD9kUdS+MgPRvlBUiD+05Y++MgPRvq5+\niD8L9Ba+MgPRvg2piD/QymG8MgPRvmvTiD9idfU9MgPRvsn9iD8IyYE+MgPRvigoiT+2NMY+\nMgPRvoZSiT8yUAU/MgPRvuR8iT8Khic/MgPRvkOniT/hu0k/MgPRvqHRiT+58Ws/MgPRvv/7\niT/IE4c/MgPRvl4mij+0Lpg/MgPRvrxQij+gSak/MgPRvhp7ij+MZLo/MgPRvnmlij93f8s/\nMgPRvtfPij9jmtw/MgPRvjX6ij9Pte0/MgPRvpQkiz96PPG/a/KKvoDrhT+OIeC/a/KKvt4V\nhj+iBs+/a/KKvj1Ahj+3672/a/KKvptqhj/L0Ky/a/KKvvmUhj/ftZu/a/KKvli/hj/0moq/\na/KKvrbphj8QAHO/a/KKvhQUhz84ylC/a/KKvnM+hz9glC6/a/KKvtFohz+JXgy/a/KKvi+T\nhz9kUdS+a/KKvo69hz+05Y++a/KKvuznhz8L9Ba+a/KKvkoSiD/QymG8a/KKvqk8iD9idfU9\na/KKvgdniD8IyYE+a/KKvmWRiD+2NMY+a/KKvsS7iD8yUAU/a/KKviLmiD8Khic/a/KKvoAQ\niT/hu0k/a/KKvt86iT+58Ws/a/KKvj1liT/IE4c/a/KKvpuPiT+0Lpg/a/KKvvq5iT+gSak/\na/KKvljkiT+MZLo/a/KKvrYOij93f8s/a/KKvhU5ij9jmtw/a/KKvnNjij9Pte0/a/KKvtGN\nij96PPG/R8MJvr5UhT+OIeC/R8MJvhx/hT+iBs+/R8MJvnuphT+3672/R8MJvtnThT/L0Ky/\nR8MJvjf+hT/ftZu/R8MJvpUohj/0moq/R8MJvvRShj8QAHO/R8MJvlJ9hj84ylC/R8MJvrGn\nhj9glC6/R8MJvg/Shj+JXgy/R8MJvm38hj9kUdS+R8MJvswmhz+05Y++R8MJvipRhz8L9Ba+\nR8MJvoh7hz/QymG8R8MJvuelhz9idfU9R8MJvkXQhz8IyYE+R8MJvqP6hz+2NMY+R8MJvgEl\niD8yUAU/R8MJvmBPiD8Khic/R8MJvr55iD/hu0k/R8MJvh2kiD+58Ws/R8MJvnvOiD/IE4c/\nR8MJvtn4iD+0Lpg/R8MJvjgjiT+gSak/R8MJvpZNiT+MZLo/R8MJvvR3iT93f8s/R8MJvlOi\niT9jmtw/R8MJvrHMiT9Pte0/R8MJvg/3iT96PPG/YJEXO/y9hD+OIeC/YJEXO1rohD+iBs+/\nYJEXO7gShT+3672/YJEXOxc9hT/L0Ky/YJEXO3VnhT/ftZu/YJEXO9ORhT/0moq/YJEXOzK8\nhT8QAHO/YJEXO5DmhT84ylC/YJEXO+4Qhj9glC6/YJEXO007hj+JXgy/YJEXO6tlhj9kUdS+\nYJEXOwmQhj+05Y++YJEXO2i6hj8L9Ba+YJEXO8bkhj/QymG8YJEXOyQPhz9idfU9YJEXO4M5\nhz8IyYE+YJEXO+Fjhz+2NMY+YJEXOz+Ohz8yUAU/YJEXO564hz8Khic/YJEXO/zihz/hu0k/\nYJEXO1oNiD+58Ws/YJEXO7k3iD/IE4c/YJEXOxdiiD+0Lpg/YJEXO3WMiD+gSak/YJEXO9S2\niD+MZLo/YJEXOzLhiD93f8s/YJEXO5ALiT9jmtw/YJEXO+81iT9Pte0/YJEXO01giT96PPG/\n0n8OPjknhD+OIeC/0n8OPphRhD+iBs+/0n8OPvZ7hD+3672/0n8OPlSmhD/L0Ky/0n8OPrPQ\nhD/ftZu/0n8OPhH7hD/0moq/0n8OPm8lhT8QAHO/0n8OPs5PhT84ylC/0n8OPix6hT9glC6/\n0n8OPoqkhT+JXgy/0n8OPunOhT9kUdS+0n8OPkf5hT+05Y++0n8OPqUjhj8L9Ba+0n8OPgRO\nhj/QymG80n8OPmJ4hj9idfU90n8OPsCihj8IyYE+0n8OPh/Nhj+2NMY+0n8OPn33hj8yUAU/\n0n8OPtshhz8Khic/0n8OPjpMhz/hu0k/0n8OPph2hz+58Ws/0n8OPvaghz/IE4c/0n8OPlXL\nhz+0Lpg/0n8OPrP1hz+gSak/0n8OPhEgiD+MZLo/0n8OPnBKiD93f8s/0n8OPs50iD9jmtw/\n0n8OPiyfiD9Pte0/0n8OPovJiD96PPG/sFCNPneQgz+OIeC/sFCNPtW6gz+iBs+/sFCNPjTl\ngz+3672/sFCNPpIPhD/L0Ky/sFCNPvA5hD/ftZu/sFCNPk9khD/0moq/sFCNPq2OhD8QAHO/\nsFCNPgu5hD84ylC/sFCNPmrjhD9glC6/sFCNPsgNhT+JXgy/sFCNPiY4hT9kUdS+sFCNPoVi\nhT+05Y++sFCNPuOMhT8L9Ba+sFCNPkG3hT/QymG8sFCNPqDhhT9idfU9sFCNPv4Lhj8IyYE+\nsFCNPlw2hj+2NMY+sFCNPrtghj8yUAU/sFCNPhmLhj8Khic/sFCNPne1hj/hu0k/sFCNPtbf\nhj+58Ws/sFCNPjQKhz/IE4c/sFCNPpI0hz+0Lpg/sFCNPvFehz+gSak/sFCNPk+Jhz+MZLo/\nsFCNPq2zhz93f8s/sFCNPgzehz9jmtw/sFCNPmoIiD9Pte0/sFCNPsgyiD96PPG/dmHTPrX5\ngj+OIeC/dmHTPhMkgz+iBs+/dmHTPnFOgz+3672/dmHTPtB4gz/L0Ky/dmHTPi6jgz/ftZu/\ndmHTPo3Ngz/0moq/dmHTPuv3gz8QAHO/dmHTPkkihD84ylC/dmHTPqhMhD9glC6/dmHTPgZ3\nhD+JXgy/dmHTPmShhD9kUdS+dmHTPsPLhD+05Y++dmHTPiH2hD8L9Ba+dmHTPn8ghT/QymG8\ndmHTPt1KhT9idfU9dmHTPjx1hT8IyYE+dmHTPpqfhT+2NMY+dmHTPvnJhT8yUAU/dmHTPlf0\nhT8Khic/dmHTPrUehj/hu0k/dmHTPhRJhj+58Ws/dmHTPnJzhj/IE4c/dmHTPtCdhj+0Lpg/\ndmHTPi/Ihj+gSak/dmHTPo3yhj+MZLo/dmHTPuschz93f8s/dmHTPklHhz9jmtw/dmHTPqhx\nhz9Pte0/dmHTPgachz96PPG/HrkMP/Nigj+OIeC/HrkMP1GNgj+iBs+/HrkMP6+3gj+3672/\nHrkMPw7igj/L0Ky/HrkMP2wMgz/ftZu/HrkMP8o2gz/0moq/HrkMPylhgz8QAHO/HrkMP4eL\ngz84ylC/HrkMP+W1gz9glC6/HrkMP0Tggz+JXgy/HrkMP6IKhD9kUdS+HrkMPwA1hD+05Y++\nHrkMP19fhD8L9Ba+HrkMP72JhD/QymG8HrkMPxu0hD9idfU9HrkMP3rehD8IyYE+HrkMP9gI\nhT+2NMY+HrkMPzYzhT8yUAU/HrkMP5VdhT8Khic/HrkMP/OHhT/hu0k/HrkMP1GyhT+58Ws/\nHrkMP7DchT/IE4c/HrkMPw4Hhj+0Lpg/HrkMP2wxhj+gSak/HrkMP8tbhj+MZLo/HrkMPymG\nhj93f8s/HrkMP4ewhj9jmtw/HrkMP+bahj9Pte0/HrkMP0QFhz96PPG/gsEvPzDMgT+OIeC/\ngsEvP4/2gT+iBs+/gsEvP+0ggj+3672/gsEvP0tLgj/L0Ky/gsEvP6p1gj/ftZu/gsEvPwig\ngj/0moq/gsEvP2bKgj8QAHO/gsEvP8X0gj84ylC/gsEvPyMfgz9glC6/gsEvP4FJgz+JXgy/\ngsEvP+Bzgz9kUdS+gsEvPz6egz+05Y++gsEvP5zIgz8L9Ba+gsEvP/vygz/QymG8gsEvP1kd\nhD9idfU9gsEvP7dHhD8IyYE+gsEvPxZyhD+2NMY+gsEvP3SchD8yUAU/gsEvP9LGhD8Khic/\ngsEvPzHxhD/hu0k/gsEvP48bhT+58Ws/gsEvP+1FhT/IE4c/gsEvP0xwhT+0Lpg/gsEvP6qa\nhT+gSak/gsEvPwjFhT+MZLo/gsEvP2fvhT93f8s/gsEvP8UZhj9jmtw/gsEvPyNEhj9Pte0/\ngsEvP4Juhj96PPG/5slSP241gT+OIeC/5slSP8xfgT+iBs+/5slSPyuKgT+3672/5slSP4m0\ngT/L0Ky/5slSP+fegT/ftZu/5slSP0YJgj/0moq/5slSP6Qzgj8QAHO/5slSPwJegj84ylC/\n5slSP2GIgj9glC6/5slSP7+ygj+JXgy/5slSPx3dgj9kUdS+5slSP3wHgz+05Y++5slSP9ox\ngz8L9Ba+5slSPzhcgz/QymG85slSP5eGgz9idfU95slSP/Wwgz8IyYE+5slSP1Pbgz+2NMY+\n5slSP7IFhD8yUAU/5slSPxAwhD8Khic/5slSP25ahD/hu0k/5slSP82EhD+58Ws/5slSPyuv\nhD/IE4c/5slSP4nZhD+0Lpg/5slSP+gDhT+gSak/5slSP0YuhT+MZLo/5slSP6RYhT93f8s/\n5slSPwODhT9jmtw/5slSP2GthT9Pte0/5slSP7/XhT96PPG/SNJ1P6yegD+OIeC/SNJ1PwrJ\ngD+iBs+/SNJ1P2nzgD+3672/SNJ1P8cdgT/L0Ky/SNJ1PyVIgT/ftZu/SNJ1P4RygT/0moq/\nSNJ1P+KcgT8QAHO/SNJ1P0DHgT84ylC/SNJ1P5/xgT9glC6/SNJ1P/0bgj+JXgy/SNJ1P1tG\ngj9kUdS+SNJ1P7lwgj+05Y++SNJ1Pxibgj8L9Ba+SNJ1P3bFgj/QymG8SNJ1P9Xvgj9idfU9\n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"}]},"context":{"shiny":false,"rmarkdown":null},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG) || defined(USE_ENVMAP)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n// USE_ENVMAP implies NEEDS_VNORMAL\n\n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n\n#ifdef USE_ENVMAP\n  vReflection = normalize(reflect(vPosition.xyz/vPosition.w, \n                        normalize(vNormal.xyz/vNormal.w)));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n\n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    // Simulate two-sided lighting\n    if (n.z < 0.0)\n      n = -n;\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i]) {\n        if (finite[i]) {\n          lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n        } else {\n          lightdir = (mvMatrix * vec4(lightdir, 0.)).xyz;\n        }\n      }\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n\n// These calculations use the definitions from \n// https://docs.gl/gl3/glTexEnv\n\n#ifdef USE_ENVMAP\n    float m = 2.0 * sqrt(dot(vReflection, vReflection) + 2.0*vReflection.z + 1.0);\n    vec4 textureColor = texture2D(uSampler, vReflection.xy / m + vec2(0.5, 0.5));\n#else\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n#endif\n\n#ifdef TEXTURE_rgb\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(textureColor.rgb, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*vec4(textureColor.rgb, 1.);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb, lighteffect.a);\n#endif\n\n#endif //TEXTURE_rgb\n        \n#ifdef TEXTURE_rgba\n\n#ifdef TEXMODE_replace\n// already done\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*textureColor;\n#endif\n\n#ifdef TEXMODE_decal\n    textureColor = vec4((1. - textureColor.a)*lighteffect.rgb) +\n                     textureColor.a*textureColor.rgb, \n                     lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n    \n#endif //TEXTURE_rgba\n    \n#ifdef TEXTURE_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(lighteffect.rgb, luminance);\n#endif \n\n#if defined(TEXMODE_modulate) || defined(TEXMODE_blend) || defined(TEXMODE_add)\n    textureColor = vec4(lighteffect.rgb, lighteffect.a*luminance);\n#endif\n \n#endif // TEXTURE_alpha\n    \n// The TEXTURE_luminance values are not from that reference    \n#ifdef TEXTURE_luminance\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, lighteffect.a);\n#endif\n\n#endif // TEXTURE_luminance\n \n    \n#ifdef TEXTURE_luminance_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, textureColor.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n\n#endif\n\n#endif // TEXTURE_luminance_alpha\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-polytrans3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;14.8: <code>data_concentric</code>: In R3 linear separierbaren Datenpunkte und trennende Hyperebene
</figcaption></figure>
</div>
</div>
<p>Beachte, dass die grüne Hyperebene die Daten nahezu perfekt trennt:</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Anteil falscher Klassifzikationen für data_concentric</span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">svm_model_poly_trans</span><span class="op">)</span> <span class="op">==</span> <span class="va">data_concentric</span><span class="op">$</span><span class="va">klasse</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0025</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># SVM mit poly Kernel auf data_concentric trainiert</span></span>
<span><span class="va">svm_model_poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">data_concentric</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span><span class="op">)</span>, </span>
<span>  y <span class="op">=</span> <span class="va">data_concentric</span><span class="op">$</span><span class="va">klasse</span>, </span>
<span>  kernel <span class="op">=</span> <span class="st">"polynomial"</span>, </span>
<span>  coef0 <span class="op">=</span> <span class="fl">0</span>, <span class="co"># c = 0</span></span>
<span>  degree <span class="op">=</span> <span class="fl">2</span>, <span class="co"># d = 2</span></span>
<span>  gamma <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  cost <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">svm_model_poly</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm.default(x = data_concentric %&gt;% dplyr::select(X1, X2), y = data_concentric$klasse, 
    kernel = "polynomial", degree = 2, gamma = 1, coef0 = 0, cost = 1)


Parameters:
   SVM-Type:  C-classification 
 SVM-Kernel:  polynomial 
       cost:  1 
     degree:  2 
     coef.0:  0 

Number of Support Vectors:  24</code></pre>
</div>
</div>
<p>Die SVM-Modelle <code>svm_model_poly_trans</code> und <code>svm_model_poly</code> liefern identische Klassifzierungen der Beobachtungen in <code>data_concentric</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">svm_model_poly_trans</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">svm_model_poly</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 399</code></pre>
</div>
</div>
<p>Ahand der Komponenten des Objekts <code>svm_model_poly</code> und mit Vorhersagen der Klassen für ein Gitter von Punkten können wir die angepasste kreisförmige Entscheidungsgrenze sowie die Margins im urspünglichen Prädiktorraum <span class="math inline">\(\mathbb{R}^2\)</span> visualisieren. <a href="#fig-concdecpred" class="quarto-xref">Abbildung&nbsp;<span>14.9</span></a> zeig das Ergebnis.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html">expand_grid</a></span><span class="op">(</span></span>
<span>  x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">data_concentric</span><span class="op">$</span><span class="va">X1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">data_concentric</span><span class="op">$</span><span class="va">X1</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>,</span>
<span>  x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">data_concentric</span><span class="op">$</span><span class="va">X2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">data_concentric</span><span class="op">$</span><span class="va">X2</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">svm_model_poly</span>, <span class="va">grid</span>, decision.values <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">decision.values</span></span>
<span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="va">grid</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Vorhersagen auf dem Grid</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    distanz <span class="op">=</span> <span class="va">dist</span>,</span>
<span>    klasse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">svm_model_poly</span>, <span class="va">grid</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Support-Vektoren</span></span>
<span><span class="va">SV</span> <span class="op">&lt;-</span> <span class="va">data_concentric</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="va">svm_model_poly</span><span class="op">$</span><span class="va">index</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_concentric</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X1</span>, y <span class="op">=</span> <span class="va">X2</span>, color <span class="op">=</span> <span class="va">klasse</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="va">grid</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, color <span class="op">=</span> <span class="va">klasse</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">geom_contour</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">grid</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, z <span class="op">=</span> <span class="va">dist</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fl">0</span>,  <span class="co"># Decision boundary</span></span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">geom_contour</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">grid</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, z <span class="op">=</span> <span class="va">dist</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,  <span class="co"># Marginal lines</span></span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">SV</span>, inherit.aes <span class="op">=</span> <span class="cn">F</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X1</span>, y <span class="op">=</span> <span class="va">X2</span><span class="op">)</span>,</span>
<span>    shape <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-concdecpred" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-concdecpred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="svm_files/figure-html/fig-concdecpred-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-concdecpred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;14.9: SVM mit Polynomial-Kernel erfasst kreisförmige Entscheidungsgrenze
</figcaption></figure>
</div>
</div>
</div>
<p>Dank des Kernel-Tricks können SVMs praktisch beliebige Formen von nicht-linearen Entscheidungsregeln lernen. Für die sinuidal verlaufende Entscheidungsgrenze im Datensatz <code>data_wavy</code> (vgl. <a href="#fig-datawavy" class="quarto-xref">Abbildung&nbsp;<span>14.5</span></a>) ist ein radialer Kernel hilfreich:</p>
<p>Der radiale Kernel ist dem polynomiellen Kernel bei der Anpassung hochflexibler Entscheidungsgrenzen überlegen, weil er selbst stark variierende Muster dank großer lokale Flexibilität besser erfassen kann. Ein polynomialer Kernel hingegen ist durch seine funktionale Form und den Polynomgrad <span class="math inline">\(d\)</span> beschränkt. Bei komplexen Grenzen muss <span class="math inline">\(d\)</span> für mehr Flexibilität der SVM groß gewählt werden, was Overfitting begünstigen kann.</p>
<p>Für einen Vergleich mit der in <a href="#fig-datawavy" class="quarto-xref">Abbildung&nbsp;<span>14.5</span></a> visualisierten Anpassung des SVC trainieren nun eine SVM für <code>data_wavy</code> mit radialem Kernel als <code>radial_svm_model</code> für die Standardwerte <code>cost = 1</code>, <code>coef0 = 0</code> und <code>gamma = 1</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># SVM mit RBF-Kernel anpassen</span></span>
<span><span class="va">radial_svm_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm</a></span><span class="op">(</span></span>
<span>  <span class="va">klasse</span> <span class="op">~</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x1</span>, </span>
<span>  data <span class="op">=</span> <span class="va">data_wavy</span>, </span>
<span>  kernel <span class="op">=</span> <span class="st">"radial"</span>, </span>
<span>  cost <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  coef0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wie zuvor plotten wir die trainierte Entscheidungsgrenze sowie die Margin gemeinsam mit mit den Datenpunkte im Regressor-Raum.</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Erzeuge einen Grid für die Vorhersagen</span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html">expand_grid</a></span><span class="op">(</span></span>
<span>  x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">data_wavy</span><span class="op">$</span><span class="va">x1</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">data_wavy</span><span class="op">$</span><span class="va">x1</span><span class="op">)</span>, </span>
<span>    length.out <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>,</span>
<span>  x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">data_wavy</span><span class="op">$</span><span class="va">x2</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">data_wavy</span><span class="op">$</span><span class="va">x2</span><span class="op">)</span>, </span>
<span>    length.out <span class="op">=</span> <span class="fl">150</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">radial_svm_model</span> , <span class="va">grid</span>, decision.values <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">decision.values</span></span>
<span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="va">grid</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Vorhersagen auf dem Grid</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    dist <span class="op">=</span> <span class="va">dist</span>,</span>
<span>    klasse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">radial_svm_model</span> , <span class="va">grid</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">SV</span> <span class="op">&lt;-</span> <span class="va">data_wavy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="va">radial_svm_model</span><span class="op">$</span><span class="va">index</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualisiere die Entscheidungsgrenze mit ggplot2</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">grid</span>, </span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, color <span class="op">=</span> <span class="va">klasse</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">data_wavy</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, color <span class="op">=</span> <span class="va">klasse</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">geom_contour</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">grid</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, z <span class="op">=</span> <span class="va">dist</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fl">0</span>,  <span class="co"># Decision boundary</span></span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">geom_contour</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">grid</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, z <span class="op">=</span> <span class="va">dist</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,  <span class="co"># Marginal lines</span></span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">SV</span>, inherit.aes <span class="op">=</span> <span class="cn">F</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span><span class="op">)</span>,</span>
<span>    shape <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    size <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="st">"X1"</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span><span class="st">"X2"</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-rbfsvmwavy" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-rbfsvmwavy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="svm_files/figure-html/fig-rbfsvmwavy-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-rbfsvmwavy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;14.10: <code>data_wavy</code> mit RBF-SVM trainierte Entscheidungsgrenze
</figcaption></figure>
</div>
</div>
</div>
<p>Ein Vergleich von <a href="#fig-rbfsvmwavy" class="quarto-xref">Abbildung&nbsp;<span>14.10</span></a> mit <a href="#fig-svcwavy" class="quarto-xref">Abbildung&nbsp;<span>14.6</span></a> zeigt, dass die SVM mit radialem Kernel im Objekt <code>radial_svm_model</code> den nicht-linearen Verlauf der sinuidalen Entscheidungsgrenze deutlich besser erfasst als der SVC in <code>svc_wavy</code>. Der Anteil fehlklassifizierter Beobachtungen liegt bei weniger als 10%.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Fehlerrate von 'radial_svm_model'</span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">radial_svm_model</span><span class="op">)</span> <span class="op">==</span> <span class="va">data_wavy</span><span class="op">$</span><span class="va">klasse</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09</code></pre>
</div>
</div>
</section><section id="overfitting" class="level3 page-columns page-full" data-number="14.3.2"><h3 data-number="14.3.2" class="anchored" data-anchor-id="overfitting">
<span class="header-section-number">14.3.2</span> Overfitting</h3>
<p>Der in Abschnitt <a href="#sec-scv" class="quarto-xref"><span>Kapitel 14.2</span></a> beschriebene Einfluss des <code>cost</code>-Parameters auf die Klassifikationsleistung von SVCs überträgt sich auch auf SVMs. Bei der Anpassung nichtlinearer Entscheidungsgrenzen mit nichtlinearen Kernelfunktionen müssen neben cost auch die Kernel-Parameter sorgfältig gewählt werden, um Overfitting zu vermeiden. Dabei bestehen Interdependenzen zwischen den Parametern. In den hier behandelten Beispielen mit einem zweidimensionalen Merkmalsraum lassen sich diese Effekte gut grafisch darstellen: Bei einer SVM mit radialem Kernel bewirken höhere <code>gamma</code>-Werte eine stärker lokal geprägte Entscheidungsgrenze, die sich enger um benachbarte Datenpunkte legt. Höhere <code>cost</code>-Werte führen zu engeren Margins, wodurch weniger Support-Vektoren zugelassen werden. Dies kann die Varianz der Entscheidungsgrenze erhöhen, da der Algorithmus sich stärker an einzelne Datenpunkte anpasst und die Schätzung tendenziell weiter von der wahren Grenze abweichen kann. Zu große Werte führen also jeweils zu einer Überanpassung an die Daten.</p>
<p>Wir illustrieren Overfitting durch eine ungünstige Parameterwahl für eine SVM mit Radial-Kernek und den Datensatz <code>data_wavy</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># SVM mit ungünstiger Parameter-Kombination</span></span>
<span><span class="va">radial_svm_overfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm</a></span><span class="op">(</span></span>
<span>  <span class="va">klasse</span> <span class="op">~</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x1</span>, </span>
<span>  data <span class="op">=</span> <span class="va">data_wavy</span>, </span>
<span>  kernel <span class="op">=</span> <span class="st">"radial"</span>, </span>
<span>  cost <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html">expand_grid</a></span><span class="op">(</span></span>
<span>  x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">data_wavy</span><span class="op">$</span><span class="va">x1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">data_wavy</span><span class="op">$</span><span class="va">x1</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>,</span>
<span>  x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">data_wavy</span><span class="op">$</span><span class="va">x2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">data_wavy</span><span class="op">$</span><span class="va">x2</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">radial_svm_overfit</span> , <span class="va">grid</span>, decision.values <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">decision.values</span></span>
<span></span>
<span><span class="va">grid_overfit</span> <span class="op">&lt;-</span> <span class="va">grid</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Vorhersagen auf dem Grid</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    dist <span class="op">=</span> <span class="va">dist</span>,</span>
<span>    klasse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">radial_svm_overfit</span> , <span class="va">grid</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualisiere die Entscheidungsgrenze mit ggplot2</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">grid_overfit</span>, </span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, color <span class="op">=</span> <span class="va">klasse</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">data_wavy</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, color <span class="op">=</span> <span class="va">klasse</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">geom_contour</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">grid_overfit</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, z <span class="op">=</span> <span class="va">dist</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fl">0</span>,  <span class="co"># Decision boundary</span></span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">geom_contour</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">grid_overfit</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x2</span>, z <span class="op">=</span> <span class="va">dist</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,  <span class="co"># Marginal lines</span></span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="st">"X1"</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span><span class="st">"X2"</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-rbfsvmof" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-rbfsvmof-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="svm_files/figure-html/fig-rbfsvmof-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-rbfsvmof-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;14.11: <code>data_wavy</code>: Overfitting der Entscheidungsgrenze mit RBF-SVM
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Fehlklassifikationsrate bei Overfitting:</span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">radial_svm_overfit</span><span class="op">)</span> <span class="op">==</span> <span class="va">data_wavy</span><span class="op">$</span><span class="va">klasse</span></span>
<span>  <span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.058</code></pre>
</div>
</div>
<p>Das Modell <code>radial_svm_overfit</code> leidet unter Overfiting: In <a href="#fig-rbfsvmof" class="quarto-xref">Abbildung&nbsp;<span>14.11</span></a> sehen wir, dass die gelernte Entscheidungsgrenze zu stark durch lokale Muster aufgrund der Überlappung der Klassen geprägt ist. Entsprechend ist die Klassifikation der für das Training genutzen Datenpunkte für <code>radial_svm_overfit</code> etwas genauer <code>radial_svm_model</code>. Diese Überanpassung resultiert tendentiell in einer schlechteren Generalisierung von <code>radial_svm_overfit</code> in Vorhersagen unbekannter Datenpunkte.</p>
<p>Mit <code><a href="https://rdrr.io/pkg/e1071/man/tune.html">e1071::tune()</a></code> können wir optimale Parameterwerte aus einem Grid mit Cross Validation schätzen. Wir übergeben hierzu die Methode (<code>METHOD</code>), die Spezifikation des Modells wie in <code><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm()</a></code> und dem Argument <code>ranges</code> die zu berücksichtigenden Parameter-Werte als Liste.</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Cross-Validation für Parameter in radialer SVM</span></span>
<span><span class="va">radial_svm_tuned</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/tune.html">tune</a></span><span class="op">(</span></span>
<span>  METHOD <span class="op">=</span> <span class="va">svm</span>, </span>
<span>  <span class="va">klasse</span> <span class="op">~</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x1</span>, </span>
<span>  data <span class="op">=</span> <span class="va">data_wavy</span>, </span>
<span>  kernel <span class="op">=</span> <span class="st">"radial"</span>,</span>
<span>  <span class="co"># Parameter-Werte festlegen</span></span>
<span>  ranges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    cost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>    gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.01</span>, <span class="fl">.05</span>, <span class="fl">.1</span>, <span class="fl">.25</span>, <span class="fl">.5</span>, <span class="fl">.8</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span>  </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CV-Ergebnisse auslesen</span></span>
<span><span class="va">radial_svm_tuned</span><span class="op">$</span><span class="va">performances</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   cost gamma  error dispersion
1     1  0.00 0.4960 0.02282786
2     2  0.00 0.4960 0.02282786
3     4  0.00 0.4960 0.02282786
4     6  0.00 0.4960 0.02282786
5     1  0.01 0.1835 0.03308659
6     2  0.01 0.1835 0.03240799
7     4  0.01 0.1830 0.03110913
8     6  0.01 0.1830 0.03038640
9     1  0.05 0.1745 0.03148633
10    2  0.05 0.1720 0.02679138
11    4  0.05 0.1665 0.02273641
12    6  0.05 0.1630 0.02335713
13    1  0.10 0.1595 0.02254009
14    2  0.10 0.1495 0.02033743
15    4  0.10 0.1450 0.01914854
16    6  0.10 0.1420 0.01584649
17    1  0.25 0.1360 0.01429841
18    2  0.25 0.1295 0.01657475
19    4  0.25 0.1230 0.01475730
20    6  0.25 0.1190 0.01370320
21    1  0.50 0.1150 0.01452966
22    2  0.50 0.1080 0.02188353
23    4  0.50 0.1000 0.02108185
24    6  0.50 0.0910 0.01696401
25    1  0.80 0.1005 0.01992346
26    2  0.80 0.0915 0.02041922
27    4  0.80 0.0885 0.01901023
28    6  0.80 0.0875 0.01703754
29    1  1.00 0.0950 0.01840894
30    2  1.00 0.0900 0.02041241
31    4  1.00 0.0865 0.01650757
32    6  1.00 0.0850 0.01763834
33    1  2.00 0.0890 0.01940790
34    2  2.00 0.0860 0.01897367
35    4  2.00 0.0905 0.01992346
36    6  2.00 0.0905 0.01921371
37    1  3.00 0.0900 0.02000000
38    2  3.00 0.0915 0.01716748
39    4  3.00 0.0925 0.01859659
40    6  3.00 0.0920 0.01798147</code></pre>
</div>
</div>
<p><code>error</code> ist die mithilfe von Cross-Validation geschätzte Fehlklassifikationsrate für unbekannte Beobachtungen. Die Ergebnisse verdeutlichen, dass die Modellleistung stark von der Fähigkeit des radialen Kernels abhängt, Nicht-Linearitäten zu erfassen: Bereits geringe <code>gamma</code>-Werte führen zu einer signifikanten Reduktion der Fehlklassifikationsrate im Vergleich zu einem trivialen Modell mit <code>gamma = 0</code>.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>&nbsp;Für <code>gamma = 0</code> wird lediglich eine Konstante angepasst, es findet also extremes “Underfitting” statt: Das Modell ist dann nicht besser als die zufällige Klassifikation mit Wahrscheinlichkeiten, die den relativen Häufigkeiten der Klassen im Datensatz entsprechen (<em>baseline accuracy</em>).</p></div></div><div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Beste Parameter-Kombination anzeigen</span></span>
<span><span class="va">radial_svm_tuned</span><span class="op">$</span><span class="va">best.parameters</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   cost gamma
32    6     1</code></pre>
</div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Beste SVM auslesen</span></span>
<span><span class="va">radial_svm_tuned</span><span class="op">$</span><span class="va">best.model</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
best.tune(METHOD = svm, train.x = klasse ~ x2 + x1, data = data_wavy, 
    ranges = list(cost = c(1, 2, 4, 6), gamma = c(0, 0.01, 0.05, 
        0.1, 0.25, 0.5, 0.8, 1, 2, 3)), kernel = "radial")


Parameters:
   SVM-Type:  C-classification 
 SVM-Kernel:  radial 
       cost:  6 

Number of Support Vectors:  450</code></pre>
</div>
</div>
</section></section><section id="beispiel-vorhersage-von-kaufentscheidungen" class="level2 page-columns page-full" data-number="14.4"><h2 data-number="14.4" class="anchored" data-anchor-id="beispiel-vorhersage-von-kaufentscheidungen">
<span class="header-section-number">14.4</span> Beispiel: Vorhersage von Kaufentscheidungen</h2>
<p>Der mit dem R-Paket <code>ISLR</code> <span class="citation" data-cites="Jamesetal2021">(<a href="Literatur.html#ref-Jamesetal2021" role="doc-biblioref">James u.&nbsp;a. 2021</a>)</span> Datensatz <code>OJ</code> enthält Beobachtungen von 1070 Orangensaft-Verkäufen bei denen der Kunde entweder die Mark “Citrus Hill” (CH) oder “Minute Maid” (MM) gekauft hat. <a href="#tbl-varsoj" class="quarto-xref">Tabelle&nbsp;<span>14.1</span></a> enthält eine Beschreibung der verfügbaren Variablen.</p>
<div class="cell page-columns page-full">
<div id="tbl-varsoj" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><div aria-describedby="tbl-varsoj-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="xfqwykgcqu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xfqwykgcqu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xfqwykgcqu thead, #xfqwykgcqu tbody, #xfqwykgcqu tfoot, #xfqwykgcqu tr, #xfqwykgcqu td, #xfqwykgcqu th {
  border-style: none;
}

#xfqwykgcqu p {
  margin: 0;
  padding: 0;
}

#xfqwykgcqu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #000000;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xfqwykgcqu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xfqwykgcqu .gt_title {
  color: #000000;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xfqwykgcqu .gt_subtitle {
  color: #000000;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xfqwykgcqu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xfqwykgcqu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xfqwykgcqu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xfqwykgcqu .gt_col_heading {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xfqwykgcqu .gt_column_spanner_outer {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xfqwykgcqu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xfqwykgcqu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xfqwykgcqu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xfqwykgcqu .gt_spanner_row {
  border-bottom-style: hidden;
}

#xfqwykgcqu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xfqwykgcqu .gt_empty_group_heading {
  padding: 0.5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xfqwykgcqu .gt_from_md > :first-child {
  margin-top: 0;
}

#xfqwykgcqu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xfqwykgcqu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xfqwykgcqu .gt_stub {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xfqwykgcqu .gt_stub_row_group {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xfqwykgcqu .gt_row_group_first td {
  border-top-width: 2px;
}

#xfqwykgcqu .gt_row_group_first th {
  border-top-width: 2px;
}

#xfqwykgcqu .gt_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xfqwykgcqu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xfqwykgcqu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xfqwykgcqu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xfqwykgcqu .gt_grand_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xfqwykgcqu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xfqwykgcqu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xfqwykgcqu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xfqwykgcqu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#xfqwykgcqu .gt_footnotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xfqwykgcqu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xfqwykgcqu .gt_sourcenotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xfqwykgcqu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xfqwykgcqu .gt_left {
  text-align: left;
}

#xfqwykgcqu .gt_center {
  text-align: center;
}

#xfqwykgcqu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xfqwykgcqu .gt_font_normal {
  font-weight: normal;
}

#xfqwykgcqu .gt_font_bold {
  font-weight: bold;
}

#xfqwykgcqu .gt_font_italic {
  font-style: italic;
}

#xfqwykgcqu .gt_super {
  font-size: 65%;
}

#xfqwykgcqu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xfqwykgcqu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xfqwykgcqu .gt_indent_1 {
  text-indent: 5px;
}

#xfqwykgcqu .gt_indent_2 {
  text-indent: 10px;
}

#xfqwykgcqu .gt_indent_3 {
  text-indent: 15px;
}

#xfqwykgcqu .gt_indent_4 {
  text-indent: 20px;
}

#xfqwykgcqu .gt_indent_5 {
  text-indent: 25px;
}

#xfqwykgcqu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xfqwykgcqu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id="Variable" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Variable</th>
<th id="Beschreibung" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Beschreibung</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Variable">Purchase</td>
<td class="gt_row gt_left" headers="Beschreibung">Kauf von CH oder MM Orangensaft</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable">WeekofPurchase</td>
<td class="gt_row gt_left" headers="Beschreibung">Kaufwoche</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variable">StoreID</td>
<td class="gt_row gt_left" headers="Beschreibung">ID des Geschäfts</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable">PriceCH</td>
<td class="gt_row gt_left" headers="Beschreibung">Preis für Citrus Hill</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variable">PriceMM</td>
<td class="gt_row gt_left" headers="Beschreibung">Preis für Minute Maid</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable">DiscCH</td>
<td class="gt_row gt_left" headers="Beschreibung">Rabatt auf Citrus Hill</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variable">DiscMM</td>
<td class="gt_row gt_left" headers="Beschreibung">Rabatt auf Minute Maid</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable">SpecialCH</td>
<td class="gt_row gt_left" headers="Beschreibung">Sonderangebot für Citrus Hill</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variable">SpecialMM</td>
<td class="gt_row gt_left" headers="Beschreibung">Sonderangebot für Minute Maid</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable">LoyalCH</td>
<td class="gt_row gt_left" headers="Beschreibung">Markentreue für Citrus Hill</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variable">SalePriceMM</td>
<td class="gt_row gt_left" headers="Beschreibung">Verkaufspreis für Minute Maid</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable">SalePriceCH</td>
<td class="gt_row gt_left" headers="Beschreibung">Verkaufspreis für Citrus Hill</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variable">PriceDiff</td>
<td class="gt_row gt_left" headers="Beschreibung">Unterschied Verkaufspreise MM - CH</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable">Store7</td>
<td class="gt_row gt_left" headers="Beschreibung">Verkauf in Geschäft 7 (Ja/Nein)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variable">PctDiscMM</td>
<td class="gt_row gt_left" headers="Beschreibung">Prozentualer Rabatt für MM</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable">PctDiscCH</td>
<td class="gt_row gt_left" headers="Beschreibung">Prozentualer Rabatt für CH</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variable">ListPriceDiff</td>
<td class="gt_row gt_left" headers="Beschreibung">Unterschied Listenpreise MM - CH</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable">STORE</td>
<td class="gt_row gt_left" headers="Beschreibung">Welches der 5 möglichen Geschäfte</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-varsoj-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;14.1: Datensatz <code>OJ</code>: Übersicht der Variablen
</figcaption></figure>
</div>
</div>
<p>Nach Laden des Pakets fügen wir den Datensatz <code>OJ</code> der Arbeitsumgebung hinzu. Wir transformieren <code>WeekofPurchase</code> in eine leichter intepretierbare Wochenangabe und definieren die kategorischen Variablen als Typ <code>factor</code>.</p>
<div class="cell">
<div>
<div id="webr-1">

</div>
<script type="webr-1-contents">
eyJhdHRyIjp7ImV2YWwiOnRydWUsImVkaXQiOnRydWUsImZpZy13aWR0aCI6IjgifSwiY29kZSI6IiMgRGF0ZW4gYmVyZWluaWdlbiB1bmQgZm9ybWF0aWVyZW5cbk9KIDwtIE9KICU+JSBcbiAgbXV0YXRlKFxuICAgIFN0b3JlSUQgPSBhc19mYWN0b3IoU3RvcmVJRCksXG4gICAgV2Vla29mUHVyY2hhc2UgPSAoV2Vla29mUHVyY2hhc2UgLSAyMjYpICU+JSBcbiAgICAgIGFzLmZhY3RvcigpXG4gICkifQ==
</script>
</div>
</div>
<p>Der nächste Code-Chunk produziert eine Grafik für die Gesamtenwicklung der Verkäufe über das Jahr.</p>
<div class="cell">
<div>
<div id="webr-2">

</div>
<script type="webr-2-contents">
eyJhdHRyIjp7ImZpZy1jYXAiOiJTYWZ0LVZlcmvDpHVmZSBpbSBaZWl0dmVybGF1ZiIsImV2YWwiOnRydWUsImxhYmVsIjoiZmlnLXNhbGVzIiwiZmlnLXdpZHRoIjoiOCIsImVkaXQiOnRydWV9LCJjb2RlIjoiIyBWZXJrw6R1ZmUgaW0gWmVpdHZlcmxhdWYgVmlzdWFsaXNpZXJlblxuT0ogJT4lIFxuICBnZ3Bsb3QoXG4gICAgbWFwcGluZyA9IGFlcyhcbiAgICAgIHggPSBhcy5mYWN0b3IoV2Vla29mUHVyY2hhc2UpLCBcbiAgICAgIGZpbGwgPSBhcy5mYWN0b3IoUHVyY2hhc2UpXG4gICAgICApXG4gICAgKSArIFxuICBnZW9tX2Jhcihwb3NpdGlvbiA9IFwic3RhY2tcIikgK1xuICBsYWJzKHggPSBcIldvY2hlIGRlcyBWZXJrYXVmc1wiLCB5ID0gXCJDb3VudFwiLCBmaWxsID0gXCJQcm9kdWt0XCIpICsgXG4gIHRoZW1lX2Nvd3Bsb3QoKSArICBcbiAgY29vcmRfY2FydGVzaWFuKGV4cGFuZCA9IDApICtcbiAgdGhlbWUoXG4gICAgYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA5MCwgaGp1c3QgPSAxKSxcbiAgICBsZWdlbmQucG9zaXRpb24gPSBcInRvcFwiXG4gICkifQ==
</script>
</div>
</div>
<p>Mit <code><a href="https://rdrr.io/pkg/ggcorrplot/man/ggcorrplot.html">ggcorrplot::ggcorrplot()</a></code> erzeugen wir einen Korrelationsplot für die numerischen Variablen des Datensatzes, um die linearen Zusammenhänge zwischen den Preis-, Rabatt- und Verkaufsvariablen einzuschätzen.</p>
<div class="cell" data-figfig-width="6">
<div>
<div id="webr-3">

</div>
<script type="webr-3-contents">
eyJhdHRyIjp7ImZpZ2ZpZy13aWR0aCI6NiwiZXZhbCI6dHJ1ZSwiZWRpdCI6dHJ1ZSwiZmlnLXdpZHRoIjoiOCJ9LCJjb2RlIjoibGlicmFyeShJU0xSKVxubGlicmFyeShnZ2NvcnJwbG90KVxuXG4jIERhdGVuc2F0eiBPSiBhdXMgSVNMUiBsYWRlblxuZGF0YShPSiwgcGFja2FnZSA9IFwiSVNMUlwiKVxuXG4jIEtvcmVsbGF0aW9uc3Bsb3RcbmdnY29ycnBsb3QoXG4gIGNvcnIgPSBjb3IoXG4gICAgT0ogJT4lIHNlbGVjdChcbiAgICAgIHdoZXJlKGlzLm51bWVyaWMpKVxuICAgICksXG4gIGhjLm9yZGVyID0gVFJVRSwgXG4gIHR5cGUgPSBcImxvd2VyXCIsXG4gIG91dGxpbmUuY29sID0gXCJ3aGl0ZVwiXG4gICkifQ==
</script>
</div>
</div>
<p>Die Abbildung zeigt, dass es starke Korellation zwischen Discount-Indikatoren (<code>DiscCH</code>, <code>DiscMM</code>) und den jeweiligen Prozent-Beträgen (<code>PctDiscCH</code>, <code>PctDiscMM</code>) sowie der Preis-Differenz (<code>PriceDiff</code>) gibt. Die Variablen <code>STORE</code> und <code>Store7</code> enthalten redundante Informationen über das Geschäft, in dem der Verkauf stattfand. Wir entfernen diese Variablen bevor der Datensatz mit <code><a href="https://rsample.tidymodels.org/reference/initial_split.html">rsample::initial_split()</a></code> in Trainings- und Test-Partitionen eingeteilt wird.</p>
<div class="cell">
<div>
<div id="webr-4">

</div>
<script type="webr-4-contents">
eyJhdHRyIjp7ImV2YWwiOnRydWUsImVkaXQiOnRydWUsImZpZy13aWR0aCI6IjgifSwiY29kZSI6IiMgRGF0ZW5hdWZ0ZWlsdW5nXG5cbnNldC5zZWVkKDEyMzQpXG5cbm9qX3NwbGl0IDwtIGluaXRpYWxfc3BsaXQoXG4gIGRhdGEgPSBPSiAlPiUgXG4gICAgZHBseXI6OnNlbGVjdChcbiAgICAgIC1TVE9SRSwgXG4gICAgICAtU3RvcmU3LCBcbiAgICAgIC1XZWVrb2ZQdXJjaGFzZSwgXG4gICAgICAtRGlzY0NILFxuICAgICAgLURpc2NNTVxuICAgICksIFxuICBwcm9wID0gLjgsIFxuICBzdHJhdGEgPSBQdXJjaGFzZVxuKVxuXG5val90cmFpbiA8LSB0cmFpbmluZyhval9zcGxpdClcbm9qX3Rlc3QgPC0gdGVzdGluZyhval9zcGxpdCkifQ==
</script>
</div>
</div>
<p>Mit <code>recipe::recipe()</code> können Datensätze systematisch für die Anwendung von Machine-Learning-Methoden vorbereitet werden. Im nachfolgenden Code-Chunk erstellen wir das recipe <code>blueprint</code>: Wir skalieren und zentrieren wir numerische Variablen, was sicherstellt, dass die Regresoren auf einer vergleichbaren Skala liegen, sodass distanzbasierte Algorithmen nicht durch unterschiedlliche Skalierungen Variablen beeinflusst werden. Kategorische Variablen mit mehr als zwei Ausprägungen werden mithilfe von <em>One-Hot-Encoding</em> in binäre Dummy-Variablen umgewandelt. Dieser Ansatz sorgt für eine konsistente und reproduzierbare Datenvorverarbeitung jenseits der Anwendungen mit SVMs.</p>
<div class="cell">
<div>
<div id="webr-5">

</div>
<script type="webr-5-contents">
eyJhdHRyIjp7ImV2YWwiOnRydWUsImVkaXQiOnRydWUsImZpZy13aWR0aCI6IjgifSwiY29kZSI6IiMgUmVjaXBlIGbDvHIgRGF0ZW52b3J2ZXJhcmJlaXR1bmcgZGVmaW5pZXJlblxuYmx1ZXByaW50IDwtIHJlY2lwZShcbiAgUHVyY2hhc2UgfiAuLCBcbiAgZGF0YSA9IG9qX3RyYWluXG4gICkgJT4lXG4gIHN0ZXBfY2VudGVyKGFsbF9udW1lcmljKCksIC1hbGxfb3V0Y29tZXMoKSkgJT4lXG4gIHN0ZXBfc2NhbGUoYWxsX251bWVyaWMoKSwgLWFsbF9vdXRjb21lcygpKSAlPiVcbiAgc3RlcF9kdW1teShhbGxfbm9taW5hbCgpLCAtYWxsX291dGNvbWVzKCksIG9uZV9ob3QgPSBUUlVFKVxuXG5ibHVlcHJpbnQifQ==
</script>
</div>
</div>
<p>Mit <code><a href="https://recipes.tidymodels.org/reference/prep.html">recipes::prep()</a></code> bestimmen wir die nötigen Parameter für die Vorbereitung von Datensätzen mit dem in <code>oj_train</code> enthaltenen. <code><a href="https://recipes.tidymodels.org/reference/bake.html">recipes::bake()</a></code> wendet die Transformationen an. Wir zeugen eine Übersicht der transformierten Trainingsdaten mit <code><a href="https://docs.ropensci.org/skimr/reference/skim.html">skimr::skim</a></code>.</p>
<div class="cell">
<div>
<div id="webr-6">

</div>
<script type="webr-6-contents">
eyJhdHRyIjp7ImV2YWwiOnRydWUsImVkaXQiOnRydWUsImZpZy13aWR0aCI6IjgifSwiY29kZSI6IiMgVm9yYmVyZWl0ZW46XG5wcmVwYXJlIDwtIHByZXAoYmx1ZXByaW50LCB0cmFpbmluZyA9IG9qX3RyYWluKVxuXG4jIERhdGVuc8OkdHplIHRyYW5zZm9ybWllcmVuXG5iYWtlZF90cmFpbiA8LSBiYWtlKHByZXBhcmUsIG5ld19kYXRhID0gb2pfdHJhaW4pXG5iYWtlZF90ZXN0IDwtIGJha2UocHJlcGFyZSwgbmV3X2RhdGEgPSBval90ZXN0KVxuXG4jIMOcYmVyYmxpY2tcbnNraW0oYmFrZWRfdHJhaW4pIn0=
</script>
</div>
</div>
<p>Die nächsten Code chunks zeigen, wie <code>parsnip</code> SVMs mit lineare, polynomialen und radialen Kernel-funktionen für die Klassifikation der gekauften Orangensaft-Marke <code>Purchase</code> angepasst werden können. Hierbei wird die Implmentierung von <code>ksvm()</code> im Paket <code>kernlab</code> genutzt. Für jeden dieser drei Ansätze definieren wir einen separaten Workflow für 10-fache Cross Validation der jeweiligen Modellparameter.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> Als Kriterium für die Modellleistung verwernden wir <code>accuracy</code>, den Anteil korrekter Klassifikationen. Nach Anpassung des als optimal ermittelten Modells evaluieren wir die Vorhersagegüte der Modelle auf dem Testdatensatz <code>bake_train</code>.</p>
<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>&nbsp;Aufgrund der geringen Rechenleistung der für die interaktiven Code-Chunks genutzen Webr-Implementierung betrachten wir hier beispielhafte, kleine Parameter-Gitter.</p></div></div><p><strong>SVM: Linearer Kernel</strong></p>
<div class="cell">
<div>
<div id="webr-7">

</div>
<script type="webr-7-contents">
eyJhdHRyIjp7ImV2YWwiOnRydWUsImVkaXQiOnRydWUsImZpZy13aWR0aCI6IjgifSwiY29kZSI6ImxpYnJhcnkodHVuZSlcblxuIyBMaW5lYXJlIFNWTSBtaXQgS3JldXp2YWxpZGllcnVuZ1xubGluZWFyX3N2bV9zcGVjX2N2IDwtIHN2bV9saW5lYXIoKSAlPiVcbiAgc2V0X2VuZ2luZShcbiAgICBlbmdpbmUgPSBcImtlcm5sYWJcIixcbiAgICBjb3N0ID0gdHVuZSgpXG4gICkgJT4lXG4gIHNldF9tb2RlKFwiY2xhc3NpZmljYXRpb25cIilcblxuIyBXb3JrZmxvdyBmZXN0bGVnZW5cbmxpbmVhcl9zdm1fd2YgPC0gd29ya2Zsb3coKSAlPiVcbiAgYWRkX21vZGVsKHNwZWMgPSBsaW5lYXJfc3ZtX3NwZWNfY3YpICU+JVxuICBhZGRfZm9ybXVsYShmb3JtdWxhID0gUHVyY2hhc2UgfiAuKVxuXG4jIDEwLWZvbGQgQ1YgZHVyY2hmw7xocmVuXG5zZXQuc2VlZCgxMjM0KVxuXG5saW5lYXJfc3ZtX3JlcyA8LSB0dW5lX2dyaWQoXG4gIGxpbmVhcl9zdm1fd2YsXG4gIHJlc2FtcGxlcyA9IHZmb2xkX2N2KGJha2VkX3RyYWluLCB2ID0gMTApLFxuICBncmlkID0gZXhwYW5kX2dyaWQoXG4gICAgY29zdCA9IGMoLjAxLCAuMSlcbiAgKSxcbiAgY29udHJvbCA9IGNvbnRyb2xfZ3JpZChzYXZlX3ByZWQgPSBUUlVFKVxuKVxuXG4jIEJlc3RlIE1vZGVsbGUgYXVzZ2ViZW5cbnNob3dfYmVzdChsaW5lYXJfc3ZtX3JlcywgbWV0cmljID0gXCJhY2N1cmFjeVwiKSJ9
</script>
</div>
</div>
<div class="cell">
<div>
<div id="webr-8">

</div>
<script type="webr-8-contents">
eyJhdHRyIjp7ImV2YWwiOnRydWUsImVkaXQiOnRydWUsImZpZy13aWR0aCI6IjgifSwiY29kZSI6ImJlc3RfbGluZWFyX3N2bSA8LSBzZWxlY3RfYmVzdChcbiAgeCA9IGxpbmVhcl9zdm1fcmVzLCBcbiAgbWV0cmljID0gXCJhY2N1cmFjeVwiXG4pXG5cbmZpbmFsX2xpbmVhcl9zdm0gPC0gZmluYWxpemVfbW9kZWwoXG4gIHggPSBsaW5lYXJfc3ZtX3NwZWNfY3YsXG4gIHBhcmFtZXRlcnMgPSBiZXN0X2xpbmVhcl9zdm1cbikgJT4lXG4gIGZpdChQdXJjaGFzZSB+IC4sIGRhdGEgPSBiYWtlZF90cmFpbikifQ==
</script>
</div>
</div>
<div class="cell">
<div>
<div id="webr-9">

</div>
<script type="webr-9-contents">
eyJhdHRyIjp7ImV2YWwiOnRydWUsImVkaXQiOnRydWUsImZpZy13aWR0aCI6IjgifSwiY29kZSI6IiMgVm9yaGVyc2FnZW5cbnRlc3RfcHJlZF9zdm1fY3YgPC0gcHJlZGljdChcbiAgb2JqZWN0ID0gZmluYWxfbGluZWFyX3N2bSwgXG4gIG5ld19kYXRhID0gYmFrZWRfdGVzdFxuICApICU+JVxuICBiaW5kX2NvbHMoYmFrZWRfdGVzdCkgJT4lXG4gIG1ldHJpY3MoXG4gICAgdHJ1dGggPSBQdXJjaGFzZSwgXG4gICAgZXN0aW1hdGUgPSAucHJlZF9jbGFzc1xuICApXG5cbnRlc3RfcHJlZF9zdm1fY3YifQ==
</script>
</div>
</div>
<p><strong>SVM: Radialer Kernel</strong></p>
<div class="cell">
<div>
<div id="webr-10">

</div>
<script type="webr-10-contents">
eyJhdHRyIjp7ImV2YWwiOnRydWUsImVkaXQiOnRydWUsImZpZy13aWR0aCI6IjgifSwiY29kZSI6IiMgU1ZNIG1pdCBSYWRpYWwtS2VybmVsIG1pdCBDVlxuXG4jIFNwZXppZmlrYXRpb25cbnJhZGlhbF9zdm1fc3BlY19jdiA8LSBzdm1fcmJmKCkgJT4lXG4gIHNldF9lbmdpbmUoXG4gICAgZW5naW5lID0gXCJrZXJubGFiXCIsXG4gICAgY29zdCA9IHR1bmUoKSwgXG4gICAgcmJmX3NpZ21hID0gdHVuZSgpXG4gICkgJT4lXG4gIHNldF9tb2RlKG1vZGUgPSBcImNsYXNzaWZpY2F0aW9uXCIpXG5cbiMgV29ya2Zsb3dcbnJhZGlhbF9zdm1fd2YgPC0gd29ya2Zsb3coKSAlPiVcbiAgYWRkX21vZGVsKHNwZWMgPSByYWRpYWxfc3ZtX3NwZWNfY3YpICU+JVxuICBhZGRfZm9ybXVsYShcbiAgICBmb3JtdWxhID0gUHVyY2hhc2UgfiAuXG4gIClcblxuIyBDViBkdXJjaGbDvGhyZW5cbnNldC5zZWVkKDEyMzQpXG5cbnJhZGlhbF9zdm1fcmVzIDwtIHR1bmVfZ3JpZChcbiAgICByYWRpYWxfc3ZtX3dmLFxuICAgIHJlc2FtcGxlcyA9IHZmb2xkX2N2KGJha2VkX3RyYWluLCB2ID0gMTApLFxuICAgIGdyaWQgPSBleHBhbmRfZ3JpZChcbiAgICAgIGNvc3QgPSBjKC4wMSwgLjEpLFxuICAgICAgcmJmX3NpZ21hID0gYyguMSwgMSlcbiAgICApLFxuICAgIGNvbnRyb2wgPSBjb250cm9sX2dyaWQoc2F2ZV9wcmVkID0gVFJVRSlcbilcblxuIyBCZXN0ZSBNb2RlbGxlIGF1c2dlYmVuXG5zaG93X2Jlc3QocmFkaWFsX3N2bV9yZXMsIG1ldHJpYyA9IFwiYWNjdXJhY3lcIikifQ==
</script>
</div>
</div>
<div class="cell">
<div>
<div id="webr-11">

</div>
<script type="webr-11-contents">
eyJhdHRyIjp7ImV2YWwiOnRydWUsImVkaXQiOnRydWUsImZpZy13aWR0aCI6IjgifSwiY29kZSI6IiMgQmVzdGVzIE1vZGVsbCB6dXdlaXNlblxuYmVzdF9yYWRpYWxfc3ZtIDwtIHNlbGVjdF9iZXN0KFxuICB4ID0gcmFkaWFsX3N2bV9yZXMsIFxuICBtZXRyaWMgPSBcImFjY3VyYWN5XCJcbilcblxuZmluYWxfcmFkaWFsX3N2bSA8LSBmaW5hbGl6ZV9tb2RlbChcbiAgeCA9IHJhZGlhbF9zdm1fc3BlY19jdiwgXG4gIHBhcmFtZXRlcnMgPSBiZXN0X3JhZGlhbF9zdm1cbikgJT4lXG4gIGZpdChQdXJjaGFzZSB+IC4sIGRhdGEgPSBiYWtlZF90cmFpbikifQ==
</script>
</div>
</div>
<div class="cell">
<div>
<div id="webr-12">

</div>
<script type="webr-12-contents">
eyJhdHRyIjp7ImV2YWwiOnRydWUsImVkaXQiOnRydWUsImZpZy13aWR0aCI6IjgifSwiY29kZSI6IiMgVm9yaGVyc2FnZW4gYXVmIGRlbSBUcmFpbmluZ3NkYXRlbnNhdHpcbnRlc3RfcHJlZF9zdm1fcmFkX2N2IDwtIHByZWRpY3QoXG4gIG9iamVjdCA9IGZpbmFsX3JhZGlhbF9zdm0sIFxuICBuZXdfZGF0YSA9IGJha2VkX3Rlc3RcbiAgKSAlPiVcbiAgYmluZF9jb2xzKGJha2VkX3Rlc3QpICU+JVxuICBtZXRyaWNzKHRydXRoID0gUHVyY2hhc2UsIGVzdGltYXRlID0gLnByZWRfY2xhc3MpXG5cbnRlc3RfcHJlZF9zdm1fcmFkX2N2In0=
</script>
</div>
</div>
<p><strong>SVM: Polynomialer Kernel</strong></p>
<div class="cell">
<div>
<div id="webr-13">

</div>
<script type="webr-13-contents">
eyJhdHRyIjp7ImV2YWwiOnRydWUsImVkaXQiOnRydWUsImZpZy13aWR0aCI6IjgifSwiY29kZSI6IiMgU1ZNIG1pdCBQb2x5bm9taWFsLUtlcm5lbFxucG9seV9zdm1fc3BlY19jdiA8LSBzdm1fcG9seShcbiAgICBtb2RlID0gXCJjbGFzc2lmaWNhdGlvblwiLCBkZWdyZWUgPSAyXG4pICU+JVxuICAgIHNldF9lbmdpbmUoXG4gICAgICBlbmdpbmUgPSBcImtlcm5sYWJcIixcbiAgICAgIHNjYWxlX2ZhY3RvciA9IHR1bmUoKSwgXG4gICAgICBjb3N0ID0gdHVuZSgpXG4gICAgICApXG5cbiMgV29ya2Zsb3dcbnBvbHlfc3ZtX3dmIDwtIHdvcmtmbG93KCkgJT4lXG4gIGFkZF9tb2RlbChzcGVjID0gcG9seV9zdm1fc3BlY19jdikgJT4lXG4gIGFkZF9mb3JtdWxhKFxuICAgIGZvcm11bGEgPSBQdXJjaGFzZSB+IC5cbiAgKVxuXG4jIENWIGR1cmNoZsO8aHJlblxuc2V0LnNlZWQoMTIzNClcblxucG9seV9zdm1fcmVzIDwtIHR1bmVfZ3JpZChcbiAgICBwb2x5X3N2bV93ZixcbiAgICByZXNhbXBsZXMgPSB2Zm9sZF9jdihiYWtlZF90cmFpbiwgdiA9IDEwKSxcbiAgICBncmlkID0gZXhwYW5kX2dyaWQoXG4gICAgICBjb3N0ID0gYyguMDEgLDEpLFxuICAgICAgc2NhbGVfZmFjdG9yID0gYyguMDAxLCAuMDEpXG4gICAgKSxcbiAgICBjb250cm9sID0gY29udHJvbF9ncmlkKHNhdmVfcHJlZCA9IFRSVUUpXG4pXG5cbiMgQmVzdGUgTW9kZWxsZSBhdXNnZWJlblxuc2hvd19iZXN0KHBvbHlfc3ZtX3JlcywgbWV0cmljID0gXCJhY2N1cmFjeVwiKSJ9
</script>
</div>
</div>
<div class="cell">
<div>
<div id="webr-14">

</div>
<script type="webr-14-contents">
eyJhdHRyIjp7ImV2YWwiOnRydWUsImVkaXQiOnRydWUsImZpZy13aWR0aCI6IjgifSwiY29kZSI6IiMgQmVzdGVzIE1vZGVsbCB6dXdlaXNlblxuYmVzdF9wb2x5X3N2bSA8LSBzZWxlY3RfYmVzdChcbiAgeCA9IHJhZGlhbF9zdm1fcmVzLCBcbiAgbWV0cmljID0gXCJhY2N1cmFjeVwiXG4pXG5cbmZpbmFsX3BvbHlfc3ZtIDwtIGZpbmFsaXplX21vZGVsKFxuICB4ID0gcG9seV9zdm1fc3BlY19jdiwgXG4gIHBhcmFtZXRlcnMgPSBiZXN0X3BvbHlfc3ZtXG4pICU+JVxuICBmaXQoUHVyY2hhc2UgfiAuLCBkYXRhID0gYmFrZWRfdHJhaW4pIn0=
</script>
</div>
</div>
<div class="cell">
<div>
<div id="webr-15">

</div>
<script type="webr-15-contents">
eyJhdHRyIjp7ImV2YWwiOnRydWUsImVkaXQiOnRydWUsImZpZy13aWR0aCI6IjgifSwiY29kZSI6IiMgVm9yaGVyc2FnZW4gYXVmIGRlbSBUcmFpbmluZ3NkYXRlbnNhdHpcbnRlc3RfcHJlZF9zdm1fcG9seV9jdiA8LSBwcmVkaWN0KFxuICBvYmplY3QgPSBmaW5hbF9wb2x5X3N2bSwgXG4gIG5ld19kYXRhID0gYmFrZWRfdGVzdFxuICApICU+JVxuICBiaW5kX2NvbHMoYmFrZWRfdGVzdCkgJT4lXG4gIG1ldHJpY3MoXG4gICAgdHJ1dGggPSBQdXJjaGFzZSwgXG4gICAgZXN0aW1hdGUgPSAucHJlZF9jbGFzc1xuICApXG5cbnRlc3RfcHJlZF9zdm1fcG9seV9jdiJ9
</script>
</div>
</div>
<p>Für einen tabellarischen Vergleich der Performance der Modelle auf den Testdatensatz sammeln wir die Ergebnisse in einer Liste <code>ergebnisse</code> und verwenden <code><a href="https://purrr.tidyverse.org/reference/map_dfr.html">purrr::map_dfr()</a></code> für die Transformation in eine <code>tibble</code> mit der ID-Variable <code>Modell</code>. Die Metrik <code>accuracy</code> tabellieren wir mit <code><a href="https://gt.rstudio.com/reference/gt.html">gt::gt()</a></code>.</p>
<div class="cell">
<div>
<div id="webr-16">

</div>
<script type="webr-16-contents">
eyJhdHRyIjp7ImV2YWwiOnRydWUsImVkaXQiOnRydWUsImZpZy13aWR0aCI6IjgifSwiY29kZSI6ImxpYnJhcnkocHVycnIpXG5saWJyYXJ5KGd0KVxuXG4jIEVyZ2Vibmlzc2Ugc2FtbWVsblxuZXJnZWJuaXNzZSA8LSBsaXN0KFxuICBgU1ZNIGxpbmVhcmAgPSB0ZXN0X3ByZWRfc3ZtX2N2LFxuICBgU1ZNIHJhZGlhbGAgPSB0ZXN0X3ByZWRfc3ZtX3JhZF9jdixcbiAgYFNWTSBwb2x5bm9taWFsYCA9IHRlc3RfcHJlZF9zdm1fcG9seV9jdlxuKVxuXG4jIFRhYmVsbGUgZXJzdGVsbGVuXG5tYXBfZGZyKFxuICAueCA9IGVyZ2Vibmlzc2UsXG4gIC5mID0gIH4gLngsIFxuICAuaWQgPSBcIk1vZGVsbFwiXG4gICkgJT4lXG4gIGZpbHRlcigubWV0cmljID09IFwiYWNjdXJhY3lcIikgJT4lXG4gIGd0KCkifQ==
</script>
</div>
</div>
<p>Die Auswertung zeigt, dass die hier betrachteten SVMs mit nicht-linearer Kernelfunktion den SVC mit linearem Kernel hinsichtlich der Genauigkeit der Vorhersagen auf dem Testdatensatz nicht schlagen können.</p>
</section><section id="zusammenfassung" class="level2" data-number="14.5"><h2 data-number="14.5" class="anchored" data-anchor-id="zusammenfassung">
<span class="header-section-number">14.5</span> Zusammenfassung</h2>
<p>In diesem Kapitel haben wir Support Vector Machines (SVM) zur Klassifikation eingeführt, eine Machine-Learning-Methode, die sich besonders für komplexe und nicht-lineare Probleme in hochdimensionalen Datensätzen eignet. Das Ziel von SVMs ist es, eine Trennlinie oder -ebene im Regressor-Raum zu finden, die zwei Klassen von Datenpunkten optimal voneinander abgrenzt. Hierfür ermittelt ein Algorithmus sogenannte Support-Vektoren – eine Teilmenge der Datenpunkte, welche die angepasste Entscheidungsgrenze bestimmen.</p>
<p>Support Vector Machines (SVMs) sind eine Weiterentwicklung des klassischen Maximal Margin Classifiers (MMC). Während der MMC eine harte Trennlinie sucht, die die Daten perfekt in zwei Klassen unterteilt, funktioniert dieser Ansatz nur dann gut, wenn die Klassen klar separierbar sind. Bei realen Datensätzen, in denen Überlappungen oder Ausreißer auftreten, scheitert der MMC-Algorithmus. Hier kann ein Soft Margin Classifier (SMC) angewendet werden, eine Verallgemeinerung des MMC, die Fehlklassifikationen zulässt. Diese zusätzliche Flexibilität erweitert die Anwendbarkeit auf reale, häufig nicht perfekt linear trennbare Klassen.</p>
<p>Für Klassifikationsprobleme mit nicht-linearen Entscheidungsgrenzen wird das Prinzip des SMCs durch den sogenannten Kernel-Trick zu einer SVM erweitert. Hierbei werden die Daten implizit in einen höherdimensionalen Raum projiziert, ohne dass die Transformation explizit durchgeführt werden muss. In diesem Raum lassen sich ursprünglich komplexe Entscheidungsgrenzen durch eine (lineare) Hyperebene modellieren. Unterschiedliche Kernel-Funktionen wie der radiale Kernel oder der polynomiale Kernel erlauben es, verschiedene Formen nicht-linearer Entscheidungsgrenzen zu erfassen und anzupassen.</p>
<p>Die Implementierung von SVMs in R erfolgt effizient durch Pakete wie <code>e1071</code> und <code>kernlab.</code> Wir haben gezeigt, wie Datensätze mithilfe von <code>parsnip</code> im <code>tidymodels</code>-Framework systematisch vorbereitet, SVM-Modelle spezifiziert, durch Cross-Validation optimiert und vergleichen werden können.</p>


<!-- -->

<script type="webr-data">
eyJyZW5kZXJfZGYiOiJkZWZhdWx0Iiwib3B0aW9ucyI6eyJiYXNlVXJsIjoiaHR0cHM6Ly93ZWJyLnItd2FzbS5vcmcvdjAuNC4xLyJ9LCJwYWNrYWdlcyI6eyJyZXBvcyI6W10sInBrZ3MiOlsiZXZhbHVhdGUiLCJrbml0ciIsImh0bWx0b29scyIsInRpZHltb2RlbHMiLCJJU0xSIiwiZm9yY2F0cyIsImtlcm5sYWIiLCJnZ2NvcnJwbG90IiwiZ3QiLCJwYXJzbmlwIiwiZ2dwbG90MiIsImNvd3Bsb3QiLCJza2ltciJdfX0=
</script><script type="ojs-module-contents">
eyJjb250ZW50cyI6W3siaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV8xNjtcbiAgaWYgKHdpbmRvdy5IVE1MV2lkZ2V0cykge1xuICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTtcbiAgfVxuICBpZiAod2luZG93LlBhZ2VkVGFibGVEb2MpIHtcbiAgICB3aW5kb3cuUGFnZWRUYWJsZURvYy5pbml0QWxsKCk7XG4gIH1cbn1cbiIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsImNlbGxOYW1lIjoid2Vici13aWRnZXQtMTYifSx7ImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBfd2Vicl9lZGl0b3JfMTYgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici0xNi1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGB3ZWJyLTE2LWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFdlYlJFeGVyY2lzZUVkaXRvcih3ZWJST2pzLndlYlJQcm9taXNlLCBibG9jay5jb2RlLCBvcHRpb25zKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl93ZWJyX3ZhbHVlXzE2ID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl8xNiwge30pO1xuIiwibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoid2Vici0xNiJ9LHsiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV8xNTtcbiAgaWYgKHdpbmRvdy5IVE1MV2lkZ2V0cykge1xuICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTtcbiAgfVxuICBpZiAod2luZG93LlBhZ2VkVGFibGVEb2MpIHtcbiAgICB3aW5kb3cuUGFnZWRUYWJsZURvYy5pbml0QWxsKCk7XG4gIH1cbn1cbiIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsImNlbGxOYW1lIjoid2Vici13aWRnZXQtMTUifSx7ImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBfd2Vicl9lZGl0b3JfMTUgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici0xNS1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGB3ZWJyLTE1LWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFdlYlJFeGVyY2lzZUVkaXRvcih3ZWJST2pzLndlYlJQcm9taXNlLCBibG9jay5jb2RlLCBvcHRpb25zKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl93ZWJyX3ZhbHVlXzE1ID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl8xNSwge30pO1xuIiwibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoid2Vici0xNSJ9LHsiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV8xNDtcbiAgaWYgKHdpbmRvdy5IVE1MV2lkZ2V0cykge1xuICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTtcbiAgfVxuICBpZiAod2luZG93LlBhZ2VkVGFibGVEb2MpIHtcbiAgICB3aW5kb3cuUGFnZWRUYWJsZURvYy5pbml0QWxsKCk7XG4gIH1cbn1cbiIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsImNlbGxOYW1lIjoid2Vici13aWRnZXQtMTQifSx7ImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBfd2Vicl9lZGl0b3JfMTQgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici0xNC1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGB3ZWJyLTE0LWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFdlYlJFeGVyY2lzZUVkaXRvcih3ZWJST2pzLndlYlJQcm9taXNlLCBibG9jay5jb2RlLCBvcHRpb25zKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl93ZWJyX3ZhbHVlXzE0ID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl8xNCwge30pO1xuIiwibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoid2Vici0xNCJ9LHsiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV8xMztcbiAgaWYgKHdpbmRvdy5IVE1MV2lkZ2V0cykge1xuICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTtcbiAgfVxuICBpZiAod2luZG93LlBhZ2VkVGFibGVEb2MpIHtcbiAgICB3aW5kb3cuUGFnZWRUYWJsZURvYy5pbml0QWxsKCk7XG4gIH1cbn1cbiIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsImNlbGxOYW1lIjoid2Vici13aWRnZXQtMTMifSx7ImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBfd2Vicl9lZGl0b3JfMTMgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici0xMy1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGB3ZWJyLTEzLWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFdlYlJFeGVyY2lzZUVkaXRvcih3ZWJST2pzLndlYlJQcm9taXNlLCBibG9jay5jb2RlLCBvcHRpb25zKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl93ZWJyX3ZhbHVlXzEzID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl8xMywge30pO1xuIiwibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoid2Vici0xMyJ9LHsiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV8xMjtcbiAgaWYgKHdpbmRvdy5IVE1MV2lkZ2V0cykge1xuICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTtcbiAgfVxuICBpZiAod2luZG93LlBhZ2VkVGFibGVEb2MpIHtcbiAgICB3aW5kb3cuUGFnZWRUYWJsZURvYy5pbml0QWxsKCk7XG4gIH1cbn1cbiIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsImNlbGxOYW1lIjoid2Vici13aWRnZXQtMTIifSx7ImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBfd2Vicl9lZGl0b3JfMTIgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici0xMi1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGB3ZWJyLTEyLWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFdlYlJFeGVyY2lzZUVkaXRvcih3ZWJST2pzLndlYlJQcm9taXNlLCBibG9jay5jb2RlLCBvcHRpb25zKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl93ZWJyX3ZhbHVlXzEyID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl8xMiwge30pO1xuIiwibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoid2Vici0xMiJ9LHsiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV8xMTtcbiAgaWYgKHdpbmRvdy5IVE1MV2lkZ2V0cykge1xuICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTtcbiAgfVxuICBpZiAod2luZG93LlBhZ2VkVGFibGVEb2MpIHtcbiAgICB3aW5kb3cuUGFnZWRUYWJsZURvYy5pbml0QWxsKCk7XG4gIH1cbn1cbiIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsImNlbGxOYW1lIjoid2Vici13aWRnZXQtMTEifSx7ImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBfd2Vicl9lZGl0b3JfMTEgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici0xMS1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGB3ZWJyLTExLWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFdlYlJFeGVyY2lzZUVkaXRvcih3ZWJST2pzLndlYlJQcm9taXNlLCBibG9jay5jb2RlLCBvcHRpb25zKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl93ZWJyX3ZhbHVlXzExID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl8xMSwge30pO1xuIiwibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoid2Vici0xMSJ9LHsiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV8xMDtcbiAgaWYgKHdpbmRvdy5IVE1MV2lkZ2V0cykge1xuICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTtcbiAgfVxuICBpZiAod2luZG93LlBhZ2VkVGFibGVEb2MpIHtcbiAgICB3aW5kb3cuUGFnZWRUYWJsZURvYy5pbml0QWxsKCk7XG4gIH1cbn1cbiIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsImNlbGxOYW1lIjoid2Vici13aWRnZXQtMTAifSx7ImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBfd2Vicl9lZGl0b3JfMTAgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici0xMC1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGB3ZWJyLTEwLWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFdlYlJFeGVyY2lzZUVkaXRvcih3ZWJST2pzLndlYlJQcm9taXNlLCBibG9jay5jb2RlLCBvcHRpb25zKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl93ZWJyX3ZhbHVlXzEwID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl8xMCwge30pO1xuIiwibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoid2Vici0xMCJ9LHsiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV85O1xuICBpZiAod2luZG93LkhUTUxXaWRnZXRzKSB7XG4gICAgd2luZG93LkhUTUxXaWRnZXRzLnN0YXRpY1JlbmRlcigpO1xuICB9XG4gIGlmICh3aW5kb3cuUGFnZWRUYWJsZURvYykge1xuICAgIHdpbmRvdy5QYWdlZFRhYmxlRG9jLmluaXRBbGwoKTtcbiAgfVxufVxuIiwibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0IiwiY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC05In0seyJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzkgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici05LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHdlYnItOS1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV85ID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl85LCB7fSk7XG4iLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJ3ZWJyLTkifSx7ImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgLy8gV2FpdCBmb3Igb3V0cHV0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSwgdGhlbiB0cmlnZ2VyIHdpZGdldCByZW5kZXJpbmdcbiAgYXdhaXQgX3dlYnJfdmFsdWVfODtcbiAgaWYgKHdpbmRvdy5IVE1MV2lkZ2V0cykge1xuICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTtcbiAgfVxuICBpZiAod2luZG93LlBhZ2VkVGFibGVEb2MpIHtcbiAgICB3aW5kb3cuUGFnZWRUYWJsZURvYy5pbml0QWxsKCk7XG4gIH1cbn1cbiIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsImNlbGxOYW1lIjoid2Vici13aWRnZXQtOCJ9LHsiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIF93ZWJyX2VkaXRvcl84ID0ge1xuICBjb25zdCB7IFdlYlJFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItOC1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGB3ZWJyLTgtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgV2ViUkV4ZXJjaXNlRWRpdG9yKHdlYlJPanMud2ViUlByb21pc2UsIGJsb2NrLmNvZGUsIG9wdGlvbnMpO1xuXG4gIHJldHVybiBlZGl0b3IuY29udGFpbmVyO1xufVxuX3dlYnJfdmFsdWVfOCA9IHdlYlJPanMucHJvY2Vzcyhfd2Vicl9lZGl0b3JfOCwge30pO1xuIiwibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoid2Vici04In0seyJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIC8vIFdhaXQgZm9yIG91dHB1dCB0byBiZSB3cml0dGVuIHRvIHRoZSBET00sIHRoZW4gdHJpZ2dlciB3aWRnZXQgcmVuZGVyaW5nXG4gIGF3YWl0IF93ZWJyX3ZhbHVlXzc7XG4gIGlmICh3aW5kb3cuSFRNTFdpZGdldHMpIHtcbiAgICB3aW5kb3cuSFRNTFdpZGdldHMuc3RhdGljUmVuZGVyKCk7XG4gIH1cbiAgaWYgKHdpbmRvdy5QYWdlZFRhYmxlRG9jKSB7XG4gICAgd2luZG93LlBhZ2VkVGFibGVEb2MuaW5pdEFsbCgpO1xuICB9XG59XG4iLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJjZWxsTmFtZSI6IndlYnItd2lkZ2V0LTcifSx7ImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBfd2Vicl9lZGl0b3JfNyA9IHtcbiAgY29uc3QgeyBXZWJSRXhlcmNpc2VFZGl0b3IsIGI2NERlY29kZSB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJ3ZWJyLTctY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgd2Vici03LWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFdlYlJFeGVyY2lzZUVkaXRvcih3ZWJST2pzLndlYlJQcm9taXNlLCBibG9jay5jb2RlLCBvcHRpb25zKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl93ZWJyX3ZhbHVlXzcgPSB3ZWJST2pzLnByb2Nlc3MoX3dlYnJfZWRpdG9yXzcsIHt9KTtcbiIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6IndlYnItNyJ9LHsiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV82O1xuICBpZiAod2luZG93LkhUTUxXaWRnZXRzKSB7XG4gICAgd2luZG93LkhUTUxXaWRnZXRzLnN0YXRpY1JlbmRlcigpO1xuICB9XG4gIGlmICh3aW5kb3cuUGFnZWRUYWJsZURvYykge1xuICAgIHdpbmRvdy5QYWdlZFRhYmxlRG9jLmluaXRBbGwoKTtcbiAgfVxufVxuIiwibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0IiwiY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC02In0seyJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzYgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici02LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHdlYnItNi1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV82ID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl82LCB7fSk7XG4iLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJ3ZWJyLTYifSx7ImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgLy8gV2FpdCBmb3Igb3V0cHV0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSwgdGhlbiB0cmlnZ2VyIHdpZGdldCByZW5kZXJpbmdcbiAgYXdhaXQgX3dlYnJfdmFsdWVfNTtcbiAgaWYgKHdpbmRvdy5IVE1MV2lkZ2V0cykge1xuICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTtcbiAgfVxuICBpZiAod2luZG93LlBhZ2VkVGFibGVEb2MpIHtcbiAgICB3aW5kb3cuUGFnZWRUYWJsZURvYy5pbml0QWxsKCk7XG4gIH1cbn1cbiIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsImNlbGxOYW1lIjoid2Vici13aWRnZXQtNSJ9LHsiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIF93ZWJyX2VkaXRvcl81ID0ge1xuICBjb25zdCB7IFdlYlJFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItNS1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGB3ZWJyLTUtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgV2ViUkV4ZXJjaXNlRWRpdG9yKHdlYlJPanMud2ViUlByb21pc2UsIGJsb2NrLmNvZGUsIG9wdGlvbnMpO1xuXG4gIHJldHVybiBlZGl0b3IuY29udGFpbmVyO1xufVxuX3dlYnJfdmFsdWVfNSA9IHdlYlJPanMucHJvY2Vzcyhfd2Vicl9lZGl0b3JfNSwge30pO1xuIiwibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoid2Vici01In0seyJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIC8vIFdhaXQgZm9yIG91dHB1dCB0byBiZSB3cml0dGVuIHRvIHRoZSBET00sIHRoZW4gdHJpZ2dlciB3aWRnZXQgcmVuZGVyaW5nXG4gIGF3YWl0IF93ZWJyX3ZhbHVlXzQ7XG4gIGlmICh3aW5kb3cuSFRNTFdpZGdldHMpIHtcbiAgICB3aW5kb3cuSFRNTFdpZGdldHMuc3RhdGljUmVuZGVyKCk7XG4gIH1cbiAgaWYgKHdpbmRvdy5QYWdlZFRhYmxlRG9jKSB7XG4gICAgd2luZG93LlBhZ2VkVGFibGVEb2MuaW5pdEFsbCgpO1xuICB9XG59XG4iLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJjZWxsTmFtZSI6IndlYnItd2lkZ2V0LTQifSx7ImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBfd2Vicl9lZGl0b3JfNCA9IHtcbiAgY29uc3QgeyBXZWJSRXhlcmNpc2VFZGl0b3IsIGI2NERlY29kZSB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJ3ZWJyLTQtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgd2Vici00LWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFdlYlJFeGVyY2lzZUVkaXRvcih3ZWJST2pzLndlYlJQcm9taXNlLCBibG9jay5jb2RlLCBvcHRpb25zKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl93ZWJyX3ZhbHVlXzQgPSB3ZWJST2pzLnByb2Nlc3MoX3dlYnJfZWRpdG9yXzQsIHt9KTtcbiIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6IndlYnItNCJ9LHsiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV8zO1xuICBpZiAod2luZG93LkhUTUxXaWRnZXRzKSB7XG4gICAgd2luZG93LkhUTUxXaWRnZXRzLnN0YXRpY1JlbmRlcigpO1xuICB9XG4gIGlmICh3aW5kb3cuUGFnZWRUYWJsZURvYykge1xuICAgIHdpbmRvdy5QYWdlZFRhYmxlRG9jLmluaXRBbGwoKTtcbiAgfVxufVxuIiwibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0IiwiY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC0zIn0seyJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzMgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici0zLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHdlYnItMy1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV8zID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl8zLCB7fSk7XG4iLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJ3ZWJyLTMifSx7ImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgLy8gV2FpdCBmb3Igb3V0cHV0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSwgdGhlbiB0cmlnZ2VyIHdpZGdldCByZW5kZXJpbmdcbiAgYXdhaXQgX3dlYnJfdmFsdWVfMjtcbiAgaWYgKHdpbmRvdy5IVE1MV2lkZ2V0cykge1xuICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTtcbiAgfVxuICBpZiAod2luZG93LlBhZ2VkVGFibGVEb2MpIHtcbiAgICB3aW5kb3cuUGFnZWRUYWJsZURvYy5pbml0QWxsKCk7XG4gIH1cbn1cbiIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsImNlbGxOYW1lIjoid2Vici13aWRnZXQtMiJ9LHsiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIF93ZWJyX2VkaXRvcl8yID0ge1xuICBjb25zdCB7IFdlYlJFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItMi1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGB3ZWJyLTItY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgV2ViUkV4ZXJjaXNlRWRpdG9yKHdlYlJPanMud2ViUlByb21pc2UsIGJsb2NrLmNvZGUsIG9wdGlvbnMpO1xuXG4gIHJldHVybiBlZGl0b3IuY29udGFpbmVyO1xufVxuX3dlYnJfdmFsdWVfMiA9IHdlYlJPanMucHJvY2Vzcyhfd2Vicl9lZGl0b3JfMiwge30pO1xuIiwibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoid2Vici0yIn0seyJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIC8vIFdhaXQgZm9yIG91dHB1dCB0byBiZSB3cml0dGVuIHRvIHRoZSBET00sIHRoZW4gdHJpZ2dlciB3aWRnZXQgcmVuZGVyaW5nXG4gIGF3YWl0IF93ZWJyX3ZhbHVlXzE7XG4gIGlmICh3aW5kb3cuSFRNTFdpZGdldHMpIHtcbiAgICB3aW5kb3cuSFRNTFdpZGdldHMuc3RhdGljUmVuZGVyKCk7XG4gIH1cbiAgaWYgKHdpbmRvdy5QYWdlZFRhYmxlRG9jKSB7XG4gICAgd2luZG93LlBhZ2VkVGFibGVEb2MuaW5pdEFsbCgpO1xuICB9XG59XG4iLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJjZWxsTmFtZSI6IndlYnItd2lkZ2V0LTEifSx7ImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBfd2Vicl9lZGl0b3JfMSA9IHtcbiAgY29uc3QgeyBXZWJSRXhlcmNpc2VFZGl0b3IsIGI2NERlY29kZSB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJ3ZWJyLTEtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgd2Vici0xLWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFdlYlJFeGVyY2lzZUVkaXRvcih3ZWJST2pzLndlYlJQcm9taXNlLCBibG9jay5jb2RlLCBvcHRpb25zKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl93ZWJyX3ZhbHVlXzEgPSB3ZWJST2pzLnByb2Nlc3MoX3dlYnJfZWRpdG9yXzEsIHt9KTtcbiIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6IndlYnItMSJ9LHsiaW5saW5lIjpmYWxzZSwic291cmNlIjoid2ViUk9qcyA9IHtcbiAgY29uc3QgeyBXZWJSIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lLldlYlI7XG4gIGNvbnN0IHtcbiAgICBXZWJSRXZhbHVhdG9yLFxuICAgIFdlYlJFbnZpcm9ubWVudE1hbmFnZXIsXG4gICAgc2V0dXBSLFxuICAgIGI2NERlY29kZSxcbiAgICBjb2xsYXBzZVBhdGhcbiAgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc3RhdHVzQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJleGVyY2lzZS1sb2FkaW5nLXN0YXR1c1wiKTtcbiAgY29uc3QgaW5kaWNhdG9yQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJleGVyY2lzZS1sb2FkaW5nLWluZGljYXRvclwiKTtcbiAgaW5kaWNhdG9yQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJkLW5vbmVcIik7XG5cbiAgbGV0IHN0YXR1c1RleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG4gIHN0YXR1c1RleHQuY2xhc3NMaXN0ID0gXCJleGVyY2lzZS1sb2FkaW5nLWRldGFpbHNcIjtcbiAgc3RhdHVzVGV4dCA9IHN0YXR1c0NvbnRhaW5lci5hcHBlbmRDaGlsZChzdGF0dXNUZXh0KTtcbiAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBJbml0aWFsaXNlYDtcblxuICAvLyBIb2lzdCBpbmRpY2F0b3Igb3V0IGZyb20gZmluYWwgc2xpZGUgd2hlbiBydW5uaW5nIHVuZGVyIHJldmVhbFxuICBjb25zdCByZXZlYWxTdGF0dXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJldmVhbCAuZXhlcmNpc2UtbG9hZGluZy1pbmRpY2F0b3JcIik7XG4gIGlmIChyZXZlYWxTdGF0dXMpIHtcbiAgICByZXZlYWxTdGF0dXMucmVtb3ZlKCk7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5yZXZlYWwgPiAuc2xpZGVzXCIpLmFwcGVuZENoaWxkKHJldmVhbFN0YXR1cyk7XG4gIH1cblxuICAvLyB3ZWJSIHN1cHBsZW1lbnRhbCBkYXRhIGFuZCBvcHRpb25zXG4gIGNvbnN0IGRhdGFDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItZGF0YVxcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGI2NERlY29kZShkYXRhQ29udGVudCkpO1xuXG4gIC8vIEdyYWIgbGlzdCBvZiByZXNvdXJjZXMgdG8gYmUgZG93bmxvYWRlZFxuICBjb25zdCBmaWxlc0NvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwidmZzLWZpbGVcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBmaWxlcyA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKGZpbGVzQ29udGVudCkpO1xuXG4gIC8vIEluaXRpYWxpc2Ugd2ViUiBhbmQgc2V0dXAgZm9yIFIgY29kZSBldmFsdWF0aW9uXG4gIGxldCB3ZWJSUHJvbWlzZSA9IChhc3luYyAod2ViUikgPT4ge1xuICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgRG93bmxvYWRpbmcgd2ViUmA7XG4gICAgYXdhaXQgd2ViUi5pbml0KCk7XG5cbiAgICAvLyBJbnN0YWxsIHByb3ZpZGVkIGxpc3Qgb2YgcGFja2FnZXNcbiAgICAvLyBFbnN1cmUgd2ViUiBkZWZhdWx0IHJlcG8gaXMgaW5jbHVkZWRcbiAgICBkYXRhLnBhY2thZ2VzLnJlcG9zLnB1c2goXCJodHRwczovL3JlcG8uci13YXNtLm9yZ1wiKVxuICAgIGF3YWl0IGRhdGEucGFja2FnZXMucGtncy5tYXAoKHBrZykgPT4gKCkgPT4ge1xuICAgICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBEb3dubG9hZGluZyBwYWNrYWdlOiAke3BrZ31gO1xuICAgICAgcmV0dXJuIHdlYlIuZXZhbFJWb2lkKGBcbiAgICAgICAgd2Vicjo6aW5zdGFsbChwa2csIHJlcG9zID0gcmVwb3MpXG4gICAgICAgIGxpYnJhcnkocGtnLCBjaGFyYWN0ZXIub25seSA9IFRSVUUpXG4gICAgICBgLCB7IGVudjoge1xuICAgICAgICBwa2c6IHBrZyxcbiAgICAgICAgcmVwb3M6IGRhdGEucGFja2FnZXMucmVwb3MsXG4gICAgICB9fSk7XG4gICAgfSkucmVkdWNlKChjdXIsIG5leHQpID0+IGN1ci50aGVuKG5leHQpLCBQcm9taXNlLnJlc29sdmUoKSk7XG5cbiAgICAvLyBEb3dubG9hZCBhbmQgaW5zdGFsbCByZXNvdXJjZXNcbiAgICBhd2FpdCBmaWxlcy5tYXAoKGZpbGUpID0+IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG5hbWUgPSBmaWxlLnN1YnN0cmluZyhmaWxlLmxhc3RJbmRleE9mKCcvJykgKyAxKTtcbiAgICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgRG93bmxvYWRpbmcgcmVzb3VyY2U6ICR7bmFtZX1gO1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChmaWxlKTtcbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW4ndCBkb3dubG9hZCBcXGAke2ZpbGV9XFxgLiBFcnJvciAke3Jlc3BvbnNlLnN0YXR1c306IFwiJHtyZXNwb25zZS5zdGF0dXNUZXh0fVwiLmApO1xuICAgICAgfVxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmFycmF5QnVmZmVyKCk7XG5cbiAgICAgIC8vIFN0b3JlIFVSTHMgaW4gdGhlIGN3ZCB3aXRob3V0IGFueSBzdWJkaXJlY3Rvcnkgc3RydWN0dXJlXG4gICAgICBpZiAoZmlsZS5pbmNsdWRlcyhcIjovL1wiKSkge1xuICAgICAgICBmaWxlID0gbmFtZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ29sbGFwc2UgaGlnaGVyIGRpcmVjdG9yeSBzdHJ1Y3R1cmVcbiAgICAgIGZpbGUgPSBjb2xsYXBzZVBhdGgoZmlsZSk7XG5cbiAgICAgIC8vIENyZWF0ZSBkaXJlY3RvcnkgdHJlZSwgaWdub3JpbmcgXCJkaXJlY3RvcnkgZXhpc3RzXCIgVkZTIGVycm9yc1xuICAgICAgY29uc3QgcGFydHMgPSBmaWxlLnNwbGl0KCcvJykuc2xpY2UoMCwgLTEpO1xuICAgICAgbGV0IHBhdGggPSAnJztcbiAgICAgIHdoaWxlIChwYXJ0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHBhdGggKz0gcGFydHMuc2hpZnQoKSArICcvJztcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCB3ZWJSLkZTLm1rZGlyKHBhdGgpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgaWYgKCFlLm1lc3NhZ2UuaW5jbHVkZXMoXCJGUyBlcnJvclwiKSkge1xuICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gV3JpdGUgdGhpcyBmaWxlIHRvIHRoZSBWRlNcbiAgICAgIHJldHVybiBhd2FpdCB3ZWJSLkZTLndyaXRlRmlsZShmaWxlLCBuZXcgVWludDhBcnJheShkYXRhKSk7XG4gICAgfSkucmVkdWNlKChjdXIsIG5leHQpID0+IGN1ci50aGVuKG5leHQpLCBQcm9taXNlLnJlc29sdmUoKSk7XG5cbiAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYEluc3RhbGxpbmcgd2ViUiBzaGltc2A7XG4gICAgYXdhaXQgd2ViUi5ldmFsUlZvaWQoYHdlYnI6OnNoaW1faW5zdGFsbCgpYCk7XG5cbiAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYFdlYlIgZW52aXJvbm1lbnQgc2V0dXBgO1xuICAgIGF3YWl0IHNldHVwUih3ZWJSLCBkYXRhKTtcblxuICAgIHN0YXR1c1RleHQucmVtb3ZlKCk7XG4gICAgaWYgKHN0YXR1c0NvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGggPT0gMCkge1xuICAgICAgc3RhdHVzQ29udGFpbmVyLnBhcmVudE5vZGUucmVtb3ZlKCk7XG4gICAgfVxuICAgIHJldHVybiB3ZWJSO1xuICB9KShuZXcgV2ViUihkYXRhLm9wdGlvbnMpKTtcblxuICAvLyBLZWVwIHRyYWNrIG9mIGluaXRpYWwgT0pTIGJsb2NrIHJlbmRlclxuICBjb25zdCByZW5kZXJlZE9qcyA9IHt9O1xuXG4gIGNvbnN0IHByb2Nlc3MgPSBhc3luYyAoY29udGV4dCwgaW5wdXRzKSA9PiB7XG4gICAgY29uc3Qgd2ViUiA9IGF3YWl0IHdlYlJQcm9taXNlO1xuICAgIGNvbnN0IGV2YWx1YXRvciA9IG5ldyBXZWJSRXZhbHVhdG9yKHdlYlIsIGNvbnRleHQpXG4gICAgYXdhaXQgZXZhbHVhdG9yLnByb2Nlc3MoaW5wdXRzKTtcbiAgICByZXR1cm4gZXZhbHVhdG9yLmNvbnRhaW5lcjtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgcHJvY2VzcyxcbiAgICB3ZWJSUHJvbWlzZSxcbiAgICByZW5kZXJlZE9qcyxcbiAgfTtcbn1cbiIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsImNlbGxOYW1lIjoid2Vici1wcmVsdWRlIn1dfQ==
</script><div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
W10=
</script><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Hastieetal2013" class="csl-entry" role="listitem">
Hastie, T., R. Tibshirani, und J. Friedman. 2013. <em>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</em>. Springer Series in Statistics. Springer New York.
</div>
<div id="ref-Jamesetal2021" class="csl-entry" role="listitem">
James, Gareth, Daniela Witten, Trevor Hastie, und Rob Tibshirani. 2021. <em>ISLR: Data for an Introduction to Statistical Learning with Applications in R</em>. <a href="https://CRAN.R-project.org/package=ISLR">https://CRAN.R-project.org/package=ISLR</a>.
</div>
<div id="ref-Jamesetal2017" class="csl-entry" role="listitem">
James, Gareth, Daniela Witten, Trevor Hastie, und Robert Tibshirani. 2017. <em>An introduction to statistical learning: With applications in R</em>. Corrected at 8th printing 2017. Springer texts in statistics. New York: Springer.
</div>
</div>
</section></main><!-- /main --><script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script><script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./RegReg.html" class="pagination-link" aria-label="Regularisierte Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Regularisierte Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./trees.html" class="pagination-link" aria-label="Baum-basierte Methoden">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Baum-basierte Methoden</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb62" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co">  live-html:</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co">    webr: </span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co">      packages:</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co">        - 'tidymodels'</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co">        - 'ISLR'</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co">        - 'forcats'</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co">        - 'kernlab'</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co">        - 'ggcorrplot'</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co">        - 'gt'</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="co">        - 'parsnip'</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co">        - 'ggplot2'</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co">        - 'cowplot'</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co">        - 'skimr'</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="co">      cell-options:</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="co">        fig-width: 8</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="an">engine:</span><span class="co"> knitr</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>{{&lt; include ./_extensions/r-wasm/live/_knitr.qmd &gt;}}</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a><span class="fu"># Support Vector Machines</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=F, message=FALSE}</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a><span class="in">library(gt)</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a><span class="in"># Formatierung von gt-Tabellen</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a><span class="in">tabopts &lt;- function(x) {</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a><span class="in">    fmt_number(x, decimals = 3, drop_trailing_zeros = T) %&gt;%</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a><span class="in">  tab_options(table_body.hlines.color = "white", </span></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a><span class="in">              column_labels.border.bottom.color = "black", </span></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a><span class="in">             column_labels.border.top.color = "black",</span></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a><span class="in">             table_body.border.bottom.color = "black", </span></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a><span class="in">             table.border.bottom.color = "black",</span></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a><span class="in">             column_labels.font.weight = "bold", </span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a><span class="in">             table.font.color = "black", </span></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a><span class="in">             table.font.size = 16)</span></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>Support Vector Machines (SVM) sind eine Methode die sich besonders für Klassifikation von Beobachtungen bei komplexen, nicht-linearen Zusammenhängen in hoch-dimensionalen Datensätzen eignet. Anders als baum-basierte Methoden, die auf der Zerlegung des Regressorraums anhand binärer Entscheidungsregeln basieren (vgl. @sec-trees), verwenden SVMs einen *geometrischen* Ansatz, der auf der Maximierung von Abständen beruht.</span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>Das Ziel eines SVM-Modells ist es, eine Hyperebene (*separating hyperplane*) zu finden, die zwei (oder mehr) Klassen optimal voneinander trennt, indem der Abstand (*margin*) zwischen einer bestimmten Anzahl nächstgelegener Datenpunkten der verschiedenen Klassen maximiert wird. Diese Datenpunkte, die der Trennfläche am nächsten liegen, definieren die Klassifikationsregel des Modells und werden als Support-Vektoren (*support vectors*) bezeichnet. Bei einer hochgradig nicht-linearen Entscheidungsgrenzen können die ursprünglichen Beobachtungen mit einer *Kernel-Funktion* in einen höherdimensionalen Raum abgebildet werden in dem die Klassen *linear* trennbar sind.</span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>Im Gegensatz zu Baum-basierten Modellen sind SVMs oft weniger intuitiv interpretierbar, da aus der angepassten Entscheidungsgrenze nicht unmittelbar die Relevanz der Regressoren abgeleitet werden kann.</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel beschreiben wir die theoretischen Grundlagen von SVMs für Klassifikation von Beobachtungen hinsichtlich einer binären Outcome-Variable. Für technische Details und Beispiele empfehlen wir eine Aufarbeitung mit Kapitel 9 in @Jamesetal2017.^<span class="co">[</span><span class="ot">@Hastieetal2013 geben eine ausführlichere, jedoch formal anspruchsvollere Erläuterung der hier behandelten Methoden.</span><span class="co">]</span> erläutern die Anwendung in R mit <span class="in">`parsnip`</span>.</span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a><span class="fu">## Trennende Hyper-Ebenen</span></span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb62-58"><a href="#cb62-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-59"><a href="#cb62-59" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb62-60"><a href="#cb62-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-61"><a href="#cb62-61" aria-hidden="true" tabindex="-1"></a>lsvm_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb62-62"><a href="#cb62-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb62-63"><a href="#cb62-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">x1 =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">2</span>),</span>
<span id="cb62-64"><a href="#cb62-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">x2 =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">2</span>),</span>
<span id="cb62-65"><a href="#cb62-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">klasse =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">50</span>))</span>
<span id="cb62-66"><a href="#cb62-66" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb62-67"><a href="#cb62-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb62-68"><a href="#cb62-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">x1 =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">2</span>),</span>
<span id="cb62-69"><a href="#cb62-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">x2 =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">2</span>),</span>
<span id="cb62-70"><a href="#cb62-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">klasse =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">50</span>))</span>
<span id="cb62-71"><a href="#cb62-71" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-72"><a href="#cb62-72" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-73"><a href="#cb62-73" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-74"><a href="#cb62-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-75"><a href="#cb62-75" aria-hidden="true" tabindex="-1"></a>Wir betrachten zunächst ein Klassifikationsproblem mit zwei Prädiktoren $X_1$, $X_2$ für die binäre Outcome-Variable $Y$. Die nächste Abbildung stellt diese Beobachtungen *im Prädiktorraum* graphisch dar. Mit <span class="in">`geom_function()`</span> fügen wir dem Plot drei mögliche Trenneben hinzu, welche die Klassen perfekt seprarieren.</span>
<span id="cb62-76"><a href="#cb62-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-79"><a href="#cb62-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-80"><a href="#cb62-80" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-81"><a href="#cb62-81" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Perfekt linear speparierbare Beobachtungen"</span></span>
<span id="cb62-82"><a href="#cb62-82" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb62-83"><a href="#cb62-83" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb62-84"><a href="#cb62-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisiere den Datensatz mit ggplot2</span></span>
<span id="cb62-85"><a href="#cb62-85" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb62-86"><a href="#cb62-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> lsvm_data,</span>
<span id="cb62-87"><a href="#cb62-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">color =</span> klasse)</span>
<span id="cb62-88"><a href="#cb62-88" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-89"><a href="#cb62-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb62-90"><a href="#cb62-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"X1"</span>, <span class="at">y =</span> <span class="st">"X2"</span>) <span class="sc">+</span></span>
<span id="cb62-91"><a href="#cb62-91" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mögliche Trennebenen</span></span>
<span id="cb62-92"><a href="#cb62-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x)  <span class="sc">-</span><span class="fl">1.5</span> <span class="sc">*</span> x, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb62-93"><a href="#cb62-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x)  <span class="sc">-</span><span class="fl">2.5</span> <span class="sc">*</span> x, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb62-94"><a href="#cb62-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x)  <span class="sc">-</span>.<span class="dv">4</span> <span class="sc">*</span> x, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb62-95"><a href="#cb62-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb62-96"><a href="#cb62-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb62-97"><a href="#cb62-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb62-98"><a href="#cb62-98" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-99"><a href="#cb62-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-100"><a href="#cb62-100" aria-hidden="true" tabindex="-1"></a><span class="fu">### Trennebenen</span></span>
<span id="cb62-101"><a href="#cb62-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-102"><a href="#cb62-102" aria-hidden="true" tabindex="-1"></a>SVM für Klassifikation basiert auf der Idee, eine Trennhyperebene</span>
<span id="cb62-103"><a href="#cb62-103" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb62-104"><a href="#cb62-104" aria-hidden="true" tabindex="-1"></a>  \boldsymbol{w}'\boldsymbol{X} + b = 0 \label{eq:sepplane}</span>
<span id="cb62-105"><a href="#cb62-105" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb62-106"><a href="#cb62-106" aria-hidden="true" tabindex="-1"></a>im Prädiktorraum zu finden, welche die Datenpunkten hinsichtlich ihrer Klasse möglichst gut trennt. </span>
<span id="cb62-107"><a href="#cb62-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-108"><a href="#cb62-108" aria-hidden="true" tabindex="-1"></a>Definiere die abhängige Variable als</span>
<span id="cb62-109"><a href="#cb62-109" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-110"><a href="#cb62-110" aria-hidden="true" tabindex="-1"></a>  y =</span>
<span id="cb62-111"><a href="#cb62-111" aria-hidden="true" tabindex="-1"></a>  \begin{cases}</span>
<span id="cb62-112"><a href="#cb62-112" aria-hidden="true" tabindex="-1"></a>    -1, &amp; \textup{wenn Beob. $i$ Klasse A hat,}<span class="sc">\\</span></span>
<span id="cb62-113"><a href="#cb62-113" aria-hidden="true" tabindex="-1"></a>     1, &amp; \textup{wenn Beob. $i$ Klasse B hat}</span>
<span id="cb62-114"><a href="#cb62-114" aria-hidden="true" tabindex="-1"></a>  \end{cases}</span>
<span id="cb62-115"><a href="#cb62-115" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-116"><a href="#cb62-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-117"><a href="#cb62-117" aria-hidden="true" tabindex="-1"></a>Wähle $\boldsymbol{w}$ und $b$ so, dass die Ungleichung </span>
<span id="cb62-118"><a href="#cb62-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-119"><a href="#cb62-119" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb62-120"><a href="#cb62-120" aria-hidden="true" tabindex="-1"></a>  y_i(\boldsymbol{w}'\boldsymbol{X}_i + b) \geq 0 \label{eq:sepcond}</span>
<span id="cb62-121"><a href="#cb62-121" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb62-122"><a href="#cb62-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-123"><a href="#cb62-123" aria-hidden="true" tabindex="-1"></a>erfüllt ist, d.h.</span>
<span id="cb62-124"><a href="#cb62-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-125"><a href="#cb62-125" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-126"><a href="#cb62-126" aria-hidden="true" tabindex="-1"></a> \boldsymbol{w}'\boldsymbol{X}_i + b \geq 0  &amp; \quad \textup{für} \quad y_i = 1,<span class="sc">\\</span></span>
<span id="cb62-127"><a href="#cb62-127" aria-hidden="true" tabindex="-1"></a>  \boldsymbol{w}'\boldsymbol{X}_i + b \leq 0  &amp; \quad \textup{für} \quad y_i = -1.</span>
<span id="cb62-128"><a href="#cb62-128" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-129"><a href="#cb62-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-130"><a href="#cb62-130" aria-hidden="true" tabindex="-1"></a>In unserem Beispiel mit zwei Regressoren $X_1$, $X_2$ ist $\boldsymbol{w} = (w_1,\,w_2)'$ und $\boldsymbol{X}=(X_1,\,X_2)'$. Der Prädiktorrraum ist also zwei-dimensional. Jede Hyperebene in diesem Raum ist ein-dimensional, kann also formal durch eine Geraden-Gleichung der Form</span>
<span id="cb62-131"><a href="#cb62-131" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb62-132"><a href="#cb62-132" aria-hidden="true" tabindex="-1"></a>  x_2 = \alpha_1\cdot x_1 + \alpha_0 \label{eq:gg}</span>
<span id="cb62-133"><a href="#cb62-133" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb62-134"><a href="#cb62-134" aria-hidden="true" tabindex="-1"></a>dargestellt werden: Durch Umformen von \eqref{eq:sepplane} erhalten wir</span>
<span id="cb62-135"><a href="#cb62-135" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb62-136"><a href="#cb62-136" aria-hidden="true" tabindex="-1"></a>  &amp;\, w_1 \cdot x_1 + w_2 \cdot x_2 + b = 0 \notag <span class="sc">\\</span></span>
<span id="cb62-137"><a href="#cb62-137" aria-hidden="true" tabindex="-1"></a>  <span class="sc">\\</span></span>
<span id="cb62-138"><a href="#cb62-138" aria-hidden="true" tabindex="-1"></a> \Leftrightarrow &amp;\, x_2 = -\left(\frac{w_1}{w_2}\right) \cdot x_1 - \frac{b}{w_2} \label{eq:ggt}</span>
<span id="cb62-139"><a href="#cb62-139" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb62-140"><a href="#cb62-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-141"><a href="#cb62-141" aria-hidden="true" tabindex="-1"></a>In Abbildung XYZ erkennen wir, dass die Beobachtungen durch eine Gerade mit negativer Steigung perfekt separiert werden können. </span>
<span id="cb62-142"><a href="#cb62-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-143"><a href="#cb62-143" aria-hidden="true" tabindex="-1"></a>Wenn die Daten perfekt separierbar sind (und die Regressoren kontinuierlich sind) gibt es unendlich viele Ebenen, die Bedingung \eqref{eq:sepcond} erfüllen. *Welche* Hyperebene (also welche Parameter $\boldsymbol{w},\,b$) gewählt werden sollen, muss durch weitere Bedingungen festgelegt werden.</span>
<span id="cb62-144"><a href="#cb62-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-145"><a href="#cb62-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-146"><a href="#cb62-146" aria-hidden="true" tabindex="-1"></a><span class="fu">### Maximal Margin Classifier</span></span>
<span id="cb62-147"><a href="#cb62-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-148"><a href="#cb62-148" aria-hidden="true" tabindex="-1"></a>Ein *Maximal Margin Classifier* (MMC) wählt die trennende Ebene wie folgt: Bestimme $<span class="sc">\{</span>\boldsymbol{w},b<span class="sc">\}</span>$ und $M$ unter der Bedingung $\sum_{j=1}^k w_j^2 = 1$ so, dass für sämtliche Beobachtungen gilt, dass</span>
<span id="cb62-149"><a href="#cb62-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-150"><a href="#cb62-150" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-151"><a href="#cb62-151" aria-hidden="true" tabindex="-1"></a>    Y_i(\boldsymbol{w}'\boldsymbol{X}_i + b) \geq M, \quad \forall i \in <span class="sc">\{</span>1, \dots, n<span class="sc">\}</span>,</span>
<span id="cb62-152"><a href="#cb62-152" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-153"><a href="#cb62-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-154"><a href="#cb62-154" aria-hidden="true" tabindex="-1"></a>wobei $M$, der *minimale Abstand aller Beobachtungen zur trennenden Ebene* -- die *Margin* -- maximiert wird.</span>
<span id="cb62-155"><a href="#cb62-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-156"><a href="#cb62-156" aria-hidden="true" tabindex="-1"></a>Beobachtungen, die exakt die Distanz $M$ zur Trennebene haben, sind die *Support-Vektoren* (SV). Beachte: Ausschließlich die SV definieren die angepasste Entschiedungsgrenze des MMC.</span>
<span id="cb62-157"><a href="#cb62-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-158"><a href="#cb62-158" aria-hidden="true" tabindex="-1"></a>Wir trainieren nun einen MMC für <span class="in">`klasse`</span> in <span class="in">`lsvm_data`</span> mit <span class="in">`e1071::svm()`</span>. Mit <span class="in">`kernel = "linear"`</span> legen wir fest, dass eine lineare Entscheidungsgrenze im zwei-dimensionalen Raum von $(X_1,X_2)$ gefunden werden soll. Die Parameter <span class="in">`cost = 1e8`</span> und <span class="in">`scale = F`</span> erzwingen wir eine "harte" Margin (mehr dazu im Abschnitt zu SVMs unten) sowie keine Skalierung der Daten. Mit <span class="in">`coef()`</span> lesen wir die trainierten Koeffizienten aus.</span>
<span id="cb62-159"><a href="#cb62-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-162"><a href="#cb62-162" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-163"><a href="#cb62-163" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb62-164"><a href="#cb62-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-165"><a href="#cb62-165" aria-hidden="true" tabindex="-1"></a><span class="co"># Trainiere das Modell</span></span>
<span id="cb62-166"><a href="#cb62-166" aria-hidden="true" tabindex="-1"></a>model_mm <span class="ot">&lt;-</span> <span class="fu">svm</span>(</span>
<span id="cb62-167"><a href="#cb62-167" aria-hidden="true" tabindex="-1"></a>  klasse <span class="sc">~</span> x1 <span class="sc">+</span> x2, </span>
<span id="cb62-168"><a href="#cb62-168" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> lsvm_data, </span>
<span id="cb62-169"><a href="#cb62-169" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">"linear"</span>, </span>
<span id="cb62-170"><a href="#cb62-170" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost =</span> <span class="fl">1e8</span>,</span>
<span id="cb62-171"><a href="#cb62-171" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale =</span> F</span>
<span id="cb62-172"><a href="#cb62-172" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-173"><a href="#cb62-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-174"><a href="#cb62-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Trainierte Koeffizienten des MMC auslesen</span></span>
<span id="cb62-175"><a href="#cb62-175" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb62-176"><a href="#cb62-176" aria-hidden="true" tabindex="-1"></a>  coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_mm) <span class="sc">%&gt;%</span></span>
<span id="cb62-177"><a href="#cb62-177" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_names</span>(</span>
<span id="cb62-178"><a href="#cb62-178" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"b"</span>, <span class="st">"w1"</span>, <span class="st">"w2"</span>)</span>
<span id="cb62-179"><a href="#cb62-179" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-180"><a href="#cb62-180" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-181"><a href="#cb62-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-182"><a href="#cb62-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-183"><a href="#cb62-183" aria-hidden="true" tabindex="-1"></a>Zur Vereinfachung der graphischen Darstellung normieren wir den Vektor der Koeffizienten <span class="in">`c("w1", "w2")`</span>.</span>
<span id="cb62-184"><a href="#cb62-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-187"><a href="#cb62-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-188"><a href="#cb62-188" aria-hidden="true" tabindex="-1"></a><span class="co"># Koeffizienten normieren</span></span>
<span id="cb62-189"><a href="#cb62-189" aria-hidden="true" tabindex="-1"></a>nrm <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(coefs[<span class="st">"w1"</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> coefs[<span class="st">"w2"</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="co"># Euklidische Norm</span></span>
<span id="cb62-190"><a href="#cb62-190" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> coefs <span class="sc">/</span> nrm</span>
<span id="cb62-191"><a href="#cb62-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-192"><a href="#cb62-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-193"><a href="#cb62-193" aria-hidden="true" tabindex="-1"></a>Mit den angepassten Koeffizienten in <span class="in">`coefs`</span> können wir anhand der Umformung \eqref{eq:ggt} die mit MMC ermittelte trennende Gerade berechnen. Wir definieren $\alpha_0$ und $\alpha_1$ wie in \eqref{eq:gg}.</span>
<span id="cb62-194"><a href="#cb62-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-197"><a href="#cb62-197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-198"><a href="#cb62-198" aria-hidden="true" tabindex="-1"></a><span class="co"># Koeffizienten der trennenden Geraden berechnen</span></span>
<span id="cb62-199"><a href="#cb62-199" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha0</span></span>
<span id="cb62-200"><a href="#cb62-200" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb62-201"><a href="#cb62-201" aria-hidden="true" tabindex="-1"></a>  alpha0 <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="sc">-</span>coefs[<span class="st">"b"</span>] <span class="sc">/</span> coefs[<span class="st">"w2"</span>])</span>
<span id="cb62-202"><a href="#cb62-202" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-203"><a href="#cb62-203" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha1  </span></span>
<span id="cb62-204"><a href="#cb62-204" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb62-205"><a href="#cb62-205" aria-hidden="true" tabindex="-1"></a>  alpha1 <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="sc">-</span>coefs[<span class="st">"w1"</span>] <span class="sc">/</span> coefs[<span class="st">"w2"</span>])</span>
<span id="cb62-206"><a href="#cb62-206" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-207"><a href="#cb62-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-208"><a href="#cb62-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-209"><a href="#cb62-209" aria-hidden="true" tabindex="-1"></a>Der Eintrag <span class="in">`SV`</span> des im Objekt <span class="in">`model_mm`</span> gespeicherten Outputs von <span class="in">`svm()`</span> enthält die Support-Vektoren des MMC.</span>
<span id="cb62-210"><a href="#cb62-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-213"><a href="#cb62-213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-214"><a href="#cb62-214" aria-hidden="true" tabindex="-1"></a><span class="co"># Support-Vektoren auslesen</span></span>
<span id="cb62-215"><a href="#cb62-215" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb62-216"><a href="#cb62-216" aria-hidden="true" tabindex="-1"></a>  sv <span class="ot">&lt;-</span> model_mm<span class="sc">$</span>SV <span class="sc">%&gt;%</span> </span>
<span id="cb62-217"><a href="#cb62-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb62-218"><a href="#cb62-218" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-219"><a href="#cb62-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-220"><a href="#cb62-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-221"><a href="#cb62-221" aria-hidden="true" tabindex="-1"></a>Mit <span class="in">`geom_function()`</span> zeichnen wir nun die ermittelte Trennlinie in den Punkteplot der Regressoren ein. Wir ergänzen die Grafik um die Marginallinien und Hervorhebungen der in <span class="in">`sv`</span> gespeicherten Support-Vektoren.</span>
<span id="cb62-222"><a href="#cb62-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-225"><a href="#cb62-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-226"><a href="#cb62-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Maximal Margin Classifier: Trennebene, Margin und SV"</span></span>
<span id="cb62-227"><a href="#cb62-227" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mmctmsv</span></span>
<span id="cb62-228"><a href="#cb62-228" aria-hidden="true" tabindex="-1"></a><span class="co"># Beobachtungen in MMC-Trennlinien einzeichnen</span></span>
<span id="cb62-229"><a href="#cb62-229" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb62-230"><a href="#cb62-230" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> lsvm_data, </span>
<span id="cb62-231"><a href="#cb62-231" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">color =</span> klasse)</span>
<span id="cb62-232"><a href="#cb62-232" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-233"><a href="#cb62-233" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"X1"</span>, <span class="at">y =</span> <span class="st">"X2"</span>) <span class="sc">+</span></span>
<span id="cb62-234"><a href="#cb62-234" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Trennlinie</span></span>
<span id="cb62-235"><a href="#cb62-235" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(</span>
<span id="cb62-236"><a href="#cb62-236" aria-hidden="true" tabindex="-1"></a>      <span class="at">fun =</span> \(x) alpha0 <span class="sc">+</span> alpha1 <span class="sc">*</span> x, <span class="at">col =</span> <span class="st">"black"</span></span>
<span id="cb62-237"><a href="#cb62-237" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb62-238"><a href="#cb62-238" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Marginallinien</span></span>
<span id="cb62-239"><a href="#cb62-239" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x) <span class="sc">-</span>(coefs[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>nrm)<span class="sc">/</span>coefs[<span class="dv">3</span>] <span class="sc">+</span> alpha1 <span class="sc">*</span> x, </span>
<span id="cb62-240"><a href="#cb62-240" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb62-241"><a href="#cb62-241" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x) <span class="sc">-</span>(coefs[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>nrm)<span class="sc">/</span>coefs[<span class="dv">3</span>] <span class="sc">+</span> alpha1 <span class="sc">*</span> x, </span>
<span id="cb62-242"><a href="#cb62-242" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb62-243"><a href="#cb62-243" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Support-Vektoren</span></span>
<span id="cb62-244"><a href="#cb62-244" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb62-245"><a href="#cb62-245" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> sv, </span>
<span id="cb62-246"><a href="#cb62-246" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2),</span>
<span id="cb62-247"><a href="#cb62-247" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb62-248"><a href="#cb62-248" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="dv">1</span>,</span>
<span id="cb62-249"><a href="#cb62-249" aria-hidden="true" tabindex="-1"></a>      <span class="at">inherit.aes =</span> F</span>
<span id="cb62-250"><a href="#cb62-250" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb62-251"><a href="#cb62-251" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Beobachtungen</span></span>
<span id="cb62-252"><a href="#cb62-252" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb62-253"><a href="#cb62-253" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lims</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">6</span>), <span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.8</span>, <span class="fl">3.8</span>)) <span class="sc">+</span></span>
<span id="cb62-254"><a href="#cb62-254" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb62-255"><a href="#cb62-255" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb62-256"><a href="#cb62-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-257"><a href="#cb62-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-258"><a href="#cb62-258" aria-hidden="true" tabindex="-1"></a>Die Grafik zeigt, dass der MMC in <span class="in">`model_mm`</span> tatsächlich eine perfekte Klassifzierung der Datenpunkte erreicht: Die gewählte Trennlinie (schwarze Linie) maximiert die jeweils durch die Marginallinien (getrichelte Linien) definierte Margin. Der MMC wird lediglich durch die 3 schwarz umrandeten Beobachtungen (die Support-Vektoren) definiert.</span>
<span id="cb62-259"><a href="#cb62-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-260"><a href="#cb62-260" aria-hidden="true" tabindex="-1"></a>Wir können die Genauigkeit der Klassifikation von <span class="in">`model_mm`</span> für die Trainingsdaten mit <span class="in">`yardstick::accuracy`</span> auswerten.</span>
<span id="cb62-261"><a href="#cb62-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-264"><a href="#cb62-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-265"><a href="#cb62-265" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb62-266"><a href="#cb62-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-267"><a href="#cb62-267" aria-hidden="true" tabindex="-1"></a><span class="co"># Genauigkeit der Klassifizierung für Trainingsdaten</span></span>
<span id="cb62-268"><a href="#cb62-268" aria-hidden="true" tabindex="-1"></a>model_mm <span class="sc">%&gt;%</span> </span>
<span id="cb62-269"><a href="#cb62-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-270"><a href="#cb62-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(</span>
<span id="cb62-271"><a href="#cb62-271" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> ., </span>
<span id="cb62-272"><a href="#cb62-272" aria-hidden="true" tabindex="-1"></a>    <span class="at">truth =</span> lsvm_data<span class="sc">$</span>klasse</span>
<span id="cb62-273"><a href="#cb62-273" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb62-274"><a href="#cb62-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(truth, estimate)</span>
<span id="cb62-275"><a href="#cb62-275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-276"><a href="#cb62-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-277"><a href="#cb62-277" aria-hidden="true" tabindex="-1"></a>Ein Nachteil des MMC ist, dass das training der separierenden Grenze empfindlich gegenüber Ausreißern und hoher Varianz in den Daten ist: Da der MMC die Trennlinie so positioniert, dass der Abstand (die "Margin") zu den nächstgelegenen Trainingsdatenpunkten maximal wird, können selbst wenige ungewöhnliche Beobachtungen die Lage der Grenze stark beeinflussen, was die Robustheit des Classifier beeinträchtigt und zu einer schlechteren Generalisierung auf neue Daten führen kann. </span>
<span id="cb62-278"><a href="#cb62-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-279"><a href="#cb62-279" aria-hidden="true" tabindex="-1"></a>@fig-mmcsens illustriert die Sensibilität des MMC durch Hinzufügen *nur einer* zusätzlichen ungewöhnlichen Beobachtung der Klasse 1 mit $X_1 = -.5$ und $X_2 = 3$^<span class="co">[</span><span class="ot">Der Code hierfür ist `lsvm_data %&gt;% add_row(tibble(x1 = -.5, x2 = 3, klasse = factor(1)))`.</span><span class="co">]</span>: Das Optimierungskalkül des MMC führt zu einer deutlich verschobenen Trennlinie im Vergleich zu ABZ.</span>
<span id="cb62-280"><a href="#cb62-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-283"><a href="#cb62-283" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-284"><a href="#cb62-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb62-285"><a href="#cb62-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Effekt von Ausreißern auf Maximum Margin Classifier"</span></span>
<span id="cb62-286"><a href="#cb62-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mmcsens</span></span>
<span id="cb62-287"><a href="#cb62-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-288"><a href="#cb62-288" aria-hidden="true" tabindex="-1"></a>lsvm_data2 <span class="ot">&lt;-</span> lsvm_data <span class="sc">%&gt;%</span> </span>
<span id="cb62-289"><a href="#cb62-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(</span>
<span id="cb62-290"><a href="#cb62-290" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">x1 =</span> <span class="sc">-</span>.<span class="dv">5</span>, <span class="at">x2 =</span> <span class="dv">3</span>, <span class="at">klasse =</span> <span class="fu">factor</span>(<span class="dv">1</span>))</span>
<span id="cb62-291"><a href="#cb62-291" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-292"><a href="#cb62-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-293"><a href="#cb62-293" aria-hidden="true" tabindex="-1"></a><span class="co"># Trainiere das Modell</span></span>
<span id="cb62-294"><a href="#cb62-294" aria-hidden="true" tabindex="-1"></a>model_mm <span class="ot">&lt;-</span> <span class="fu">svm</span>(</span>
<span id="cb62-295"><a href="#cb62-295" aria-hidden="true" tabindex="-1"></a>  klasse <span class="sc">~</span> x1 <span class="sc">+</span> x2, </span>
<span id="cb62-296"><a href="#cb62-296" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> lsvm_data2, </span>
<span id="cb62-297"><a href="#cb62-297" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">"linear"</span>, </span>
<span id="cb62-298"><a href="#cb62-298" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost =</span> <span class="fl">1e6</span>,</span>
<span id="cb62-299"><a href="#cb62-299" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale =</span> F</span>
<span id="cb62-300"><a href="#cb62-300" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-301"><a href="#cb62-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-302"><a href="#cb62-302" aria-hidden="true" tabindex="-1"></a><span class="co"># Trainierte Koeffizienten der MMC auslesen</span></span>
<span id="cb62-303"><a href="#cb62-303" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_mm) <span class="sc">%&gt;%</span></span>
<span id="cb62-304"><a href="#cb62-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(</span>
<span id="cb62-305"><a href="#cb62-305" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"b"</span>, <span class="st">"w1"</span>, <span class="st">"w2"</span>)</span>
<span id="cb62-306"><a href="#cb62-306" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-307"><a href="#cb62-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-308"><a href="#cb62-308" aria-hidden="true" tabindex="-1"></a>nrm <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(coefs[<span class="st">"w1"</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> coefs[<span class="st">"w2"</span>]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb62-309"><a href="#cb62-309" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> coefs <span class="sc">/</span> nrm</span>
<span id="cb62-310"><a href="#cb62-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-311"><a href="#cb62-311" aria-hidden="true" tabindex="-1"></a><span class="co"># Koeffizienten der trennenden Geraden berechnen</span></span>
<span id="cb62-312"><a href="#cb62-312" aria-hidden="true" tabindex="-1"></a>alpha0 <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="sc">-</span>coefs[<span class="st">"b"</span>] <span class="sc">/</span> coefs[<span class="st">"w2"</span>])</span>
<span id="cb62-313"><a href="#cb62-313" aria-hidden="true" tabindex="-1"></a>alpha1 <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="sc">-</span>coefs[<span class="st">"w1"</span>] <span class="sc">/</span> coefs[<span class="st">"w2"</span>])</span>
<span id="cb62-314"><a href="#cb62-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-315"><a href="#cb62-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-316"><a href="#cb62-316" aria-hidden="true" tabindex="-1"></a><span class="co"># Support-Vektoren auslesen</span></span>
<span id="cb62-317"><a href="#cb62-317" aria-hidden="true" tabindex="-1"></a>sv <span class="ot">&lt;-</span> model_mm<span class="sc">$</span>SV <span class="sc">%&gt;%</span> </span>
<span id="cb62-318"><a href="#cb62-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb62-319"><a href="#cb62-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-320"><a href="#cb62-320" aria-hidden="true" tabindex="-1"></a><span class="co"># Beobachtungen in MMC-Trennlinien einzeichnen</span></span>
<span id="cb62-321"><a href="#cb62-321" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb62-322"><a href="#cb62-322" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> lsvm_data2, </span>
<span id="cb62-323"><a href="#cb62-323" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">color =</span> klasse)</span>
<span id="cb62-324"><a href="#cb62-324" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-325"><a href="#cb62-325" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"X1"</span>, <span class="at">y =</span> <span class="st">"X2"</span>) <span class="sc">+</span></span>
<span id="cb62-326"><a href="#cb62-326" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Trennlinie</span></span>
<span id="cb62-327"><a href="#cb62-327" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(</span>
<span id="cb62-328"><a href="#cb62-328" aria-hidden="true" tabindex="-1"></a>      <span class="at">fun =</span> \(x) alpha0 <span class="sc">+</span> alpha1 <span class="sc">*</span> x, <span class="at">col =</span> <span class="st">"black"</span></span>
<span id="cb62-329"><a href="#cb62-329" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb62-330"><a href="#cb62-330" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Marginallinien</span></span>
<span id="cb62-331"><a href="#cb62-331" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x) <span class="sc">-</span>(coefs[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>nrm)<span class="sc">/</span>coefs[<span class="dv">3</span>] <span class="sc">+</span> alpha1 <span class="sc">*</span> x, </span>
<span id="cb62-332"><a href="#cb62-332" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb62-333"><a href="#cb62-333" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x) <span class="sc">-</span>(coefs[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>nrm)<span class="sc">/</span>coefs[<span class="dv">3</span>] <span class="sc">+</span> alpha1 <span class="sc">*</span> x, </span>
<span id="cb62-334"><a href="#cb62-334" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb62-335"><a href="#cb62-335" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Support-Vektoren</span></span>
<span id="cb62-336"><a href="#cb62-336" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb62-337"><a href="#cb62-337" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> sv, </span>
<span id="cb62-338"><a href="#cb62-338" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2),</span>
<span id="cb62-339"><a href="#cb62-339" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb62-340"><a href="#cb62-340" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="dv">1</span>,</span>
<span id="cb62-341"><a href="#cb62-341" aria-hidden="true" tabindex="-1"></a>      <span class="at">inherit.aes =</span> F</span>
<span id="cb62-342"><a href="#cb62-342" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb62-343"><a href="#cb62-343" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Beobachtungen</span></span>
<span id="cb62-344"><a href="#cb62-344" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb62-345"><a href="#cb62-345" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lims</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">6</span>), <span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.8</span>, <span class="fl">3.8</span>)) <span class="sc">+</span></span>
<span id="cb62-346"><a href="#cb62-346" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb62-347"><a href="#cb62-347" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb62-348"><a href="#cb62-348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-349"><a href="#cb62-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-350"><a href="#cb62-350" aria-hidden="true" tabindex="-1"></a>Eine Erweitung des MMC, die dieses Problem adressiert ist der *(Soft Margin) Support Vector Classifier*  (SVC). Der Ausreißer lässt bestimmte Fehlklassifizierungen zu, um eine bessere Balance zwischen Genauigkeit auf dem Trainingsdatensatz und Generalisierungsfähigkeit des Modells zu finden.</span>
<span id="cb62-351"><a href="#cb62-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-352"><a href="#cb62-352" aria-hidden="true" tabindex="-1"></a><span class="fu">## Support Vector Classifier {#sec-scv}</span></span>
<span id="cb62-353"><a href="#cb62-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-354"><a href="#cb62-354" aria-hidden="true" tabindex="-1"></a>Ein MMC strebt eine strikte Trennung der Datenklassen durch eine Hyperebene mit einer "harten" Margin, deren Grenzen durch die Support-Vektoren definierten werden (*hard margin*). Ein SVC erlaubt eine "weiche" Margin (*soft margin*) die zu weniger Empfindlichkeit der ermittelten Enscheidungsgrenze gegenüber Rauschen und Ausreißern führt. Diese weiche Margin lässt zu, dass Beobachtungen innerhalb der Margin liegen und erlaubt auch Fehlklassifikationenen. Die *Support-Vektoren* des SVC sind sämtliche Beobachtungen, di im Bereich der Margin liegen.</span>
<span id="cb62-355"><a href="#cb62-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-356"><a href="#cb62-356" aria-hidden="true" tabindex="-1"></a>Wie beim MMC ist es das Ziel des SVC, die Parameter $<span class="sc">\{</span>\boldsymbol{w}, b<span class="sc">\}</span>$ so zu bestimmen, dass die Margin maximiert wird, jedoch dürfen einige Datenpunkte innerhalb der Margin oder sogar auf der *falschen Seite* der trennenden Hyperebene (Fehlerklassifizierung) liegen. Ein SVC kann so eine (nicht perfekt) trennende Hyperbene finden, wenn das Optimierungskalkühl des MMC aufgrund der Überlappung der Klassen unlösbar ist.</span>
<span id="cb62-357"><a href="#cb62-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-358"><a href="#cb62-358" aria-hidden="true" tabindex="-1"></a>Hierzu wird die Ebene unter Berücksichtigung einer weiteren Bedingung für die Optimierung ermittelt, die auf *Slack-Variablen* $\epsilon_i \geq 0$ basiert, </span>
<span id="cb62-359"><a href="#cb62-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-360"><a href="#cb62-360" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb62-361"><a href="#cb62-361" aria-hidden="true" tabindex="-1"></a>  \sum_{i=1}^{n} \epsilon_i \leq C. \label{eq:svcreg}</span>
<span id="cb62-362"><a href="#cb62-362" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb62-363"><a href="#cb62-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-364"><a href="#cb62-364" aria-hidden="true" tabindex="-1"></a>Die $\epsilon_i$ sind größer 0 für Beobachtungen, welche die Margin verletzen, wobei die Größe von $\epsilon_i$ die Intensität der Verletzung misst. Für eine Beobachtung $i$ innerhalb der Margin, aber auf der *korrekten* Seite der Trennebene ist $0\leq\epsilon_i&lt;1$. Liegt die Beobachtung auf der *falschen* Seite der Ebene, ist $\epsilon_i&gt;1$. </span>
<span id="cb62-365"><a href="#cb62-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-366"><a href="#cb62-366" aria-hidden="true" tabindex="-1"></a>$C\geq0$ ist ein Regularisierungsparameter, der die Balance zwischen der Maximierung der Margin und der Anzahl der tolerierten Fehlklassifikationen regelt.^<span class="co">[</span><span class="ot">Für $C=0$ muss $\sum_{i=1}^{n} \epsilon_i = 0$ sein. Der SVC entspricht dann dem MMC.</span><span class="co">]</span> Ein hoher Wert von $C$ ermöglicht mehr Verletzungen der Margin und mehr Fehlklassifikationen, was meist zu einer breiteren Margin führt. Ein kleinerer Wert von $C$ hingegen erzielt eine kleinere Margin mit weniger Verletzungen und Fehlklassifikationen. $C$ ist also ein Tuning-Parameter der einen Bias-Varianz-Tradeoff regelt: Für kleine $C$ (kleine Margins) wird die trennende Ebene gut an die Trainingsdaten angepasst, hat also wenig Verzerrung aber tendentiell größere Varianz. Für große $C$ (breite  Margin) ist die Varianz beim Bestimmen der trennenden Ebene tendentiell kleiner, jedoch kann die Verzerrung groß sein. Diese Abwägung ist wichtig für die Güte der Klassifizierung neuer Beobachtung. In empirischen Anwendungen wird $C$ mit Cross-Validation bestimmt.</span>
<span id="cb62-367"><a href="#cb62-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-368"><a href="#cb62-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-369"><a href="#cb62-369" aria-hidden="true" tabindex="-1"></a>**Nicht perfekt separierbare Klassen**</span>
<span id="cb62-370"><a href="#cb62-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-373"><a href="#cb62-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-374"><a href="#cb62-374" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb62-375"><a href="#cb62-375" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb62-376"><a href="#cb62-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-377"><a href="#cb62-377" aria-hidden="true" tabindex="-1"></a>lsvm_nonsep_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb62-378"><a href="#cb62-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb62-379"><a href="#cb62-379" aria-hidden="true" tabindex="-1"></a>    <span class="at">x1 =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="sc">-</span>.<span class="dv">5</span>),</span>
<span id="cb62-380"><a href="#cb62-380" aria-hidden="true" tabindex="-1"></a>    <span class="at">x2 =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">2</span>),</span>
<span id="cb62-381"><a href="#cb62-381" aria-hidden="true" tabindex="-1"></a>    <span class="at">klasse =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">50</span>))</span>
<span id="cb62-382"><a href="#cb62-382" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb62-383"><a href="#cb62-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb62-384"><a href="#cb62-384" aria-hidden="true" tabindex="-1"></a>    <span class="at">x1 =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">0</span>),</span>
<span id="cb62-385"><a href="#cb62-385" aria-hidden="true" tabindex="-1"></a>    <span class="at">x2 =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">0</span>),</span>
<span id="cb62-386"><a href="#cb62-386" aria-hidden="true" tabindex="-1"></a>    <span class="at">klasse =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">50</span>))</span>
<span id="cb62-387"><a href="#cb62-387" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-388"><a href="#cb62-388" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-389"><a href="#cb62-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-390"><a href="#cb62-390" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(<span class="at">object =</span> lsvm_nonsep_data, <span class="at">file =</span> <span class="st">"datasets/lsvm_nonsep_data.RDS"</span>)</span>
<span id="cb62-391"><a href="#cb62-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-392"><a href="#cb62-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-395"><a href="#cb62-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-396"><a href="#cb62-396" aria-hidden="true" tabindex="-1"></a><span class="co"># nicht exakt separierbare Daten einlesen</span></span>
<span id="cb62-397"><a href="#cb62-397" aria-hidden="true" tabindex="-1"></a>lsvm_nonsep_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">"datasets/lsvm_nonsep_data.RDS"</span>)</span>
<span id="cb62-398"><a href="#cb62-398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-399"><a href="#cb62-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-402"><a href="#cb62-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-403"><a href="#cb62-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Nicht perfekt separierbare Klassen"</span></span>
<span id="cb62-404"><a href="#cb62-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mmcnonsep</span></span>
<span id="cb62-405"><a href="#cb62-405" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb62-406"><a href="#cb62-406" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> lsvm_nonsep_data, </span>
<span id="cb62-407"><a href="#cb62-407" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">color =</span> klasse)</span>
<span id="cb62-408"><a href="#cb62-408" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-409"><a href="#cb62-409" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb62-410"><a href="#cb62-410" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"X1"</span>, </span>
<span id="cb62-411"><a href="#cb62-411" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"X2"</span>, </span>
<span id="cb62-412"><a href="#cb62-412" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Nicht perfekt separierbare Klassen"</span></span>
<span id="cb62-413"><a href="#cb62-413" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb62-414"><a href="#cb62-414" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Beobachtungen</span></span>
<span id="cb62-415"><a href="#cb62-415" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb62-416"><a href="#cb62-416" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb62-417"><a href="#cb62-417" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb62-418"><a href="#cb62-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-419"><a href="#cb62-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-420"><a href="#cb62-420" aria-hidden="true" tabindex="-1"></a>Ein MMC kann für den in @fig-mmcnonsep gezeigten Datensatz <span class="in">`lsvm_nonsep_data`</span> keine Lösung finden: Der Algorithmus iteriert bis zu einer maximalen Anzahl an Durchläufen.</span>
<span id="cb62-421"><a href="#cb62-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-422"><a href="#cb62-422" aria-hidden="true" tabindex="-1"></a>Ein SVC hingegen kann angepasst werden: Mit <span class="in">`cost = 1`</span> räumen wir ein  "Budget" für Verletzungen der Margin und Fehlklassifikationen ein.^<span class="co">[</span><span class="ot">Der Parameter `cost` in `svm()` ist ein Langrange-Multiplikator und verhält sich daher invers zu $C$ in \eqref{eq:svcreg}: Große Werte für `cost` führen zu viel Regularisierung (kleine Margin) und umgekehrt.</span><span class="co">]</span></span>
<span id="cb62-423"><a href="#cb62-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-426"><a href="#cb62-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-427"><a href="#cb62-427" aria-hidden="true" tabindex="-1"></a><span class="co"># Trainiere ein SVC-Modell</span></span>
<span id="cb62-428"><a href="#cb62-428" aria-hidden="true" tabindex="-1"></a>model_svc <span class="ot">&lt;-</span> <span class="fu">svm</span>(</span>
<span id="cb62-429"><a href="#cb62-429" aria-hidden="true" tabindex="-1"></a>  klasse <span class="sc">~</span> x1 <span class="sc">+</span> x2, </span>
<span id="cb62-430"><a href="#cb62-430" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> lsvm_nonsep_data, </span>
<span id="cb62-431"><a href="#cb62-431" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">"linear"</span>, </span>
<span id="cb62-432"><a href="#cb62-432" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost =</span> <span class="dv">1</span>, </span>
<span id="cb62-433"><a href="#cb62-433" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale =</span> F</span>
<span id="cb62-434"><a href="#cb62-434" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-435"><a href="#cb62-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-436"><a href="#cb62-436" aria-hidden="true" tabindex="-1"></a>model_svc</span>
<span id="cb62-437"><a href="#cb62-437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-440"><a href="#cb62-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-441"><a href="#cb62-441" aria-hidden="true" tabindex="-1"></a><span class="co"># Trainierte Koeffizienten des SVC auslesen</span></span>
<span id="cb62-442"><a href="#cb62-442" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb62-443"><a href="#cb62-443" aria-hidden="true" tabindex="-1"></a>  coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_svc) <span class="sc">%&gt;%</span></span>
<span id="cb62-444"><a href="#cb62-444" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_names</span>(</span>
<span id="cb62-445"><a href="#cb62-445" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"b"</span>, <span class="st">"w1"</span>, <span class="st">"w2"</span>)</span>
<span id="cb62-446"><a href="#cb62-446" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-447"><a href="#cb62-447" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-448"><a href="#cb62-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-449"><a href="#cb62-449" aria-hidden="true" tabindex="-1"></a>nrm <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(coefs[<span class="st">"w1"</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> coefs[<span class="st">"w2"</span>]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb62-450"><a href="#cb62-450" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> coefs <span class="sc">/</span> nrm</span>
<span id="cb62-451"><a href="#cb62-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-452"><a href="#cb62-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-453"><a href="#cb62-453" aria-hidden="true" tabindex="-1"></a>alpha0 <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="sc">-</span>coefs[<span class="st">"b"</span>] <span class="sc">/</span> coefs[<span class="st">"w2"</span>])</span>
<span id="cb62-454"><a href="#cb62-454" aria-hidden="true" tabindex="-1"></a>alpha1 <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="sc">-</span>coefs[<span class="st">"w1"</span>] <span class="sc">/</span> coefs[<span class="st">"w2"</span>])</span>
<span id="cb62-455"><a href="#cb62-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-456"><a href="#cb62-456" aria-hidden="true" tabindex="-1"></a>sv <span class="ot">&lt;-</span> model_svc<span class="sc">$</span>SV <span class="sc">%&gt;%</span> </span>
<span id="cb62-457"><a href="#cb62-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb62-458"><a href="#cb62-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-459"><a href="#cb62-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-460"><a href="#cb62-460" aria-hidden="true" tabindex="-1"></a>Analog zu <span class="in">`model_mmc`</span> können wir die trennende Gerade gemeinsam mit den Margins sowie den SV graphisch darstellen.</span>
<span id="cb62-461"><a href="#cb62-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-464"><a href="#cb62-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-465"><a href="#cb62-465" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Soft Margin Support Vector Classifier"</span></span>
<span id="cb62-466"><a href="#cb62-466" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-smsvc</span></span>
<span id="cb62-467"><a href="#cb62-467" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb62-468"><a href="#cb62-468" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> lsvm_nonsep_data, </span>
<span id="cb62-469"><a href="#cb62-469" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">color =</span> klasse)</span>
<span id="cb62-470"><a href="#cb62-470" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-471"><a href="#cb62-471" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"X1"</span>, <span class="at">y =</span> <span class="st">"X2"</span>) <span class="sc">+</span></span>
<span id="cb62-472"><a href="#cb62-472" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Trennlinie</span></span>
<span id="cb62-473"><a href="#cb62-473" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(</span>
<span id="cb62-474"><a href="#cb62-474" aria-hidden="true" tabindex="-1"></a>      <span class="at">fun =</span> \(x) alpha0 <span class="sc">+</span> alpha1 <span class="sc">*</span> x, <span class="at">col =</span> <span class="st">"black"</span></span>
<span id="cb62-475"><a href="#cb62-475" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb62-476"><a href="#cb62-476" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Marginallinien</span></span>
<span id="cb62-477"><a href="#cb62-477" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x) <span class="sc">-</span>(coefs[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>nrm)<span class="sc">/</span>coefs[<span class="dv">3</span>] <span class="sc">+</span> alpha1 <span class="sc">*</span> x, </span>
<span id="cb62-478"><a href="#cb62-478" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb62-479"><a href="#cb62-479" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x) <span class="sc">-</span>(coefs[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>nrm)<span class="sc">/</span>coefs[<span class="dv">3</span>] <span class="sc">+</span> alpha1 <span class="sc">*</span> x, </span>
<span id="cb62-480"><a href="#cb62-480" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb62-481"><a href="#cb62-481" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Support-Vektoren</span></span>
<span id="cb62-482"><a href="#cb62-482" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb62-483"><a href="#cb62-483" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> sv, </span>
<span id="cb62-484"><a href="#cb62-484" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2),</span>
<span id="cb62-485"><a href="#cb62-485" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb62-486"><a href="#cb62-486" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="dv">1</span>,</span>
<span id="cb62-487"><a href="#cb62-487" aria-hidden="true" tabindex="-1"></a>      <span class="at">inherit.aes =</span> F</span>
<span id="cb62-488"><a href="#cb62-488" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb62-489"><a href="#cb62-489" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Beobachtungen</span></span>
<span id="cb62-490"><a href="#cb62-490" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb62-491"><a href="#cb62-491" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb62-492"><a href="#cb62-492" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb62-493"><a href="#cb62-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-494"><a href="#cb62-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-495"><a href="#cb62-495" aria-hidden="true" tabindex="-1"></a>Aufgrund der *Soft Margin* des SVC werden hier Fehlklassifikationen in Kauf genommen. Beachte, dass sowohl Beobachtungen auf und innerhalb der Margin als auch *fehlklassifizierte* Beobachtungen die Support-Vektoren der trennenden Geraden sind in @fig-smsvc sind.</span>
<span id="cb62-496"><a href="#cb62-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-499"><a href="#cb62-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-500"><a href="#cb62-500" aria-hidden="true" tabindex="-1"></a><span class="co"># Genauigkeit der Klassifizierung für Trainingsdaten</span></span>
<span id="cb62-501"><a href="#cb62-501" aria-hidden="true" tabindex="-1"></a>model_svc <span class="sc">%&gt;%</span> </span>
<span id="cb62-502"><a href="#cb62-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-503"><a href="#cb62-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(</span>
<span id="cb62-504"><a href="#cb62-504" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> ., </span>
<span id="cb62-505"><a href="#cb62-505" aria-hidden="true" tabindex="-1"></a>    <span class="at">truth =</span> lsvm_nonsep_data<span class="sc">$</span>klasse</span>
<span id="cb62-506"><a href="#cb62-506" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb62-507"><a href="#cb62-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(truth, estimate)</span>
<span id="cb62-508"><a href="#cb62-508" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-509"><a href="#cb62-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-510"><a href="#cb62-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-511"><a href="#cb62-511" aria-hidden="true" tabindex="-1"></a>**Nicht-lineare und unscharfe Entscheidungsgrenzen**</span>
<span id="cb62-512"><a href="#cb62-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-513"><a href="#cb62-513" aria-hidden="true" tabindex="-1"></a>In empirischen Anwendungen gibt es selten exakt lineare Entscheidungsgrenzen. Wir präsentieren nun ein Beispiel für eine nicht-lineare Entscheidungsgrenze, bei der SVC dennoch eine hilfreiche Approximation der Entscheidungsgrenze liefern kann und diskutieren anschließend Support Vector Machines als Generalisierung von SVC zur Anpassung nicht-linearer Grenzen.</span>
<span id="cb62-514"><a href="#cb62-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-515"><a href="#cb62-515" aria-hidden="true" tabindex="-1"></a>Der Datensatz <span class="in">`data_wavy`</span> enthält gleichverteilte Beobachtungen $(X_1, X_2)$ die gemäß der sinuidalen Entscheidungsgrenze</span>
<span id="cb62-516"><a href="#cb62-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-517"><a href="#cb62-517" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-518"><a href="#cb62-518" aria-hidden="true" tabindex="-1"></a>  g(x_1) =  x_1 + 3\cdot \sin(1.2 \cdot x_1),</span>
<span id="cb62-519"><a href="#cb62-519" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-520"><a href="#cb62-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-521"><a href="#cb62-521" aria-hidden="true" tabindex="-1"></a>in zwei Klassen eingeteilt sind: Beoabchtungen gehören zu Klasse 1, wenn $x_2 + \varepsilon &gt; g(x_1)$ und ansonsten zu Klasse 2. Der (normalverteilte) Fehlerterm $\varepsilon$ führt zu einer unscharfen Trennung der Klassen, d.h. der Trainingsdatensatz ist selbst bei Abgleich mit der (nachfolgend als unbekannt angenommenen) Funktion $g(x_1)$ nicht vollständig korrekt klassifizierbar. Wir suchen dennoch einen Classifier, der $g(x_1)$ gut approximiert, also den deterministischen Teil der Entscheidungsregel möglichst gut lernt.</span>
<span id="cb62-522"><a href="#cb62-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-525"><a href="#cb62-525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-526"><a href="#cb62-526" aria-hidden="true" tabindex="-1"></a><span class="co"># data_wavy einlesen</span></span>
<span id="cb62-527"><a href="#cb62-527" aria-hidden="true" tabindex="-1"></a>data_wavy <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"datasets/data_wavy.RDS"</span>)</span>
<span id="cb62-528"><a href="#cb62-528" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-529"><a href="#cb62-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-530"><a href="#cb62-530" aria-hidden="true" tabindex="-1"></a>Zunächst plotten wir die Beobachtungen in <span class="in">`data_wavy`</span> gemeinsam mit der deterministischen Entscheidungsgrenze $g(x_1)$.</span>
<span id="cb62-531"><a href="#cb62-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-534"><a href="#cb62-534" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-535"><a href="#cb62-535" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb62-536"><a href="#cb62-536" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "`data_wavy`: Beobachtungen mit nicht-linearer Entscheidungsgrenze"</span></span>
<span id="cb62-537"><a href="#cb62-537" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-datawavy</span></span>
<span id="cb62-538"><a href="#cb62-538" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb62-539"><a href="#cb62-539" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisiere den Datensatz mit ggplot2</span></span>
<span id="cb62-540"><a href="#cb62-540" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb62-541"><a href="#cb62-541" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_wavy,</span>
<span id="cb62-542"><a href="#cb62-542" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb62-543"><a href="#cb62-543" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> x1, </span>
<span id="cb62-544"><a href="#cb62-544" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> x2, </span>
<span id="cb62-545"><a href="#cb62-545" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> klasse</span>
<span id="cb62-546"><a href="#cb62-546" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-547"><a href="#cb62-547" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-548"><a href="#cb62-548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb62-549"><a href="#cb62-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb62-550"><a href="#cb62-550" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"X1"</span>,</span>
<span id="cb62-551"><a href="#cb62-551" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"X2"</span></span>
<span id="cb62-552"><a href="#cb62-552" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-553"><a href="#cb62-553" aria-hidden="true" tabindex="-1"></a>  <span class="co"># deterministische Entscheidungsgrenze</span></span>
<span id="cb62-554"><a href="#cb62-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb62-555"><a href="#cb62-555" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> \(x) x <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">sin</span>(x <span class="sc">*</span> <span class="fl">1.2</span>), </span>
<span id="cb62-556"><a href="#cb62-556" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">1.25</span></span>
<span id="cb62-557"><a href="#cb62-557" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-558"><a href="#cb62-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>(<span class="at">expand =</span> F) <span class="sc">+</span></span>
<span id="cb62-559"><a href="#cb62-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb62-560"><a href="#cb62-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb62-561"><a href="#cb62-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-562"><a href="#cb62-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-563"><a href="#cb62-563" aria-hidden="true" tabindex="-1"></a>Ein SVC kann die nicht-lineare Entscheidungsgrenze nicht abbilden, erreicht jedoch aufgrund der groben Teilbarkeit des Regressorraums hinsichtlich der Klassen durch eine (von links unten nach rechts oben verlaufende) Grade eine akzeptable Fehlklassifikationrate. Wir zeigen dies mit R.</span>
<span id="cb62-564"><a href="#cb62-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-567"><a href="#cb62-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-568"><a href="#cb62-568" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb62-569"><a href="#cb62-569" aria-hidden="true" tabindex="-1"></a><span class="co"># Trainiere SV Classifier mit Cost-Kriterium</span></span>
<span id="cb62-570"><a href="#cb62-570" aria-hidden="true" tabindex="-1"></a>svc_wavy <span class="ot">&lt;-</span> <span class="fu">svm</span>(</span>
<span id="cb62-571"><a href="#cb62-571" aria-hidden="true" tabindex="-1"></a>  klasse <span class="sc">~</span> ., </span>
<span id="cb62-572"><a href="#cb62-572" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_wavy, </span>
<span id="cb62-573"><a href="#cb62-573" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">"linear"</span>,</span>
<span id="cb62-574"><a href="#cb62-574" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost =</span> <span class="dv">1</span>,</span>
<span id="cb62-575"><a href="#cb62-575" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale =</span> F</span>
<span id="cb62-576"><a href="#cb62-576" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-577"><a href="#cb62-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-578"><a href="#cb62-578" aria-hidden="true" tabindex="-1"></a>svc_wavy</span>
<span id="cb62-579"><a href="#cb62-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-580"><a href="#cb62-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-583"><a href="#cb62-583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-584"><a href="#cb62-584" aria-hidden="true" tabindex="-1"></a><span class="co"># Erzeuge einen Grid für die Vorhersagen</span></span>
<span id="cb62-585"><a href="#cb62-585" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb62-586"><a href="#cb62-586" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1 =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data_wavy<span class="sc">$</span>x1), <span class="fu">max</span>(data_wavy<span class="sc">$</span>x1), <span class="at">length.out =</span> <span class="dv">150</span>),</span>
<span id="cb62-587"><a href="#cb62-587" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2 =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data_wavy<span class="sc">$</span>x2), <span class="fu">max</span>(data_wavy<span class="sc">$</span>x2), <span class="at">length.out =</span> <span class="dv">150</span>)</span>
<span id="cb62-588"><a href="#cb62-588" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb62-589"><a href="#cb62-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-590"><a href="#cb62-590" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> grid <span class="sc">%&gt;%</span></span>
<span id="cb62-591"><a href="#cb62-591" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vorhersagen auf dem Grid</span></span>
<span id="cb62-592"><a href="#cb62-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb62-593"><a href="#cb62-593" aria-hidden="true" tabindex="-1"></a>    <span class="at">klasse =</span> <span class="fu">predict</span>(svc_wavy, grid)</span>
<span id="cb62-594"><a href="#cb62-594" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-595"><a href="#cb62-595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-596"><a href="#cb62-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-599"><a href="#cb62-599" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-600"><a href="#cb62-600" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "`data_wavy`: Mit SVC trainierte und deerministische Entscheidungsgrenze"</span></span>
<span id="cb62-601"><a href="#cb62-601" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-svcwavy</span></span>
<span id="cb62-602"><a href="#cb62-602" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb62-603"><a href="#cb62-603" aria-hidden="true" tabindex="-1"></a><span class="co"># Daten + Entscheidungsgrenze mit ggplot</span></span>
<span id="cb62-604"><a href="#cb62-604" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb62-605"><a href="#cb62-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb62-606"><a href="#cb62-606" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> grid, </span>
<span id="cb62-607"><a href="#cb62-607" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">color =</span> klasse), <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb62-608"><a href="#cb62-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb62-609"><a href="#cb62-609" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data_wavy,</span>
<span id="cb62-610"><a href="#cb62-610" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">color =</span> klasse)) <span class="sc">+</span></span>
<span id="cb62-611"><a href="#cb62-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb62-612"><a href="#cb62-612" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> \(x) x <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">sin</span>(x <span class="sc">*</span> <span class="fl">1.2</span>), </span>
<span id="cb62-613"><a href="#cb62-613" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"#00BFC4"</span>, </span>
<span id="cb62-614"><a href="#cb62-614" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">1.25</span></span>
<span id="cb62-615"><a href="#cb62-615" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-616"><a href="#cb62-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"X1"</span>, <span class="at">y =</span> <span class="st">"X2"</span>) <span class="sc">+</span></span>
<span id="cb62-617"><a href="#cb62-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>(<span class="at">expand =</span> F) <span class="sc">+</span></span>
<span id="cb62-618"><a href="#cb62-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb62-619"><a href="#cb62-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb62-620"><a href="#cb62-620" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-621"><a href="#cb62-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-624"><a href="#cb62-624" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-625"><a href="#cb62-625" aria-hidden="true" tabindex="-1"></a><span class="co"># Anteil falscher Klassifzikationen für data_wavy</span></span>
<span id="cb62-626"><a href="#cb62-626" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">mean</span>(<span class="fu">predict</span>(svc_wavy) <span class="sc">==</span> data_wavy<span class="sc">$</span>klasse)</span>
<span id="cb62-627"><a href="#cb62-627" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-628"><a href="#cb62-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-629"><a href="#cb62-629" aria-hidden="true" tabindex="-1"></a>Diese Fehlerrate kann durch Verfahren, die nicht-lineare Entscheidungsgrenzen lernen können, deutlich verringert werden. Der nächste Abschnitt erläutert eine entsprechende Erweiterung des SVC: *Support Vector Machines*.</span>
<span id="cb62-630"><a href="#cb62-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-631"><a href="#cb62-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-632"><a href="#cb62-632" aria-hidden="true" tabindex="-1"></a><span class="fu">## Support Vector Machines</span></span>
<span id="cb62-633"><a href="#cb62-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-634"><a href="#cb62-634" aria-hidden="true" tabindex="-1"></a>Sei $S$ die *Indexmenge* der zu findenden Support-Vektoren für den SVC. Mann kann zeigen <span class="co">[</span><span class="ot">vgl. @Hastieetal2013</span><span class="co">]</span>, dass die zu lernende Entscheidungsregel des SVC die Form</span>
<span id="cb62-635"><a href="#cb62-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-636"><a href="#cb62-636" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb62-637"><a href="#cb62-637" aria-hidden="true" tabindex="-1"></a>  f(x) = b + \alpha_i \sum_{i\in S} \langle\boldsymbol{x},\boldsymbol{x}_j\rangle \label{eq:svck}</span>
<span id="cb62-638"><a href="#cb62-638" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb62-639"><a href="#cb62-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-640"><a href="#cb62-640" aria-hidden="true" tabindex="-1"></a>hat, wobei $\langle\boldsymbol{x}_i,\boldsymbol{x}_j\rangle$ das *innere Produkt* der Vektoren $\boldsymbol{x}_i$ und $\boldsymbol{x}_j$ meint,</span>
<span id="cb62-641"><a href="#cb62-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-642"><a href="#cb62-642" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-643"><a href="#cb62-643" aria-hidden="true" tabindex="-1"></a>  \langle\boldsymbol{x}_i,\boldsymbol{x}_j\rangle := \sum_{l=1}^k x_{i,l} x_{j,l}.</span>
<span id="cb62-644"><a href="#cb62-644" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-645"><a href="#cb62-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-646"><a href="#cb62-646" aria-hidden="true" tabindex="-1"></a>Die Funktion $\langle\boldsymbol{x}_i,\boldsymbol{x}_j\rangle$ ist ein Beispiel für eine *Kernel-Funktion* $K(\boldsymbol{x}_i,\boldsymbol{x}_j)$, der *lineare Kernel*. Ein Kernel $K$ berechnet die "Ähnlichkeit" zwischen zwei Datenpunkten. Mit $K(\boldsymbol{x}_i,\boldsymbol{x}_j)=\langle\boldsymbol{x}_i,\boldsymbol{x}_j\rangle$ wird die lineare Übereinstimmung der Vektoren $\boldsymbol{x}_i$ und $\boldsymbol{x}_j$ im ursprünglichen Regressorraum gemessen und damit eine lineare Klassifikationsregel $f(x)$ gesucht.^<span class="co">[</span><span class="ot">Geometrisch wird die Ähnlichkeit durch den Winkel zwischen den Regressor-Vektoren gemessen: $\langle\boldsymbol{x}_i \boldsymbol{x}_j\rangle = \|\boldsymbol{x}_i\| \|\boldsymbol{x}_j\| \cos(\theta)$, wobei $\theta$ der Winkel zwischen $\boldsymbol{x}_i$ und $\boldsymbol{x}_j$ ist.</span><span class="co">]</span></span>
<span id="cb62-647"><a href="#cb62-647" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb62-648"><a href="#cb62-648" aria-hidden="true" tabindex="-1"></a>Eine *Support Vector Machine* (SVM) ersetzt das innere Produkt in \eqref{eq:svck} durch einen *nicht-linearen* Kernel $K$. Dadurch können SVMs auch hochgradig nicht-lineare Entscheidungsgrenzen lernen: Um die nicht-lineare Beziehungen in den Daten zu modellieren, werden die Regressoren mit einem $K$ implizit so transformiert, dass sie in einem (möglicherweise hoch-dimensionalen) Raum einfacher hinsichtlich ihrer Klasse getrennt werden können. Diese Transformation muss jedoch dank des Kernels nicht explizit berechnet werden --- dies ist der *Kernel Trick*.^<span class="co">[</span><span class="ot">Der Kernel Trick ist hilfreich, weil die explizite Transformation der Daten rechenaufwendig oder sogar unlösbar sein kann. Kernel-Funktionen hingegen können schnell berechnet werden.</span><span class="co">]</span></span>
<span id="cb62-649"><a href="#cb62-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-650"><a href="#cb62-650" aria-hidden="true" tabindex="-1"></a>Typische nicht-lineare Kernel-Funktionen sind</span>
<span id="cb62-651"><a href="#cb62-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-652"><a href="#cb62-652" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Radialer Kernel**</span>
<span id="cb62-653"><a href="#cb62-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-654"><a href="#cb62-654" aria-hidden="true" tabindex="-1"></a>  \begin{align*}</span>
<span id="cb62-655"><a href="#cb62-655" aria-hidden="true" tabindex="-1"></a>    K(\boldsymbol{x}_i,\boldsymbol{x}_j) = \exp\bigg(-\gamma \sum_{l=1}^k (x_{lj} - x_{li})^2\bigg)</span>
<span id="cb62-656"><a href="#cb62-656" aria-hidden="true" tabindex="-1"></a>  \end{align*}</span>
<span id="cb62-657"><a href="#cb62-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-658"><a href="#cb62-658" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Polynomialer Kernel** (Ordnung $d$)</span>
<span id="cb62-659"><a href="#cb62-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-660"><a href="#cb62-660" aria-hidden="true" tabindex="-1"></a>  \begin{align*}</span>
<span id="cb62-661"><a href="#cb62-661" aria-hidden="true" tabindex="-1"></a>    K(\boldsymbol{x}_i,\boldsymbol{x}_j) = \bigg(c + \sum_{l=1}^k x_{lj} \cdot x_{li} \bigg)^d, \quad c\in\mathbb{R},\ d&gt;1</span>
<span id="cb62-662"><a href="#cb62-662" aria-hidden="true" tabindex="-1"></a>  \end{align*}</span>
<span id="cb62-663"><a href="#cb62-663" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-664"><a href="#cb62-664" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Sigmoidaler Kernel**</span>
<span id="cb62-665"><a href="#cb62-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-666"><a href="#cb62-666" aria-hidden="true" tabindex="-1"></a>  \begin{align*}</span>
<span id="cb62-667"><a href="#cb62-667" aria-hidden="true" tabindex="-1"></a>    K(\boldsymbol{x}_i,\boldsymbol{x}_j) = \tanh\bigg(\gamma\sum_{l=1}^k x_{lj} \cdot x_{li} + c \bigg), \quad c\in\mathbb{R}</span>
<span id="cb62-668"><a href="#cb62-668" aria-hidden="true" tabindex="-1"></a>  \end{align*}</span>
<span id="cb62-669"><a href="#cb62-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-670"><a href="#cb62-670" aria-hidden="true" tabindex="-1"></a>Zusätzlich zu dem Tuning-Parameter $C$ müssen also für das Training einer Entscheidungsgrenze die Skalierungs- bzw. Positions-Parameter $\gamma$ und $c$ für den Kernel gewählt werden. Letzteres erfolgt in empirischen Anwendungen häufig mit Cross Validation.</span>
<span id="cb62-671"><a href="#cb62-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-672"><a href="#cb62-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-673"><a href="#cb62-673" aria-hidden="true" tabindex="-1"></a><span class="fu">### Der Kernel-Trick</span></span>
<span id="cb62-674"><a href="#cb62-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-675"><a href="#cb62-675" aria-hidden="true" tabindex="-1"></a>Um den Kernel Trick zu veranschaulichen, betrachten wir ein binäres Klassifikationsproblem mit einer nicht-linearen Entscheidungsgrenze im Regressorraum für $(X_1,X_2)\in\mathbb{R}^2$, bei dem die Klassenzugehörigkeit der Beobachtungen konzentrisch ist. Wir lesen hierzu den Datensatz <span class="in">`data_concentric`</span> ein.</span>
<span id="cb62-676"><a href="#cb62-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-679"><a href="#cb62-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-680"><a href="#cb62-680" aria-hidden="true" tabindex="-1"></a><span class="co"># konzentrische Daten einlesen</span></span>
<span id="cb62-681"><a href="#cb62-681" aria-hidden="true" tabindex="-1"></a>data_concentric <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(</span>
<span id="cb62-682"><a href="#cb62-682" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"datasets/data_concentric.RDS"</span></span>
<span id="cb62-683"><a href="#cb62-683" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-684"><a href="#cb62-684" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-685"><a href="#cb62-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-686"><a href="#cb62-686" aria-hidden="true" tabindex="-1"></a>Für einen Verständnis der Verteilung der Klassenzugehörigkeit im Regressorraum visualisieren wir den Datensatz <span class="in">`data_concentric`</span> mit <span class="in">`ggplot()`</span>.</span>
<span id="cb62-687"><a href="#cb62-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-690"><a href="#cb62-690" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-691"><a href="#cb62-691" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Konzentrisch angeordnete Klassenzugehörigkeit"</span></span>
<span id="cb62-692"><a href="#cb62-692" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-dataconc</span></span>
<span id="cb62-693"><a href="#cb62-693" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb62-694"><a href="#cb62-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-695"><a href="#cb62-695" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb62-696"><a href="#cb62-696" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb62-697"><a href="#cb62-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-698"><a href="#cb62-698" aria-hidden="true" tabindex="-1"></a><span class="co"># `data_concentric` visualisieren</span></span>
<span id="cb62-699"><a href="#cb62-699" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb62-700"><a href="#cb62-700" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_concentric,</span>
<span id="cb62-701"><a href="#cb62-701" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, <span class="at">color =</span> klasse)</span>
<span id="cb62-702"><a href="#cb62-702" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb62-703"><a href="#cb62-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb62-704"><a href="#cb62-704" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Seitenverhältnis auf 1 setzten</span></span>
<span id="cb62-705"><a href="#cb62-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb62-706"><a href="#cb62-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb62-707"><a href="#cb62-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb62-708"><a href="#cb62-708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-709"><a href="#cb62-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-710"><a href="#cb62-710" aria-hidden="true" tabindex="-1"></a>Die Klassen der in @fig-dataconc gezeigten Beobachtungen sind aufgrund der konzentrischen Verteilung nicht linear separierbar -- die Entscheidungsgrenze hat eine kreisförmige Struktur. Der *Kernel-Trick* nutz hier eine implizite Daten abbildung in einen höherdimensionalen Raum, in dem die Klassen leichter zu trennen sind.</span>
<span id="cb62-711"><a href="#cb62-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-712"><a href="#cb62-712" aria-hidden="true" tabindex="-1"></a>Wir suchen hierfür einen Kernel $K(\boldsymbol{x}_i, \boldsymbol{x}_j)$, der "ähnliche" Funktionswerte annimmt, wenn die Datenpunkte $i$ und $j$ zu derselben Klasse gehören. Für die in der Abbildung gezeigte Verteilung empfiehlt sich der *polynomiale Kernel* mit dem Grad $d = 2$. Dieser Kernel berechnet die Ähnlichkeit zwischen zwei Datenpunkten $\boldsymbol{x}_i$ und $\boldsymbol{x}_j$ im Regressorraum als</span>
<span id="cb62-713"><a href="#cb62-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-714"><a href="#cb62-714" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb62-715"><a href="#cb62-715" aria-hidden="true" tabindex="-1"></a>  K(\boldsymbol{x}_i, \boldsymbol{x}_j) = \left( \sum_{l=1}^k x_{li} \cdot x_{lj} \right)^2.</span>
<span id="cb62-716"><a href="#cb62-716" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb62-717"><a href="#cb62-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-718"><a href="#cb62-718" aria-hidden="true" tabindex="-1"></a>Der polynomiale Kernel entspricht einer quadratischen Beziehung zwischen den Datenpunkten und ist so in der Lage, kreisförmige oder konzentrische Zusammenhänge im Regressorraum zu erfassen. Die Trennbarkeit der Beobachtungen aufgrund ähnlicher Werte des Kernels für Beobachtungen der selben Klasse kann hierbei durch eine explizite Transformation der Datenpunkte in einen höherdimensionalen Raum dargestellt werden. In unserem zwei-dimensionalen Beispiel ist diese Transformation </span>
<span id="cb62-719"><a href="#cb62-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-720"><a href="#cb62-720" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb62-721"><a href="#cb62-721" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb62-722"><a href="#cb62-722" aria-hidden="true" tabindex="-1"></a>    x = x_1<span class="sc">\\</span> y = x_2</span>
<span id="cb62-723"><a href="#cb62-723" aria-hidden="true" tabindex="-1"></a>  \end{pmatrix}</span>
<span id="cb62-724"><a href="#cb62-724" aria-hidden="true" tabindex="-1"></a>  \rightarrow </span>
<span id="cb62-725"><a href="#cb62-725" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb62-726"><a href="#cb62-726" aria-hidden="true" tabindex="-1"></a>    x = x_1<span class="sc">\\</span> </span>
<span id="cb62-727"><a href="#cb62-727" aria-hidden="true" tabindex="-1"></a>    y = x_2<span class="sc">\\</span> </span>
<span id="cb62-728"><a href="#cb62-728" aria-hidden="true" tabindex="-1"></a>    z = x_1^2 + x_2^2. </span>
<span id="cb62-729"><a href="#cb62-729" aria-hidden="true" tabindex="-1"></a>  \end{pmatrix}</span>
<span id="cb62-730"><a href="#cb62-730" aria-hidden="true" tabindex="-1"></a>  \label{eq:polykerntrans}</span>
<span id="cb62-731"><a href="#cb62-731" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb62-732"><a href="#cb62-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-733"><a href="#cb62-733" aria-hidden="true" tabindex="-1"></a>Die Abbildung \eqref{eq:polykerntrans} projiziert die Daten in den drei-dimensionalen Raum $\mathbb{R}^3$, wobei die zusätzliche Koordinate  $z = x_1^2 + x_2^2$ die (quadratische) Distanz einer Beobachtung vom Ursprung darstellt. In diesem transformierten Raum sind konzentrisch angeordnete Klassen anhand des Wertes von $z$ linear separierbar, was geometrisch einer trennenden Hyperebene entspricht. Durch die Wahl des polynomialen Kernels wird so eine nicht-lineare Trennlinie im ursprünglichen Regressor-Raum $\mathbb{R}^2$ modelliert, welche die kreisförmige Entscheidungsgrenze erfassen kann.</span>
<span id="cb62-734"><a href="#cb62-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-735"><a href="#cb62-735" aria-hidden="true" tabindex="-1"></a>Um dies grafisch zu veranschaulichen, transformieren wir die Datenpunkte in <span class="in">`data_concentric`</span> gemäß der Funktion \eqref{eq:polykerntrans} nach $\mathbb{R}^3$. </span>
<span id="cb62-736"><a href="#cb62-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-739"><a href="#cb62-739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-740"><a href="#cb62-740" aria-hidden="true" tabindex="-1"></a><span class="co"># Funktion: Explizite Transformation durch </span></span>
<span id="cb62-741"><a href="#cb62-741" aria-hidden="true" tabindex="-1"></a><span class="co"># polynomiellen Kernel mit d = 2</span></span>
<span id="cb62-742"><a href="#cb62-742" aria-hidden="true" tabindex="-1"></a>poly_transform <span class="ot">&lt;-</span> <span class="cf">function</span>(X) {</span>
<span id="cb62-743"><a href="#cb62-743" aria-hidden="true" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> X[, <span class="dv">1</span>]</span>
<span id="cb62-744"><a href="#cb62-744" aria-hidden="true" tabindex="-1"></a>    X2 <span class="ot">&lt;-</span> X[, <span class="dv">2</span>]</span>
<span id="cb62-745"><a href="#cb62-745" aria-hidden="true" tabindex="-1"></a>    X_trans <span class="ot">&lt;-</span> <span class="fu">tibble</span>(X1, X2, <span class="at">z =</span> X1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> X2<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb62-746"><a href="#cb62-746" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(X_trans)</span>
<span id="cb62-747"><a href="#cb62-747" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-748"><a href="#cb62-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-749"><a href="#cb62-749" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformation furchführen</span></span>
<span id="cb62-750"><a href="#cb62-750" aria-hidden="true" tabindex="-1"></a>X_transformed <span class="ot">&lt;-</span> <span class="fu">poly_transform</span>(</span>
<span id="cb62-751"><a href="#cb62-751" aria-hidden="true" tabindex="-1"></a>  data_concentric <span class="sc">%&gt;%</span> </span>
<span id="cb62-752"><a href="#cb62-752" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(X1, X2)</span>
<span id="cb62-753"><a href="#cb62-753" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-754"><a href="#cb62-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-755"><a href="#cb62-755" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformierte Beobachtungen</span></span>
<span id="cb62-756"><a href="#cb62-756" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_head</span>(X_transformed, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb62-757"><a href="#cb62-757" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-758"><a href="#cb62-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-759"><a href="#cb62-759" aria-hidden="true" tabindex="-1"></a>Im nächsten Schritt berechnen wir für die transformierten Daten <span class="in">`X_transformed`</span> unter Verwendung der Klassen in <span class="in">`data_concentric$klasse`</span> einen SVC, also eine SVM mit linearem Kernel: Wir suchen eine trennende Ebene für die transformierten Daten <span class="in">`X_transformed`</span> in $\mathbb{R}^3$. </span>
<span id="cb62-760"><a href="#cb62-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-763"><a href="#cb62-763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-764"><a href="#cb62-764" aria-hidden="true" tabindex="-1"></a><span class="co"># SVM mit einem linearen Kernel </span></span>
<span id="cb62-765"><a href="#cb62-765" aria-hidden="true" tabindex="-1"></a><span class="co"># auf den transformierten Daten trainieren</span></span>
<span id="cb62-766"><a href="#cb62-766" aria-hidden="true" tabindex="-1"></a>svm_model_poly_trans <span class="ot">&lt;-</span> <span class="fu">svm</span>(</span>
<span id="cb62-767"><a href="#cb62-767" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> X_transformed, </span>
<span id="cb62-768"><a href="#cb62-768" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> data_concentric<span class="sc">$</span>klasse, </span>
<span id="cb62-769"><a href="#cb62-769" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">"linear"</span></span>
<span id="cb62-770"><a href="#cb62-770" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-771"><a href="#cb62-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-772"><a href="#cb62-772" aria-hidden="true" tabindex="-1"></a>svm_model_poly_trans</span>
<span id="cb62-773"><a href="#cb62-773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-774"><a href="#cb62-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-775"><a href="#cb62-775" aria-hidden="true" tabindex="-1"></a>Die interaktive @fig-polytrans3d zeigt</span>
<span id="cb62-776"><a href="#cb62-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-777"><a href="#cb62-777" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>die transformierten Datenpunkte in $\mathbb{R}^3$,</span>
<span id="cb62-778"><a href="#cb62-778" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>die mit dem Modell-Objekt <span class="in">`svm_model_poly_trans`</span> berechnete trennende Hyperebene (grün) und </span>
<span id="cb62-779"><a href="#cb62-779" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>die Support-Vektore der Hyperebene (grau hinterlegt). </span>
<span id="cb62-780"><a href="#cb62-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-783"><a href="#cb62-783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-784"><a href="#cb62-784" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb62-785"><a href="#cb62-785" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "`data_concentric`: In R3 linear separierbaren Datenpunkte und trennende Hyperebene"</span></span>
<span id="cb62-786"><a href="#cb62-786" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-polytrans3d</span></span>
<span id="cb62-787"><a href="#cb62-787" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb62-788"><a href="#cb62-788" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgl)</span>
<span id="cb62-789"><a href="#cb62-789" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">rgl.printRglwidget =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-790"><a href="#cb62-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-791"><a href="#cb62-791" aria-hidden="true" tabindex="-1"></a>X_transformed <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X_transformed)</span>
<span id="cb62-792"><a href="#cb62-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-793"><a href="#cb62-793" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_concentric<span class="sc">$</span>klasse <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"#00BFC4"</span>, <span class="st">"#F8766D"</span>)</span>
<span id="cb62-794"><a href="#cb62-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-795"><a href="#cb62-795" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotten der transformierten Daten im 3D-Raum</span></span>
<span id="cb62-796"><a href="#cb62-796" aria-hidden="true" tabindex="-1"></a><span class="fu">plot3d</span>(</span>
<span id="cb62-797"><a href="#cb62-797" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> X_transformed[, <span class="dv">1</span>],</span>
<span id="cb62-798"><a href="#cb62-798" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> X_transformed[, <span class="dv">2</span>], </span>
<span id="cb62-799"><a href="#cb62-799" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> X_transformed[, <span class="dv">3</span>], </span>
<span id="cb62-800"><a href="#cb62-800" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"X1"</span>, <span class="at">ylab =</span> <span class="st">"X2"</span>, <span class="at">zlab =</span> <span class="st">"f(X1, X2)"</span>,</span>
<span id="cb62-801"><a href="#cb62-801" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> cols, </span>
<span id="cb62-802"><a href="#cb62-802" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> .<span class="dv">5</span>, </span>
<span id="cb62-803"><a href="#cb62-803" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"s"</span> </span>
<span id="cb62-804"><a href="#cb62-804" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-805"><a href="#cb62-805" aria-hidden="true" tabindex="-1"></a><span class="fu">rgl.viewpoint</span>(<span class="at">theta =</span> <span class="dv">0</span>, <span class="at">phi =</span> <span class="sc">-</span><span class="dv">80</span>,  <span class="at">zoom =</span> .<span class="dv">7</span>)</span>
<span id="cb62-806"><a href="#cb62-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-807"><a href="#cb62-807" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrahiere die Koeffizienten (w1, w2, w3) und den Bias (intercept) des Hyperplanes</span></span>
<span id="cb62-808"><a href="#cb62-808" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">t</span>(svm_model_poly_trans<span class="sc">$</span>coefs) <span class="sc">%*%</span> svm_model_poly_trans<span class="sc">$</span>SV</span>
<span id="cb62-809"><a href="#cb62-809" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="sc">-</span>svm_model_poly_trans<span class="sc">$</span>rho</span>
<span id="cb62-810"><a href="#cb62-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-811"><a href="#cb62-811" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstellen eines Gitternetzes für das Plotten des Hyperplanes</span></span>
<span id="cb62-812"><a href="#cb62-812" aria-hidden="true" tabindex="-1"></a>x_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_transformed[,<span class="dv">1</span>]), <span class="fu">max</span>(X_transformed[,<span class="dv">1</span>]), <span class="at">length =</span> <span class="dv">30</span>)</span>
<span id="cb62-813"><a href="#cb62-813" aria-hidden="true" tabindex="-1"></a>y_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_transformed[,<span class="dv">2</span>]), <span class="fu">max</span>(X_transformed[,<span class="dv">2</span>]), <span class="at">length =</span> <span class="dv">30</span>)</span>
<span id="cb62-814"><a href="#cb62-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-815"><a href="#cb62-815" aria-hidden="true" tabindex="-1"></a><span class="co"># Hier sicherstellen, dass die Z-Werte korrekt berechnet werden, um die Höhe der Hyperplane zu berücksichtigen</span></span>
<span id="cb62-816"><a href="#cb62-816" aria-hidden="true" tabindex="-1"></a>z_grid <span class="ot">&lt;-</span> <span class="fu">outer</span>(x_seq, y_seq, <span class="cf">function</span>(x, y) (<span class="sc">-</span>w[<span class="dv">1</span>]<span class="sc">*</span>x <span class="sc">-</span> w[<span class="dv">2</span>]<span class="sc">*</span>y <span class="sc">-</span> intercept) <span class="sc">/</span> w[<span class="dv">3</span>] <span class="sc">-</span> intercept)</span>
<span id="cb62-817"><a href="#cb62-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-818"><a href="#cb62-818" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotten des Hyperplanes (der Hyperplane wird blau und semitransparent angezeigt)</span></span>
<span id="cb62-819"><a href="#cb62-819" aria-hidden="true" tabindex="-1"></a><span class="fu">surface3d</span>(x_seq, y_seq, z_grid, <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb62-820"><a href="#cb62-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-821"><a href="#cb62-821" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotten der Support-Vektoren in rot zur Visualisierung</span></span>
<span id="cb62-822"><a href="#cb62-822" aria-hidden="true" tabindex="-1"></a>sv <span class="ot">&lt;-</span> X_transformed[svm_model_poly_trans<span class="sc">$</span>index,]</span>
<span id="cb62-823"><a href="#cb62-823" aria-hidden="true" tabindex="-1"></a><span class="fu">points3d</span>(sv[, <span class="dv">1</span>], sv[, <span class="dv">2</span>], sv[, <span class="dv">3</span>], </span>
<span id="cb62-824"><a href="#cb62-824" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"gray"</span>, </span>
<span id="cb62-825"><a href="#cb62-825" aria-hidden="true" tabindex="-1"></a>         <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb62-826"><a href="#cb62-826" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-827"><a href="#cb62-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-828"><a href="#cb62-828" aria-hidden="true" tabindex="-1"></a>Beachte, dass die grüne Hyperebene die Daten nahezu perfekt trennt:</span>
<span id="cb62-829"><a href="#cb62-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-832"><a href="#cb62-832" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-833"><a href="#cb62-833" aria-hidden="true" tabindex="-1"></a><span class="co"># Anteil falscher Klassifzikationen für data_concentric</span></span>
<span id="cb62-834"><a href="#cb62-834" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">mean</span>(<span class="fu">predict</span>(svm_model_poly_trans) <span class="sc">==</span> data_concentric<span class="sc">$</span>klasse)</span>
<span id="cb62-835"><a href="#cb62-835" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-836"><a href="#cb62-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-839"><a href="#cb62-839" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-840"><a href="#cb62-840" aria-hidden="true" tabindex="-1"></a><span class="co"># SVM mit poly Kernel auf data_concentric trainiert</span></span>
<span id="cb62-841"><a href="#cb62-841" aria-hidden="true" tabindex="-1"></a>svm_model_poly <span class="ot">&lt;-</span> <span class="fu">svm</span>(</span>
<span id="cb62-842"><a href="#cb62-842" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> data_concentric <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(X1, X2), </span>
<span id="cb62-843"><a href="#cb62-843" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> data_concentric<span class="sc">$</span>klasse, </span>
<span id="cb62-844"><a href="#cb62-844" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">"polynomial"</span>, </span>
<span id="cb62-845"><a href="#cb62-845" aria-hidden="true" tabindex="-1"></a>  <span class="at">coef0 =</span> <span class="dv">0</span>, <span class="co"># c = 0</span></span>
<span id="cb62-846"><a href="#cb62-846" aria-hidden="true" tabindex="-1"></a>  <span class="at">degree =</span> <span class="dv">2</span>, <span class="co"># d = 2</span></span>
<span id="cb62-847"><a href="#cb62-847" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma =</span> <span class="dv">1</span>, </span>
<span id="cb62-848"><a href="#cb62-848" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost =</span> <span class="dv">1</span></span>
<span id="cb62-849"><a href="#cb62-849" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-850"><a href="#cb62-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-851"><a href="#cb62-851" aria-hidden="true" tabindex="-1"></a>svm_model_poly</span>
<span id="cb62-852"><a href="#cb62-852" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-853"><a href="#cb62-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-854"><a href="#cb62-854" aria-hidden="true" tabindex="-1"></a>Die SVM-Modelle <span class="in">`svm_model_poly_trans`</span> und <span class="in">`svm_model_poly`</span> liefern identische Klassifzierungen der Beobachtungen in <span class="in">`data_concentric`</span>.</span>
<span id="cb62-855"><a href="#cb62-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-858"><a href="#cb62-858" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-859"><a href="#cb62-859" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(</span>
<span id="cb62-860"><a href="#cb62-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(svm_model_poly_trans) <span class="sc">==</span> <span class="fu">predict</span>(svm_model_poly)</span>
<span id="cb62-861"><a href="#cb62-861" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-862"><a href="#cb62-862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-863"><a href="#cb62-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-864"><a href="#cb62-864" aria-hidden="true" tabindex="-1"></a>Ahand der Komponenten des Objekts <span class="in">`svm_model_poly`</span> und mit Vorhersagen der Klassen für ein Gitter von Punkten können wir die angepasste kreisförmige Entscheidungsgrenze sowie die Margins im urspünglichen Prädiktorraum $\mathbb{R}^2$ visualisieren. @fig-concdecpred zeig das Ergebnis.</span>
<span id="cb62-865"><a href="#cb62-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-868"><a href="#cb62-868" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-869"><a href="#cb62-869" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "SVM mit Polynomial-Kernel erfasst kreisförmige Entscheidungsgrenze"</span></span>
<span id="cb62-870"><a href="#cb62-870" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-concdecpred</span></span>
<span id="cb62-871"><a href="#cb62-871" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb62-872"><a href="#cb62-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-873"><a href="#cb62-873" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb62-874"><a href="#cb62-874" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1 =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data_concentric<span class="sc">$</span>X1), <span class="fu">max</span>(data_concentric<span class="sc">$</span>X1), <span class="at">length.out =</span> <span class="dv">150</span>),</span>
<span id="cb62-875"><a href="#cb62-875" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2 =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data_concentric<span class="sc">$</span>X2), <span class="fu">max</span>(data_concentric<span class="sc">$</span>X2), <span class="at">length.out =</span> <span class="dv">150</span>)</span>
<span id="cb62-876"><a href="#cb62-876" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb62-877"><a href="#cb62-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-878"><a href="#cb62-878" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">attributes</span>(</span>
<span id="cb62-879"><a href="#cb62-879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(svm_model_poly, grid, <span class="at">decision.values =</span> T)</span>
<span id="cb62-880"><a href="#cb62-880" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>decision.values</span>
<span id="cb62-881"><a href="#cb62-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-882"><a href="#cb62-882" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> grid <span class="sc">%&gt;%</span></span>
<span id="cb62-883"><a href="#cb62-883" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vorhersagen auf dem Grid</span></span>
<span id="cb62-884"><a href="#cb62-884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb62-885"><a href="#cb62-885" aria-hidden="true" tabindex="-1"></a>    <span class="at">distanz =</span> dist,</span>
<span id="cb62-886"><a href="#cb62-886" aria-hidden="true" tabindex="-1"></a>    <span class="at">klasse =</span> <span class="fu">predict</span>(svm_model_poly, grid)</span>
<span id="cb62-887"><a href="#cb62-887" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-888"><a href="#cb62-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-889"><a href="#cb62-889" aria-hidden="true" tabindex="-1"></a><span class="co"># Support-Vektoren</span></span>
<span id="cb62-890"><a href="#cb62-890" aria-hidden="true" tabindex="-1"></a>SV <span class="ot">&lt;-</span> data_concentric <span class="sc">%&gt;%</span> </span>
<span id="cb62-891"><a href="#cb62-891" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(svm_model_poly<span class="sc">$</span>index)</span>
<span id="cb62-892"><a href="#cb62-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-893"><a href="#cb62-893" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb62-894"><a href="#cb62-894" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_concentric,</span>
<span id="cb62-895"><a href="#cb62-895" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, <span class="at">color =</span> klasse)</span>
<span id="cb62-896"><a href="#cb62-896" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb62-897"><a href="#cb62-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(grid, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">color =</span> klasse), <span class="at">alpha =</span> .<span class="dv">01</span>) <span class="sc">+</span></span>
<span id="cb62-898"><a href="#cb62-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb62-899"><a href="#cb62-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(</span>
<span id="cb62-900"><a href="#cb62-900" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> grid,</span>
<span id="cb62-901"><a href="#cb62-901" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> dist),</span>
<span id="cb62-902"><a href="#cb62-902" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="dv">0</span>,  <span class="co"># Decision boundary</span></span>
<span id="cb62-903"><a href="#cb62-903" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb62-904"><a href="#cb62-904" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-905"><a href="#cb62-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(</span>
<span id="cb62-906"><a href="#cb62-906" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> grid,</span>
<span id="cb62-907"><a href="#cb62-907" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> dist),</span>
<span id="cb62-908"><a href="#cb62-908" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),  <span class="co"># Marginal lines</span></span>
<span id="cb62-909"><a href="#cb62-909" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb62-910"><a href="#cb62-910" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.5</span></span>
<span id="cb62-911"><a href="#cb62-911" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-912"><a href="#cb62-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb62-913"><a href="#cb62-913" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> SV, <span class="at">inherit.aes =</span> F,</span>
<span id="cb62-914"><a href="#cb62-914" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2),</span>
<span id="cb62-915"><a href="#cb62-915" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb62-916"><a href="#cb62-916" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-917"><a href="#cb62-917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>(<span class="at">expand =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb62-918"><a href="#cb62-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb62-919"><a href="#cb62-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb62-920"><a href="#cb62-920" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-921"><a href="#cb62-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-922"><a href="#cb62-922" aria-hidden="true" tabindex="-1"></a>Dank des Kernel-Tricks können SVMs praktisch beliebige Formen von nicht-linearen Entscheidungsregeln lernen. Für die sinuidal verlaufende Entscheidungsgrenze im Datensatz <span class="in">`data_wavy`</span> (vgl. @fig-datawavy) ist ein radialer Kernel hilfreich:</span>
<span id="cb62-923"><a href="#cb62-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-924"><a href="#cb62-924" aria-hidden="true" tabindex="-1"></a>Der radiale Kernel ist dem polynomiellen Kernel bei der Anpassung hochflexibler Entscheidungsgrenzen überlegen, weil er selbst stark variierende Muster dank großer lokale Flexibilität besser erfassen kann. Ein polynomialer Kernel hingegen ist durch seine funktionale Form und den Polynomgrad $d$ beschränkt. Bei komplexen Grenzen muss $d$ für mehr Flexibilität der SVM groß gewählt werden, was Overfitting begünstigen kann.</span>
<span id="cb62-925"><a href="#cb62-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-926"><a href="#cb62-926" aria-hidden="true" tabindex="-1"></a>Für einen Vergleich mit der in @fig-datawavy visualisierten Anpassung des SVC trainieren nun eine SVM für <span class="in">`data_wavy`</span> mit radialem Kernel als <span class="in">`radial_svm_model`</span> für die Standardwerte <span class="in">`cost = 1`</span>, <span class="in">`coef0 = 0`</span> und <span class="in">`gamma = 1`</span>.</span>
<span id="cb62-927"><a href="#cb62-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-930"><a href="#cb62-930" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-931"><a href="#cb62-931" aria-hidden="true" tabindex="-1"></a><span class="co"># SVM mit RBF-Kernel anpassen</span></span>
<span id="cb62-932"><a href="#cb62-932" aria-hidden="true" tabindex="-1"></a>radial_svm_model <span class="ot">&lt;-</span> <span class="fu">svm</span>(</span>
<span id="cb62-933"><a href="#cb62-933" aria-hidden="true" tabindex="-1"></a>  klasse <span class="sc">~</span> x2 <span class="sc">+</span> x1, </span>
<span id="cb62-934"><a href="#cb62-934" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_wavy, </span>
<span id="cb62-935"><a href="#cb62-935" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">"radial"</span>, </span>
<span id="cb62-936"><a href="#cb62-936" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost =</span> <span class="dv">1</span>,</span>
<span id="cb62-937"><a href="#cb62-937" aria-hidden="true" tabindex="-1"></a>  <span class="at">coef0 =</span> <span class="dv">0</span>,</span>
<span id="cb62-938"><a href="#cb62-938" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma =</span> <span class="dv">1</span></span>
<span id="cb62-939"><a href="#cb62-939" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-940"><a href="#cb62-940" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-941"><a href="#cb62-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-942"><a href="#cb62-942" aria-hidden="true" tabindex="-1"></a>Wie zuvor plotten wir die trainierte Entscheidungsgrenze sowie die Margin gemeinsam mit mit den Datenpunkte im Regressor-Raum.</span>
<span id="cb62-943"><a href="#cb62-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-946"><a href="#cb62-946" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-947"><a href="#cb62-947" aria-hidden="true" tabindex="-1"></a><span class="co"># Erzeuge einen Grid für die Vorhersagen</span></span>
<span id="cb62-948"><a href="#cb62-948" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb62-949"><a href="#cb62-949" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1 =</span> <span class="fu">seq</span>(</span>
<span id="cb62-950"><a href="#cb62-950" aria-hidden="true" tabindex="-1"></a>    <span class="fu">min</span>(data_wavy<span class="sc">$</span>x1), </span>
<span id="cb62-951"><a href="#cb62-951" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(data_wavy<span class="sc">$</span>x1), </span>
<span id="cb62-952"><a href="#cb62-952" aria-hidden="true" tabindex="-1"></a>    <span class="at">length.out =</span> <span class="dv">150</span>),</span>
<span id="cb62-953"><a href="#cb62-953" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2 =</span> <span class="fu">seq</span>(</span>
<span id="cb62-954"><a href="#cb62-954" aria-hidden="true" tabindex="-1"></a>    <span class="fu">min</span>(data_wavy<span class="sc">$</span>x2), </span>
<span id="cb62-955"><a href="#cb62-955" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(data_wavy<span class="sc">$</span>x2), </span>
<span id="cb62-956"><a href="#cb62-956" aria-hidden="true" tabindex="-1"></a>    <span class="at">length.out =</span> <span class="dv">150</span></span>
<span id="cb62-957"><a href="#cb62-957" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-958"><a href="#cb62-958" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb62-959"><a href="#cb62-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-960"><a href="#cb62-960" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">attributes</span>(<span class="fu">predict</span>(radial_svm_model , grid, <span class="at">decision.values =</span> T))<span class="sc">$</span>decision.values</span>
<span id="cb62-961"><a href="#cb62-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-962"><a href="#cb62-962" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> grid <span class="sc">%&gt;%</span></span>
<span id="cb62-963"><a href="#cb62-963" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vorhersagen auf dem Grid</span></span>
<span id="cb62-964"><a href="#cb62-964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb62-965"><a href="#cb62-965" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist =</span> dist,</span>
<span id="cb62-966"><a href="#cb62-966" aria-hidden="true" tabindex="-1"></a>    <span class="at">klasse =</span> <span class="fu">predict</span>(radial_svm_model , grid)</span>
<span id="cb62-967"><a href="#cb62-967" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-968"><a href="#cb62-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-969"><a href="#cb62-969" aria-hidden="true" tabindex="-1"></a>SV <span class="ot">&lt;-</span> data_wavy <span class="sc">%&gt;%</span> </span>
<span id="cb62-970"><a href="#cb62-970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(radial_svm_model<span class="sc">$</span>index)</span>
<span id="cb62-971"><a href="#cb62-971" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-972"><a href="#cb62-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-975"><a href="#cb62-975" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-976"><a href="#cb62-976" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb62-977"><a href="#cb62-977" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "`data_wavy` mit RBF-SVM trainierte Entscheidungsgrenze"</span></span>
<span id="cb62-978"><a href="#cb62-978" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-rbfsvmwavy</span></span>
<span id="cb62-979"><a href="#cb62-979" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisiere die Entscheidungsgrenze mit ggplot2</span></span>
<span id="cb62-980"><a href="#cb62-980" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb62-981"><a href="#cb62-981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb62-982"><a href="#cb62-982" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> grid, </span>
<span id="cb62-983"><a href="#cb62-983" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">color =</span> klasse), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb62-984"><a href="#cb62-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb62-985"><a href="#cb62-985" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data_wavy,</span>
<span id="cb62-986"><a href="#cb62-986" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">color =</span> klasse)) <span class="sc">+</span></span>
<span id="cb62-987"><a href="#cb62-987" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-988"><a href="#cb62-988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(</span>
<span id="cb62-989"><a href="#cb62-989" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> grid,</span>
<span id="cb62-990"><a href="#cb62-990" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> dist),</span>
<span id="cb62-991"><a href="#cb62-991" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="dv">0</span>,  <span class="co"># Decision boundary</span></span>
<span id="cb62-992"><a href="#cb62-992" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb62-993"><a href="#cb62-993" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-994"><a href="#cb62-994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(</span>
<span id="cb62-995"><a href="#cb62-995" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> grid,</span>
<span id="cb62-996"><a href="#cb62-996" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> dist),</span>
<span id="cb62-997"><a href="#cb62-997" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),  <span class="co"># Marginal lines</span></span>
<span id="cb62-998"><a href="#cb62-998" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb62-999"><a href="#cb62-999" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb62-1000"><a href="#cb62-1000" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb62-1001"><a href="#cb62-1001" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-1002"><a href="#cb62-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb62-1003"><a href="#cb62-1003" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> SV, <span class="at">inherit.aes =</span> F,</span>
<span id="cb62-1004"><a href="#cb62-1004" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2),</span>
<span id="cb62-1005"><a href="#cb62-1005" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">1</span>, </span>
<span id="cb62-1006"><a href="#cb62-1006" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb62-1007"><a href="#cb62-1007" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-1008"><a href="#cb62-1008" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-1009"><a href="#cb62-1009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb62-1010"><a href="#cb62-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"X1"</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb62-1011"><a href="#cb62-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"X2"</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb62-1012"><a href="#cb62-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb62-1013"><a href="#cb62-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb62-1014"><a href="#cb62-1014" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1015"><a href="#cb62-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1016"><a href="#cb62-1016" aria-hidden="true" tabindex="-1"></a>Ein Vergleich von @fig-rbfsvmwavy mit @fig-svcwavy zeigt, dass die SVM mit radialem Kernel im Objekt <span class="in">`radial_svm_model`</span> den nicht-linearen Verlauf der sinuidalen Entscheidungsgrenze deutlich besser erfasst als der SVC in <span class="in">`svc_wavy`</span>. Der Anteil fehlklassifizierter Beobachtungen liegt bei weniger als 10\%.</span>
<span id="cb62-1017"><a href="#cb62-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1020"><a href="#cb62-1020" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1021"><a href="#cb62-1021" aria-hidden="true" tabindex="-1"></a><span class="co"># Fehlerrate von 'radial_svm_model'</span></span>
<span id="cb62-1022"><a href="#cb62-1022" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">mean</span>(</span>
<span id="cb62-1023"><a href="#cb62-1023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(radial_svm_model) <span class="sc">==</span> data_wavy<span class="sc">$</span>klasse</span>
<span id="cb62-1024"><a href="#cb62-1024" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-1025"><a href="#cb62-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1026"><a href="#cb62-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1027"><a href="#cb62-1027" aria-hidden="true" tabindex="-1"></a><span class="fu">### Overfitting</span></span>
<span id="cb62-1028"><a href="#cb62-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1029"><a href="#cb62-1029" aria-hidden="true" tabindex="-1"></a>Der in Abschnitt @sec-scv beschriebene Einfluss des <span class="in">`cost`</span>-Parameters auf die Klassifikationsleistung von SVCs überträgt sich auch auf SVMs. Bei der Anpassung nichtlinearer Entscheidungsgrenzen mit nichtlinearen Kernelfunktionen müssen neben cost auch die Kernel-Parameter sorgfältig gewählt werden, um Overfitting zu vermeiden. Dabei bestehen Interdependenzen zwischen den Parametern. In den hier behandelten Beispielen mit einem zweidimensionalen Merkmalsraum lassen sich diese Effekte gut grafisch darstellen: Bei einer SVM mit radialem Kernel bewirken höhere <span class="in">`gamma`</span>-Werte eine stärker lokal geprägte Entscheidungsgrenze, die sich enger um benachbarte Datenpunkte legt. Höhere <span class="in">`cost`</span>-Werte führen zu engeren Margins, wodurch weniger Support-Vektoren zugelassen werden. Dies kann die Varianz der Entscheidungsgrenze erhöhen, da der Algorithmus sich stärker an einzelne Datenpunkte anpasst und die Schätzung tendenziell weiter von der wahren Grenze abweichen kann. Zu große Werte führen also jeweils zu einer Überanpassung an die Daten.</span>
<span id="cb62-1030"><a href="#cb62-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1031"><a href="#cb62-1031" aria-hidden="true" tabindex="-1"></a>Wir illustrieren Overfitting durch eine ungünstige Parameterwahl für eine SVM mit Radial-Kernek und den Datensatz <span class="in">`data_wavy`</span>.</span>
<span id="cb62-1032"><a href="#cb62-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1035"><a href="#cb62-1035" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1036"><a href="#cb62-1036" aria-hidden="true" tabindex="-1"></a><span class="co"># SVM mit ungünstiger Parameter-Kombination</span></span>
<span id="cb62-1037"><a href="#cb62-1037" aria-hidden="true" tabindex="-1"></a>radial_svm_overfit <span class="ot">&lt;-</span> <span class="fu">svm</span>(</span>
<span id="cb62-1038"><a href="#cb62-1038" aria-hidden="true" tabindex="-1"></a>  klasse <span class="sc">~</span> x2 <span class="sc">+</span> x1, </span>
<span id="cb62-1039"><a href="#cb62-1039" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_wavy, </span>
<span id="cb62-1040"><a href="#cb62-1040" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">"radial"</span>, </span>
<span id="cb62-1041"><a href="#cb62-1041" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost =</span> <span class="dv">1000</span>,</span>
<span id="cb62-1042"><a href="#cb62-1042" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma =</span> <span class="dv">10</span></span>
<span id="cb62-1043"><a href="#cb62-1043" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-1044"><a href="#cb62-1044" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1045"><a href="#cb62-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1048"><a href="#cb62-1048" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1049"><a href="#cb62-1049" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb62-1050"><a href="#cb62-1050" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1 =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data_wavy<span class="sc">$</span>x1), <span class="fu">max</span>(data_wavy<span class="sc">$</span>x1), <span class="at">length.out =</span> <span class="dv">150</span>),</span>
<span id="cb62-1051"><a href="#cb62-1051" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2 =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data_wavy<span class="sc">$</span>x2), <span class="fu">max</span>(data_wavy<span class="sc">$</span>x2), <span class="at">length.out =</span> <span class="dv">150</span>)</span>
<span id="cb62-1052"><a href="#cb62-1052" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb62-1053"><a href="#cb62-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1054"><a href="#cb62-1054" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">attributes</span>(<span class="fu">predict</span>(radial_svm_overfit , grid, <span class="at">decision.values =</span> T))<span class="sc">$</span>decision.values</span>
<span id="cb62-1055"><a href="#cb62-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1056"><a href="#cb62-1056" aria-hidden="true" tabindex="-1"></a>grid_overfit <span class="ot">&lt;-</span> grid <span class="sc">%&gt;%</span></span>
<span id="cb62-1057"><a href="#cb62-1057" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vorhersagen auf dem Grid</span></span>
<span id="cb62-1058"><a href="#cb62-1058" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb62-1059"><a href="#cb62-1059" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist =</span> dist,</span>
<span id="cb62-1060"><a href="#cb62-1060" aria-hidden="true" tabindex="-1"></a>    <span class="at">klasse =</span> <span class="fu">predict</span>(radial_svm_overfit , grid)</span>
<span id="cb62-1061"><a href="#cb62-1061" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-1062"><a href="#cb62-1062" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1063"><a href="#cb62-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1066"><a href="#cb62-1066" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1067"><a href="#cb62-1067" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "`data_wavy`: Overfitting der Entscheidungsgrenze mit RBF-SVM"</span></span>
<span id="cb62-1068"><a href="#cb62-1068" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-rbfsvmof</span></span>
<span id="cb62-1069"><a href="#cb62-1069" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb62-1070"><a href="#cb62-1070" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisiere die Entscheidungsgrenze mit ggplot2</span></span>
<span id="cb62-1071"><a href="#cb62-1071" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb62-1072"><a href="#cb62-1072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb62-1073"><a href="#cb62-1073" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> grid_overfit, </span>
<span id="cb62-1074"><a href="#cb62-1074" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">color =</span> klasse), <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb62-1075"><a href="#cb62-1075" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb62-1076"><a href="#cb62-1076" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data_wavy,</span>
<span id="cb62-1077"><a href="#cb62-1077" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">color =</span> klasse)) <span class="sc">+</span></span>
<span id="cb62-1078"><a href="#cb62-1078" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-1079"><a href="#cb62-1079" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(</span>
<span id="cb62-1080"><a href="#cb62-1080" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> grid_overfit,</span>
<span id="cb62-1081"><a href="#cb62-1081" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> dist),</span>
<span id="cb62-1082"><a href="#cb62-1082" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="dv">0</span>,  <span class="co"># Decision boundary</span></span>
<span id="cb62-1083"><a href="#cb62-1083" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb62-1084"><a href="#cb62-1084" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-1085"><a href="#cb62-1085" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(</span>
<span id="cb62-1086"><a href="#cb62-1086" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> grid_overfit,</span>
<span id="cb62-1087"><a href="#cb62-1087" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> dist),</span>
<span id="cb62-1088"><a href="#cb62-1088" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),  <span class="co"># Marginal lines</span></span>
<span id="cb62-1089"><a href="#cb62-1089" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb62-1090"><a href="#cb62-1090" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb62-1091"><a href="#cb62-1091" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb62-1092"><a href="#cb62-1092" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-1093"><a href="#cb62-1093" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-1094"><a href="#cb62-1094" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb62-1095"><a href="#cb62-1095" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"X1"</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb62-1096"><a href="#cb62-1096" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"X2"</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb62-1097"><a href="#cb62-1097" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb62-1098"><a href="#cb62-1098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb62-1099"><a href="#cb62-1099" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1100"><a href="#cb62-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1103"><a href="#cb62-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1104"><a href="#cb62-1104" aria-hidden="true" tabindex="-1"></a><span class="co"># Fehlklassifikationsrate bei Overfitting:</span></span>
<span id="cb62-1105"><a href="#cb62-1105" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">mean</span>(</span>
<span id="cb62-1106"><a href="#cb62-1106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(radial_svm_overfit) <span class="sc">==</span> data_wavy<span class="sc">$</span>klasse</span>
<span id="cb62-1107"><a href="#cb62-1107" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-1108"><a href="#cb62-1108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1109"><a href="#cb62-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1110"><a href="#cb62-1110" aria-hidden="true" tabindex="-1"></a>Das Modell <span class="in">`radial_svm_overfit`</span> leidet unter Overfiting: In @fig-rbfsvmof sehen wir, dass die gelernte Entscheidungsgrenze zu stark durch lokale Muster aufgrund der Überlappung der Klassen geprägt ist. Entsprechend ist die Klassifikation der für das Training genutzen Datenpunkte für <span class="in">`radial_svm_overfit`</span> etwas genauer <span class="in">`radial_svm_model`</span>. Diese Überanpassung resultiert tendentiell in einer schlechteren Generalisierung von <span class="in">`radial_svm_overfit`</span> in Vorhersagen unbekannter Datenpunkte.</span>
<span id="cb62-1111"><a href="#cb62-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1112"><a href="#cb62-1112" aria-hidden="true" tabindex="-1"></a>Mit <span class="in">`e1071::tune()`</span> können wir optimale Parameterwerte aus einem Grid mit Cross Validation schätzen. Wir übergeben hierzu die Methode (<span class="in">`METHOD`</span>), die Spezifikation des Modells wie in <span class="in">`svm()`</span> und dem Argument <span class="in">`ranges`</span> die zu berücksichtigenden Parameter-Werte als Liste.</span>
<span id="cb62-1113"><a href="#cb62-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1114"><a href="#cb62-1114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, cache=TRUE}</span></span>
<span id="cb62-1115"><a href="#cb62-1115" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1234)</span></span>
<span id="cb62-1116"><a href="#cb62-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1117"><a href="#cb62-1117" aria-hidden="true" tabindex="-1"></a><span class="in"># Cross-Validation für Parameter in radialer SVM</span></span>
<span id="cb62-1118"><a href="#cb62-1118" aria-hidden="true" tabindex="-1"></a><span class="in">radial_svm_tuned &lt;- tune(</span></span>
<span id="cb62-1119"><a href="#cb62-1119" aria-hidden="true" tabindex="-1"></a><span class="in">  METHOD = svm, </span></span>
<span id="cb62-1120"><a href="#cb62-1120" aria-hidden="true" tabindex="-1"></a><span class="in">  klasse ~ x2 + x1, </span></span>
<span id="cb62-1121"><a href="#cb62-1121" aria-hidden="true" tabindex="-1"></a><span class="in">  data = data_wavy, </span></span>
<span id="cb62-1122"><a href="#cb62-1122" aria-hidden="true" tabindex="-1"></a><span class="in">  kernel = "radial",</span></span>
<span id="cb62-1123"><a href="#cb62-1123" aria-hidden="true" tabindex="-1"></a><span class="in">  # Parameter-Werte festlegen</span></span>
<span id="cb62-1124"><a href="#cb62-1124" aria-hidden="true" tabindex="-1"></a><span class="in">  ranges = list(</span></span>
<span id="cb62-1125"><a href="#cb62-1125" aria-hidden="true" tabindex="-1"></a><span class="in">    cost = c(1, 2, 4, 6),</span></span>
<span id="cb62-1126"><a href="#cb62-1126" aria-hidden="true" tabindex="-1"></a><span class="in">    gamma = c(0, .01, .05, .1, .25, .5, .8, 1, 2, 3)</span></span>
<span id="cb62-1127"><a href="#cb62-1127" aria-hidden="true" tabindex="-1"></a><span class="in">  )  </span></span>
<span id="cb62-1128"><a href="#cb62-1128" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb62-1129"><a href="#cb62-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1130"><a href="#cb62-1130" aria-hidden="true" tabindex="-1"></a><span class="in"># CV-Ergebnisse auslesen</span></span>
<span id="cb62-1131"><a href="#cb62-1131" aria-hidden="true" tabindex="-1"></a><span class="in">radial_svm_tuned$performances</span></span>
<span id="cb62-1132"><a href="#cb62-1132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1133"><a href="#cb62-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1134"><a href="#cb62-1134" aria-hidden="true" tabindex="-1"></a><span class="in">`error`</span> ist die mithilfe von Cross-Validation geschätzte Fehlklassifikationsrate für unbekannte Beobachtungen. Die Ergebnisse verdeutlichen, dass die Modellleistung stark von der Fähigkeit des radialen Kernels abhängt, Nicht-Linearitäten zu erfassen: Bereits geringe <span class="in">`gamma`</span>-Werte führen zu einer signifikanten Reduktion der Fehlklassifikationsrate im Vergleich zu einem trivialen Modell mit <span class="in">`gamma = 0`</span>.^<span class="co">[</span><span class="ot">Für `gamma = 0` wird lediglich eine Konstante angepasst, es findet also extremes "Underfitting" statt: Das Modell ist dann nicht besser als die zufällige Klassifikation mit Wahrscheinlichkeiten, die den relativen Häufigkeiten der Klassen im Datensatz entsprechen (*baseline accuracy*).</span><span class="co">]</span></span>
<span id="cb62-1135"><a href="#cb62-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1138"><a href="#cb62-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1139"><a href="#cb62-1139" aria-hidden="true" tabindex="-1"></a><span class="co"># Beste Parameter-Kombination anzeigen</span></span>
<span id="cb62-1140"><a href="#cb62-1140" aria-hidden="true" tabindex="-1"></a>radial_svm_tuned<span class="sc">$</span>best.parameters</span>
<span id="cb62-1141"><a href="#cb62-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1142"><a href="#cb62-1142" aria-hidden="true" tabindex="-1"></a><span class="co"># Beste SVM auslesen</span></span>
<span id="cb62-1143"><a href="#cb62-1143" aria-hidden="true" tabindex="-1"></a>radial_svm_tuned<span class="sc">$</span>best.model</span>
<span id="cb62-1144"><a href="#cb62-1144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1145"><a href="#cb62-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1146"><a href="#cb62-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1147"><a href="#cb62-1147" aria-hidden="true" tabindex="-1"></a><span class="fu">## Beispiel: Vorhersage von Kaufentscheidungen</span></span>
<span id="cb62-1148"><a href="#cb62-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1149"><a href="#cb62-1149" aria-hidden="true" tabindex="-1"></a>Der mit dem R-Paket <span class="in">`ISLR`</span> <span class="co">[</span><span class="ot">@Jamesetal2021</span><span class="co">]</span> Datensatz <span class="in">`OJ`</span> enthält Beobachtungen von 1070 Orangensaft-Verkäufen bei denen der Kunde entweder die Mark "Citrus Hill" (CH) oder "Minute Maid" (MM) gekauft hat. @tbl-varsoj enthält eine Beschreibung der verfügbaren Variablen.</span>
<span id="cb62-1150"><a href="#cb62-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1151"><a href="#cb62-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1152"><a href="#cb62-1152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=F}</span></span>
<span id="cb62-1153"><a href="#cb62-1153" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: "Datensatz `OJ`: Übersicht der Variablen"</span></span>
<span id="cb62-1154"><a href="#cb62-1154" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: tbl-varsoj</span></span>
<span id="cb62-1155"><a href="#cb62-1155" aria-hidden="true" tabindex="-1"></a><span class="in">library(tibble)</span></span>
<span id="cb62-1156"><a href="#cb62-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1157"><a href="#cb62-1157" aria-hidden="true" tabindex="-1"></a><span class="in"># Erstellen der tibble mit den Variablennamen und den gekürzten Beschreibungen</span></span>
<span id="cb62-1158"><a href="#cb62-1158" aria-hidden="true" tabindex="-1"></a><span class="in">daten_tibble &lt;- tibble(</span></span>
<span id="cb62-1159"><a href="#cb62-1159" aria-hidden="true" tabindex="-1"></a><span class="in">  Variable = c("Purchase", "WeekofPurchase", "StoreID", "PriceCH", "PriceMM", </span></span>
<span id="cb62-1160"><a href="#cb62-1160" aria-hidden="true" tabindex="-1"></a><span class="in">               "DiscCH", "DiscMM", "SpecialCH", "SpecialMM", "LoyalCH", </span></span>
<span id="cb62-1161"><a href="#cb62-1161" aria-hidden="true" tabindex="-1"></a><span class="in">               "SalePriceMM", "SalePriceCH", "PriceDiff", "Store7", </span></span>
<span id="cb62-1162"><a href="#cb62-1162" aria-hidden="true" tabindex="-1"></a><span class="in">               "PctDiscMM", "PctDiscCH", "ListPriceDiff", "STORE"),</span></span>
<span id="cb62-1163"><a href="#cb62-1163" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb62-1164"><a href="#cb62-1164" aria-hidden="true" tabindex="-1"></a><span class="in">  Beschreibung = c("Kauf von CH oder MM Orangensaft", </span></span>
<span id="cb62-1165"><a href="#cb62-1165" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Kaufwoche", </span></span>
<span id="cb62-1166"><a href="#cb62-1166" aria-hidden="true" tabindex="-1"></a><span class="in">                   "ID des Geschäfts", </span></span>
<span id="cb62-1167"><a href="#cb62-1167" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Preis für Citrus Hill", </span></span>
<span id="cb62-1168"><a href="#cb62-1168" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Preis für Minute Maid", </span></span>
<span id="cb62-1169"><a href="#cb62-1169" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Rabatt auf Citrus Hill", </span></span>
<span id="cb62-1170"><a href="#cb62-1170" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Rabatt auf Minute Maid", </span></span>
<span id="cb62-1171"><a href="#cb62-1171" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Sonderangebot für Citrus Hill", </span></span>
<span id="cb62-1172"><a href="#cb62-1172" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Sonderangebot für Minute Maid", </span></span>
<span id="cb62-1173"><a href="#cb62-1173" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Markentreue für Citrus Hill", </span></span>
<span id="cb62-1174"><a href="#cb62-1174" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Verkaufspreis für Minute Maid", </span></span>
<span id="cb62-1175"><a href="#cb62-1175" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Verkaufspreis für Citrus Hill", </span></span>
<span id="cb62-1176"><a href="#cb62-1176" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Unterschied Verkaufspreise MM - CH", </span></span>
<span id="cb62-1177"><a href="#cb62-1177" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Verkauf in Geschäft 7 (Ja/Nein)", </span></span>
<span id="cb62-1178"><a href="#cb62-1178" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Prozentualer Rabatt für MM", </span></span>
<span id="cb62-1179"><a href="#cb62-1179" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Prozentualer Rabatt für CH", </span></span>
<span id="cb62-1180"><a href="#cb62-1180" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Unterschied Listenpreise MM - CH", </span></span>
<span id="cb62-1181"><a href="#cb62-1181" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Welches der 5 möglichen Geschäfte")</span></span>
<span id="cb62-1182"><a href="#cb62-1182" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb62-1183"><a href="#cb62-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1184"><a href="#cb62-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1185"><a href="#cb62-1185" aria-hidden="true" tabindex="-1"></a><span class="in">daten_tibble %&gt;%</span></span>
<span id="cb62-1186"><a href="#cb62-1186" aria-hidden="true" tabindex="-1"></a><span class="in">  gt::gt() %&gt;%</span></span>
<span id="cb62-1187"><a href="#cb62-1187" aria-hidden="true" tabindex="-1"></a><span class="in">  tabopts</span></span>
<span id="cb62-1188"><a href="#cb62-1188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1189"><a href="#cb62-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1190"><a href="#cb62-1190" aria-hidden="true" tabindex="-1"></a>Nach Laden des Pakets fügen wir den Datensatz <span class="in">`OJ`</span> der Arbeitsumgebung hinzu. Wir transformieren <span class="in">`WeekofPurchase`</span> in eine leichter intepretierbare Wochenangabe und definieren die kategorischen Variablen als Typ <span class="in">`factor`</span>.</span>
<span id="cb62-1191"><a href="#cb62-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1194"><a href="#cb62-1194" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1195"><a href="#cb62-1195" aria-hidden="true" tabindex="-1"></a><span class="in"># Daten bereinigen und formatieren</span></span>
<span id="cb62-1196"><a href="#cb62-1196" aria-hidden="true" tabindex="-1"></a><span class="in">OJ &lt;- OJ %&gt;% </span></span>
<span id="cb62-1197"><a href="#cb62-1197" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb62-1198"><a href="#cb62-1198" aria-hidden="true" tabindex="-1"></a><span class="in">    StoreID = as_factor(StoreID),</span></span>
<span id="cb62-1199"><a href="#cb62-1199" aria-hidden="true" tabindex="-1"></a><span class="in">    WeekofPurchase = (WeekofPurchase - 226) %&gt;% </span></span>
<span id="cb62-1200"><a href="#cb62-1200" aria-hidden="true" tabindex="-1"></a><span class="in">      as.factor()</span></span>
<span id="cb62-1201"><a href="#cb62-1201" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb62-1202"><a href="#cb62-1202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1203"><a href="#cb62-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1204"><a href="#cb62-1204" aria-hidden="true" tabindex="-1"></a>Der nächste Code-Chunk produziert eine Grafik für die Gesamtenwicklung der Verkäufe über das Jahr.</span>
<span id="cb62-1205"><a href="#cb62-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1208"><a href="#cb62-1208" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1209"><a href="#cb62-1209" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Saft-Verkäufe im Zeitverlauf"</span></span>
<span id="cb62-1210"><a href="#cb62-1210" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-sales</span></span>
<span id="cb62-1211"><a href="#cb62-1211" aria-hidden="true" tabindex="-1"></a><span class="in"># Verkäufe im Zeitverlauf Visualisieren</span></span>
<span id="cb62-1212"><a href="#cb62-1212" aria-hidden="true" tabindex="-1"></a><span class="in">OJ %&gt;% </span></span>
<span id="cb62-1213"><a href="#cb62-1213" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(</span></span>
<span id="cb62-1214"><a href="#cb62-1214" aria-hidden="true" tabindex="-1"></a><span class="in">    mapping = aes(</span></span>
<span id="cb62-1215"><a href="#cb62-1215" aria-hidden="true" tabindex="-1"></a><span class="in">      x = as.factor(WeekofPurchase), </span></span>
<span id="cb62-1216"><a href="#cb62-1216" aria-hidden="true" tabindex="-1"></a><span class="in">      fill = as.factor(Purchase)</span></span>
<span id="cb62-1217"><a href="#cb62-1217" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb62-1218"><a href="#cb62-1218" aria-hidden="true" tabindex="-1"></a><span class="in">    ) + </span></span>
<span id="cb62-1219"><a href="#cb62-1219" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(position = "stack") +</span></span>
<span id="cb62-1220"><a href="#cb62-1220" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "Woche des Verkaufs", y = "Count", fill = "Produkt") + </span></span>
<span id="cb62-1221"><a href="#cb62-1221" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_cowplot() +  </span></span>
<span id="cb62-1222"><a href="#cb62-1222" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(expand = 0) +</span></span>
<span id="cb62-1223"><a href="#cb62-1223" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb62-1224"><a href="#cb62-1224" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.x = element_text(angle = 90, hjust = 1),</span></span>
<span id="cb62-1225"><a href="#cb62-1225" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position = "top"</span></span>
<span id="cb62-1226"><a href="#cb62-1226" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb62-1227"><a href="#cb62-1227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1228"><a href="#cb62-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1229"><a href="#cb62-1229" aria-hidden="true" tabindex="-1"></a>Mit <span class="in">`ggcorrplot::ggcorrplot()`</span> erzeugen wir einen Korrelationsplot für die numerischen Variablen des Datensatzes, um die linearen Zusammenhänge zwischen den Preis-, Rabatt- und Verkaufsvariablen einzuschätzen.</span>
<span id="cb62-1230"><a href="#cb62-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1233"><a href="#cb62-1233" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1234"><a href="#cb62-1234" aria-hidden="true" tabindex="-1"></a><span class="in">#| figfig-width: 6</span></span>
<span id="cb62-1235"><a href="#cb62-1235" aria-hidden="true" tabindex="-1"></a><span class="in">library(ISLR)</span></span>
<span id="cb62-1236"><a href="#cb62-1236" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggcorrplot)</span></span>
<span id="cb62-1237"><a href="#cb62-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1238"><a href="#cb62-1238" aria-hidden="true" tabindex="-1"></a><span class="in"># Datensatz OJ aus ISLR laden</span></span>
<span id="cb62-1239"><a href="#cb62-1239" aria-hidden="true" tabindex="-1"></a><span class="in">data(OJ, package = "ISLR")</span></span>
<span id="cb62-1240"><a href="#cb62-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1241"><a href="#cb62-1241" aria-hidden="true" tabindex="-1"></a><span class="in"># Korellationsplot</span></span>
<span id="cb62-1242"><a href="#cb62-1242" aria-hidden="true" tabindex="-1"></a><span class="in">ggcorrplot(</span></span>
<span id="cb62-1243"><a href="#cb62-1243" aria-hidden="true" tabindex="-1"></a><span class="in">  corr = cor(</span></span>
<span id="cb62-1244"><a href="#cb62-1244" aria-hidden="true" tabindex="-1"></a><span class="in">    OJ %&gt;% select(</span></span>
<span id="cb62-1245"><a href="#cb62-1245" aria-hidden="true" tabindex="-1"></a><span class="in">      where(is.numeric))</span></span>
<span id="cb62-1246"><a href="#cb62-1246" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb62-1247"><a href="#cb62-1247" aria-hidden="true" tabindex="-1"></a><span class="in">  hc.order = TRUE, </span></span>
<span id="cb62-1248"><a href="#cb62-1248" aria-hidden="true" tabindex="-1"></a><span class="in">  type = "lower",</span></span>
<span id="cb62-1249"><a href="#cb62-1249" aria-hidden="true" tabindex="-1"></a><span class="in">  outline.col = "white"</span></span>
<span id="cb62-1250"><a href="#cb62-1250" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb62-1251"><a href="#cb62-1251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1252"><a href="#cb62-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1253"><a href="#cb62-1253" aria-hidden="true" tabindex="-1"></a>Die Abbildung zeigt, dass es starke Korellation zwischen Discount-Indikatoren (<span class="in">`DiscCH`</span>, <span class="in">`DiscMM`</span>) und den jeweiligen Prozent-Beträgen (<span class="in">`PctDiscCH`</span>, <span class="in">`PctDiscMM`</span>) sowie der Preis-Differenz (<span class="in">`PriceDiff`</span>) gibt. Die Variablen <span class="in">`STORE`</span> und <span class="in">`Store7`</span> enthalten redundante Informationen über das Geschäft, in dem der Verkauf stattfand. Wir entfernen diese Variablen bevor der Datensatz mit <span class="in">`rsample::initial_split()`</span> in Trainings- und Test-Partitionen eingeteilt wird.</span>
<span id="cb62-1254"><a href="#cb62-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1255"><a href="#cb62-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1258"><a href="#cb62-1258" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1259"><a href="#cb62-1259" aria-hidden="true" tabindex="-1"></a><span class="in"># Datenaufteilung</span></span>
<span id="cb62-1260"><a href="#cb62-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1261"><a href="#cb62-1261" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1234)</span></span>
<span id="cb62-1262"><a href="#cb62-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1263"><a href="#cb62-1263" aria-hidden="true" tabindex="-1"></a><span class="in">oj_split &lt;- initial_split(</span></span>
<span id="cb62-1264"><a href="#cb62-1264" aria-hidden="true" tabindex="-1"></a><span class="in">  data = OJ %&gt;% </span></span>
<span id="cb62-1265"><a href="#cb62-1265" aria-hidden="true" tabindex="-1"></a><span class="in">    dplyr::select(</span></span>
<span id="cb62-1266"><a href="#cb62-1266" aria-hidden="true" tabindex="-1"></a><span class="in">      -STORE, </span></span>
<span id="cb62-1267"><a href="#cb62-1267" aria-hidden="true" tabindex="-1"></a><span class="in">      -Store7, </span></span>
<span id="cb62-1268"><a href="#cb62-1268" aria-hidden="true" tabindex="-1"></a><span class="in">      -WeekofPurchase, </span></span>
<span id="cb62-1269"><a href="#cb62-1269" aria-hidden="true" tabindex="-1"></a><span class="in">      -DiscCH,</span></span>
<span id="cb62-1270"><a href="#cb62-1270" aria-hidden="true" tabindex="-1"></a><span class="in">      -DiscMM</span></span>
<span id="cb62-1271"><a href="#cb62-1271" aria-hidden="true" tabindex="-1"></a><span class="in">    ), </span></span>
<span id="cb62-1272"><a href="#cb62-1272" aria-hidden="true" tabindex="-1"></a><span class="in">  prop = .8, </span></span>
<span id="cb62-1273"><a href="#cb62-1273" aria-hidden="true" tabindex="-1"></a><span class="in">  strata = Purchase</span></span>
<span id="cb62-1274"><a href="#cb62-1274" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb62-1275"><a href="#cb62-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1276"><a href="#cb62-1276" aria-hidden="true" tabindex="-1"></a><span class="in">oj_train &lt;- training(oj_split)</span></span>
<span id="cb62-1277"><a href="#cb62-1277" aria-hidden="true" tabindex="-1"></a><span class="in">oj_test &lt;- testing(oj_split)</span></span>
<span id="cb62-1278"><a href="#cb62-1278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1279"><a href="#cb62-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1280"><a href="#cb62-1280" aria-hidden="true" tabindex="-1"></a>Mit <span class="in">`recipe::recipe()`</span> können Datensätze systematisch für die Anwendung von Machine-Learning-Methoden vorbereitet werden. Im nachfolgenden Code-Chunk erstellen wir das recipe <span class="in">`blueprint`</span>: Wir skalieren und zentrieren wir numerische Variablen, was sicherstellt, dass die Regresoren auf einer vergleichbaren Skala liegen, sodass distanzbasierte Algorithmen nicht durch unterschiedlliche Skalierungen Variablen beeinflusst werden. Kategorische Variablen mit mehr als zwei Ausprägungen werden mithilfe von *One-Hot-Encoding* in binäre Dummy-Variablen umgewandelt. Dieser Ansatz sorgt für eine konsistente und reproduzierbare Datenvorverarbeitung jenseits der Anwendungen mit SVMs.</span>
<span id="cb62-1281"><a href="#cb62-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1284"><a href="#cb62-1284" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1285"><a href="#cb62-1285" aria-hidden="true" tabindex="-1"></a><span class="in"># Recipe für Datenvorverarbeitung definieren</span></span>
<span id="cb62-1286"><a href="#cb62-1286" aria-hidden="true" tabindex="-1"></a><span class="in">blueprint &lt;- recipe(</span></span>
<span id="cb62-1287"><a href="#cb62-1287" aria-hidden="true" tabindex="-1"></a><span class="in">  Purchase ~ ., </span></span>
<span id="cb62-1288"><a href="#cb62-1288" aria-hidden="true" tabindex="-1"></a><span class="in">  data = oj_train</span></span>
<span id="cb62-1289"><a href="#cb62-1289" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb62-1290"><a href="#cb62-1290" aria-hidden="true" tabindex="-1"></a><span class="in">  step_center(all_numeric(), -all_outcomes()) %&gt;%</span></span>
<span id="cb62-1291"><a href="#cb62-1291" aria-hidden="true" tabindex="-1"></a><span class="in">  step_scale(all_numeric(), -all_outcomes()) %&gt;%</span></span>
<span id="cb62-1292"><a href="#cb62-1292" aria-hidden="true" tabindex="-1"></a><span class="in">  step_dummy(all_nominal(), -all_outcomes(), one_hot = TRUE)</span></span>
<span id="cb62-1293"><a href="#cb62-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1294"><a href="#cb62-1294" aria-hidden="true" tabindex="-1"></a><span class="in">blueprint</span></span>
<span id="cb62-1295"><a href="#cb62-1295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1296"><a href="#cb62-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1297"><a href="#cb62-1297" aria-hidden="true" tabindex="-1"></a>Mit <span class="in">`recipes::prep()`</span> bestimmen wir die nötigen Parameter für die Vorbereitung von Datensätzen mit dem in <span class="in">`oj_train`</span> enthaltenen. <span class="in">`recipes::bake()`</span> wendet die Transformationen an. Wir zeugen eine Übersicht der transformierten Trainingsdaten mit <span class="in">`skimr::skim`</span>.</span>
<span id="cb62-1298"><a href="#cb62-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1301"><a href="#cb62-1301" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1302"><a href="#cb62-1302" aria-hidden="true" tabindex="-1"></a><span class="in"># Vorbereiten:</span></span>
<span id="cb62-1303"><a href="#cb62-1303" aria-hidden="true" tabindex="-1"></a><span class="in">prepare &lt;- prep(blueprint, training = oj_train)</span></span>
<span id="cb62-1304"><a href="#cb62-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1305"><a href="#cb62-1305" aria-hidden="true" tabindex="-1"></a><span class="in"># Datensätze transformieren</span></span>
<span id="cb62-1306"><a href="#cb62-1306" aria-hidden="true" tabindex="-1"></a><span class="in">baked_train &lt;- bake(prepare, new_data = oj_train)</span></span>
<span id="cb62-1307"><a href="#cb62-1307" aria-hidden="true" tabindex="-1"></a><span class="in">baked_test &lt;- bake(prepare, new_data = oj_test)</span></span>
<span id="cb62-1308"><a href="#cb62-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1309"><a href="#cb62-1309" aria-hidden="true" tabindex="-1"></a><span class="in"># Überblick</span></span>
<span id="cb62-1310"><a href="#cb62-1310" aria-hidden="true" tabindex="-1"></a><span class="in">skim(baked_train)</span></span>
<span id="cb62-1311"><a href="#cb62-1311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1312"><a href="#cb62-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1313"><a href="#cb62-1313" aria-hidden="true" tabindex="-1"></a>Die nächsten Code chunks zeigen, wie <span class="in">`parsnip`</span> SVMs mit lineare, polynomialen und radialen Kernel-funktionen für die Klassifikation der gekauften Orangensaft-Marke <span class="in">`Purchase`</span> angepasst werden können. Hierbei wird die Implmentierung von <span class="in">`ksvm()`</span> im Paket <span class="in">`kernlab`</span> genutzt. Für jeden dieser drei Ansätze definieren wir einen separaten Workflow für 10-fache Cross Validation der jeweiligen Modellparameter.^<span class="co">[</span><span class="ot">Aufgrund der geringen Rechenleistung der für die interaktiven Code-Chunks genutzen Webr-Implementierung betrachten wir hier beispielhafte, kleine Parameter-Gitter.</span><span class="co">]</span> Als Kriterium für die Modellleistung verwernden wir <span class="in">`accuracy`</span>, den Anteil korrekter Klassifikationen. Nach Anpassung des als optimal ermittelten Modells evaluieren wir die Vorhersagegüte der Modelle auf dem Testdatensatz <span class="in">`bake_train`</span>.</span>
<span id="cb62-1314"><a href="#cb62-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1315"><a href="#cb62-1315" aria-hidden="true" tabindex="-1"></a>**SVM: Linearer Kernel**</span>
<span id="cb62-1316"><a href="#cb62-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1319"><a href="#cb62-1319" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1320"><a href="#cb62-1320" aria-hidden="true" tabindex="-1"></a><span class="in">library(tune)</span></span>
<span id="cb62-1321"><a href="#cb62-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1322"><a href="#cb62-1322" aria-hidden="true" tabindex="-1"></a><span class="in"># Lineare SVM mit Kreuzvalidierung</span></span>
<span id="cb62-1323"><a href="#cb62-1323" aria-hidden="true" tabindex="-1"></a><span class="in">linear_svm_spec_cv &lt;- svm_linear() %&gt;%</span></span>
<span id="cb62-1324"><a href="#cb62-1324" aria-hidden="true" tabindex="-1"></a><span class="in">  set_engine(</span></span>
<span id="cb62-1325"><a href="#cb62-1325" aria-hidden="true" tabindex="-1"></a><span class="in">    engine = "kernlab",</span></span>
<span id="cb62-1326"><a href="#cb62-1326" aria-hidden="true" tabindex="-1"></a><span class="in">    cost = tune()</span></span>
<span id="cb62-1327"><a href="#cb62-1327" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb62-1328"><a href="#cb62-1328" aria-hidden="true" tabindex="-1"></a><span class="in">  set_mode("classification")</span></span>
<span id="cb62-1329"><a href="#cb62-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1330"><a href="#cb62-1330" aria-hidden="true" tabindex="-1"></a><span class="in"># Workflow festlegen</span></span>
<span id="cb62-1331"><a href="#cb62-1331" aria-hidden="true" tabindex="-1"></a><span class="in">linear_svm_wf &lt;- workflow() %&gt;%</span></span>
<span id="cb62-1332"><a href="#cb62-1332" aria-hidden="true" tabindex="-1"></a><span class="in">  add_model(spec = linear_svm_spec_cv) %&gt;%</span></span>
<span id="cb62-1333"><a href="#cb62-1333" aria-hidden="true" tabindex="-1"></a><span class="in">  add_formula(formula = Purchase ~ .)</span></span>
<span id="cb62-1334"><a href="#cb62-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1335"><a href="#cb62-1335" aria-hidden="true" tabindex="-1"></a><span class="in"># 10-fold CV durchführen</span></span>
<span id="cb62-1336"><a href="#cb62-1336" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1234)</span></span>
<span id="cb62-1337"><a href="#cb62-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1338"><a href="#cb62-1338" aria-hidden="true" tabindex="-1"></a><span class="in">linear_svm_res &lt;- tune_grid(</span></span>
<span id="cb62-1339"><a href="#cb62-1339" aria-hidden="true" tabindex="-1"></a><span class="in">  linear_svm_wf,</span></span>
<span id="cb62-1340"><a href="#cb62-1340" aria-hidden="true" tabindex="-1"></a><span class="in">  resamples = vfold_cv(baked_train, v = 10),</span></span>
<span id="cb62-1341"><a href="#cb62-1341" aria-hidden="true" tabindex="-1"></a><span class="in">  grid = expand_grid(</span></span>
<span id="cb62-1342"><a href="#cb62-1342" aria-hidden="true" tabindex="-1"></a><span class="in">    cost = c(.01, .1)</span></span>
<span id="cb62-1343"><a href="#cb62-1343" aria-hidden="true" tabindex="-1"></a><span class="in">  ),</span></span>
<span id="cb62-1344"><a href="#cb62-1344" aria-hidden="true" tabindex="-1"></a><span class="in">  control = control_grid(save_pred = TRUE)</span></span>
<span id="cb62-1345"><a href="#cb62-1345" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb62-1346"><a href="#cb62-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1347"><a href="#cb62-1347" aria-hidden="true" tabindex="-1"></a><span class="in"># Beste Modelle ausgeben</span></span>
<span id="cb62-1348"><a href="#cb62-1348" aria-hidden="true" tabindex="-1"></a><span class="in">show_best(linear_svm_res, metric = "accuracy")</span></span>
<span id="cb62-1349"><a href="#cb62-1349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1350"><a href="#cb62-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1351"><a href="#cb62-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1354"><a href="#cb62-1354" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1355"><a href="#cb62-1355" aria-hidden="true" tabindex="-1"></a><span class="in">best_linear_svm &lt;- select_best(</span></span>
<span id="cb62-1356"><a href="#cb62-1356" aria-hidden="true" tabindex="-1"></a><span class="in">  x = linear_svm_res, </span></span>
<span id="cb62-1357"><a href="#cb62-1357" aria-hidden="true" tabindex="-1"></a><span class="in">  metric = "accuracy"</span></span>
<span id="cb62-1358"><a href="#cb62-1358" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb62-1359"><a href="#cb62-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1360"><a href="#cb62-1360" aria-hidden="true" tabindex="-1"></a><span class="in">final_linear_svm &lt;- finalize_model(</span></span>
<span id="cb62-1361"><a href="#cb62-1361" aria-hidden="true" tabindex="-1"></a><span class="in">  x = linear_svm_spec_cv,</span></span>
<span id="cb62-1362"><a href="#cb62-1362" aria-hidden="true" tabindex="-1"></a><span class="in">  parameters = best_linear_svm</span></span>
<span id="cb62-1363"><a href="#cb62-1363" aria-hidden="true" tabindex="-1"></a><span class="in">) %&gt;%</span></span>
<span id="cb62-1364"><a href="#cb62-1364" aria-hidden="true" tabindex="-1"></a><span class="in">  fit(Purchase ~ ., data = baked_train)</span></span>
<span id="cb62-1365"><a href="#cb62-1365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1366"><a href="#cb62-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1369"><a href="#cb62-1369" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1370"><a href="#cb62-1370" aria-hidden="true" tabindex="-1"></a><span class="in"># Vorhersagen</span></span>
<span id="cb62-1371"><a href="#cb62-1371" aria-hidden="true" tabindex="-1"></a><span class="in">test_pred_svm_cv &lt;- predict(</span></span>
<span id="cb62-1372"><a href="#cb62-1372" aria-hidden="true" tabindex="-1"></a><span class="in">  object = final_linear_svm, </span></span>
<span id="cb62-1373"><a href="#cb62-1373" aria-hidden="true" tabindex="-1"></a><span class="in">  new_data = baked_test</span></span>
<span id="cb62-1374"><a href="#cb62-1374" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb62-1375"><a href="#cb62-1375" aria-hidden="true" tabindex="-1"></a><span class="in">  bind_cols(baked_test) %&gt;%</span></span>
<span id="cb62-1376"><a href="#cb62-1376" aria-hidden="true" tabindex="-1"></a><span class="in">  metrics(</span></span>
<span id="cb62-1377"><a href="#cb62-1377" aria-hidden="true" tabindex="-1"></a><span class="in">    truth = Purchase, </span></span>
<span id="cb62-1378"><a href="#cb62-1378" aria-hidden="true" tabindex="-1"></a><span class="in">    estimate = .pred_class</span></span>
<span id="cb62-1379"><a href="#cb62-1379" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb62-1380"><a href="#cb62-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1381"><a href="#cb62-1381" aria-hidden="true" tabindex="-1"></a><span class="in">test_pred_svm_cv</span></span>
<span id="cb62-1382"><a href="#cb62-1382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1383"><a href="#cb62-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1384"><a href="#cb62-1384" aria-hidden="true" tabindex="-1"></a>**SVM: Radialer Kernel**</span>
<span id="cb62-1385"><a href="#cb62-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1388"><a href="#cb62-1388" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1389"><a href="#cb62-1389" aria-hidden="true" tabindex="-1"></a><span class="in"># SVM mit Radial-Kernel mit CV</span></span>
<span id="cb62-1390"><a href="#cb62-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1391"><a href="#cb62-1391" aria-hidden="true" tabindex="-1"></a><span class="in"># Spezifikation</span></span>
<span id="cb62-1392"><a href="#cb62-1392" aria-hidden="true" tabindex="-1"></a><span class="in">radial_svm_spec_cv &lt;- svm_rbf() %&gt;%</span></span>
<span id="cb62-1393"><a href="#cb62-1393" aria-hidden="true" tabindex="-1"></a><span class="in">  set_engine(</span></span>
<span id="cb62-1394"><a href="#cb62-1394" aria-hidden="true" tabindex="-1"></a><span class="in">    engine = "kernlab",</span></span>
<span id="cb62-1395"><a href="#cb62-1395" aria-hidden="true" tabindex="-1"></a><span class="in">    cost = tune(), </span></span>
<span id="cb62-1396"><a href="#cb62-1396" aria-hidden="true" tabindex="-1"></a><span class="in">    rbf_sigma = tune()</span></span>
<span id="cb62-1397"><a href="#cb62-1397" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb62-1398"><a href="#cb62-1398" aria-hidden="true" tabindex="-1"></a><span class="in">  set_mode(mode = "classification")</span></span>
<span id="cb62-1399"><a href="#cb62-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1400"><a href="#cb62-1400" aria-hidden="true" tabindex="-1"></a><span class="in"># Workflow</span></span>
<span id="cb62-1401"><a href="#cb62-1401" aria-hidden="true" tabindex="-1"></a><span class="in">radial_svm_wf &lt;- workflow() %&gt;%</span></span>
<span id="cb62-1402"><a href="#cb62-1402" aria-hidden="true" tabindex="-1"></a><span class="in">  add_model(spec = radial_svm_spec_cv) %&gt;%</span></span>
<span id="cb62-1403"><a href="#cb62-1403" aria-hidden="true" tabindex="-1"></a><span class="in">  add_formula(</span></span>
<span id="cb62-1404"><a href="#cb62-1404" aria-hidden="true" tabindex="-1"></a><span class="in">    formula = Purchase ~ .</span></span>
<span id="cb62-1405"><a href="#cb62-1405" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb62-1406"><a href="#cb62-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1407"><a href="#cb62-1407" aria-hidden="true" tabindex="-1"></a><span class="in"># CV durchführen</span></span>
<span id="cb62-1408"><a href="#cb62-1408" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1234)</span></span>
<span id="cb62-1409"><a href="#cb62-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1410"><a href="#cb62-1410" aria-hidden="true" tabindex="-1"></a><span class="in">radial_svm_res &lt;- tune_grid(</span></span>
<span id="cb62-1411"><a href="#cb62-1411" aria-hidden="true" tabindex="-1"></a><span class="in">    radial_svm_wf,</span></span>
<span id="cb62-1412"><a href="#cb62-1412" aria-hidden="true" tabindex="-1"></a><span class="in">    resamples = vfold_cv(baked_train, v = 10),</span></span>
<span id="cb62-1413"><a href="#cb62-1413" aria-hidden="true" tabindex="-1"></a><span class="in">    grid = expand_grid(</span></span>
<span id="cb62-1414"><a href="#cb62-1414" aria-hidden="true" tabindex="-1"></a><span class="in">      cost = c(.01, .1),</span></span>
<span id="cb62-1415"><a href="#cb62-1415" aria-hidden="true" tabindex="-1"></a><span class="in">      rbf_sigma = c(.1, 1)</span></span>
<span id="cb62-1416"><a href="#cb62-1416" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb62-1417"><a href="#cb62-1417" aria-hidden="true" tabindex="-1"></a><span class="in">    control = control_grid(save_pred = TRUE)</span></span>
<span id="cb62-1418"><a href="#cb62-1418" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb62-1419"><a href="#cb62-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1420"><a href="#cb62-1420" aria-hidden="true" tabindex="-1"></a><span class="in"># Beste Modelle ausgeben</span></span>
<span id="cb62-1421"><a href="#cb62-1421" aria-hidden="true" tabindex="-1"></a><span class="in">show_best(radial_svm_res, metric = "accuracy")</span></span>
<span id="cb62-1422"><a href="#cb62-1422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1423"><a href="#cb62-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1426"><a href="#cb62-1426" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1427"><a href="#cb62-1427" aria-hidden="true" tabindex="-1"></a><span class="in"># Bestes Modell zuweisen</span></span>
<span id="cb62-1428"><a href="#cb62-1428" aria-hidden="true" tabindex="-1"></a><span class="in">best_radial_svm &lt;- select_best(</span></span>
<span id="cb62-1429"><a href="#cb62-1429" aria-hidden="true" tabindex="-1"></a><span class="in">  x = radial_svm_res, </span></span>
<span id="cb62-1430"><a href="#cb62-1430" aria-hidden="true" tabindex="-1"></a><span class="in">  metric = "accuracy"</span></span>
<span id="cb62-1431"><a href="#cb62-1431" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb62-1432"><a href="#cb62-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1433"><a href="#cb62-1433" aria-hidden="true" tabindex="-1"></a><span class="in">final_radial_svm &lt;- finalize_model(</span></span>
<span id="cb62-1434"><a href="#cb62-1434" aria-hidden="true" tabindex="-1"></a><span class="in">  x = radial_svm_spec_cv, </span></span>
<span id="cb62-1435"><a href="#cb62-1435" aria-hidden="true" tabindex="-1"></a><span class="in">  parameters = best_radial_svm</span></span>
<span id="cb62-1436"><a href="#cb62-1436" aria-hidden="true" tabindex="-1"></a><span class="in">) %&gt;%</span></span>
<span id="cb62-1437"><a href="#cb62-1437" aria-hidden="true" tabindex="-1"></a><span class="in">  fit(Purchase ~ ., data = baked_train)</span></span>
<span id="cb62-1438"><a href="#cb62-1438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1439"><a href="#cb62-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1442"><a href="#cb62-1442" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1443"><a href="#cb62-1443" aria-hidden="true" tabindex="-1"></a><span class="in"># Vorhersagen auf dem Trainingsdatensatz</span></span>
<span id="cb62-1444"><a href="#cb62-1444" aria-hidden="true" tabindex="-1"></a><span class="in">test_pred_svm_rad_cv &lt;- predict(</span></span>
<span id="cb62-1445"><a href="#cb62-1445" aria-hidden="true" tabindex="-1"></a><span class="in">  object = final_radial_svm, </span></span>
<span id="cb62-1446"><a href="#cb62-1446" aria-hidden="true" tabindex="-1"></a><span class="in">  new_data = baked_test</span></span>
<span id="cb62-1447"><a href="#cb62-1447" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb62-1448"><a href="#cb62-1448" aria-hidden="true" tabindex="-1"></a><span class="in">  bind_cols(baked_test) %&gt;%</span></span>
<span id="cb62-1449"><a href="#cb62-1449" aria-hidden="true" tabindex="-1"></a><span class="in">  metrics(truth = Purchase, estimate = .pred_class)</span></span>
<span id="cb62-1450"><a href="#cb62-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1451"><a href="#cb62-1451" aria-hidden="true" tabindex="-1"></a><span class="in">test_pred_svm_rad_cv</span></span>
<span id="cb62-1452"><a href="#cb62-1452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1453"><a href="#cb62-1453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1454"><a href="#cb62-1454" aria-hidden="true" tabindex="-1"></a>**SVM: Polynomialer Kernel**</span>
<span id="cb62-1455"><a href="#cb62-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1458"><a href="#cb62-1458" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1459"><a href="#cb62-1459" aria-hidden="true" tabindex="-1"></a><span class="in"># SVM mit Polynomial-Kernel</span></span>
<span id="cb62-1460"><a href="#cb62-1460" aria-hidden="true" tabindex="-1"></a><span class="in">poly_svm_spec_cv &lt;- svm_poly(</span></span>
<span id="cb62-1461"><a href="#cb62-1461" aria-hidden="true" tabindex="-1"></a><span class="in">    mode = "classification", degree = 2</span></span>
<span id="cb62-1462"><a href="#cb62-1462" aria-hidden="true" tabindex="-1"></a><span class="in">) %&gt;%</span></span>
<span id="cb62-1463"><a href="#cb62-1463" aria-hidden="true" tabindex="-1"></a><span class="in">    set_engine(</span></span>
<span id="cb62-1464"><a href="#cb62-1464" aria-hidden="true" tabindex="-1"></a><span class="in">      engine = "kernlab",</span></span>
<span id="cb62-1465"><a href="#cb62-1465" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_factor = tune(), </span></span>
<span id="cb62-1466"><a href="#cb62-1466" aria-hidden="true" tabindex="-1"></a><span class="in">      cost = tune()</span></span>
<span id="cb62-1467"><a href="#cb62-1467" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb62-1468"><a href="#cb62-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1469"><a href="#cb62-1469" aria-hidden="true" tabindex="-1"></a><span class="in"># Workflow</span></span>
<span id="cb62-1470"><a href="#cb62-1470" aria-hidden="true" tabindex="-1"></a><span class="in">poly_svm_wf &lt;- workflow() %&gt;%</span></span>
<span id="cb62-1471"><a href="#cb62-1471" aria-hidden="true" tabindex="-1"></a><span class="in">  add_model(spec = poly_svm_spec_cv) %&gt;%</span></span>
<span id="cb62-1472"><a href="#cb62-1472" aria-hidden="true" tabindex="-1"></a><span class="in">  add_formula(</span></span>
<span id="cb62-1473"><a href="#cb62-1473" aria-hidden="true" tabindex="-1"></a><span class="in">    formula = Purchase ~ .</span></span>
<span id="cb62-1474"><a href="#cb62-1474" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb62-1475"><a href="#cb62-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1476"><a href="#cb62-1476" aria-hidden="true" tabindex="-1"></a><span class="in"># CV durchführen</span></span>
<span id="cb62-1477"><a href="#cb62-1477" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1234)</span></span>
<span id="cb62-1478"><a href="#cb62-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1479"><a href="#cb62-1479" aria-hidden="true" tabindex="-1"></a><span class="in">poly_svm_res &lt;- tune_grid(</span></span>
<span id="cb62-1480"><a href="#cb62-1480" aria-hidden="true" tabindex="-1"></a><span class="in">    poly_svm_wf,</span></span>
<span id="cb62-1481"><a href="#cb62-1481" aria-hidden="true" tabindex="-1"></a><span class="in">    resamples = vfold_cv(baked_train, v = 10),</span></span>
<span id="cb62-1482"><a href="#cb62-1482" aria-hidden="true" tabindex="-1"></a><span class="in">    grid = expand_grid(</span></span>
<span id="cb62-1483"><a href="#cb62-1483" aria-hidden="true" tabindex="-1"></a><span class="in">      cost = c(.01 ,1),</span></span>
<span id="cb62-1484"><a href="#cb62-1484" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_factor = c(.001, .01)</span></span>
<span id="cb62-1485"><a href="#cb62-1485" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb62-1486"><a href="#cb62-1486" aria-hidden="true" tabindex="-1"></a><span class="in">    control = control_grid(save_pred = TRUE)</span></span>
<span id="cb62-1487"><a href="#cb62-1487" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb62-1488"><a href="#cb62-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1489"><a href="#cb62-1489" aria-hidden="true" tabindex="-1"></a><span class="in"># Beste Modelle ausgeben</span></span>
<span id="cb62-1490"><a href="#cb62-1490" aria-hidden="true" tabindex="-1"></a><span class="in">show_best(poly_svm_res, metric = "accuracy")</span></span>
<span id="cb62-1491"><a href="#cb62-1491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1492"><a href="#cb62-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1495"><a href="#cb62-1495" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1496"><a href="#cb62-1496" aria-hidden="true" tabindex="-1"></a><span class="in"># Bestes Modell zuweisen</span></span>
<span id="cb62-1497"><a href="#cb62-1497" aria-hidden="true" tabindex="-1"></a><span class="in">best_poly_svm &lt;- select_best(</span></span>
<span id="cb62-1498"><a href="#cb62-1498" aria-hidden="true" tabindex="-1"></a><span class="in">  x = radial_svm_res, </span></span>
<span id="cb62-1499"><a href="#cb62-1499" aria-hidden="true" tabindex="-1"></a><span class="in">  metric = "accuracy"</span></span>
<span id="cb62-1500"><a href="#cb62-1500" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb62-1501"><a href="#cb62-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1502"><a href="#cb62-1502" aria-hidden="true" tabindex="-1"></a><span class="in">final_poly_svm &lt;- finalize_model(</span></span>
<span id="cb62-1503"><a href="#cb62-1503" aria-hidden="true" tabindex="-1"></a><span class="in">  x = poly_svm_spec_cv, </span></span>
<span id="cb62-1504"><a href="#cb62-1504" aria-hidden="true" tabindex="-1"></a><span class="in">  parameters = best_poly_svm</span></span>
<span id="cb62-1505"><a href="#cb62-1505" aria-hidden="true" tabindex="-1"></a><span class="in">) %&gt;%</span></span>
<span id="cb62-1506"><a href="#cb62-1506" aria-hidden="true" tabindex="-1"></a><span class="in">  fit(Purchase ~ ., data = baked_train)</span></span>
<span id="cb62-1507"><a href="#cb62-1507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1508"><a href="#cb62-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1511"><a href="#cb62-1511" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1512"><a href="#cb62-1512" aria-hidden="true" tabindex="-1"></a><span class="in"># Vorhersagen auf dem Trainingsdatensatz</span></span>
<span id="cb62-1513"><a href="#cb62-1513" aria-hidden="true" tabindex="-1"></a><span class="in">test_pred_svm_poly_cv &lt;- predict(</span></span>
<span id="cb62-1514"><a href="#cb62-1514" aria-hidden="true" tabindex="-1"></a><span class="in">  object = final_poly_svm, </span></span>
<span id="cb62-1515"><a href="#cb62-1515" aria-hidden="true" tabindex="-1"></a><span class="in">  new_data = baked_test</span></span>
<span id="cb62-1516"><a href="#cb62-1516" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb62-1517"><a href="#cb62-1517" aria-hidden="true" tabindex="-1"></a><span class="in">  bind_cols(baked_test) %&gt;%</span></span>
<span id="cb62-1518"><a href="#cb62-1518" aria-hidden="true" tabindex="-1"></a><span class="in">  metrics(</span></span>
<span id="cb62-1519"><a href="#cb62-1519" aria-hidden="true" tabindex="-1"></a><span class="in">    truth = Purchase, </span></span>
<span id="cb62-1520"><a href="#cb62-1520" aria-hidden="true" tabindex="-1"></a><span class="in">    estimate = .pred_class</span></span>
<span id="cb62-1521"><a href="#cb62-1521" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb62-1522"><a href="#cb62-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1523"><a href="#cb62-1523" aria-hidden="true" tabindex="-1"></a><span class="in">test_pred_svm_poly_cv</span></span>
<span id="cb62-1524"><a href="#cb62-1524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1525"><a href="#cb62-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1526"><a href="#cb62-1526" aria-hidden="true" tabindex="-1"></a>Für einen tabellarischen Vergleich der Performance der Modelle auf den Testdatensatz sammeln wir die Ergebnisse in einer Liste <span class="in">`ergebnisse`</span> und verwenden <span class="in">`purrr::map_dfr()`</span> für die Transformation in eine <span class="in">`tibble`</span> mit der ID-Variable <span class="in">`Modell`</span>. Die Metrik <span class="in">`accuracy`</span> tabellieren wir mit <span class="in">`gt::gt()`</span>.</span>
<span id="cb62-1527"><a href="#cb62-1527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1530"><a href="#cb62-1530" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr}</span></span>
<span id="cb62-1531"><a href="#cb62-1531" aria-hidden="true" tabindex="-1"></a><span class="in">library(purrr)</span></span>
<span id="cb62-1532"><a href="#cb62-1532" aria-hidden="true" tabindex="-1"></a><span class="in">library(gt)</span></span>
<span id="cb62-1533"><a href="#cb62-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1534"><a href="#cb62-1534" aria-hidden="true" tabindex="-1"></a><span class="in"># Ergebnisse sammeln</span></span>
<span id="cb62-1535"><a href="#cb62-1535" aria-hidden="true" tabindex="-1"></a><span class="in">ergebnisse &lt;- list(</span></span>
<span id="cb62-1536"><a href="#cb62-1536" aria-hidden="true" tabindex="-1"></a><span class="in">  `SVM linear` = test_pred_svm_cv,</span></span>
<span id="cb62-1537"><a href="#cb62-1537" aria-hidden="true" tabindex="-1"></a><span class="in">  `SVM radial` = test_pred_svm_rad_cv,</span></span>
<span id="cb62-1538"><a href="#cb62-1538" aria-hidden="true" tabindex="-1"></a><span class="in">  `SVM polynomial` = test_pred_svm_poly_cv</span></span>
<span id="cb62-1539"><a href="#cb62-1539" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb62-1540"><a href="#cb62-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1541"><a href="#cb62-1541" aria-hidden="true" tabindex="-1"></a><span class="in"># Tabelle erstellen</span></span>
<span id="cb62-1542"><a href="#cb62-1542" aria-hidden="true" tabindex="-1"></a><span class="in">map_dfr(</span></span>
<span id="cb62-1543"><a href="#cb62-1543" aria-hidden="true" tabindex="-1"></a><span class="in">  .x = ergebnisse,</span></span>
<span id="cb62-1544"><a href="#cb62-1544" aria-hidden="true" tabindex="-1"></a><span class="in">  .f =  ~ .x, </span></span>
<span id="cb62-1545"><a href="#cb62-1545" aria-hidden="true" tabindex="-1"></a><span class="in">  .id = "Modell"</span></span>
<span id="cb62-1546"><a href="#cb62-1546" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb62-1547"><a href="#cb62-1547" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(.metric == "accuracy") %&gt;%</span></span>
<span id="cb62-1548"><a href="#cb62-1548" aria-hidden="true" tabindex="-1"></a><span class="in">  gt()</span></span>
<span id="cb62-1549"><a href="#cb62-1549" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1550"><a href="#cb62-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1551"><a href="#cb62-1551" aria-hidden="true" tabindex="-1"></a>Die Auswertung zeigt, dass die hier betrachteten SVMs mit nicht-linearer Kernelfunktion den SVC mit linearem Kernel hinsichtlich der Genauigkeit der Vorhersagen auf dem Testdatensatz nicht schlagen können.</span>
<span id="cb62-1552"><a href="#cb62-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1553"><a href="#cb62-1553" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zusammenfassung</span></span>
<span id="cb62-1554"><a href="#cb62-1554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1555"><a href="#cb62-1555" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel haben wir Support Vector Machines (SVM) zur Klassifikation eingeführt, eine Machine-Learning-Methode, die sich besonders für komplexe und nicht-lineare Probleme in hochdimensionalen Datensätzen eignet. Das Ziel von SVMs ist es, eine Trennlinie oder -ebene im Regressor-Raum zu finden, die zwei Klassen von Datenpunkten optimal voneinander abgrenzt. Hierfür ermittelt ein Algorithmus sogenannte Support-Vektoren -- eine Teilmenge der Datenpunkte, welche die angepasste Entscheidungsgrenze bestimmen.</span>
<span id="cb62-1556"><a href="#cb62-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1557"><a href="#cb62-1557" aria-hidden="true" tabindex="-1"></a>Support Vector Machines (SVMs) sind eine Weiterentwicklung des klassischen Maximal Margin Classifiers (MMC). Während der MMC eine harte Trennlinie sucht, die die Daten perfekt in zwei Klassen unterteilt, funktioniert dieser Ansatz nur dann gut, wenn die Klassen klar separierbar sind. Bei realen Datensätzen, in denen Überlappungen oder Ausreißer auftreten, scheitert der MMC-Algorithmus. Hier kann ein Soft Margin Classifier (SMC) angewendet werden, eine Verallgemeinerung des MMC, die Fehlklassifikationen zulässt. Diese zusätzliche Flexibilität erweitert die Anwendbarkeit auf reale, häufig nicht perfekt linear trennbare Klassen.</span>
<span id="cb62-1558"><a href="#cb62-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1559"><a href="#cb62-1559" aria-hidden="true" tabindex="-1"></a>Für Klassifikationsprobleme mit nicht-linearen Entscheidungsgrenzen wird das Prinzip des SMCs durch den sogenannten Kernel-Trick zu einer SVM erweitert. Hierbei werden die Daten implizit in einen höherdimensionalen Raum projiziert, ohne dass die Transformation explizit durchgeführt werden muss. In diesem Raum lassen sich ursprünglich komplexe Entscheidungsgrenzen durch eine (lineare) Hyperebene modellieren. Unterschiedliche Kernel-Funktionen wie der radiale Kernel oder der polynomiale Kernel erlauben es, verschiedene Formen nicht-linearer Entscheidungsgrenzen zu erfassen und anzupassen.</span>
<span id="cb62-1560"><a href="#cb62-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1561"><a href="#cb62-1561" aria-hidden="true" tabindex="-1"></a>Die Implementierung von SVMs in R erfolgt effizient durch Pakete wie <span class="in">`e1071`</span> und <span class="in">`kernlab.`</span> Wir haben gezeigt, wie Datensätze mithilfe von <span class="in">`parsnip`</span> im <span class="in">`tidymodels`</span>-Framework systematisch vorbereitet, SVM-Modelle spezifiziert, durch Cross-Validation optimiert und vergleichen werden können.</span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>