<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Kausalanalyse und Machinelles Lernen mit R - 5&nbsp; Panel-Daten</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./IV.html" rel="next">
<link href="./Matching.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script><meta name="robots" content="noindex">
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.js" integrity="sha512-aoZChv+8imY/U1O7KIHXvO87EOzCuKO0GhFtpD6G2Cyjo/xPeTgdf3/bchB10iB+AojMTDkMHDPLKNxPJVqDcw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
<style>
.qwebr-code-output-stdout {background-color: powderblue;}

.qwebr-button-run {
 width = 100%; 
}

.centered-caption {
   text-align: center;
}
</style>
<script src="https://cdn.jsdelivr.net/npm/quizdown@latest/public/build/quizdown.js"></script><script>quizdown.init();</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./FixedEffects.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Panel-Daten</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a><a href="./index.html">Kausalanalyse mit R</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Lesemodus umschalten">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Start</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_Einfuehrung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistische Programmierung mit R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Matching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Matching</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedEffects.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Panel-Daten</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IV.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">IV-Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DiD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Difference-in-Differences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RDD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regression Discontiniuty Designs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RegReg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Regularisierte Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Machine Learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SyntheticControl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Synthetic Control</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Literatur.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatur</span></a>
  </div>
</li>
    </ul>
</div>
    <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title"><a href="./index.html">Übersicht</a></h2>
   
  <ul>
<li><a href="#sec-panel-uh" id="toc-sec-panel-uh" class="nav-link active" data-scroll-target="#sec-panel-uh"><span class="header-section-number">5.1</span> Pooled Regression und unbeobachtbare Heterogenität</a></li>
  <li><a href="#regression-in-differenzen" id="toc-regression-in-differenzen" class="nav-link" data-scroll-target="#regression-in-differenzen"><span class="header-section-number">5.2</span> Regression in Differenzen</a></li>
  <li>
<a href="#fixed-effects-regression" id="toc-fixed-effects-regression" class="nav-link" data-scroll-target="#fixed-effects-regression"><span class="header-section-number">5.3</span> Fixed-Effects-Regression</a>
  <ul class="collapse">
<li><a href="#zeit-fixed-effects" id="toc-zeit-fixed-effects" class="nav-link" data-scroll-target="#zeit-fixed-effects"><span class="header-section-number">5.3.1</span> Zeit-Fixed-Effects</a></li>
  </ul>
</li>
  <li>
<a href="#random-effects" id="toc-random-effects" class="nav-link" data-scroll-target="#random-effects"><span class="header-section-number">5.4</span> Random Effects</a>
  <ul class="collapse">
<li><a href="#verzerrung-bei-endogenit%C3%A4t" id="toc-verzerrung-bei-endogenität" class="nav-link" data-scroll-target="#verzerrung-bei-endogenit%C3%A4t"><span class="header-section-number">5.4.1</span> Verzerrung bei Endogenität</a></li>
  </ul>
</li>
  <li><a href="#beispiel-einkommen-und-demokratie" id="toc-beispiel-einkommen-und-demokratie" class="nav-link" data-scroll-target="#beispiel-einkommen-und-demokratie"><span class="header-section-number">5.5</span> Beispiel: Einkommen und Demokratie</a></li>
  </ul></nav>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Panel-Daten</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><style>
.qwebr-code-output-stdout {background-color: powderblue;}

.qwebr-button-run, .qwebr-button-reset, .qwebr-button-copy {
  background-color:  rgba(0, 0, 0, 0);
  border-style: none;
  font-weight: 400;
  color: white; 
  transition: none;
}

.qwebr-editor-toolbar {
  width: 100%;
  display: flex;
  justify-content: space-between;
  box-sizing: border-box;
  border-radius: 0 0 6px 6px;
  background-color: darkgreen;
  border-color: darkgreen;
  border-width: 1px;
  border-style: solid;
  padding: 0 0; 
  transition: color .1s ease-in-out, background-color .1s ease-in-out,border-color .1s ease-in-out,box-shadow .1s ease-in-out;
}

.qwebr-editor-toolbar:hover {
  background-color: white;
  border-color: darkgreen;
  border-width: 1px;
}

.qwebr-editor-toolbar:hover * {
  color: darkgreen;
}

.overflow-guard, .qwebr-editor, .monaco-editor {
  border-radius: 6px 6px 0 0;
  border-width: 1px 1px 0 1px;
  border-color: darkgreen;
}

</style>
<section id="sec-panel-uh" class="level2 page-columns page-full" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="sec-panel-uh">
<span class="header-section-number">5.1</span> Pooled Regression und unbeobachtbare Heterogenität</h2>
<div class="cell">

</div>
<p>Ein Panel-Datensatz enthält Beobachtungen von <span class="math inline">\(n\)</span> Einheiten für (bis zu) <span class="math inline">\(T\)</span> Zeitpunkte, wobei <span class="math inline">\(t=1,\dots,T\)</span>. Betrachte das Panel-Modell</p>
<p><span class="math display">\[\begin{align}
  Y_{it} = \beta_0 + \beta_1 B_{it} + \beta_2 X_i + \beta_3 U_i + \epsilon_{it},\label{eq:unobshetmodel}
\end{align}\]</span></p>
<p>wobei <span class="math inline">\(U_i\)</span> unbeobachtete und <span class="math inline">\(X_i\)</span> beobachtete, <strong>zeitlich-invariante</strong> Heterogenitäten zwischen den Beobachtungseinheiten <span class="math inline">\(i=1,\dots,n\)</span> sind. Wie zuvor ist <span class="math inline">\(B_{it}\)</span> die Behandlungsvariable und <span class="math inline">\(\beta_1\)</span> der interessierende kausale Effekt einer Veränderung von <span class="math inline">\(B_{it}\)</span> auf <span class="math inline">\(Y_{it}\)</span>.</p>
<p>Angenommen wir beobachten <span class="math inline">\(Y_{it}\)</span> und <span class="math inline">\(B_{it}\)</span> für <span class="math inline">\(T=1\)</span>, also für eine Periode. Bei Korrelation zwischen den <strong>unbeobachtbaren</strong> zeit-invarianten Effekten <span class="math inline">\(U_i\)</span> und der Behandlungsvariable <span class="math inline">\(B_{it}\)</span> kann der kausale Effekt <span class="math inline">\(\beta_1\)</span> in nicht identifiziert werden. Diese Situation ist in <a href="#fig-FEDAG1" class="quarto-xref">Abbildung&nbsp;<span>5.1</span></a> dargestellt.</p>
<div class="cell page-columns page-full" data-fig-width="3" data-fig-height="3" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-FEDAG1" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-FEDAG1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<svg width="288" height="288" viewbox="0.00 0.00 277.94 252.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(36 216)"><title>FE_dag_single_period</title>
<polygon fill="white" stroke="transparent" points="-36,36 -36,-216 241.94,-216 241.94,36 -36,36"></polygon><!-- U --><g id="node1" class="node"><title>U</title>
<ellipse fill="none" stroke="gray" cx="174.97" cy="-162" rx="30.94" ry="18"></ellipse><text text-anchor="start" x="160.52" y="-158.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00" fill="gray">U</text><text text-anchor="start" x="170.63" y="-158.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00" fill="gray">t=1</text></g><!-- X --><g id="node2" class="node"><title>X</title>
<ellipse fill="none" stroke="black" cx="174.97" cy="-18" rx="30.94" ry="18"></ellipse><text text-anchor="start" x="160.52" y="-14.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">X</text><text text-anchor="start" x="170.63" y="-14.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00">t=1</text></g><!-- U&#45;&gt;X --><g id="edge1" class="edge"><title>U-&gt;X</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M174.97,-143.76C174.97,-119.2 174.97,-75.25 174.97,-46.35"></path><polygon fill="gray" stroke="gray" points="178.47,-46.09 174.97,-36.09 171.47,-46.09 178.47,-46.09"></polygon></g><!-- B --><g id="node3" class="node"><title>B</title>
<ellipse fill="none" stroke="black" cx="30.97" cy="-18" rx="30.37" ry="18"></ellipse><text text-anchor="start" x="16.91" y="-14.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">B</text><text text-anchor="start" x="26.24" y="-14.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00">t=1</text></g><!-- U&#45;&gt;B --><g id="edge3" class="edge"><title>U-&gt;B</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M159.28,-146.32C133.86,-120.89 83.52,-70.55 54.01,-41.04"></path><polygon fill="gray" stroke="gray" points="56.18,-38.26 46.63,-33.67 51.23,-43.21 56.18,-38.26"></polygon></g><!-- Y --><g id="node4" class="node"><title>Y</title>
<ellipse fill="none" stroke="black" cx="30.97" cy="-162" rx="30.94" ry="18"></ellipse><text text-anchor="start" x="16.52" y="-158.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Y</text><text text-anchor="start" x="26.63" y="-158.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00">t=1</text></g><!-- U&#45;&gt;Y --><g id="edge2" class="edge"><title>U-&gt;Y</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M143.72,-162C122.78,-162 94.97,-162 72.21,-162"></path><polygon fill="gray" stroke="gray" points="72.15,-158.5 62.15,-162 72.15,-165.5 72.15,-158.5"></polygon></g><!-- X&#45;&gt;B --><g id="edge5" class="edge"><title>X-&gt;B</title>
<path fill="none" stroke="black" d="M143.72,-18C122.63,-18 94.59,-18 71.74,-18"></path><polygon fill="black" stroke="black" points="71.66,-14.5 61.66,-18 71.66,-21.5 71.66,-14.5"></polygon></g><!-- X&#45;&gt;Y --><g id="edge4" class="edge"><title>X-&gt;Y</title>
<path fill="none" stroke="black" d="M159.28,-33.68C133.86,-59.11 83.52,-109.45 54.01,-138.96"></path><polygon fill="black" stroke="black" points="51.23,-136.79 46.63,-146.33 56.18,-141.74 51.23,-136.79"></polygon></g><!-- B&#45;&gt;Y --><g id="edge6" class="edge"><title>B-&gt;Y</title>
<path fill="none" stroke="black" d="M30.97,-36.24C30.97,-60.8 30.97,-104.75 30.97,-133.65"></path><polygon fill="black" stroke="black" points="27.47,-133.91 30.97,-143.91 34.47,-133.91 27.47,-133.91"></polygon></g></g></svg>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-FEDAG1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;5.1: Backdoors durch beobachtete und unbeobachtete Variablen
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-FEDAG1" class="quarto-xref">Abbildung&nbsp;<span>5.1</span></a> zeigt Backdoors durch die <span class="math inline">\(U_i\)</span>, die wir mit einer “naiven” KQ-Schätzung der fehlspezifizierten Regression <span class="math display">\[\begin{align}
  Y_{it} = \beta_0 + \beta_1 B_{it} + \beta_2 X_i + \varepsilon_{it},\quad t=1,\label{eq:femodelfail}
\end{align}\]</span> nicht schließen können.</p>
<p>Wir betrachten nun eine Generalisierung von <a href="#fig-FEDAG1" class="quarto-xref">Abbildung&nbsp;<span>5.1</span></a> für <span class="math inline">\(T=2\)</span> Perioden, dargestellt in <a href="#fig-FEDAG2" class="quarto-xref">Abbildung&nbsp;<span>5.2</span></a>.</p>
<div class="cell page-columns page-full" data-fig-width="6" data-fig-height="4" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-FEDAG2" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-FEDAG2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<svg width="576" height="384" viewbox="0.00 0.00 357.94 476.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 472)"><title>FE_dag2</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-472 353.94,-472 353.94,4 -4,4"></polygon><!-- U --><g id="node1" class="node"><title>U</title>
<ellipse fill="none" stroke="gray" cx="174.97" cy="-450" rx="27" ry="18"></ellipse><text text-anchor="middle" x="174.97" y="-445.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00" fill="gray">U</text></g><!-- X --><g id="node2" class="node"><title>X</title>
<ellipse fill="none" stroke="black" cx="174.97" cy="-18" rx="27" ry="18"></ellipse><text text-anchor="middle" x="174.97" y="-13.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">X</text></g><!-- U&#45;&gt;X --><g id="edge1" class="edge"><title>U-&gt;X</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M174.97,-431.99C174.97,-364.74 174.97,-128.08 174.97,-46.16"></path><polygon fill="gray" stroke="gray" points="178.47,-46.09 174.97,-36.09 171.47,-46.09 178.47,-46.09"></polygon></g><!-- B1 --><g id="node3" class="node"><title>B1</title>
<ellipse fill="none" stroke="black" cx="30.97" cy="-162" rx="30.37" ry="18"></ellipse><text text-anchor="start" x="16.91" y="-158.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">B</text><text text-anchor="start" x="26.24" y="-158.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00">t=1</text></g><!-- U&#45;&gt;B1 --><g id="edge3" class="edge"><title>U-&gt;B1</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M166.39,-432.85C142.24,-384.54 73.51,-247.09 44.33,-188.73"></path><polygon fill="gray" stroke="gray" points="47.28,-186.81 39.68,-179.43 41.02,-189.94 47.28,-186.81"></polygon></g><!-- Y1 --><g id="node4" class="node"><title>Y1</title>
<ellipse fill="none" stroke="black" cx="30.97" cy="-306" rx="30.94" ry="18"></ellipse><text text-anchor="start" x="16.52" y="-302.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Y</text><text text-anchor="start" x="26.63" y="-302.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00">t=1</text></g><!-- U&#45;&gt;Y1 --><g id="edge2" class="edge"><title>U-&gt;Y1</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M159.83,-434.86C134.64,-409.67 83.96,-358.99 54.21,-329.25"></path><polygon fill="gray" stroke="gray" points="56.32,-326.4 46.78,-321.81 51.37,-331.35 56.32,-326.4"></polygon></g><!-- B2 --><g id="node5" class="node"><title>B2</title>
<ellipse fill="none" stroke="black" cx="318.97" cy="-162" rx="30.37" ry="18"></ellipse><text text-anchor="start" x="304.91" y="-158.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">B</text><text text-anchor="start" x="314.24" y="-158.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00">t=2</text></g><!-- U&#45;&gt;B2 --><g id="edge9" class="edge"><title>U-&gt;B2</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M183.54,-432.85C207.7,-384.54 276.42,-247.09 305.6,-188.73"></path><polygon fill="gray" stroke="gray" points="308.91,-189.94 310.25,-179.43 302.65,-186.81 308.91,-189.94"></polygon></g><!-- Y2 --><g id="node6" class="node"><title>Y2</title>
<ellipse fill="none" stroke="black" cx="318.97" cy="-306" rx="30.94" ry="18"></ellipse><text text-anchor="start" x="304.52" y="-302.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Y</text><text text-anchor="start" x="314.63" y="-302.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00">t=2</text></g><!-- U&#45;&gt;Y2 --><g id="edge8" class="edge"><title>U-&gt;Y2</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M190.11,-434.86C215.3,-409.67 265.98,-358.99 295.72,-329.25"></path><polygon fill="gray" stroke="gray" points="298.56,-331.35 303.16,-321.81 293.61,-326.4 298.56,-331.35"></polygon></g><!-- X&#45;&gt;B1 --><g id="edge5" class="edge"><title>X-&gt;B1</title>
<path fill="none" stroke="black" d="M159.83,-33.14C134.64,-58.33 83.96,-109.01 54.21,-138.75"></path><polygon fill="black" stroke="black" points="51.37,-136.65 46.78,-146.19 56.32,-141.6 51.37,-136.65"></polygon></g><!-- X&#45;&gt;Y1 --><g id="edge4" class="edge"><title>X-&gt;Y1</title>
<path fill="none" stroke="black" d="M166.39,-35.15C142.24,-83.46 73.51,-220.91 44.33,-279.27"></path><polygon fill="black" stroke="black" points="41.02,-278.06 39.68,-288.57 47.28,-281.19 41.02,-278.06"></polygon></g><!-- X&#45;&gt;B2 --><g id="edge11" class="edge"><title>X-&gt;B2</title>
<path fill="none" stroke="black" d="M190.11,-33.14C215.3,-58.33 265.98,-109.01 295.72,-138.75"></path><polygon fill="black" stroke="black" points="293.61,-141.6 303.16,-146.19 298.56,-136.65 293.61,-141.6"></polygon></g><!-- X&#45;&gt;Y2 --><g id="edge10" class="edge"><title>X-&gt;Y2</title>
<path fill="none" stroke="black" d="M183.54,-35.15C207.7,-83.46 276.42,-220.91 305.6,-279.27"></path><polygon fill="black" stroke="black" points="302.65,-281.19 310.25,-288.57 308.91,-278.06 302.65,-281.19"></polygon></g><!-- B1&#45;&gt;Y1 --><g id="edge6" class="edge"><title>B1-&gt;Y1</title>
<path fill="none" stroke="black" d="M30.97,-180.24C30.97,-204.8 30.97,-248.75 30.97,-277.65"></path><polygon fill="black" stroke="black" points="27.47,-277.91 30.97,-287.91 34.47,-277.91 27.47,-277.91"></polygon></g><!-- B1&#45;&gt;B2 --><g id="edge7" class="edge"><title>B1-&gt;B2</title>
<path fill="none" stroke="black" d="M61.52,-162C113.58,-162 219.51,-162 277.96,-162"></path><polygon fill="black" stroke="black" points="278.3,-165.5 288.3,-162 278.3,-158.5 278.3,-165.5"></polygon></g><!-- B2&#45;&gt;Y2 --><g id="edge12" class="edge"><title>B2-&gt;Y2</title>
<path fill="none" stroke="black" d="M318.97,-180.24C318.97,-204.8 318.97,-248.75 318.97,-277.65"></path><polygon fill="black" stroke="black" points="315.47,-277.91 318.97,-287.91 322.47,-277.91 315.47,-277.91"></polygon></g></g></svg>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-FEDAG2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;5.2: Panel-Design mit Backdoors durch beobachtete und unbeobachtete zeit-invariante Variablen
</figcaption></figure>
</div>
</div>
</div>
<p>Der in <a href="#fig-FEDAG2" class="quarto-xref">Abbildung&nbsp;<span>5.2</span></a> gezeigte Zusammenhang führt (idealerweise) zwar zu einer Verdoppelung des Beobachtungsumfangs, jedoch besteht weiterhin das in <a href="#fig-FEDAG1" class="quarto-xref">Abbildung&nbsp;<span>5.1</span></a> gezeigte Endogenitätsproblem, falls die Regression <span class="math inline">\(\eqref{eq:femodelfail}\)</span> nun anhand einer Zusammenlegung (<strong>Pooling</strong>) der Beobachtungen für <span class="math inline">\(t\in\{1,2\}\)</span> geschätzt wird:<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Die unbeobachteten zeit-invarianten Einflüsse <span class="math inline">\(U_i\)</span> verursachen auch für Periode <span class="math inline">\(t=2\)</span> Backdoor-Pfade.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;Pooled Regression kann auch berechnet werden, wenn nicht für alle <span class="math inline">\(n\)</span> Einheiten jeweils <span class="math inline">\(T\)</span> Beobachtungen vorliegen (unbalanced Panel).</p></div></div><p>In diesem Kapitel betrachten wir Panel-Verfahren, welche den kausalen Effekt in <a href="#fig-FEDAG2" class="quarto-xref">Abbildung&nbsp;<span>5.2</span></a> und Verallgemeinerungen hiervon schätzen können. Analog zu Querschnittsdaten können die hier betrachteten Panel-Schätzer Endogenitäten aufgrund simultaner Kausalität oder nicht beheben. In solchen Szenarien können Panel-Methoden in Kombination mit einer Schätzstrategie basierend auf Instrument-Variablen hilfreich sein. Wir betrachten solche Schätzer in den empirischen Beispielen in Kapitel <a href="IV.html" class="quarto-xref"><span>Kapitel 6</span></a>.</p>
<p>Bevor wir diese Panel-Verfahren erläutern, veranschaulichen wir die verzerrte Schätzung eines Behandlungseffekts mit <em>Pooled Regression</em> für einen simulierten Datensatz <code>paneldata.csv</code>, der Beobachtungen von <span class="math inline">\(n=12\)</span> Einheiten zu <span class="math inline">\(T=8\)</span> Perioden beinhaltet. Alle Einheiten weisen unbeobachtbare zeit-invariante Heterogenitäten auf, die mit <span class="math inline">\(B_{it}\)</span> korellieren. Der wahre Behandlungseffekt beträgt <span class="math inline">\(\beta_1 = -1\)</span> für alle <span class="math inline">\(n\)</span> Einheiten.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;Der (R code für den) DGP ist <a href="https://stats.stackexchange.com/a/188559">diesem StackExchange-Post</a> entnommen.</p></div></div><p>Wir lesen zunächst den Datensatz ein und selektieren die benötigten Variablen.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Datensatz 'paneldata.csv' einlesen</span></span>
<span><span class="va">paneldata</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"datasets/paneldata.csv"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, <span class="va">ID</span>, <span class="va">time</span>, <span class="va">col</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Panel-Dimensionen bestimmen</span></span>
<span><span class="va">paneldata</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    T <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
      N     T
  &lt;int&gt; &lt;int&gt;
1    12     8</code></pre>
</div>
</div>
<p>Mit der Funktion <code><a href="https://rdrr.io/pkg/plm/man/is.pbalanced.html">plm::is.pbalanced()</a></code> überprüfen wir, ob im Panel-Datensatz für alle beobachteten Einheiten die gleiche Anzahl an Beobachtungsperioden vorliegt (<em>balanced panel</em>).<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;Fehlende Beobachtungen sind typischerweise mit einem <code>NA</code>-Wert gekennzeichnet. Der Differenz-Schätzer kann auch berechnet werden, wenn der Datensatz nicht ausgeglichen (<em>unbalanced</em>) ist.</p></div></div><div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=plm">plm</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Datensatz balanced?</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/is.pbalanced.html">is.pbalanced</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">paneldata</span>, </span>
<span>  index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"time"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Zunächst schätzen wir eine Pooled Regression für die ersten beiden Zeitperioden, basierend auf einem entsprechend gefilterten Datensatz.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;Wir verweisen nachfolgend explizit auf Funktionen aus <code>dplyr</code>, falls Funktionen aus <code>plm</code> identische Namen haben.</p></div></div><div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Subsetting der Daten für 2 Perioden (t = {1, 2})</span></span>
<span><span class="va">paneldata_T2</span> <span class="op">&lt;-</span> <span class="va">paneldata</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html">between</a></span><span class="op">(</span><span class="va">time</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Für die Schätzung von <span class="math inline">\(\eqref{eq:femodelfail}\)</span> nutzen wir <code><a href="https://lrberge.github.io/fixest/reference/feols.html">fixest::feols()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lrberge.github.io/fixest/">fixest</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Naive KQ-Schätzung für t = {1, 2}</span></span>
<span><span class="va">panel_KQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span></span>
<span>  fml <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, </span>
<span>  data <span class="op">=</span> <span class="va">paneldata_T2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">panel_KQ</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OLS estimation, Dep. Var.: Y
Observations: 24
Standard-errors: IID 
            Estimate Std. Error  t value   Pr(&gt;|t|)    
(Intercept) -2.50547   1.481150 -1.69157 1.0485e-01    
X            3.80692   0.194202 19.60295 2.0252e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 3.28785   Adj. R2: 0.943388</code></pre>
</div>
</div>
<p>Die Schätzung von <span class="math inline">\(\beta_1\)</span> ist <span class="math inline">\(3.81\)</span> und weist auf eine deutliche Verzerrung hin. Wir illustrieren die Problematik in <a href="#fig-pooledregression1" class="quarto-xref">Abbildung&nbsp;<span>5.3</span></a>, in dem wir die für die Regression verwendeten Daten (Kreise) sowie die Beobachtungen späterer Perioden (Kreuze) nach Gruppenzugehörigkeit einfärben und die Schätzung der Pooled Regression abtragen.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot: Naiver KQ-Schätzer für t = 1, 2</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">paneldata</span> <span class="op">%&gt;%</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">col</span><span class="op">)</span>,</span>
<span>    pch <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">F</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">paneldata</span> <span class="op">%&gt;%</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">col</span><span class="op">)</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">F</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Naive KQ-Schätzung für t = 1, 2</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">paneldata</span> <span class="op">%&gt;%</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"lm"</span>, </span>
<span>    se <span class="op">=</span> <span class="cn">F</span>,</span>
<span>    col <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_identity</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-pooledregression1" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-pooledregression1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="FixedEffects_files/figure-html/fig-pooledregression1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pooledregression1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;5.3: <code>paneldaten.csv</code> – Pooled Regression für t = 1, 2
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-pooledregression1" class="quarto-xref">Abbildung&nbsp;<span>5.3</span></a> zeigt einen negativen Verlauf des Zusammenhangs zwischen X und Y anhand der Variation der Beobachtungen <em>innerhalb</em> der farblich gekennzeichneten Gruppen. Dieser negative Zusammenhang kann aufgrund der Endogenität von <span class="math inline">\(X\)</span> nicht erfasst werden.</p>
<p>Eine Erweiturung der Regression auf sämtliche Perioden (Pooling aller <span class="math inline">\(n\times T = 12 \times 8 = 96\)</span> Beobachtungen) erhöht lediglich die Präzision der Schätzung (geringerer Standardfehler von <span class="math inline">\(\widehat{\beta}_1\)</span>), nicht aber die Endogenität, vgl. <a href="#fig-pooledregression2" class="quarto-xref">Abbildung&nbsp;<span>5.4</span></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Naive KQ-Schätzung für t = 1,...,8</span></span>
<span><span class="va">panel_KQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span></span>
<span>  fml <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, </span>
<span>  data <span class="op">=</span> <span class="va">paneldata</span> </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">panel_KQ</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OLS estimation, Dep. Var.: Y
Observations: 96
Standard-errors: IID 
            Estimate Std. Error  t value  Pr(&gt;|t|)    
(Intercept) -1.45318   1.008859 -1.44042   0.15307    
X            3.76470   0.134364 28.01868 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 4.63461   Adj. R2: 0.891928</code></pre>
</div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot: Naiver KQ-Schätzer für t = 1,...,8</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">paneldata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">col</span><span class="op">)</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">F</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Pooled Schätzung</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">paneldata</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"lm"</span>, </span>
<span>    se <span class="op">=</span> <span class="cn">F</span>,</span>
<span>    col <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_identity</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-pooledregression2" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-pooledregression2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="FixedEffects_files/figure-html/fig-pooledregression2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pooledregression2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;5.4: <code>paneldaten.csv</code> – Pooled Regression für t = 1, …, 8
</figcaption></figure>
</div>
</div>
</div>
</section><section id="regression-in-differenzen" class="level2 page-columns page-full" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="regression-in-differenzen">
<span class="header-section-number">5.2</span> Regression in Differenzen</h2>
<p>Wir betrachten zunächst den in <a href="#fig-FEDAG2" class="quarto-xref">Abbildung&nbsp;<span>5.2</span></a> dargestellten DGP für <span class="math inline">\(T=2\)</span> Zeitperioden. In dieser Situation können Backdoors durch <span class="math inline">\(U\)</span> anhand einer simplen Transformation von Modell <span class="math inline">\(\eqref{eq:femodel}\)</span> geschlossen werden: Regression der Zeit-Differenzen zwischen den Perioden <span class="math inline">\(t=2\)</span> und <span class="math inline">\(t=1\)</span>, <span class="math display">\[\begin{align}
  \Delta Y_{it} = \beta_1 \Delta B_{it} + e_{it}, \qquad i=1,\dots,n,\qquad t=1,2 \label{eq:femodeldiff},
\end{align}\]</span> wobei <span class="math inline">\(\Delta\,Y_{it} := Y_{i2} - Y_{i1}\)</span> und <span class="math inline">\(e_{it} := \epsilon_{i2} - \epsilon_{i1}\)</span> für <span class="math inline">\(t=2\)</span>. Beachte, dass <span class="math inline">\(\Delta U_i=\Delta X_i=0\)</span>. Differenzieren ergibt also ein Modell, in dem weder für <span class="math inline">\(X_i\)</span> noch für die (unbeobachtbaren) <span class="math inline">\(U_i\)</span> kontrolliert werden muss, damit <span class="math inline">\(\beta_1\)</span> identifiziert werden kann. Der Behandlungseffekt <span class="math inline">\(\beta_1\)</span> kann mit KQ geschätzt werden.</p>
<p>Zur Transformation der Regressoren in <code><a href="https://lrberge.github.io/fixest/reference/feols.html">fixest::feols()</a></code> verwenden wir den Operator <code><a href="https://lrberge.github.io/fixest/reference/l.html">d()</a></code>. Dieser benötigt die im Argument <code>panel.id</code> als Formel spezifizierten Identifikationsvariablen für Einheiten (<code>ID</code>) und Zeitpunkte (<code>time</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Panel-Schätzer: KQ-Regression in Differenzen</span></span>
<span><span class="va">panel_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span></span>
<span>  fml <span class="op">=</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/l.html">d</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/l.html">d</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, </span>
<span>  data <span class="op">=</span> <span class="va">paneldata</span> <span class="op">%&gt;%</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html">between</a></span><span class="op">(</span><span class="va">time</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>  panel.id <span class="op">=</span> <span class="op">~</span> <span class="va">ID</span> <span class="op">+</span> <span class="va">time</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">panel_diff</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OLS estimation, Dep. Var.: d(Y, 1)
Observations: 12
Standard-errors: Clustered (ID) 
        Estimate Std. Error  t value  Pr(&gt;|t|)    
d(X, 1) -1.03205   0.326838 -3.15767 0.0091166 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.907432   Adj. R2: 0.509923</code></pre>
</div>
</div>
<p>Die Schätzung anhand der Regression in Differenzen liegt nahe beim wahren Behandlungseffekt <span class="math inline">\(\beta_1 = -1\)</span>. Abbildung <a href="#fig-diffregression1" class="quarto-xref">Abbildung&nbsp;<span>5.5</span></a> zeigt die ersten Differenzen der Daten und den mit KQ geschätzten Zusammenhang.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Transformation zu Differenzen</span></span>
<span><span class="va">paneldata_diff</span> <span class="op">&lt;-</span> <span class="va">paneldata</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    DeltaX <span class="op">=</span> <span class="va">X</span> <span class="op">-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,</span>
<span>    DeltaY <span class="op">=</span> <span class="va">Y</span> <span class="op">-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot: KQ-Schätzer für Differenzen  </span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">DeltaX</span>, y <span class="op">=</span> <span class="va">DeltaY</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_point</span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">paneldata_diff</span> <span class="op">%&gt;%</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>      mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">col</span><span class="op">)</span>,</span>
<span>      pch <span class="op">=</span> <span class="fl">3</span>,</span>
<span>      show.legend <span class="op">=</span> <span class="cn">F</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">paneldata_diff</span> <span class="op">%&gt;%</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>      mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">col</span><span class="op">)</span>,</span>
<span>      show.legend <span class="op">=</span> <span class="cn">F</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">paneldata_diff</span> <span class="op">%&gt;%</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"lm"</span>, </span>
<span>    se <span class="op">=</span> <span class="cn">F</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_color_identity</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-diffregression1" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-diffregression1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="FixedEffects_files/figure-html/fig-diffregression1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-diffregression1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;5.5: <code>paneldaten.csv</code> – Regression in Differenzen für t = 2
</figcaption></figure>
</div>
</div>
</div>
<p>Wie für die Pooled Regression können wir den Differenzen-Schätzer für den gesamten Datensatz berechnen.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Panel-Schätzer: KQ-Regression in Differenzen</span></span>
<span><span class="va">panel_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span></span>
<span>  fml <span class="op">=</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/l.html">d</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/l.html">d</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, </span>
<span>  data <span class="op">=</span> <span class="va">paneldata</span>,</span>
<span>  panel.id <span class="op">=</span> <span class="op">~</span> <span class="va">ID</span> <span class="op">+</span> <span class="va">time</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">panel_diff</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OLS estimation, Dep. Var.: d(Y, 1)
Observations: 84
Standard-errors: Clustered (ID) 
         Estimate Std. Error  t value   Pr(&gt;|t|)    
d(X, 1) -0.982042   0.135217 -7.26269 1.6178e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 1.12641   Adj. R2: 0.571235</code></pre>
</div>
</div>
<p>Beachte, dass der Standardfehler der Schätzers etwas größer ist als für den KQ-Schätzer in der Pooled Regression. Grund hierfür ist der Verlust von <span class="math inline">\(12\)</span> Beobachtungen bei der Bildung der <span class="math inline">\(T-1 = 7\)</span> Differenzen.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot: KQ-Schätzer in Differenzen (alle t)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">paneldata_diff</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">DeltaX</span>, y <span class="op">=</span> <span class="va">DeltaY</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="st">"gray"</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">F</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">col</span><span class="op">)</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">F</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"lm"</span>, </span>
<span>    se <span class="op">=</span> <span class="cn">F</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_color_identity</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-diffregression2" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-diffregression2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="FixedEffects_files/figure-html/fig-diffregression2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-diffregression2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;5.6: <code>paneldaten.csv</code> – Regression in Differenzen für t = 1, …, 8
</figcaption></figure>
</div>
</div>
</div>
</section><section id="fixed-effects-regression" class="level2 page-columns page-full" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="fixed-effects-regression">
<span class="header-section-number">5.3</span> Fixed-Effects-Regression</h2>
<p>Die Regression in Differenzen hat den Nachteil, dass einheiten-spezifische Effekte nicht geschätzt werden können. Weiterhin impliziert die Differenzbildung einen Verlust des Beobachtungsumfangs bei der Schätzung des kausalen Effekts.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> Für den Datensatz <code>paneldata.csv</code> verlieren wir daher 1/8 der Stichprobe. Abhängig von der empirischen Fragestellung und der Datenverfügbarkeit kann Fixed-Effects-Regression eine nützliche Alternative zu Regression in Differenzen sein, wenn Panel-Daten mit <span class="math inline">\(T\geq2\)</span> vorliegen.</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;Eine Reduktion des Beobachtungsumfangs erhöht die Varianz der Schätzung.</p></div><div id="fn6"><p><sup>6</sup>&nbsp;Eine Modellierung mit gruppen-spezifischen Achsenabschnitten scheint in <a href="#fig-pooledregression2" class="quarto-xref">Abbildung&nbsp;<span>5.4</span></a> plausibel.</p></div></div><p>Wir betrachten erneut Modell <span class="math inline">\(\eqref{eq:unobshetmodel}\)</span> und definieren <span class="math display">\[\begin{align*}
  \delta_i = \beta_0 + \beta_3 U_i.
\end{align*}\]</span> Nach einsetzen in <span class="math inline">\(\eqref{eq:unobshetmodel}\)</span> erhalten wir das Modell <span class="math display">\[\begin{align}
  Y_{it} = \delta_i + \beta_1 B_{it} + \beta_2 X_i + \epsilon_{it} \label{eq:femodel},
\end{align}\]</span> mit einheiten-spezifischen Konstanten <span class="math inline">\(\delta_i\)</span>, <span class="math inline">\(i=1,\dots,n\)</span>. Die <span class="math inline">\(\delta_i\)</span> können als individuelle Achsenabschnitte (“feste Effekte”) interpretieren werden, weshalb Modell <span class="math inline">\(\eqref{eq:femodel}\)</span> auch als “Fixed-Effects-Modell” bezeichnet wird.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<p>Für die Vermeidung von Backdoors in den <span class="math inline">\(\delta_i\)</span> subtrahieren wir die einheiten-spezifischen Mittelwerte von den Komponenten (Within-Transformation), <span class="math display">\[\begin{align}
  Y_{it} - \overline{Y}_i =&amp;\, (\delta_i - \overline{\delta}_i) + \beta_1 (B_{it} - \overline{B}_i) + \beta_2 (X_i - \overline{X}_i) + (\epsilon_{it} - \overline{\epsilon}_i)\notag\\
  \tilde Y_{it} =&amp;\, \beta_1 \tilde B_{it} + \tilde\epsilon_{it}.\label{eq:fewithin}
\end{align}\]</span> Der Fixed-Effects-Schätzer von <span class="math inline">\(\beta_1\)</span> ist der KQ-Schätzer in <span class="math inline">\(\eqref{eq:fewithin}\)</span>. Ähnlich wie für den Differenzen-Schätzer eliminieren die Mittelwert-Differenzen <span class="math inline">\(\delta_i - \overline{\delta}_i=0\)</span> und <span class="math inline">\(X_i - \overline{X}_i=0\)</span> den Einfluss zeit-invarianter Variablen.</p>
<p>Das Modell <span class="math inline">\(\eqref{eq:femodel}\)</span> kann weiterhin als eine Regression mit <span class="math inline">\(n-1\)</span> Dummy-Variablen und einer Konstante umgeschrieben werden, <span class="math display">\[\begin{align}
  Y_{it} = \beta_0 + \beta_2 B_{it} + \beta_2 X_i  + \gamma_2 D^{(2)}_i + \gamma_3 D^{(3)}_i + \cdots + \gamma_n D^{(n)}_i + \epsilon_{it} \label{eq:drmodel}.
\end{align}\]</span> Die Darstellung <span class="math inline">\(\eqref{eq:drmodel}\)</span> hat <span class="math inline">\(n\)</span> verschiedene Achsenabschnitte – einen für jede Beobachtungseinheit – und kann ebenfalls mit KQ geschätzt werden.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> Die Modelle <span class="math inline">\(\eqref{eq:femodel}\)</span> und <span class="math inline">\(\eqref{eq:drmodel}\)</span> sind also gleichwertige Darstellungen eines Modells, dass (unbeobachtbare) zeit-invariante Heterogenität berücksichtigt.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> Beachte, dass die Schätzung der Koeffizienten <em>beobachtbarer</em> zeit-invarianter Regressoren <span class="math inline">\(X_{i}\)</span> lediglich in Modell <span class="math inline">\(\eqref{eq:drmodel}\)</span> möglich ist.</p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>&nbsp;Für <span class="math inline">\(n-1\)</span> Einheiten ist der individuelle Achsenabschnitt damit <span class="math inline">\(\beta_0 + \gamma_i\)</span> und für <em>eine</em> Einheit <span class="math inline">\(\beta_0\)</span>. Diese Einheit (hier <span class="math inline">\(i=1\)</span>) wird auch als <em>Referenzkategorie</em> bezeichnet. Alternativ kann das Modell mit <span class="math inline">\(n\)</span> Dummies und <em>ohne</em> die Konstante <span class="math inline">\(\beta_0\)</span> geschrieben werden.</p></div><div id="fn8"><p><sup>8</sup>&nbsp;Der Ansatz <span class="math inline">\(\eqref{eq:drmodel}\)</span> wird in der Literatur auch als <em>Least Squares Dummy Variables</em> (LSDV) Regression bezeichnet.</p></div><div id="fn9"><p><sup>9</sup>&nbsp;Eine Alternative ist <code><a href="https://rdrr.io/pkg/plm/man/plm.html">plm::plm()</a></code> mit dem Argument <code>method = "within"</code>.</p></div></div><p>Fixed-Effects-Regressionen können mit <code><a href="https://lrberge.github.io/fixest/reference/feols.html">fixest::feols()</a></code> geschätzt werden.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> Je nach Spezifikation des Formula-Arguments (<code>fml</code>) wird ein effizienter Algorithmus für eine Variante von <span class="math inline">\(\eqref{eq:femodel}\)</span> angwandt. Für <code>paneldata.csv</code> erhalten wir mit <code>fml = Y ~ X | ID</code> per Referenz des Indikators <code>ID</code> eine Schätzung mit Berechnung der einheiten-spezifischen Effekte.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Fixed-Effects-Schätzung</span></span>
<span><span class="va">panel_FE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span></span>
<span>  fml <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">|</span> <span class="va">ID</span>,  </span>
<span>  data <span class="op">=</span> <span class="va">paneldata</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">panel_FE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OLS estimation, Dep. Var.: Y
Observations: 96
Fixed-effects: ID: 12
Standard-errors: Clustered (ID) 
  Estimate Std. Error  t value   Pr(&gt;|t|)    
X -1.04507    0.10473 -9.97865 7.5526e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.746006     Adj. R2: 0.996829
                 Within R2: 0.602694</code></pre>
</div>
</div>
<p>Die Zusammenfassung der Schätzung zeigt einen signifikanten Koeffizienten, der mit einer Schätzung von <span class="math inline">\(-1.05\)</span> nahe beim wahren Wert von <span class="math inline">\(\beta_1 = -1\)</span> liegt. Die geschätzten einheiten-spezifischen Effekte können mit <code><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html">fixest::fixef()</a></code> ausgelesen werden.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Geschätzte Fixed Effects (Einheiten) auslesen</span></span>
<span><span class="fu">fixest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html">fixef</a></span><span class="op">(</span><span class="va">panel_FE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$ID
        1         2         3         4         5         6         7         8 
 3.814550  7.149097 12.716507 15.319130 23.458442 28.239634 33.659734 35.729516 
        9        10        11        12 
41.701817 47.911623 55.044052 59.445967 

attr(,"class")
[1] "fixest.fixef" "list"        
attr(,"exponential")
[1] FALSE</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Facts zu Fixed-Effects-Regression
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Fixed-Effects-Schätzer kontrollieren für den Einfluss von Heterogenitäten zwischen Beobachtungseinheiten die über die Zeit konstant sind (einheiten-spezifische Effekte) und/oder für Heterogenitäten, die identisch für die Beobachtungseinheiten sind, jedoch über die Zeit variieren (Zeit-Effekte).</p></li>
<li><p>Ein Fixed-Effects-Ansatz ist nötig, wenn <em>unbeobachtete</em>, mit den erklärenden Variablen korrelierte Heterogenitäten vorhanden sind. Kontrolle für letztere gewährleistet eine verzerrungsfreie Schätzung der Regressionskoeffizienten in Panel-Studien.</p></li>
<li><p>LSDV-Regression ist eine Variante zur Schätzung bei Fixed Effects mit KQ. Hierbei werden Backdoors durch unbeobachtbare Heterogenitäten mit Dummy-Variablen geschlossen. In einer LSDV-Regression können die Koeffizienten zeitlich konstanter Variablen geschätzt werden.</p></li>
<li><p>KQ liefert in Fixed-Effects-Designs erwartungstreue und konsistente Schätzer, solange die erklärenden Variablen zeitlich unkorreliert mit den Fehlertermen sind.</p></li>
<li><p>Statistische Inferenz für Fixed-Effects-Schätzer erfolgt anhand einer Approximation der asymptotischen Normalverteilung. Da die Fehlerterme heteroskedastisch und/oder über die Zeit korreliert sein können, sollten (cluster) robuste Standardfehler verwendet werden.</p></li>
<li><p>Fixed Effects Modelle können in R mit dem Paketen <code>fixest</code> oder <code>plm</code> berechnet werden.</p></li>
</ul>
</div>
</div>
<section id="zeit-fixed-effects" class="level3 page-columns page-full" data-number="5.3.1"><h3 data-number="5.3.1" class="anchored" data-anchor-id="zeit-fixed-effects">
<span class="header-section-number">5.3.1</span> Zeit-Fixed-Effects</h3>
<p>Neben zeit-invarianten Heterogenitäten zwischen den Beobachtungseinheiten können beobachtbare und unbeobachtbare Einflüsse vorliegen, die nicht zwischen den Einheiten, jedoch über die Zeit variieren. Ein DGP mit solchen zeitabhängigen Heterogenitäten ist in <a href="#fig-FEDAG3" class="quarto-xref">Abbildung&nbsp;<span>5.7</span></a> für <span class="math inline">\(T=2\)</span> dargestellt.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn10"><p><sup>10</sup>&nbsp;Zur Vereinfachung der Interpretierbarkeit vernachlässigt das DAG in <a href="#fig-FEDAG3" class="quarto-xref">Abbildung&nbsp;<span>5.7</span></a> zeitlich konstante Variablen.</p></div></div><div class="cell page-columns page-full" data-fig-width="6" data-fig-height="4" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-FEDAG3" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-FEDAG3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<svg width="576" height="384" viewbox="0.00 0.00 501.94 476.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 472)"><title>FE_dag3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-472 497.94,-472 497.94,4 -4,4"></polygon><!-- U1 --><g id="node1" class="node"><title>U1</title>
<ellipse fill="none" stroke="gray" cx="174.97" cy="-450" rx="30.94" ry="18"></ellipse><text text-anchor="start" x="160.52" y="-446.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00" fill="gray">U</text><text text-anchor="start" x="170.63" y="-446.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00" fill="gray">t=1</text></g><!-- U2 --><g id="node2" class="node"><title>U2</title>
<ellipse fill="none" stroke="gray" cx="318.97" cy="-450" rx="30.94" ry="18"></ellipse><text text-anchor="start" x="304.52" y="-446.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00" fill="gray">U</text><text text-anchor="start" x="314.63" y="-446.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00" fill="gray">t=2</text></g><!-- U1&#45;&gt;U2 --><g id="edge14" class="edge"><title>U1-&gt;U2</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M206.21,-450C227.16,-450 254.97,-450 277.72,-450"></path><polygon fill="gray" stroke="gray" points="277.78,-453.5 287.78,-450 277.78,-446.5 277.78,-453.5"></polygon></g><!-- X1 --><g id="node3" class="node"><title>X1</title>
<ellipse fill="none" stroke="black" cx="174.97" cy="-18" rx="30.94" ry="18"></ellipse><text text-anchor="start" x="160.52" y="-14.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">X</text><text text-anchor="start" x="170.63" y="-14.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00">t=1</text></g><!-- U1&#45;&gt;X1 --><g id="edge1" class="edge"><title>U1-&gt;X1</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M174.97,-431.99C174.97,-364.74 174.97,-128.08 174.97,-46.16"></path><polygon fill="gray" stroke="gray" points="178.47,-46.09 174.97,-36.09 171.47,-46.09 178.47,-46.09"></polygon></g><!-- B1 --><g id="node5" class="node"><title>B1</title>
<ellipse fill="none" stroke="black" cx="30.97" cy="-162" rx="30.37" ry="18"></ellipse><text text-anchor="start" x="16.91" y="-158.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">B</text><text text-anchor="start" x="26.24" y="-158.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00">t=1</text></g><!-- U1&#45;&gt;B1 --><g id="edge3" class="edge"><title>U1-&gt;B1</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M166.18,-432.42C141.82,-383.7 73.34,-246.74 44.28,-188.62"></path><polygon fill="gray" stroke="gray" points="47.25,-186.73 39.64,-179.35 40.99,-189.86 47.25,-186.73"></polygon></g><!-- Y1 --><g id="node6" class="node"><title>Y1</title>
<ellipse fill="none" stroke="black" cx="30.97" cy="-306" rx="30.94" ry="18"></ellipse><text text-anchor="start" x="16.52" y="-302.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Y</text><text text-anchor="start" x="26.63" y="-302.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00">t=1</text></g><!-- U1&#45;&gt;Y1 --><g id="edge2" class="edge"><title>U1-&gt;Y1</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M159.28,-434.32C133.86,-408.89 83.52,-358.55 54.01,-329.04"></path><polygon fill="gray" stroke="gray" points="56.18,-326.26 46.63,-321.67 51.23,-331.21 56.18,-326.26"></polygon></g><!-- X2 --><g id="node4" class="node"><title>X2</title>
<ellipse fill="none" stroke="black" cx="318.97" cy="-18" rx="30.94" ry="18"></ellipse><text text-anchor="start" x="304.52" y="-14.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">X</text><text text-anchor="start" x="314.63" y="-14.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00">t=2</text></g><!-- U2&#45;&gt;X2 --><g id="edge8" class="edge"><title>U2-&gt;X2</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M318.97,-431.99C318.97,-364.74 318.97,-128.08 318.97,-46.16"></path><polygon fill="gray" stroke="gray" points="322.47,-46.09 318.97,-36.09 315.47,-46.09 322.47,-46.09"></polygon></g><!-- B2 --><g id="node7" class="node"><title>B2</title>
<ellipse fill="none" stroke="black" cx="462.97" cy="-162" rx="30.37" ry="18"></ellipse><text text-anchor="start" x="448.91" y="-158.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">B</text><text text-anchor="start" x="458.24" y="-158.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00">t=2</text></g><!-- U2&#45;&gt;B2 --><g id="edge10" class="edge"><title>U2-&gt;B2</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M327.76,-432.42C352.12,-383.7 420.6,-246.74 449.66,-188.62"></path><polygon fill="gray" stroke="gray" points="452.95,-189.86 454.29,-179.35 446.69,-186.73 452.95,-189.86"></polygon></g><!-- Y2 --><g id="node8" class="node"><title>Y2</title>
<ellipse fill="none" stroke="black" cx="462.97" cy="-306" rx="30.94" ry="18"></ellipse><text text-anchor="start" x="448.52" y="-302.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Y</text><text text-anchor="start" x="458.63" y="-302.8" font-family="Helvetica,Arial,sans-serif" baseline-shift="sub" font-size="14.00">t=2</text></g><!-- U2&#45;&gt;Y2 --><g id="edge9" class="edge"><title>U2-&gt;Y2</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M334.65,-434.32C360.08,-408.89 410.42,-358.55 439.93,-329.04"></path><polygon fill="gray" stroke="gray" points="442.71,-331.21 447.3,-321.67 437.76,-326.26 442.71,-331.21"></polygon></g><!-- X1&#45;&gt;X2 --><g id="edge15" class="edge"><title>X1-&gt;X2</title>
<path fill="none" stroke="black" d="M206.21,-18C227.16,-18 254.97,-18 277.72,-18"></path><polygon fill="black" stroke="black" points="277.78,-21.5 287.78,-18 277.78,-14.5 277.78,-21.5"></polygon></g><!-- X1&#45;&gt;B1 --><g id="edge5" class="edge"><title>X1-&gt;B1</title>
<path fill="none" stroke="black" d="M159.28,-33.68C133.86,-59.11 83.52,-109.45 54.01,-138.96"></path><polygon fill="black" stroke="black" points="51.23,-136.79 46.63,-146.33 56.18,-141.74 51.23,-136.79"></polygon></g><!-- X1&#45;&gt;Y1 --><g id="edge4" class="edge"><title>X1-&gt;Y1</title>
<path fill="none" stroke="black" d="M166.18,-35.58C141.82,-84.3 73.34,-221.26 44.28,-279.38"></path><polygon fill="black" stroke="black" points="40.99,-278.14 39.64,-288.65 47.25,-281.27 40.99,-278.14"></polygon></g><!-- X2&#45;&gt;B2 --><g id="edge12" class="edge"><title>X2-&gt;B2</title>
<path fill="none" stroke="black" d="M334.65,-33.68C360.08,-59.11 410.42,-109.45 439.93,-138.96"></path><polygon fill="black" stroke="black" points="437.76,-141.74 447.3,-146.33 442.71,-136.79 437.76,-141.74"></polygon></g><!-- X2&#45;&gt;Y2 --><g id="edge11" class="edge"><title>X2-&gt;Y2</title>
<path fill="none" stroke="black" d="M327.76,-35.58C352.12,-84.3 420.6,-221.26 449.66,-279.38"></path><polygon fill="black" stroke="black" points="446.69,-281.27 454.29,-288.65 452.95,-278.14 446.69,-281.27"></polygon></g><!-- B1&#45;&gt;Y1 --><g id="edge6" class="edge"><title>B1-&gt;Y1</title>
<path fill="none" stroke="black" d="M30.97,-180.24C30.97,-204.8 30.97,-248.75 30.97,-277.65"></path><polygon fill="black" stroke="black" points="27.47,-277.91 30.97,-287.91 34.47,-277.91 27.47,-277.91"></polygon></g><!-- B1&#45;&gt;B2 --><g id="edge7" class="edge"><title>B1-&gt;B2</title>
<path fill="none" stroke="black" d="M61.69,-162C138.02,-162 336.31,-162 422.25,-162"></path><polygon fill="black" stroke="black" points="422.4,-165.5 432.4,-162 422.4,-158.5 422.4,-165.5"></polygon></g><!-- B2&#45;&gt;Y2 --><g id="edge13" class="edge"><title>B2-&gt;Y2</title>
<path fill="none" stroke="black" d="M462.97,-180.24C462.97,-204.8 462.97,-248.75 462.97,-277.65"></path><polygon fill="black" stroke="black" points="459.47,-277.91 462.97,-287.91 466.47,-277.91 459.47,-277.91"></polygon></g></g></svg>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-FEDAG3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;5.7: Panel-Design mit Backdoors durch beobachtete und unbeobachtete zeitabhängige Variablen
</figcaption></figure>
</div>
</div>
</div>
<p>Für beobachtbare zeitabhängige Backdoor-Variablen <span class="math inline">\(X_t\)</span> kann durch Aufnahme dieser in die Regression <span class="math inline">\(\eqref{eq:femodel}\)</span> kontrolliert werden. Analog zum Fixed-Effects-Ansatz mit einheiten-spezifischen Konstanten können Backdoors durch unbeobachtbare zeitabhängige Einflüsse <span class="math inline">\(U_t\)</span> durch Kontrolle für perioden-spezifische Dummies <span class="math inline">\(D_t^{(t)}\)</span> (Time Fixed Effects) vermieden werden. Das Modell lautet dann</p>
<p><span class="math display">\[\begin{align*}
  Y_{it} = \beta_0 + \beta_1 B_{it} + \beta_2 X_t + \lambda_2 D_t^{(2)} + \cdots + \lambda_T D_t^{(T)} + \epsilon_{it}.
\end{align*}\]</span></p>
<p>In empirischen Anwendung ist es häufig plausibel, für zeit- und einheiten-spezifische Effekte zu kontrollieren. Der entsprechende Regressionsansatz wird als <em>Two Way Fixed Effects</em> (TWFE) bezeichnet.</p>
<p>Ein TWFE-Modell für <code>paneldata.csv</code> kann mit <code><a href="https://lrberge.github.io/fixest/reference/feols.html">feols()</a></code> leicht unter Angabe der Identifikationsvariable der Zeitperioden (<code>time</code>) innerhalb des <code>fml</code>-Arguments geschätzt werden.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># TWFE-Schätzung</span></span>
<span><span class="va">panel_TWFE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span></span>
<span>  fml <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">|</span> <span class="va">ID</span> <span class="op">+</span> <span class="va">time</span>,  </span>
<span>  data <span class="op">=</span> <span class="va">paneldata</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">panel_TWFE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OLS estimation, Dep. Var.: Y
Observations: 96
Fixed-effects: ID: 12,  time: 8
Standard-errors: Clustered (ID) 
  Estimate Std. Error  t value   Pr(&gt;|t|)    
X -1.01411   0.096129 -10.5495 4.3209e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.655695     Adj. R2: 0.997325
                 Within R2: 0.636218</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Geschätzte Fixed Effects (Einheiten + Zeit) auslesen</span></span>
<span><span class="fu">fixest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html">fixef</a></span><span class="op">(</span><span class="va">panel_TWFE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$ID
        1         2         3         4         5         6         7         8 
 3.608414  6.893444 12.445006 15.020731 23.126151 27.884480 33.255238 35.311437 
        9        10        11        12 
41.252680 47.433690 54.515757 58.889276 

$time
          1           2           3           4           5           6 
 0.00000000 -0.16836639  0.84624725  0.09109152  0.45843997 -0.38103581 
          7           8 
 0.24023573  0.31186366 

attr(,"class")
[1] "fixest.fixef" "list"        
attr(,"references")
  ID time 
   0    1 
attr(,"exponential")
[1] FALSE</code></pre>
</div>
</div>
</section></section><section id="random-effects" class="level2 page-columns page-full" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="random-effects">
<span class="header-section-number">5.4</span> Random Effects</h2>
<p>Der Fixed-Effects-Ansatz behandelt die einheiten-spezifischen Effekte <span class="math inline">\(\delta_i\)</span> in Modell <span class="math inline">\(\eqref{eq:femodel}\)</span> als konstante Parameter. Das einfache Random-Effects-Modell lautet <span class="math display">\[\begin{align*}
  Y_{it} =&amp;\, \beta_0 + \beta_1 B_{it} + \varepsilon_{it},
\end{align*}\]</span> wobei sich der Fehlerterm <span class="math inline">\(\varepsilon_{it}\)</span> aus dem zufälligen individuellen Effekt <span class="math inline">\(\delta_i\)</span> und dem unabhängigen Fehler <span class="math inline">\(\epsilon_{it}\)</span> zusammensetzt, <span class="math display">\[\begin{align*}
  \varepsilon_{it} = \alpha_i + \epsilon_{it}.
\end{align*}\]</span> Der Random-Effects-Ansatz betrachtet die <span class="math inline">\(\delta_i\)</span> als <em>Zufallsvariablen</em> mit einer gemeinsamen (Normal)Verteilung, unter der Annahme, dass die <span class="math inline">\(\delta_i\)</span> <em>nicht</em> mit den erklärenden Variablen korrelieren.<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a> Falls diese Annahme erfüllt ist, ist der Random-Random-Effects-Schätzer effizienter als der Fixed-Effects-Schätzer: Der mittlere quadratische Fehler der Schätzung ist geringer.<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn11"><p><sup>11</sup>&nbsp;Weiterhin dürfen die <span class="math inline">\(\delta_i\)</span> nicht mit dem Fehler <span class="math inline">\(\epsilon_{it}\)</span> korrelieren.</p></div><div id="fn12"><p><sup>12</sup>&nbsp;Die Schätzung erfolgt oft mit der <a href="https://de.wikipedia.org/wiki/Maximum-Likelihood-Methode">Maximum-Likelihood-Methode</a>.</p></div></div><p>Für ein Beispiel simulieren wir Daten gemäß der Vorschrift <span class="math display">\[\begin{align}
  y_{it} = \alpha_i + \beta B_{it} + \epsilon_{it},\label{eq:resim}
\end{align}\]</span> wobei <span class="math inline">\(\alpha_i\)</span> die individuellen Zufallseffekte. Wir wählen <span class="math display">\[\begin{align*}
  &amp; \alpha_i \overset{u.i.v}{\sim} N(0,2.5^2), \\
  &amp; \beta_1 = -1,\\
  &amp; X_{it} \sim N(0,1),\\
  &amp; \epsilon_{it} \overset{u.i.v}{\sim} N(0,0.75^2).
\end{align*}\]</span> Wie in <code>paneldata.csv</code> erzeugen wir Daten für <span class="math inline">\(n=12\)</span> Individuen, die zu <span class="math inline">\(T=8\)</span> Zeitperioden beobachtet werden. Mit diesen Komponenten wird die Outcome-Variable <span class="math inline">\(y_{it}\)</span> wie in <span class="math inline">\(\eqref{eq:resim}\)</span> generiert. Der nachstehende Code erzeugt die Daten als Matrizen für und , die anschließend in ein langes Datenformat (<code>tibble</code>) umgewandelt werden.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=plm">plm</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parameter</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">12</span>  <span class="co"># Individuen</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">8</span>   <span class="co"># Perioden</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="co"># Behandlungseffekt</span></span>
<span><span class="va">sigma_alpha</span> <span class="op">&lt;-</span> <span class="fl">2.5</span> <span class="co"># SD für RE</span></span>
<span><span class="va">sigma_epsilon</span> <span class="op">&lt;-</span> <span class="fl">0.75</span> <span class="co"># SD für Fehler</span></span>
<span></span>
<span><span class="co"># Random Effects</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="va">sigma_alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Matrizen</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulation</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">X</span><span class="op">[</span><span class="va">t</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">epsilon_it</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="va">sigma_epsilon</span><span class="op">)</span></span>
<span>    <span class="va">y</span><span class="op">[</span><span class="va">t</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">alpha</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">X</span><span class="op">[</span><span class="va">t</span>, <span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">epsilon_it</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># tibble erzeugen</span></span>
<span><span class="va">RE_paneldata</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, each <span class="op">=</span> <span class="va">m</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">m</span>, times <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>  X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Für die Anpassung des Random-Effect-Schätzers an den simulierten Datensatz <code>RE_paneldata</code> nutzen wir <code><a href="https://rdrr.io/pkg/plm/man/plm.html">plm::plm()</a></code> mit <code>model = "random"</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Random-Effects-Modell anpassen</span></span>
<span><span class="va">panel_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">X</span>, </span>
<span>  data <span class="op">=</span> <span class="va">RE_paneldata</span>, </span>
<span>  index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"time"</span><span class="op">)</span>, </span>
<span>  model <span class="op">=</span> <span class="st">"random"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">panel_RE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)

Call:
plm(formula = y ~ X, data = RE_paneldata, model = "random", index = c("id", 
    "time"))

Balanced Panel: n = 12, T = 8, N = 96

Effects:
                 var std.dev share
idiosyncratic 0.5221  0.7226  0.13
individual    3.4801  1.8655  0.87
theta: 0.8643

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-2.019439 -0.351116  0.017785  0.420719  2.109010 

Coefficients:
             Estimate Std. Error  z-value Pr(&gt;|z|)    
(Intercept) -1.156573   0.552747  -2.0924   0.0364 *  
X           -0.996175   0.075859 -13.1320   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    143.86
Residual Sum of Squares: 50.753
R-Squared:      0.64721
Adj. R-Squared: 0.64346
Chisq: 172.45 on 1 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
</div>
<p>Die Schätzung zeigt eine gute Anpassung an die Daten und der geschätzte Behandlungseffekt liegt mit <span class="math inline">\(-0.996\)</span> nahe am wahren Koeffizienten <span class="math inline">\(\beta_1 = -1\)</span>.</p>
<p>Mit <code><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">plm::ranef()</a></code> erhalten wir <em>Differenzen</em> der geschätzten einheiten-spezifischen Effekte vom geschätzten Erwartungswert der unterstellten gemeinsamen Verteilung.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Gesch. Random Effects auslesen</span></span>
<span><span class="co"># (Differenzen zum geschätzten Mittelwert der gem. Verteilung)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">panel_RE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1           2           3           4           5           6 
-1.92217199  1.24364147  3.27470045 -4.12524574  2.00235610  2.71903482 
          7           8           9          10          11          12 
-0.17492965 -0.50237866  0.01435925 -1.03252985  0.16092971 -1.65776590 </code></pre>
</div>
</div>
<p>Für die grafische Darstellung der Schätzung berechnen wir zunächst mit <code><a href="https://rdrr.io/r/stats/fitted.values.html">fitted()</a></code> die angepassten Werte. Für ein mit <code><a href="https://rdrr.io/pkg/plm/man/plm.html">plm()</a></code> geschätztes Random-Effects-Modell werden die individuellen Effekte von <code><a href="https://rdrr.io/r/stats/fitted.values.html">fitted()</a></code> nicht berücksichtigt und müssen daher manuell hinzugefügt werden. Hierfür lesen wir zunächst den geschätzten Erwartungswert der gemeinsamen Verteilung <span class="math inline">\(\widehat{\beta}_0\)</span> aus und addieren anschließend die von <code><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef()</a></code> ausgegebenen Differenzen der individuellen Effekte gruppenweise.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Gesch. Erwartungswert der gem. Verteilung</span></span>
<span><span class="va">hat_beta_0</span> <span class="op">&lt;-</span> <span class="va">panel_RE</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Gesch. Random Effects berücksichtigen</span></span>
<span><span class="va">RE_paneldata</span> <span class="op">&lt;-</span> <span class="va">RE_paneldata</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    fitted_RE <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">panel_RE</span><span class="op">)</span> </span>
<span>    <span class="op">+</span> <span class="va">hat_beta_0</span> </span>
<span>    <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">panel_RE</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">RE_paneldata</span>, </span>
<span>  mapping <span class="op">=</span> </span>
<span>    <span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">X</span>, </span>
<span>      y <span class="op">=</span> <span class="va">y</span>, </span>
<span>      col <span class="op">=</span> <span class="va">id</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">fitted_RE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span>, </span>
<span>    show.legend <span class="op">=</span> <span class="cn">F</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-repanelest" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-repanelest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="FixedEffects_files/figure-html/fig-repanelest-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-repanelest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;5.8: <code>RE_paneldata</code> – Random-Effects-Schätzung für simulierte Daten
</figcaption></figure>
</div>
</div>
</div>
<p>Die Random-Effects-Methode findet bei kausalen Analyse in empirischen Anwendungen selten Anwendung, weil die Annahme von Unkorreliertheit mit den erklärenden Regressoren oft unplausibel ist. Falls diese Annahme (wie in den DAGs <a href="#fig-FEDAG1" class="quarto-xref">Abbildung&nbsp;<span>5.1</span></a> und <a href="#fig-FEDAG2" class="quarto-xref">Abbildung&nbsp;<span>5.2</span></a>) verletzt ist, kann Random Effects die ensprechenden Backdoors nicht schließen: Der Random-Effects-Schätzer ist dann verzerrt und inkonsistent, ähnlich wie der naive KQ-Schätzer in einer Pooled Regression.</p>
<section id="verzerrung-bei-endogenität" class="level3 page-columns page-full" data-number="5.4.1"><h3 data-number="5.4.1" class="anchored" data-anchor-id="verzerrung-bei-endogenität">
<span class="header-section-number">5.4.1</span> Verzerrung bei Endogenität</h3>
<p>Zur Illustration der Verzerrung des Random-Effects-Schätzers bei Endogenität von erklärenden Variablen verwenden wir erneut den anhand eines Fixed-Effects-DGPs simulierten Datensatz <code>paneldata.csv</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Random-Effects-Schätzung für `paneldata`</span></span>
<span><span class="va">panel_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>,  </span>
<span>  model <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>  index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"time"</span><span class="op">)</span>,  </span>
<span>  data <span class="op">=</span> <span class="va">paneldata</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">panel_RE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)

Call:
plm(formula = Y ~ X, data = paneldata, model = "random", index = c("ID", 
    "time"))

Balanced Panel: n = 12, T = 8, N = 96

Effects:
                 var std.dev share
idiosyncratic 0.6437  0.8023 0.229
individual    2.1732  1.4742 0.771
theta: 0.811

Residuals:
   Min. 1st Qu.  Median 3rd Qu.    Max. 
-6.0355 -1.9888 -0.1651  1.9196  6.4374 

Coefficients:
            Estimate Std. Error z-value  Pr(&gt;|z|)    
(Intercept) 18.34586    2.31566  7.9225 2.328e-15 ***
X            0.77031    0.26346  2.9238  0.003458 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    818.14
Residual Sum of Squares: 749.94
R-Squared:      0.083362
Adj. R-Squared: 0.07361
Chisq: 8.54862 on 1 DF, p-value: 0.0034579</code></pre>
</div>
</div>
<p>Offenbar weicht der Random-Effects-Schätzer des Effects von <span class="math inline">\(X\)</span> auf <span class="math inline">\(Y\)</span> deutlich vom wahren Parameter <span class="math inline">\(\beta_1 = -1\)</span> ab. Diese Abweichung ist auf die Endogenität von <span class="math inline">\(X\)</span> zurückzuführen.</p>
<p>Die nächste Grafik vergleicht die Schätzungen des Behandlungseffekts für den Datensatz <code>paneldata.csv</code> mit Pooling (schwarze Linie), Fixed Effects (farbige Linien) und Random Effects (gestrichelte schwarze Linie). Vorab erweitern wir <code>paneldata</code> um die angepassten Werte für die Fixed- und die Random-Effects-Schätzung in <code>panel_FE</code> und <code>panel_RE</code>.<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn13"><p><sup>13</sup>&nbsp;Für bessere Lesbarkeit erzeugen wir hier mit <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> eine Regressionsgerade, deren Achsenabschnitt dem geschätzten Erwartungswert der Random-Effects-Verteilung entspricht.</p></div></div><div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">paneldata</span> <span class="op">&lt;-</span> <span class="va">paneldata</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="co"># Vorhergesagte Werte für FE-Schätzung</span></span>
<span>    yhat_FE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">panel_FE</span><span class="op">)</span>,</span>
<span>    <span class="co"># Vorhergesagte Werte für RE-Schätzung</span></span>
<span>    yhat_RE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">panel_RE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">paneldata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">col</span><span class="op">)</span>, </span>
<span>    show.legend <span class="op">=</span> <span class="cn">F</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Pooling</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"lm"</span>, </span>
<span>    se <span class="op">=</span> <span class="cn">F</span>,</span>
<span>    col <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Fixed Effects</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">yhat_FE</span>, group <span class="op">=</span> <span class="va">ID</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">)</span>, </span>
<span>    show.legend <span class="op">=</span> <span class="cn">F</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Random Effects</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">yhat_RE</span><span class="op">)</span>, </span>
<span>    lty <span class="op">=</span> <span class="st">"dashed"</span>, </span>
<span>    show.legend <span class="op">=</span> <span class="cn">F</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-panelcomparison" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-panelcomparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="FixedEffects_files/figure-html/fig-panelcomparison-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-panelcomparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;5.9: <code>paneldaten.csv</code> – Vergleich von Schätzern bei Einheiten mit endogeneen Effekten
</figcaption></figure>
</div>
</div>
</div>
<hr>
<p><strong>Interaktive Illustration von Panel-Schätzern</strong></p>
<p>Die nachfolgende interaktive Illustration erlaubt einen Vergleich der in <a href="#fig-panelcomparison" class="quarto-xref">Abbildung&nbsp;<span>5.9</span></a> geplotteten geschätzten Regressionsfunktionen für <code>paneldata.csv</code> mit dem wahren DGP (Show truth) unter Reproduktion der in <a href="#fig-panelcomparison" class="quarto-xref">Abbildung&nbsp;<span>5.9</span></a> gezeigten Komponenten.</p>
<iframe width="100%" height="642" frameborder="0" src="https://observablehq.com/embed/@mca91/panelcomp?cells=viewof+showgroups%2Cviewof+showdgp%2Cviewof+regtype%2Ctheplot">
</iframe>
</section></section><section id="beispiel-einkommen-und-demokratie" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="beispiel-einkommen-und-demokratie">
<span class="header-section-number">5.5</span> Beispiel: Einkommen und Demokratie</h2>
<p>Eine Vielzahl polit-ökonomischer Standardwerke und Studien <span class="citation" data-cites="Dahl1971 Huntington1991 Rueschemeyer1992">(bspw. <a href="Literatur.html#ref-Dahl1971" role="doc-biblioref">Dahl 1971</a>; <a href="Literatur.html#ref-Huntington1991" role="doc-biblioref">Huntington 1991</a>; <a href="Literatur.html#ref-Rueschemeyer1992" role="doc-biblioref">Rueschemeyer, Stephens, und Stephens 1992</a>)</span> liefert vermeindliche Belege für einen zentralen Grundsatz der <a href="https://de.wikipedia.org/wiki/Modernisierungstheorie">Modernisierungstheorie</a>: Ein höheres Pro-Kopf-Einkommen erhöht die Nachfrage der Bevölkerung nach politischer Freiheit und demokratischen Insitutionen. <span class="citation" data-cites="Acemogluetal2008">Acemoglu u.&nbsp;a. (<a href="Literatur.html#ref-Acemogluetal2008" role="doc-biblioref">2008a</a>)</span> argumentieren, dass der in derartigen länderübergreifenden Analysen mit Pooling häufig als positiv geschätzte Zusammenhang zwischen Einkommen und Demokratisierung nicht kausal interpetiert werden sollte. Ein Grund hierfür ist, dass (unbeobachtbare) ausgelassene länderspezifische Faktoren, die sowohl die ökonomische Entwicklung als auch die Stärke demokratischer Institutionen beeinflussen, wahrscheinlich sind. Um diese mögliche Ursache für Endogenität des Zusammenhangs <span class="math display">\[\begin{align}
  \text{Demokratisierung}_i = \beta_0 + \beta_1\,\text{PK-Einkommen}_i + \epsilon_i
\end{align}\]</span> zu adressieren, nutzen <span class="citation" data-cites="Acemogluetal2008">Acemoglu u.&nbsp;a. (<a href="Literatur.html#ref-Acemogluetal2008" role="doc-biblioref">2008a</a>)</span> einen Panel-Regressionsansatz ähnlich zu <span class="math display">\[\begin{align}
  \text{Demokratisierung}_{it} = \delta_i + \beta_1\,\text{PK-Einkommen}_{it} + \epsilon_{it}
\end{align}\]</span> mit Fixed Effects <span class="math inline">\(\delta_i\)</span>, die für länderspezifische zeit-invariante Einflüsse kontrollieren.</p>
<p>Das Kernergebnis von <span class="citation" data-cites="Acemogluetal2008">Acemoglu u.&nbsp;a. (<a href="Literatur.html#ref-Acemogluetal2008" role="doc-biblioref">2008a</a>)</span> ist, dass es <em>keinen</em> kausalen Zusammenhang zwischen dem Einkommen (Wirtschaftswachstum) und der Demokratisierung gibt. Die Autoren zeigen, dass historische und geografische Faktoren, die sowohl das Einkommen als auch die politischen Institutionen beeinflussen, den beobachteten Zusammenhang verzerren können.</p>
<p>Für die nachfolgenden Code-Beispiele nutzen wir einen Auszug des Datensatzes aus dem Replikationspaket zu <span class="citation" data-cites="Acemogluetal2008">Acemoglu u.&nbsp;a. (<a href="Literatur.html#ref-Acemogluetal2008" role="doc-biblioref">2008a</a>)</span>, siehe <span class="citation" data-cites="Acemogluetal2008data">Acemoglu u.&nbsp;a. (<a href="Literatur.html#ref-Acemogluetal2008data" role="doc-biblioref">2008b</a>)</span>.</p>
<p>Wir lesen zunächst den Datensatz <code>Acemogluetal2008.csv</code> ein.</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">acem</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xls</a></span><span class="op">(</span></span>
<span>  <span class="st">"~/Downloads/113251-V1/Income-and-Democracy-Data-AER-adjustment.xls"</span>, </span>
<span>  sheet <span class="op">=</span> <span class="st">"5 Year Panel"</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">acem</span> <span class="op">&lt;-</span> <span class="va">acem</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html">between</a></span><span class="op">(</span><span class="va">year</span>, <span class="fl">1955</span>, <span class="fl">2000</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">year</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Pooling</span></span>
<span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span></span>
<span>  fml <span class="op">=</span> <span class="va">fhpolrigaug</span> <span class="op">~</span> <span class="va">lrgdpch</span>,</span>
<span>  panel.id <span class="op">=</span> <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">year</span>,</span>
<span>  data <span class="op">=</span> <span class="va">acem</span>, </span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OLS estimation, Dep. Var.: fhpolrigaug
Observations: 1,090
Standard-errors: Clustered (country) 
             Estimate Std. Error  t value  Pr(&gt;|t|)    
(Intercept) -1.210494   0.094546 -12.8032 &lt; 2.2e-16 ***
lrgdpch      0.217745   0.011194  19.4518 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.273788   Adj. R2: 0.404579</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">acem_f</span> <span class="op">&lt;-</span> <span class="va">acem</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1970</span>, <span class="fl">1995</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">code</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    dlrgdpch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">lrgdpch</span><span class="op">)</span>,</span>
<span>    dfhpolrigaug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">fhpolrigaug</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">dfhpolrigaug</span> <span class="op">~</span> <span class="va">dlrgdpch</span>,</span>
<span>  data <span class="op">=</span> <span class="va">acem_f</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dfhpolrigaug ~ dlrgdpch, data = acem_f)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.9582 -0.1541 -0.1172  0.2081  0.7079 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  0.12629    0.04008   3.151  0.00214 **
dlrgdpch     0.03298    0.06354   0.519  0.60486   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3422 on 101 degrees of freedom
Multiple R-squared:  0.00266,   Adjusted R-squared:  -0.007214 
F-statistic: 0.2694 on 1 and 101 DF,  p-value: 0.6049</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">acem_f</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">dlrgdpch</span>,</span>
<span>    y <span class="op">=</span> <span class="va">dfhpolrigaug</span></span>
<span>  <span class="op">)</span> </span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">code</span><span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu">position_jitter</span><span class="op">(</span></span>
<span>      height <span class="op">=</span> <span class="fl">.05</span>, </span>
<span>      seed <span class="op">=</span> <span class="fl">1234</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Diff. Log(Pro-Kopf-BIP) (1970 - 1995)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Diff. Demokratie-Index (1970 - 1995)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="FixedEffects_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># time + country fixed effects</span></span>
<span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span></span>
<span>  fml <span class="op">=</span> <span class="va">fhpolrigaug</span> <span class="op">~</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/l.html">l</a></span><span class="op">(</span><span class="va">fhpolrigaug</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/l.html">l</a></span><span class="op">(</span><span class="va">lrgdpch</span><span class="op">)</span> </span>
<span>  <span class="op">|</span> <span class="va">year</span> <span class="op">+</span> <span class="va">country</span>,</span>
<span>  panel.id <span class="op">=</span> <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">year</span>,</span>
<span>  cluster <span class="op">=</span> <span class="op">~</span> <span class="va">country</span>,</span>
<span>  data <span class="op">=</span> <span class="va">acem</span>, </span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OLS estimation, Dep. Var.: fhpolrigaug
Observations: 955
Fixed-effects: year: 9,  country: 150
Standard-errors: Clustered (country) 
                  Estimate Std. Error  t value   Pr(&gt;|t|)    
l(fhpolrigaug, 1) 0.377490   0.048071 7.852772 7.4009e-13 ***
l(lrgdpch, 1)     0.008417   0.031587 0.266461 7.9025e-01    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.16588     Adj. R2: 0.748871
                Within R2: 0.140859</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># time-fixed effects</span></span>
<span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span></span>
<span>  fml <span class="op">=</span> <span class="va">fhpolrigaug</span> <span class="op">~</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/l.html">l</a></span><span class="op">(</span><span class="va">fhpolrigaug</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/l.html">l</a></span><span class="op">(</span><span class="va">lrgdpch</span><span class="op">)</span> </span>
<span>  <span class="op">|</span> <span class="va">year</span>,</span>
<span>  panel.id <span class="op">=</span> <span class="op">~</span> <span class="va">country</span> <span class="op">+</span> <span class="va">year</span>,</span>
<span>  cluster <span class="op">=</span> <span class="op">~</span> <span class="va">country</span>,</span>
<span>  data <span class="op">=</span> <span class="va">acem</span>, </span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OLS estimation, Dep. Var.: fhpolrigaug
Observations: 955
Fixed-effects: year: 9
Standard-errors: Clustered (country) 
                  Estimate Std. Error  t value   Pr(&gt;|t|)    
l(fhpolrigaug, 1) 0.702504   0.036023 19.50147  &lt; 2.2e-16 ***
l(lrgdpch, 1)     0.073042   0.009861  7.40714 8.8791e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.191614     Adj. R2: 0.7178  
                 Within R2: 0.705629</code></pre>
</div>
</div>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Acemogluetal2008" class="csl-entry" role="listitem">
Acemoglu, Daron, Simon Johnson, James A. Robinson, und Pierre Yared. 2008a. <span>„Income and Democracy“</span>. <em>American Economic Review</em> 98 (3): 808–42. <a href="https://doi.org/10.1257/aer.98.3.808">https://doi.org/10.1257/aer.98.3.808</a>.
</div>
<div id="ref-Acemogluetal2008data" class="csl-entry" role="listitem">
———. 2008b. <span>„Replication data for: Income and Democracy“</span>. ICPSR - Interuniversity Consortium for Political; Social Research. <a href="https://doi.org/10.3886/E113251V1">https://doi.org/10.3886/E113251V1</a>.
</div>
<div id="ref-Dahl1971" class="csl-entry" role="listitem">
Dahl, Robert Alan. 1971. <em>Polyarchy: Participation and Opposition: Participation and opposition</em>. New Haven: Yale Univ. Press.
</div>
<div id="ref-Huntington1991" class="csl-entry" role="listitem">
Huntington, Samuel P. 1991. <em>The Third Wave: Democratization in the Late Twentieth Century: Democratization in the late twentieth century</em>. Norman, OK: Univ. of Oklahoma Press.
</div>
<div id="ref-Rueschemeyer1992" class="csl-entry" role="listitem">
Rueschemeyer, Dietrich, Evelyne H. Stephens, und John D. Stephens. 1992. <em>Capitalist development and democracy</em>. Cambridge: Polity Pr.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./Matching.html" class="pagination-link" aria-label="Matching">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Matching</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./IV.html" class="pagination-link" aria-label="IV-Regression">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">IV-Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb49" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="an">webr:</span><span class="co"> </span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co">  show-startup-message: true</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co">  packages: [</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co">            'dplyr',</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co">            'ggplot2',</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co">            'sandwich',</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co">            'tidyr',</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co">            'readr',</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co">            'Synth'</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co">            ]</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="in">.qwebr-code-output-stdout {background-color: powderblue;}</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="in">.qwebr-button-run, .qwebr-button-reset, .qwebr-button-copy {</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="in">  background-color:  rgba(0, 0, 0, 0);</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="in">  border-style: none;</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="in">  font-weight: 400;</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="in">  color: white; </span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="in">  transition: none;</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="in">.qwebr-editor-toolbar {</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="in">  width: 100%;</span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a><span class="in">  display: flex;</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a><span class="in">  justify-content: space-between;</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="in">  box-sizing: border-box;</span></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a><span class="in">  border-radius: 0 0 6px 6px;</span></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a><span class="in">  background-color: darkgreen;</span></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a><span class="in">  border-color: darkgreen;</span></span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a><span class="in">  border-width: 1px;</span></span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a><span class="in">  border-style: solid;</span></span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a><span class="in">  padding: 0 0; </span></span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a><span class="in">  transition: color .1s ease-in-out, background-color .1s ease-in-out,border-color .1s ease-in-out,box-shadow .1s ease-in-out;</span></span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a><span class="in">.qwebr-editor-toolbar:hover {</span></span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a><span class="in">  background-color: white;</span></span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a><span class="in">  border-color: darkgreen;</span></span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a><span class="in">  border-width: 1px;</span></span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a><span class="in">.qwebr-editor-toolbar:hover * {</span></span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a><span class="in">  color: darkgreen;</span></span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a><span class="in">.overflow-guard, .qwebr-editor, .monaco-editor {</span></span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a><span class="in">  border-radius: 6px 6px 0 0;</span></span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a><span class="in">  border-width: 1px 1px 0 1px;</span></span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a><span class="in">  border-color: darkgreen;</span></span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-56"><a href="#cb49-56" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb49-57"><a href="#cb49-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-58"><a href="#cb49-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-59"><a href="#cb49-59" aria-hidden="true" tabindex="-1"></a><span class="fu"># Panel-Daten</span></span>
<span id="cb49-60"><a href="#cb49-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-61"><a href="#cb49-61" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pooled Regression und unbeobachtbare Heterogenität {#sec-panel-uh}</span></span>
<span id="cb49-62"><a href="#cb49-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-63"><a href="#cb49-63" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=F,message=F,warning=F}</span></span>
<span id="cb49-64"><a href="#cb49-64" aria-hidden="true" tabindex="-1"></a><span class="in"># Formatierung von gt-Tabellen</span></span>
<span id="cb49-65"><a href="#cb49-65" aria-hidden="true" tabindex="-1"></a><span class="in">library(gt)</span></span>
<span id="cb49-66"><a href="#cb49-66" aria-hidden="true" tabindex="-1"></a><span class="in">tabopts &lt;- function(x) {</span></span>
<span id="cb49-67"><a href="#cb49-67" aria-hidden="true" tabindex="-1"></a><span class="in">    fmt_number(x, decimals = 3, drop_trailing_zeros = T) %&gt;%</span></span>
<span id="cb49-68"><a href="#cb49-68" aria-hidden="true" tabindex="-1"></a><span class="in">    tab_options(table_body.hlines.color = "white",</span></span>
<span id="cb49-69"><a href="#cb49-69" aria-hidden="true" tabindex="-1"></a><span class="in">              column_labels.border.bottom.color = "black", </span></span>
<span id="cb49-70"><a href="#cb49-70" aria-hidden="true" tabindex="-1"></a><span class="in">             column_labels.border.top.color = "black",</span></span>
<span id="cb49-71"><a href="#cb49-71" aria-hidden="true" tabindex="-1"></a><span class="in">             table_body.border.bottom.color = "black", </span></span>
<span id="cb49-72"><a href="#cb49-72" aria-hidden="true" tabindex="-1"></a><span class="in">             table.border.bottom.color = "black",</span></span>
<span id="cb49-73"><a href="#cb49-73" aria-hidden="true" tabindex="-1"></a><span class="in">             column_labels.font.weight = "bold", </span></span>
<span id="cb49-74"><a href="#cb49-74" aria-hidden="true" tabindex="-1"></a><span class="in">             table.font.color = "black", </span></span>
<span id="cb49-75"><a href="#cb49-75" aria-hidden="true" tabindex="-1"></a><span class="in">             table.font.size = 16)</span></span>
<span id="cb49-76"><a href="#cb49-76" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb49-77"><a href="#cb49-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-78"><a href="#cb49-78" aria-hidden="true" tabindex="-1"></a><span class="in"># load the tidyverse</span></span>
<span id="cb49-79"><a href="#cb49-79" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb49-80"><a href="#cb49-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-81"><a href="#cb49-81" aria-hidden="true" tabindex="-1"></a><span class="in">options(pillar.sigfig = 2)</span></span>
<span id="cb49-82"><a href="#cb49-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-83"><a href="#cb49-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-84"><a href="#cb49-84" aria-hidden="true" tabindex="-1"></a>Ein Panel-Datensatz enthält Beobachtungen von $n$ Einheiten für (bis zu) $T$ Zeitpunkte, wobei $t=1,\dots,T$. Betrachte das Panel-Modell</span>
<span id="cb49-85"><a href="#cb49-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-86"><a href="#cb49-86" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb49-87"><a href="#cb49-87" aria-hidden="true" tabindex="-1"></a>  Y_{it} = \beta_0 + \beta_1 B_{it} + \beta_2 X_i + \beta_3 U_i + \epsilon_{it},\label{eq:unobshetmodel}</span>
<span id="cb49-88"><a href="#cb49-88" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb49-89"><a href="#cb49-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-90"><a href="#cb49-90" aria-hidden="true" tabindex="-1"></a>wobei $U_i$ unbeobachtete und $X_i$ beobachtete, **zeitlich-invariante** Heterogenitäten zwischen den Beobachtungseinheiten $i=1,\dots,n$ sind. Wie zuvor ist $B_{it}$ die Behandlungsvariable und $\beta_1$ der interessierende kausale Effekt einer Veränderung von $B_{it}$ auf $Y_{it}$. </span>
<span id="cb49-91"><a href="#cb49-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-92"><a href="#cb49-92" aria-hidden="true" tabindex="-1"></a>Angenommen wir beobachten $Y_{it}$ und $B_{it}$ für $T=1$, also für eine Periode. Bei Korrelation zwischen den **unbeobachtbaren** zeit-invarianten Effekten $U_i$ und der Behandlungsvariable $B_{it}$ kann der kausale Effekt $\beta_1$ in nicht identifiziert werden. Diese Situation ist in @fig-FEDAG1 dargestellt.</span>
<span id="cb49-93"><a href="#cb49-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-96"><a href="#cb49-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{dot}</span></span>
<span id="cb49-97"><a href="#cb49-97" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-width: 3</span></span>
<span id="cb49-98"><a href="#cb49-98" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-height: 3</span></span>
<span id="cb49-99"><a href="#cb49-99" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-align: 'center'</span></span>
<span id="cb49-100"><a href="#cb49-100" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-cap: "Backdoors durch beobachtete und unbeobachtete Variablen"</span></span>
<span id="cb49-101"><a href="#cb49-101" aria-hidden="true" tabindex="-1"></a><span class="in">//| label: "fig-FEDAG1" </span></span>
<span id="cb49-102"><a href="#cb49-102" aria-hidden="true" tabindex="-1"></a><span class="in">digraph FE_dag_single_period {</span></span>
<span id="cb49-103"><a href="#cb49-103" aria-hidden="true" tabindex="-1"></a><span class="in">    layout=neato</span></span>
<span id="cb49-104"><a href="#cb49-104" aria-hidden="true" tabindex="-1"></a><span class="in">    fontname="Helvetica,Arial,sans-serif"</span></span>
<span id="cb49-105"><a href="#cb49-105" aria-hidden="true" tabindex="-1"></a><span class="in">    node [fontname="Helvetica,Arial,sans-serif"]</span></span>
<span id="cb49-106"><a href="#cb49-106" aria-hidden="true" tabindex="-1"></a><span class="in">    edge [fontname="Helvetica,Arial,sans-serif"]</span></span>
<span id="cb49-107"><a href="#cb49-107" aria-hidden="true" tabindex="-1"></a><span class="in">    splines=true</span></span>
<span id="cb49-108"><a href="#cb49-108" aria-hidden="true" tabindex="-1"></a><span class="in">    pad=.5</span></span>
<span id="cb49-109"><a href="#cb49-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-110"><a href="#cb49-110" aria-hidden="true" tabindex="-1"></a><span class="in">    // Zeitinvariante Einflüsse</span></span>
<span id="cb49-111"><a href="#cb49-111" aria-hidden="true" tabindex="-1"></a><span class="in">    U [pos="2,8!", label=&lt;U&lt;SUB&gt;t=1&lt;/SUB&gt;&gt;, color=gray, fontcolor=gray];</span></span>
<span id="cb49-112"><a href="#cb49-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-113"><a href="#cb49-113" aria-hidden="true" tabindex="-1"></a><span class="in">    // Knoten für Zeitvariante Einflüsse</span></span>
<span id="cb49-114"><a href="#cb49-114" aria-hidden="true" tabindex="-1"></a><span class="in">    X [pos="2,6!", label=&lt;X&lt;SUB&gt;t=1&lt;/SUB&gt;&gt;];</span></span>
<span id="cb49-115"><a href="#cb49-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-116"><a href="#cb49-116" aria-hidden="true" tabindex="-1"></a><span class="in">    // Knoten für eine Periode</span></span>
<span id="cb49-117"><a href="#cb49-117" aria-hidden="true" tabindex="-1"></a><span class="in">    B [pos="0,6!", label=&lt;B&lt;SUB&gt;t=1&lt;/SUB&gt;&gt;];</span></span>
<span id="cb49-118"><a href="#cb49-118" aria-hidden="true" tabindex="-1"></a><span class="in">    Y [pos="0,8!", label=&lt;Y&lt;SUB&gt;t=1&lt;/SUB&gt;&gt;];</span></span>
<span id="cb49-119"><a href="#cb49-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-120"><a href="#cb49-120" aria-hidden="true" tabindex="-1"></a><span class="in">    // Kanten für eine Periode</span></span>
<span id="cb49-121"><a href="#cb49-121" aria-hidden="true" tabindex="-1"></a><span class="in">    U -&gt; X [color=gray, style=dashed];</span></span>
<span id="cb49-122"><a href="#cb49-122" aria-hidden="true" tabindex="-1"></a><span class="in">    U -&gt; Y [color=gray, style=dashed];</span></span>
<span id="cb49-123"><a href="#cb49-123" aria-hidden="true" tabindex="-1"></a><span class="in">    U -&gt; B [color=gray, style=dashed];</span></span>
<span id="cb49-124"><a href="#cb49-124" aria-hidden="true" tabindex="-1"></a><span class="in">    X -&gt; Y;</span></span>
<span id="cb49-125"><a href="#cb49-125" aria-hidden="true" tabindex="-1"></a><span class="in">    X -&gt; B;</span></span>
<span id="cb49-126"><a href="#cb49-126" aria-hidden="true" tabindex="-1"></a><span class="in">    B -&gt; Y;</span></span>
<span id="cb49-127"><a href="#cb49-127" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb49-128"><a href="#cb49-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-129"><a href="#cb49-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-130"><a href="#cb49-130" aria-hidden="true" tabindex="-1"></a>@fig-FEDAG1 zeigt Backdoors durch die $U_i$, die wir mit einer "naiven" KQ-Schätzung der fehlspezifizierten Regression </span>
<span id="cb49-131"><a href="#cb49-131" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb49-132"><a href="#cb49-132" aria-hidden="true" tabindex="-1"></a>  Y_{it} = \beta_0 + \beta_1 B_{it} + \beta_2 X_i + \varepsilon_{it},\quad t=1,\label{eq:femodelfail}</span>
<span id="cb49-133"><a href="#cb49-133" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb49-134"><a href="#cb49-134" aria-hidden="true" tabindex="-1"></a>nicht schließen können.</span>
<span id="cb49-135"><a href="#cb49-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-136"><a href="#cb49-136" aria-hidden="true" tabindex="-1"></a>Wir betrachten nun eine Generalisierung von @fig-FEDAG1 für $T=2$ Perioden, dargestellt in @fig-FEDAG2.</span>
<span id="cb49-137"><a href="#cb49-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-140"><a href="#cb49-140" aria-hidden="true" tabindex="-1"></a><span class="in">```{dot}</span></span>
<span id="cb49-141"><a href="#cb49-141" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-width: 6</span></span>
<span id="cb49-142"><a href="#cb49-142" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-height: 4</span></span>
<span id="cb49-143"><a href="#cb49-143" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-align: 'center'</span></span>
<span id="cb49-144"><a href="#cb49-144" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-cap: "Panel-Design mit Backdoors durch beobachtete und unbeobachtete zeit-invariante Variablen"</span></span>
<span id="cb49-145"><a href="#cb49-145" aria-hidden="true" tabindex="-1"></a><span class="in">//| label: "fig-FEDAG2" </span></span>
<span id="cb49-146"><a href="#cb49-146" aria-hidden="true" tabindex="-1"></a><span class="in">digraph FE_dag2 {</span></span>
<span id="cb49-147"><a href="#cb49-147" aria-hidden="true" tabindex="-1"></a><span class="in">    layout=neato</span></span>
<span id="cb49-148"><a href="#cb49-148" aria-hidden="true" tabindex="-1"></a><span class="in">    fontname="Helvetica,Arial,sans-serif"</span></span>
<span id="cb49-149"><a href="#cb49-149" aria-hidden="true" tabindex="-1"></a><span class="in">    node [fontname="Helvetica,Arial,sans-serif"]</span></span>
<span id="cb49-150"><a href="#cb49-150" aria-hidden="true" tabindex="-1"></a><span class="in">    edge [fontname="Helvetica,Arial,sans-serif"]</span></span>
<span id="cb49-151"><a href="#cb49-151" aria-hidden="true" tabindex="-1"></a><span class="in">    splines=true</span></span>
<span id="cb49-152"><a href="#cb49-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-153"><a href="#cb49-153" aria-hidden="true" tabindex="-1"></a><span class="in">    // Zeitinvariante Einflüsse</span></span>
<span id="cb49-154"><a href="#cb49-154" aria-hidden="true" tabindex="-1"></a><span class="in">    U [pos="2,8!", label=&lt;U&gt;, color=gray, fontcolor=gray];</span></span>
<span id="cb49-155"><a href="#cb49-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-156"><a href="#cb49-156" aria-hidden="true" tabindex="-1"></a><span class="in">    // Knoten für Zeitvariante Einflüsse</span></span>
<span id="cb49-157"><a href="#cb49-157" aria-hidden="true" tabindex="-1"></a><span class="in">    X [pos="2,2!", label=&lt;X&gt;];</span></span>
<span id="cb49-158"><a href="#cb49-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-159"><a href="#cb49-159" aria-hidden="true" tabindex="-1"></a><span class="in">    // Knoten für Perioden 1</span></span>
<span id="cb49-160"><a href="#cb49-160" aria-hidden="true" tabindex="-1"></a><span class="in">    B1 [pos="0,4!", label=&lt;B&lt;SUB&gt;t=1&lt;/SUB&gt;&gt;];</span></span>
<span id="cb49-161"><a href="#cb49-161" aria-hidden="true" tabindex="-1"></a><span class="in">    Y1 [pos="0,6!", label=&lt;Y&lt;SUB&gt;t=1&lt;/SUB&gt;&gt;];</span></span>
<span id="cb49-162"><a href="#cb49-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-163"><a href="#cb49-163" aria-hidden="true" tabindex="-1"></a><span class="in">    // Knoten für Perioden 2</span></span>
<span id="cb49-164"><a href="#cb49-164" aria-hidden="true" tabindex="-1"></a><span class="in">    B2 [pos="4,4!", label=&lt;B&lt;SUB&gt;t=2&lt;/SUB&gt;&gt;];</span></span>
<span id="cb49-165"><a href="#cb49-165" aria-hidden="true" tabindex="-1"></a><span class="in">    Y2 [pos="4,6!", label=&lt;Y&lt;SUB&gt;t=2&lt;/SUB&gt;&gt;];</span></span>
<span id="cb49-166"><a href="#cb49-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-167"><a href="#cb49-167" aria-hidden="true" tabindex="-1"></a><span class="in">    // Kanten für Perioden 1</span></span>
<span id="cb49-168"><a href="#cb49-168" aria-hidden="true" tabindex="-1"></a><span class="in">    U -&gt; X [color=gray, style=dashed];</span></span>
<span id="cb49-169"><a href="#cb49-169" aria-hidden="true" tabindex="-1"></a><span class="in">    U -&gt; Y1 [color=gray, style=dashed];</span></span>
<span id="cb49-170"><a href="#cb49-170" aria-hidden="true" tabindex="-1"></a><span class="in">    U -&gt; B1 [color=gray, style=dashed];</span></span>
<span id="cb49-171"><a href="#cb49-171" aria-hidden="true" tabindex="-1"></a><span class="in">    X -&gt; Y1;</span></span>
<span id="cb49-172"><a href="#cb49-172" aria-hidden="true" tabindex="-1"></a><span class="in">    X -&gt; B1;</span></span>
<span id="cb49-173"><a href="#cb49-173" aria-hidden="true" tabindex="-1"></a><span class="in">    B1 -&gt; Y1;</span></span>
<span id="cb49-174"><a href="#cb49-174" aria-hidden="true" tabindex="-1"></a><span class="in">    B1 -&gt; B2;</span></span>
<span id="cb49-175"><a href="#cb49-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-176"><a href="#cb49-176" aria-hidden="true" tabindex="-1"></a><span class="in">    // Kanten für Perioden 2</span></span>
<span id="cb49-177"><a href="#cb49-177" aria-hidden="true" tabindex="-1"></a><span class="in">    U -&gt; Y2 [color=gray, style=dashed];</span></span>
<span id="cb49-178"><a href="#cb49-178" aria-hidden="true" tabindex="-1"></a><span class="in">    U -&gt; B2 [color=gray, style=dashed];</span></span>
<span id="cb49-179"><a href="#cb49-179" aria-hidden="true" tabindex="-1"></a><span class="in">    X -&gt; Y2;</span></span>
<span id="cb49-180"><a href="#cb49-180" aria-hidden="true" tabindex="-1"></a><span class="in">    X -&gt; B2;</span></span>
<span id="cb49-181"><a href="#cb49-181" aria-hidden="true" tabindex="-1"></a><span class="in">    B2 -&gt; Y2;</span></span>
<span id="cb49-182"><a href="#cb49-182" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb49-183"><a href="#cb49-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-184"><a href="#cb49-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-185"><a href="#cb49-185" aria-hidden="true" tabindex="-1"></a>Der in @fig-FEDAG2 gezeigte Zusammenhang führt (idealerweise) zwar zu einer Verdoppelung des Beobachtungsumfangs, jedoch besteht weiterhin das in @fig-FEDAG1 gezeigte Endogenitätsproblem, falls die Regression \eqref{eq:femodelfail} nun anhand einer Zusammenlegung (**Pooling**) der Beobachtungen für $t\in<span class="sc">\{</span>1,2<span class="sc">\}</span>$ geschätzt wird:^<span class="co">[</span><span class="ot">Pooled Regression kann auch berechnet werden, wenn nicht für alle $n$ Einheiten jeweils $T$ Beobachtungen vorliegen (unbalanced Panel).</span><span class="co">]</span> Die unbeobachteten zeit-invarianten Einflüsse $U_i$ verursachen auch für Periode $t=2$ Backdoor-Pfade.</span>
<span id="cb49-186"><a href="#cb49-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-187"><a href="#cb49-187" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel betrachten wir Panel-Verfahren, welche den kausalen Effekt in @fig-FEDAG2 und Verallgemeinerungen hiervon schätzen können. Analog zu Querschnittsdaten können die hier betrachteten Panel-Schätzer Endogenitäten aufgrund simultaner Kausalität oder nicht beheben. In solchen Szenarien können Panel-Methoden in Kombination mit einer Schätzstrategie basierend auf Instrument-Variablen hilfreich sein. Wir betrachten solche Schätzer in den empirischen Beispielen in Kapitel @sec-IV. </span>
<span id="cb49-188"><a href="#cb49-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-189"><a href="#cb49-189" aria-hidden="true" tabindex="-1"></a>Bevor wir diese Panel-Verfahren erläutern, veranschaulichen wir die verzerrte Schätzung eines Behandlungseffekts mit *Pooled Regression* für einen simulierten Datensatz <span class="in">`paneldata.csv`</span>, der Beobachtungen von $n=12$ Einheiten zu $T=8$ Perioden beinhaltet. Alle Einheiten weisen unbeobachtbare zeit-invariante Heterogenitäten auf, die mit $B_{it}$ korellieren. Der wahre Behandlungseffekt beträgt $\beta_1 = -1$ für alle $n$ Einheiten.^<span class="co">[</span><span class="ot">Der (R code für den) DGP ist [diesem StackExchange-Post](https://stats.stackexchange.com/a/188559) entnommen.</span><span class="co">]</span></span>
<span id="cb49-190"><a href="#cb49-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-191"><a href="#cb49-191" aria-hidden="true" tabindex="-1"></a>Wir lesen zunächst den Datensatz ein und selektieren die benötigten Variablen.</span>
<span id="cb49-192"><a href="#cb49-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-195"><a href="#cb49-195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-196"><a href="#cb49-196" aria-hidden="true" tabindex="-1"></a><span class="co"># Datensatz 'paneldata.csv' einlesen</span></span>
<span id="cb49-197"><a href="#cb49-197" aria-hidden="true" tabindex="-1"></a>paneldata <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datasets/paneldata.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-198"><a href="#cb49-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(X, Y, ID, time, col)</span>
<span id="cb49-199"><a href="#cb49-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-200"><a href="#cb49-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-201"><a href="#cb49-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-204"><a href="#cb49-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-205"><a href="#cb49-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel-Dimensionen bestimmen</span></span>
<span id="cb49-206"><a href="#cb49-206" aria-hidden="true" tabindex="-1"></a>paneldata <span class="sc">%&gt;%</span></span>
<span id="cb49-207"><a href="#cb49-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb49-208"><a href="#cb49-208" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">unique</span>(ID) <span class="sc">%&gt;%</span> <span class="fu">length</span>(),</span>
<span id="cb49-209"><a href="#cb49-209" aria-hidden="true" tabindex="-1"></a>    <span class="at">T =</span> <span class="fu">unique</span>(time) <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span>
<span id="cb49-210"><a href="#cb49-210" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-211"><a href="#cb49-211" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-212"><a href="#cb49-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-213"><a href="#cb49-213" aria-hidden="true" tabindex="-1"></a>Mit der Funktion <span class="in">`plm::is.pbalanced()`</span> überprüfen wir, ob im Panel-Datensatz für alle beobachteten Einheiten die gleiche Anzahl an Beobachtungsperioden vorliegt (*balanced panel*).^[Fehlende Beobachtungen sind typischerweise mit einem `NA`-Wert gekennzeichnet. Der Differenz-Schätzer kann auch berechnet werden, wenn der Datensatz nicht ausgeglichen (*unbalanced*) ist.]</span>
<span id="cb49-214"><a href="#cb49-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-217"><a href="#cb49-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-218"><a href="#cb49-218" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plm)</span>
<span id="cb49-219"><a href="#cb49-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-220"><a href="#cb49-220" aria-hidden="true" tabindex="-1"></a><span class="co"># Datensatz balanced?</span></span>
<span id="cb49-221"><a href="#cb49-221" aria-hidden="true" tabindex="-1"></a><span class="fu">is.pbalanced</span>(</span>
<span id="cb49-222"><a href="#cb49-222" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> paneldata, </span>
<span id="cb49-223"><a href="#cb49-223" aria-hidden="true" tabindex="-1"></a>  <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"ID"</span>, <span class="st">"time"</span>)</span>
<span id="cb49-224"><a href="#cb49-224" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-225"><a href="#cb49-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-226"><a href="#cb49-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-227"><a href="#cb49-227" aria-hidden="true" tabindex="-1"></a>Zunächst schätzen wir eine Pooled Regression für die ersten beiden Zeitperioden, basierend auf einem entsprechend gefilterten Datensatz.^<span class="co">[</span><span class="ot">Wir verweisen nachfolgend explizit auf Funktionen aus `dplyr`, falls Funktionen aus `plm` identische Namen haben.</span><span class="co">]</span></span>
<span id="cb49-228"><a href="#cb49-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-231"><a href="#cb49-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-232"><a href="#cb49-232" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting der Daten für 2 Perioden (t = {1, 2})</span></span>
<span id="cb49-233"><a href="#cb49-233" aria-hidden="true" tabindex="-1"></a>paneldata_T2 <span class="ot">&lt;-</span> paneldata <span class="sc">%&gt;%</span> </span>
<span id="cb49-234"><a href="#cb49-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb49-235"><a href="#cb49-235" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">between</span>(time, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb49-236"><a href="#cb49-236" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-237"><a href="#cb49-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-238"><a href="#cb49-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-239"><a href="#cb49-239" aria-hidden="true" tabindex="-1"></a>Für die Schätzung von \eqref{eq:femodelfail} nutzen wir <span class="in">`fixest::feols()`</span>.</span>
<span id="cb49-240"><a href="#cb49-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-243"><a href="#cb49-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-244"><a href="#cb49-244" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb49-245"><a href="#cb49-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-246"><a href="#cb49-246" aria-hidden="true" tabindex="-1"></a><span class="co"># Naive KQ-Schätzung für t = {1, 2}</span></span>
<span id="cb49-247"><a href="#cb49-247" aria-hidden="true" tabindex="-1"></a>panel_KQ <span class="ot">&lt;-</span> <span class="fu">feols</span>(</span>
<span id="cb49-248"><a href="#cb49-248" aria-hidden="true" tabindex="-1"></a>  <span class="at">fml =</span> Y <span class="sc">~</span> X, </span>
<span id="cb49-249"><a href="#cb49-249" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> paneldata_T2</span>
<span id="cb49-250"><a href="#cb49-250" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-251"><a href="#cb49-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-252"><a href="#cb49-252" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(panel_KQ)</span>
<span id="cb49-253"><a href="#cb49-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-254"><a href="#cb49-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-255"><a href="#cb49-255" aria-hidden="true" tabindex="-1"></a>Die Schätzung von $\beta_1$ ist $<span class="in">`r round(panel_KQ$coefficients[2], 2)`</span>$ und weist auf eine deutliche Verzerrung hin. Wir illustrieren die Problematik in @fig-pooledregression1, in dem wir die für die Regression verwendeten Daten (Kreise) sowie die Beobachtungen späterer Perioden (Kreuze) nach Gruppenzugehörigkeit einfärben und die Schätzung der Pooled Regression abtragen.</span>
<span id="cb49-256"><a href="#cb49-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-259"><a href="#cb49-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-260"><a href="#cb49-260" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pooledregression1</span></span>
<span id="cb49-261"><a href="#cb49-261" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "`paneldaten.csv` -- Pooled Regression für t = 1, 2"</span></span>
<span id="cb49-262"><a href="#cb49-262" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb49-263"><a href="#cb49-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-264"><a href="#cb49-264" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot: Naiver KQ-Schätzer für t = 1, 2</span></span>
<span id="cb49-265"><a href="#cb49-265" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb49-266"><a href="#cb49-266" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)</span>
<span id="cb49-267"><a href="#cb49-267" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb49-268"><a href="#cb49-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb49-269"><a href="#cb49-269" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> paneldata <span class="sc">%&gt;%</span> </span>
<span id="cb49-270"><a href="#cb49-270" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(time <span class="sc">&gt;</span> <span class="dv">2</span>),</span>
<span id="cb49-271"><a href="#cb49-271" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> col),</span>
<span id="cb49-272"><a href="#cb49-272" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">3</span>,</span>
<span id="cb49-273"><a href="#cb49-273" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> F</span>
<span id="cb49-274"><a href="#cb49-274" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-275"><a href="#cb49-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb49-276"><a href="#cb49-276" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> paneldata <span class="sc">%&gt;%</span> </span>
<span id="cb49-277"><a href="#cb49-277" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(time <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>),</span>
<span id="cb49-278"><a href="#cb49-278" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> col),</span>
<span id="cb49-279"><a href="#cb49-279" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> F</span>
<span id="cb49-280"><a href="#cb49-280" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-281"><a href="#cb49-281" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Naive KQ-Schätzung für t = 1, 2</span></span>
<span id="cb49-282"><a href="#cb49-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb49-283"><a href="#cb49-283" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> paneldata <span class="sc">%&gt;%</span> </span>
<span id="cb49-284"><a href="#cb49-284" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(time <span class="sc">%in%</span> <span class="dv">1</span>),</span>
<span id="cb49-285"><a href="#cb49-285" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb49-286"><a href="#cb49-286" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> F,</span>
<span id="cb49-287"><a href="#cb49-287" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span></span>
<span id="cb49-288"><a href="#cb49-288" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-289"><a href="#cb49-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_identity</span>() <span class="sc">+</span></span>
<span id="cb49-290"><a href="#cb49-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb49-291"><a href="#cb49-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-292"><a href="#cb49-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-293"><a href="#cb49-293" aria-hidden="true" tabindex="-1"></a>@fig-pooledregression1 zeigt einen negativen Verlauf des Zusammenhangs zwischen X und Y anhand der Variation der Beobachtungen *innerhalb* der farblich gekennzeichneten Gruppen. Dieser negative Zusammenhang kann aufgrund der Endogenität von $X$ nicht erfasst werden. </span>
<span id="cb49-294"><a href="#cb49-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-295"><a href="#cb49-295" aria-hidden="true" tabindex="-1"></a>Eine Erweiturung der Regression auf sämtliche Perioden (Pooling aller $n\times T = 12 \times 8 = 96$ Beobachtungen) erhöht lediglich die Präzision der Schätzung (geringerer Standardfehler von $\widehat{\beta}_1$), nicht aber die Endogenität, vgl. @fig-pooledregression2.</span>
<span id="cb49-296"><a href="#cb49-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-299"><a href="#cb49-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-300"><a href="#cb49-300" aria-hidden="true" tabindex="-1"></a><span class="co"># Naive KQ-Schätzung für t = 1,...,8</span></span>
<span id="cb49-301"><a href="#cb49-301" aria-hidden="true" tabindex="-1"></a>panel_KQ <span class="ot">&lt;-</span> <span class="fu">feols</span>(</span>
<span id="cb49-302"><a href="#cb49-302" aria-hidden="true" tabindex="-1"></a>  <span class="at">fml =</span> Y <span class="sc">~</span> X, </span>
<span id="cb49-303"><a href="#cb49-303" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> paneldata </span>
<span id="cb49-304"><a href="#cb49-304" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-305"><a href="#cb49-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-306"><a href="#cb49-306" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(panel_KQ)</span>
<span id="cb49-307"><a href="#cb49-307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-308"><a href="#cb49-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-311"><a href="#cb49-311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-312"><a href="#cb49-312" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pooledregression2</span></span>
<span id="cb49-313"><a href="#cb49-313" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "`paneldaten.csv` -- Pooled Regression für t = 1, ..., 8"</span></span>
<span id="cb49-314"><a href="#cb49-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-315"><a href="#cb49-315" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot: Naiver KQ-Schätzer für t = 1,...,8</span></span>
<span id="cb49-316"><a href="#cb49-316" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb49-317"><a href="#cb49-317" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> paneldata,</span>
<span id="cb49-318"><a href="#cb49-318" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)</span>
<span id="cb49-319"><a href="#cb49-319" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb49-320"><a href="#cb49-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb49-321"><a href="#cb49-321" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> col),</span>
<span id="cb49-322"><a href="#cb49-322" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> F</span>
<span id="cb49-323"><a href="#cb49-323" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-324"><a href="#cb49-324" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pooled Schätzung</span></span>
<span id="cb49-325"><a href="#cb49-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb49-326"><a href="#cb49-326" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> paneldata,</span>
<span id="cb49-327"><a href="#cb49-327" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb49-328"><a href="#cb49-328" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> F,</span>
<span id="cb49-329"><a href="#cb49-329" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span></span>
<span id="cb49-330"><a href="#cb49-330" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-331"><a href="#cb49-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_identity</span>() <span class="sc">+</span></span>
<span id="cb49-332"><a href="#cb49-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb49-333"><a href="#cb49-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-334"><a href="#cb49-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-335"><a href="#cb49-335" aria-hidden="true" tabindex="-1"></a><span class="fu">## Regression in Differenzen</span></span>
<span id="cb49-336"><a href="#cb49-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-337"><a href="#cb49-337" aria-hidden="true" tabindex="-1"></a>Wir betrachten zunächst den in @fig-FEDAG2 dargestellten DGP für $T=2$ Zeitperioden. In dieser Situation können Backdoors durch $U$ anhand einer simplen Transformation von Modell \eqref{eq:femodel} geschlossen werden: Regression der Zeit-Differenzen zwischen den Perioden $t=2$ und $t=1$,</span>
<span id="cb49-338"><a href="#cb49-338" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb49-339"><a href="#cb49-339" aria-hidden="true" tabindex="-1"></a>  \Delta Y_{it} = \beta_1 \Delta B_{it} + e_{it}, \qquad i=1,\dots,n,\qquad t=1,2 \label{eq:femodeldiff},</span>
<span id="cb49-340"><a href="#cb49-340" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb49-341"><a href="#cb49-341" aria-hidden="true" tabindex="-1"></a>wobei $\Delta\,Y_{it} := Y_{i2} - Y_{i1}$ und $e_{it} := \epsilon_{i2} - \epsilon_{i1}$ für $t=2$. Beachte, dass $\Delta U_i=\Delta X_i=0$. Differenzieren ergibt also ein Modell, in dem weder für $X_i$ noch für die (unbeobachtbaren) $U_i$ kontrolliert werden muss, damit $\beta_1$ identifiziert werden kann. Der Behandlungseffekt $\beta_1$ kann mit KQ geschätzt werden. </span>
<span id="cb49-342"><a href="#cb49-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-343"><a href="#cb49-343" aria-hidden="true" tabindex="-1"></a>Zur Transformation der Regressoren in <span class="in">`fixest::feols()`</span> verwenden wir den Operator <span class="in">`d()`</span>. Dieser benötigt die im Argument <span class="in">`panel.id`</span> als Formel spezifizierten Identifikationsvariablen für Einheiten (<span class="in">`ID`</span>) und Zeitpunkte (<span class="in">`time`</span>).</span>
<span id="cb49-344"><a href="#cb49-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-347"><a href="#cb49-347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-348"><a href="#cb49-348" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel-Schätzer: KQ-Regression in Differenzen</span></span>
<span id="cb49-349"><a href="#cb49-349" aria-hidden="true" tabindex="-1"></a>panel_diff <span class="ot">&lt;-</span> <span class="fu">feols</span>(</span>
<span id="cb49-350"><a href="#cb49-350" aria-hidden="true" tabindex="-1"></a>  <span class="at">fml =</span> <span class="fu">d</span>(Y) <span class="sc">~</span> <span class="fu">d</span>(X) <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb49-351"><a href="#cb49-351" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> paneldata <span class="sc">%&gt;%</span> </span>
<span id="cb49-352"><a href="#cb49-352" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(</span>
<span id="cb49-353"><a href="#cb49-353" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">between</span>(time, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb49-354"><a href="#cb49-354" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb49-355"><a href="#cb49-355" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.id =</span> <span class="sc">~</span> ID <span class="sc">+</span> time</span>
<span id="cb49-356"><a href="#cb49-356" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-357"><a href="#cb49-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-358"><a href="#cb49-358" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(panel_diff)</span>
<span id="cb49-359"><a href="#cb49-359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-360"><a href="#cb49-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-361"><a href="#cb49-361" aria-hidden="true" tabindex="-1"></a>Die Schätzung anhand der Regression in Differenzen liegt nahe beim wahren Behandlungseffekt $\beta_1 = -1$. Abbildung @fig-diffregression1 zeigt die ersten Differenzen der Daten und den mit KQ geschätzten Zusammenhang.</span>
<span id="cb49-362"><a href="#cb49-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-365"><a href="#cb49-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-366"><a href="#cb49-366" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-diffregression1</span></span>
<span id="cb49-367"><a href="#cb49-367" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "`paneldaten.csv` -- Regression in Differenzen für t = 2"</span></span>
<span id="cb49-368"><a href="#cb49-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-369"><a href="#cb49-369" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformation zu Differenzen</span></span>
<span id="cb49-370"><a href="#cb49-370" aria-hidden="true" tabindex="-1"></a>paneldata_diff <span class="ot">&lt;-</span> paneldata <span class="sc">%&gt;%</span> </span>
<span id="cb49-371"><a href="#cb49-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-372"><a href="#cb49-372" aria-hidden="true" tabindex="-1"></a>    <span class="at">DeltaX =</span> X <span class="sc">-</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(X),</span>
<span id="cb49-373"><a href="#cb49-373" aria-hidden="true" tabindex="-1"></a>    <span class="at">DeltaY =</span> Y <span class="sc">-</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(Y)</span>
<span id="cb49-374"><a href="#cb49-374" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb49-375"><a href="#cb49-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb49-376"><a href="#cb49-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-377"><a href="#cb49-377" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot: KQ-Schätzer für Differenzen  </span></span>
<span id="cb49-378"><a href="#cb49-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb49-379"><a href="#cb49-379" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> DeltaX, <span class="at">y =</span> DeltaY)</span>
<span id="cb49-380"><a href="#cb49-380" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb49-381"><a href="#cb49-381" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb49-382"><a href="#cb49-382" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> paneldata_diff <span class="sc">%&gt;%</span> </span>
<span id="cb49-383"><a href="#cb49-383" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(time <span class="sc">&gt;</span> <span class="dv">2</span>),</span>
<span id="cb49-384"><a href="#cb49-384" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> col),</span>
<span id="cb49-385"><a href="#cb49-385" aria-hidden="true" tabindex="-1"></a>      <span class="at">pch =</span> <span class="dv">3</span>,</span>
<span id="cb49-386"><a href="#cb49-386" aria-hidden="true" tabindex="-1"></a>      <span class="at">show.legend =</span> F</span>
<span id="cb49-387"><a href="#cb49-387" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb49-388"><a href="#cb49-388" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb49-389"><a href="#cb49-389" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> paneldata_diff <span class="sc">%&gt;%</span> </span>
<span id="cb49-390"><a href="#cb49-390" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(time <span class="sc">==</span> <span class="dv">2</span>),</span>
<span id="cb49-391"><a href="#cb49-391" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> col),</span>
<span id="cb49-392"><a href="#cb49-392" aria-hidden="true" tabindex="-1"></a>      <span class="at">show.legend =</span> F</span>
<span id="cb49-393"><a href="#cb49-393" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb49-394"><a href="#cb49-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb49-395"><a href="#cb49-395" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> paneldata_diff <span class="sc">%&gt;%</span> </span>
<span id="cb49-396"><a href="#cb49-396" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(time <span class="sc">==</span> <span class="dv">2</span>),</span>
<span id="cb49-397"><a href="#cb49-397" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb49-398"><a href="#cb49-398" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> F,</span>
<span id="cb49-399"><a href="#cb49-399" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb49-400"><a href="#cb49-400" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb49-401"><a href="#cb49-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_identity</span>() <span class="sc">+</span></span>
<span id="cb49-402"><a href="#cb49-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb49-403"><a href="#cb49-403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-404"><a href="#cb49-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-405"><a href="#cb49-405" aria-hidden="true" tabindex="-1"></a>Wie für die Pooled Regression können wir den Differenzen-Schätzer für den gesamten Datensatz berechnen. </span>
<span id="cb49-406"><a href="#cb49-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-409"><a href="#cb49-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-410"><a href="#cb49-410" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel-Schätzer: KQ-Regression in Differenzen</span></span>
<span id="cb49-411"><a href="#cb49-411" aria-hidden="true" tabindex="-1"></a>panel_diff <span class="ot">&lt;-</span> <span class="fu">feols</span>(</span>
<span id="cb49-412"><a href="#cb49-412" aria-hidden="true" tabindex="-1"></a>  <span class="at">fml =</span> <span class="fu">d</span>(Y) <span class="sc">~</span> <span class="fu">d</span>(X) <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb49-413"><a href="#cb49-413" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> paneldata,</span>
<span id="cb49-414"><a href="#cb49-414" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.id =</span> <span class="sc">~</span> ID <span class="sc">+</span> time</span>
<span id="cb49-415"><a href="#cb49-415" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-416"><a href="#cb49-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-417"><a href="#cb49-417" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(panel_diff)</span>
<span id="cb49-418"><a href="#cb49-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-419"><a href="#cb49-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-420"><a href="#cb49-420" aria-hidden="true" tabindex="-1"></a>Beachte, dass der Standardfehler der Schätzers etwas größer ist als für den KQ-Schätzer in der Pooled Regression. Grund hierfür ist der Verlust von $12$ Beobachtungen bei der Bildung der $T-1 = 7$ Differenzen.</span>
<span id="cb49-421"><a href="#cb49-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-424"><a href="#cb49-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-425"><a href="#cb49-425" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-diffregression2</span></span>
<span id="cb49-426"><a href="#cb49-426" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "`paneldaten.csv` -- Regression in Differenzen für t = 1, ..., 8"</span></span>
<span id="cb49-427"><a href="#cb49-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-428"><a href="#cb49-428" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot: KQ-Schätzer in Differenzen (alle t)</span></span>
<span id="cb49-429"><a href="#cb49-429" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb49-430"><a href="#cb49-430" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> paneldata_diff,</span>
<span id="cb49-431"><a href="#cb49-431" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> DeltaX, <span class="at">y =</span> DeltaY)</span>
<span id="cb49-432"><a href="#cb49-432" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb49-433"><a href="#cb49-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb49-434"><a href="#cb49-434" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray"</span>,</span>
<span id="cb49-435"><a href="#cb49-435" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> F</span>
<span id="cb49-436"><a href="#cb49-436" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-437"><a href="#cb49-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb49-438"><a href="#cb49-438" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> col),</span>
<span id="cb49-439"><a href="#cb49-439" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> F</span>
<span id="cb49-440"><a href="#cb49-440" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-441"><a href="#cb49-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb49-442"><a href="#cb49-442" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb49-443"><a href="#cb49-443" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> F,</span>
<span id="cb49-444"><a href="#cb49-444" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb49-445"><a href="#cb49-445" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb49-446"><a href="#cb49-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_identity</span>() <span class="sc">+</span></span>
<span id="cb49-447"><a href="#cb49-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb49-448"><a href="#cb49-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-449"><a href="#cb49-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-450"><a href="#cb49-450" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fixed-Effects-Regression</span></span>
<span id="cb49-451"><a href="#cb49-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-452"><a href="#cb49-452" aria-hidden="true" tabindex="-1"></a>Die Regression in Differenzen hat den Nachteil, dass einheiten-spezifische Effekte nicht geschätzt werden können. Weiterhin impliziert die Differenzbildung einen Verlust des Beobachtungsumfangs bei der Schätzung des kausalen Effekts.^<span class="co">[</span><span class="ot">Eine Reduktion des Beobachtungsumfangs erhöht die Varianz der Schätzung.</span><span class="co">]</span> Für den Datensatz <span class="in">`paneldata.csv`</span> verlieren wir daher 1/8 der Stichprobe. Abhängig von der empirischen Fragestellung und der Datenverfügbarkeit kann Fixed-Effects-Regression eine nützliche Alternative zu Regression in Differenzen sein, wenn Panel-Daten mit $T\geq2$ vorliegen.</span>
<span id="cb49-453"><a href="#cb49-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-454"><a href="#cb49-454" aria-hidden="true" tabindex="-1"></a>Wir betrachten erneut Modell \eqref{eq:unobshetmodel} und definieren</span>
<span id="cb49-455"><a href="#cb49-455" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb49-456"><a href="#cb49-456" aria-hidden="true" tabindex="-1"></a>  \delta_i = \beta_0 + \beta_3 U_i.</span>
<span id="cb49-457"><a href="#cb49-457" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb49-458"><a href="#cb49-458" aria-hidden="true" tabindex="-1"></a>Nach einsetzen in \eqref{eq:unobshetmodel} erhalten wir das Modell</span>
<span id="cb49-459"><a href="#cb49-459" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb49-460"><a href="#cb49-460" aria-hidden="true" tabindex="-1"></a>  Y_{it} = \delta_i + \beta_1 B_{it} + \beta_2 X_i + \epsilon_{it} \label{eq:femodel},</span>
<span id="cb49-461"><a href="#cb49-461" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb49-462"><a href="#cb49-462" aria-hidden="true" tabindex="-1"></a>mit einheiten-spezifischen Konstanten $\delta_i$, $i=1,\dots,n$. Die $\delta_i$ können als individuelle Achsenabschnitte ("feste Effekte") interpretieren werden, weshalb Modell \eqref{eq:femodel} auch als "Fixed-Effects-Modell" bezeichnet wird.^<span class="co">[</span><span class="ot">Eine Modellierung mit gruppen-spezifischen Achsenabschnitten scheint in @fig-pooledregression2 plausibel.</span><span class="co">]</span> </span>
<span id="cb49-463"><a href="#cb49-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-464"><a href="#cb49-464" aria-hidden="true" tabindex="-1"></a>Für die Vermeidung von Backdoors in den $\delta_i$ subtrahieren wir die einheiten-spezifischen Mittelwerte von den Komponenten (Within-Transformation),</span>
<span id="cb49-465"><a href="#cb49-465" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb49-466"><a href="#cb49-466" aria-hidden="true" tabindex="-1"></a>  Y_{it} - \overline{Y}_i =&amp;\, (\delta_i - \overline{\delta}_i) + \beta_1 (B_{it} - \overline{B}_i) + \beta_2 (X_i - \overline{X}_i) + (\epsilon_{it} - \overline{\epsilon}_i)\notag<span class="sc">\\</span></span>
<span id="cb49-467"><a href="#cb49-467" aria-hidden="true" tabindex="-1"></a>  \tilde Y_{it} =&amp;\, \beta_1 \tilde B_{it} + \tilde\epsilon_{it}.\label{eq:fewithin}</span>
<span id="cb49-468"><a href="#cb49-468" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb49-469"><a href="#cb49-469" aria-hidden="true" tabindex="-1"></a>Der Fixed-Effects-Schätzer von $\beta_1$ ist der KQ-Schätzer in \eqref{eq:fewithin}. Ähnlich wie für den Differenzen-Schätzer eliminieren die Mittelwert-Differenzen $\delta_i - \overline{\delta}_i=0$ und $X_i - \overline{X}_i=0$ den Einfluss zeit-invarianter Variablen.</span>
<span id="cb49-470"><a href="#cb49-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-471"><a href="#cb49-471" aria-hidden="true" tabindex="-1"></a>Das Modell \eqref{eq:femodel} kann weiterhin als eine Regression mit $n-1$ Dummy-Variablen und einer Konstante umgeschrieben werden,</span>
<span id="cb49-472"><a href="#cb49-472" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb49-473"><a href="#cb49-473" aria-hidden="true" tabindex="-1"></a>  Y_{it} = \beta_0 + \beta_2 B_{it} + \beta_2 X_i  + \gamma_2 D^{(2)}_i + \gamma_3 D^{(3)}_i + \cdots + \gamma_n D^{(n)}_i + \epsilon_{it} \label{eq:drmodel}.</span>
<span id="cb49-474"><a href="#cb49-474" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb49-475"><a href="#cb49-475" aria-hidden="true" tabindex="-1"></a>Die Darstellung \eqref{eq:drmodel} hat $n$ verschiedene Achsenabschnitte -- einen für jede Beobachtungseinheit -- und kann ebenfalls mit KQ geschätzt werden.^<span class="co">[</span><span class="ot">Für $n-1$ Einheiten ist der individuelle Achsenabschnitt damit $\beta_0 + \gamma_i$ und für *eine* Einheit $\beta_0$. Diese Einheit (hier $i=1$) wird auch als *Referenzkategorie* bezeichnet. Alternativ kann das Modell mit $n$ Dummies und *ohne* die Konstante $\beta_0$ geschrieben werden.</span><span class="co">]</span> Die Modelle \eqref{eq:femodel} und \eqref{eq:drmodel} sind also gleichwertige Darstellungen eines Modells, dass (unbeobachtbare) zeit-invariante Heterogenität berücksichtigt.^<span class="co">[</span><span class="ot">Der Ansatz \eqref{eq:drmodel} wird in der Literatur auch als *Least Squares Dummy Variables* (LSDV) Regression bezeichnet.</span><span class="co">]</span> Beachte, dass die Schätzung der Koeffizienten *beobachtbarer* zeit-invarianter Regressoren $X_{i}$ lediglich in Modell \eqref{eq:drmodel} möglich ist.</span>
<span id="cb49-476"><a href="#cb49-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-477"><a href="#cb49-477" aria-hidden="true" tabindex="-1"></a>Fixed-Effects-Regressionen können mit <span class="in">`fixest::feols()`</span> geschätzt werden.^<span class="co">[</span><span class="ot">Eine Alternative ist `plm::plm()` mit dem Argument `method = "within"`.</span><span class="co">]</span> Je nach Spezifikation des Formula-Arguments (<span class="in">`fml`</span>) wird ein effizienter Algorithmus für eine Variante von \eqref{eq:femodel} angwandt. Für <span class="in">`paneldata.csv`</span> erhalten wir mit <span class="in">`fml = Y ~ X | ID`</span> per Referenz des Indikators <span class="in">`ID`</span> eine Schätzung mit Berechnung der einheiten-spezifischen Effekte.</span>
<span id="cb49-478"><a href="#cb49-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-481"><a href="#cb49-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-482"><a href="#cb49-482" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed-Effects-Schätzung</span></span>
<span id="cb49-483"><a href="#cb49-483" aria-hidden="true" tabindex="-1"></a>panel_FE <span class="ot">&lt;-</span> <span class="fu">feols</span>(</span>
<span id="cb49-484"><a href="#cb49-484" aria-hidden="true" tabindex="-1"></a>  <span class="at">fml =</span> Y <span class="sc">~</span> X <span class="sc">|</span> ID,  </span>
<span id="cb49-485"><a href="#cb49-485" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> paneldata</span>
<span id="cb49-486"><a href="#cb49-486" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-487"><a href="#cb49-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-488"><a href="#cb49-488" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(panel_FE)</span>
<span id="cb49-489"><a href="#cb49-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-490"><a href="#cb49-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-491"><a href="#cb49-491" aria-hidden="true" tabindex="-1"></a>Die Zusammenfassung der Schätzung zeigt einen signifikanten Koeffizienten, der mit einer Schätzung von $<span class="in">`r round(panel_FE$coefficients[1], 2)`</span>$ nahe beim wahren Wert von $\beta_1 = -1$ liegt. Die geschätzten einheiten-spezifischen Effekte können mit <span class="in">`fixest::fixef()`</span> ausgelesen werden.</span>
<span id="cb49-492"><a href="#cb49-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-495"><a href="#cb49-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-496"><a href="#cb49-496" aria-hidden="true" tabindex="-1"></a><span class="co"># Geschätzte Fixed Effects (Einheiten) auslesen</span></span>
<span id="cb49-497"><a href="#cb49-497" aria-hidden="true" tabindex="-1"></a>fixest<span class="sc">::</span><span class="fu">fixef</span>(panel_FE)</span>
<span id="cb49-498"><a href="#cb49-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-499"><a href="#cb49-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-500"><a href="#cb49-500" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb49-501"><a href="#cb49-501" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Key Facts zu Fixed-Effects-Regression</span></span>
<span id="cb49-502"><a href="#cb49-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-503"><a href="#cb49-503" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fixed-Effects-Schätzer kontrollieren für den Einfluss von Heterogenitäten zwischen Beobachtungseinheiten die über die Zeit konstant sind (einheiten-spezifische Effekte) und/oder für Heterogenitäten, die identisch für die Beobachtungseinheiten sind, jedoch über die Zeit variieren (Zeit-Effekte).</span>
<span id="cb49-504"><a href="#cb49-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-505"><a href="#cb49-505" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ein Fixed-Effects-Ansatz ist nötig, wenn *unbeobachtete*, mit den erklärenden Variablen korrelierte Heterogenitäten vorhanden sind. Kontrolle für letztere gewährleistet eine verzerrungsfreie Schätzung der Regressionskoeffizienten in Panel-Studien. </span>
<span id="cb49-506"><a href="#cb49-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-507"><a href="#cb49-507" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>LSDV-Regression ist eine Variante zur Schätzung bei Fixed Effects mit KQ. Hierbei werden Backdoors durch unbeobachtbare Heterogenitäten mit Dummy-Variablen geschlossen. In einer LSDV-Regression können die Koeffizienten zeitlich konstanter Variablen geschätzt werden.</span>
<span id="cb49-508"><a href="#cb49-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-509"><a href="#cb49-509" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>KQ liefert in Fixed-Effects-Designs erwartungstreue und konsistente Schätzer, solange die erklärenden Variablen zeitlich unkorreliert mit den Fehlertermen sind.</span>
<span id="cb49-510"><a href="#cb49-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-511"><a href="#cb49-511" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Statistische Inferenz für Fixed-Effects-Schätzer erfolgt anhand einer Approximation der asymptotischen Normalverteilung. Da die Fehlerterme heteroskedastisch und/oder über die Zeit korreliert sein können, sollten (cluster) robuste Standardfehler verwendet werden.</span>
<span id="cb49-512"><a href="#cb49-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-513"><a href="#cb49-513" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fixed Effects Modelle können in R mit dem Paketen <span class="in">`fixest`</span> oder <span class="in">`plm`</span> berechnet werden.</span>
<span id="cb49-514"><a href="#cb49-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-515"><a href="#cb49-515" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-516"><a href="#cb49-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-517"><a href="#cb49-517" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zeit-Fixed-Effects</span></span>
<span id="cb49-518"><a href="#cb49-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-519"><a href="#cb49-519" aria-hidden="true" tabindex="-1"></a>Neben zeit-invarianten Heterogenitäten zwischen den Beobachtungseinheiten können beobachtbare und unbeobachtbare Einflüsse vorliegen, die nicht zwischen den Einheiten, jedoch über die Zeit variieren. Ein DGP mit solchen zeitabhängigen Heterogenitäten ist in @fig-FEDAG3 für $T=2$ dargestellt.^<span class="co">[</span><span class="ot">Zur Vereinfachung der Interpretierbarkeit vernachlässigt das DAG in @fig-FEDAG3 zeitlich konstante Variablen.</span><span class="co">]</span></span>
<span id="cb49-520"><a href="#cb49-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-523"><a href="#cb49-523" aria-hidden="true" tabindex="-1"></a><span class="in">```{dot}</span></span>
<span id="cb49-524"><a href="#cb49-524" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-width: 6</span></span>
<span id="cb49-525"><a href="#cb49-525" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-height: 4</span></span>
<span id="cb49-526"><a href="#cb49-526" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-align: 'center'</span></span>
<span id="cb49-527"><a href="#cb49-527" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-cap: "Panel-Design mit Backdoors durch beobachtete und unbeobachtete zeitabhängige Variablen"</span></span>
<span id="cb49-528"><a href="#cb49-528" aria-hidden="true" tabindex="-1"></a><span class="in">//| label: "fig-FEDAG3" </span></span>
<span id="cb49-529"><a href="#cb49-529" aria-hidden="true" tabindex="-1"></a><span class="in">digraph FE_dag3 {</span></span>
<span id="cb49-530"><a href="#cb49-530" aria-hidden="true" tabindex="-1"></a><span class="in">    layout=neato</span></span>
<span id="cb49-531"><a href="#cb49-531" aria-hidden="true" tabindex="-1"></a><span class="in">    fontname="Helvetica,Arial,sans-serif"</span></span>
<span id="cb49-532"><a href="#cb49-532" aria-hidden="true" tabindex="-1"></a><span class="in">    node [fontname="Helvetica,Arial,sans-serif"]</span></span>
<span id="cb49-533"><a href="#cb49-533" aria-hidden="true" tabindex="-1"></a><span class="in">    edge [fontname="Helvetica,Arial,sans-serif"]</span></span>
<span id="cb49-534"><a href="#cb49-534" aria-hidden="true" tabindex="-1"></a><span class="in">    splines=true</span></span>
<span id="cb49-535"><a href="#cb49-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-536"><a href="#cb49-536" aria-hidden="true" tabindex="-1"></a><span class="in">    // Zeitvariante unbeobachtete Effekte</span></span>
<span id="cb49-537"><a href="#cb49-537" aria-hidden="true" tabindex="-1"></a><span class="in">    U1 [pos="1,8!", label=&lt;U&lt;SUB&gt;t=1&lt;/SUB&gt;&gt;, color=gray, fontcolor=gray];</span></span>
<span id="cb49-538"><a href="#cb49-538" aria-hidden="true" tabindex="-1"></a><span class="in">    U2 [pos="3,8!", label=&lt;U&lt;SUB&gt;t=2&lt;/SUB&gt;&gt;, color=gray, fontcolor=gray];</span></span>
<span id="cb49-539"><a href="#cb49-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-540"><a href="#cb49-540" aria-hidden="true" tabindex="-1"></a><span class="in">    // Knoten für Zeitvariante Einflüsse</span></span>
<span id="cb49-541"><a href="#cb49-541" aria-hidden="true" tabindex="-1"></a><span class="in">    X1 [pos="1,2!", label=&lt;X&lt;SUB&gt;t=1&lt;/SUB&gt;&gt;];</span></span>
<span id="cb49-542"><a href="#cb49-542" aria-hidden="true" tabindex="-1"></a><span class="in">    X2 [pos="3,2!", label=&lt;X&lt;SUB&gt;t=2&lt;/SUB&gt;&gt;];</span></span>
<span id="cb49-543"><a href="#cb49-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-544"><a href="#cb49-544" aria-hidden="true" tabindex="-1"></a><span class="in">    // Knoten für Perioden 1</span></span>
<span id="cb49-545"><a href="#cb49-545" aria-hidden="true" tabindex="-1"></a><span class="in">    B1 [pos="-1,4!", label=&lt;B&lt;SUB&gt;t=1&lt;/SUB&gt;&gt;];</span></span>
<span id="cb49-546"><a href="#cb49-546" aria-hidden="true" tabindex="-1"></a><span class="in">    Y1 [pos="-1,6!", label=&lt;Y&lt;SUB&gt;t=1&lt;/SUB&gt;&gt;];</span></span>
<span id="cb49-547"><a href="#cb49-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-548"><a href="#cb49-548" aria-hidden="true" tabindex="-1"></a><span class="in">    // Knoten für Perioden 2</span></span>
<span id="cb49-549"><a href="#cb49-549" aria-hidden="true" tabindex="-1"></a><span class="in">    B2 [pos="5,4!", label=&lt;B&lt;SUB&gt;t=2&lt;/SUB&gt;&gt;];</span></span>
<span id="cb49-550"><a href="#cb49-550" aria-hidden="true" tabindex="-1"></a><span class="in">    Y2 [pos="5,6!", label=&lt;Y&lt;SUB&gt;t=2&lt;/SUB&gt;&gt;];</span></span>
<span id="cb49-551"><a href="#cb49-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-552"><a href="#cb49-552" aria-hidden="true" tabindex="-1"></a><span class="in">    // Kanten für Perioden 1</span></span>
<span id="cb49-553"><a href="#cb49-553" aria-hidden="true" tabindex="-1"></a><span class="in">    U1 -&gt; X1 [color=gray, style=dashed];</span></span>
<span id="cb49-554"><a href="#cb49-554" aria-hidden="true" tabindex="-1"></a><span class="in">    U1 -&gt; Y1 [color=gray, style=dashed];</span></span>
<span id="cb49-555"><a href="#cb49-555" aria-hidden="true" tabindex="-1"></a><span class="in">    U1 -&gt; B1 [color=gray, style=dashed];</span></span>
<span id="cb49-556"><a href="#cb49-556" aria-hidden="true" tabindex="-1"></a><span class="in">    X1 -&gt; Y1;</span></span>
<span id="cb49-557"><a href="#cb49-557" aria-hidden="true" tabindex="-1"></a><span class="in">    X1 -&gt; B1;</span></span>
<span id="cb49-558"><a href="#cb49-558" aria-hidden="true" tabindex="-1"></a><span class="in">    B1 -&gt; Y1;</span></span>
<span id="cb49-559"><a href="#cb49-559" aria-hidden="true" tabindex="-1"></a><span class="in">    B1 -&gt; B2;</span></span>
<span id="cb49-560"><a href="#cb49-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-561"><a href="#cb49-561" aria-hidden="true" tabindex="-1"></a><span class="in">    // Kanten für Perioden 2</span></span>
<span id="cb49-562"><a href="#cb49-562" aria-hidden="true" tabindex="-1"></a><span class="in">    U2 -&gt; X2 [color=gray, style=dashed];</span></span>
<span id="cb49-563"><a href="#cb49-563" aria-hidden="true" tabindex="-1"></a><span class="in">    U2 -&gt; Y2 [color=gray, style=dashed];</span></span>
<span id="cb49-564"><a href="#cb49-564" aria-hidden="true" tabindex="-1"></a><span class="in">    U2 -&gt; B2 [color=gray, style=dashed];</span></span>
<span id="cb49-565"><a href="#cb49-565" aria-hidden="true" tabindex="-1"></a><span class="in">    X2 -&gt; Y2;</span></span>
<span id="cb49-566"><a href="#cb49-566" aria-hidden="true" tabindex="-1"></a><span class="in">    X2 -&gt; B2;</span></span>
<span id="cb49-567"><a href="#cb49-567" aria-hidden="true" tabindex="-1"></a><span class="in">    B2 -&gt; Y2;</span></span>
<span id="cb49-568"><a href="#cb49-568" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb49-569"><a href="#cb49-569" aria-hidden="true" tabindex="-1"></a><span class="in">    U1 -&gt; U2 [color=gray, style=dashed];</span></span>
<span id="cb49-570"><a href="#cb49-570" aria-hidden="true" tabindex="-1"></a><span class="in">    X1 -&gt; X2;</span></span>
<span id="cb49-571"><a href="#cb49-571" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb49-572"><a href="#cb49-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-573"><a href="#cb49-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-574"><a href="#cb49-574" aria-hidden="true" tabindex="-1"></a>Für beobachtbare zeitabhängige Backdoor-Variablen $X_t$ kann durch Aufnahme dieser in die Regression \eqref{eq:femodel} kontrolliert werden. Analog zum Fixed-Effects-Ansatz mit einheiten-spezifischen Konstanten können Backdoors durch unbeobachtbare zeitabhängige Einflüsse $U_t$ durch Kontrolle für perioden-spezifische Dummies $D_t^{(t)}$ (Time Fixed Effects) vermieden werden. Das Modell lautet dann</span>
<span id="cb49-575"><a href="#cb49-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-576"><a href="#cb49-576" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb49-577"><a href="#cb49-577" aria-hidden="true" tabindex="-1"></a>  Y_{it} = \beta_0 + \beta_1 B_{it} + \beta_2 X_t + \lambda_2 D_t^{(2)} + \cdots + \lambda_T D_t^{(T)} + \epsilon_{it}. </span>
<span id="cb49-578"><a href="#cb49-578" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb49-579"><a href="#cb49-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-580"><a href="#cb49-580" aria-hidden="true" tabindex="-1"></a>In empirischen Anwendung ist es häufig plausibel, für zeit- und einheiten-spezifische Effekte zu kontrollieren. Der entsprechende Regressionsansatz wird als *Two Way Fixed Effects* (TWFE) bezeichnet. </span>
<span id="cb49-581"><a href="#cb49-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-582"><a href="#cb49-582" aria-hidden="true" tabindex="-1"></a>Ein TWFE-Modell für <span class="in">`paneldata.csv`</span> kann mit <span class="in">`feols()`</span> leicht unter Angabe der Identifikationsvariable der Zeitperioden (<span class="in">`time`</span>) innerhalb des <span class="in">`fml`</span>-Arguments geschätzt werden.</span>
<span id="cb49-583"><a href="#cb49-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-586"><a href="#cb49-586" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-587"><a href="#cb49-587" aria-hidden="true" tabindex="-1"></a><span class="co"># TWFE-Schätzung</span></span>
<span id="cb49-588"><a href="#cb49-588" aria-hidden="true" tabindex="-1"></a>panel_TWFE <span class="ot">&lt;-</span> <span class="fu">feols</span>(</span>
<span id="cb49-589"><a href="#cb49-589" aria-hidden="true" tabindex="-1"></a>  <span class="at">fml =</span> Y <span class="sc">~</span> X <span class="sc">|</span> ID <span class="sc">+</span> time,  </span>
<span id="cb49-590"><a href="#cb49-590" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> paneldata</span>
<span id="cb49-591"><a href="#cb49-591" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-592"><a href="#cb49-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-593"><a href="#cb49-593" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(panel_TWFE)</span>
<span id="cb49-594"><a href="#cb49-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-595"><a href="#cb49-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-598"><a href="#cb49-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-599"><a href="#cb49-599" aria-hidden="true" tabindex="-1"></a><span class="co"># Geschätzte Fixed Effects (Einheiten + Zeit) auslesen</span></span>
<span id="cb49-600"><a href="#cb49-600" aria-hidden="true" tabindex="-1"></a>fixest<span class="sc">::</span><span class="fu">fixef</span>(panel_TWFE)</span>
<span id="cb49-601"><a href="#cb49-601" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-602"><a href="#cb49-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-603"><a href="#cb49-603" aria-hidden="true" tabindex="-1"></a><span class="fu">## Random Effects</span></span>
<span id="cb49-604"><a href="#cb49-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-605"><a href="#cb49-605" aria-hidden="true" tabindex="-1"></a>Der Fixed-Effects-Ansatz behandelt die einheiten-spezifischen Effekte $\delta_i$ in Modell \eqref{eq:femodel} als konstante Parameter. Das einfache Random-Effects-Modell lautet</span>
<span id="cb49-606"><a href="#cb49-606" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb49-607"><a href="#cb49-607" aria-hidden="true" tabindex="-1"></a>  Y_{it} =&amp;\, \beta_0 + \beta_1 B_{it} + \varepsilon_{it},</span>
<span id="cb49-608"><a href="#cb49-608" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb49-609"><a href="#cb49-609" aria-hidden="true" tabindex="-1"></a>wobei sich der Fehlerterm $\varepsilon_{it}$ aus dem zufälligen individuellen Effekt $\delta_i$ und dem unabhängigen Fehler $\epsilon_{it}$ zusammensetzt,</span>
<span id="cb49-610"><a href="#cb49-610" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb49-611"><a href="#cb49-611" aria-hidden="true" tabindex="-1"></a>  \varepsilon_{it} = \alpha_i + \epsilon_{it}.</span>
<span id="cb49-612"><a href="#cb49-612" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb49-613"><a href="#cb49-613" aria-hidden="true" tabindex="-1"></a>Der Random-Effects-Ansatz betrachtet die $\delta_i$ als *Zufallsvariablen* mit einer gemeinsamen (Normal)Verteilung, unter der Annahme, dass die $\delta_i$ *nicht* mit den erklärenden Variablen korrelieren.^<span class="co">[</span><span class="ot">Weiterhin dürfen die $\delta_i$ nicht mit dem Fehler $\epsilon_{it}$ korrelieren.</span><span class="co">]</span> </span>
<span id="cb49-614"><a href="#cb49-614" aria-hidden="true" tabindex="-1"></a>Falls diese Annahme erfüllt ist, ist der Random-Random-Effects-Schätzer effizienter als der Fixed-Effects-Schätzer: Der mittlere quadratische Fehler der Schätzung ist geringer.^<span class="co">[</span><span class="ot">Die Schätzung erfolgt oft mit der [Maximum-Likelihood-Methode](https://de.wikipedia.org/wiki/Maximum-Likelihood-Methode).</span><span class="co">]</span></span>
<span id="cb49-615"><a href="#cb49-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-616"><a href="#cb49-616" aria-hidden="true" tabindex="-1"></a>Für ein Beispiel simulieren wir Daten gemäß der Vorschrift </span>
<span id="cb49-617"><a href="#cb49-617" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb49-618"><a href="#cb49-618" aria-hidden="true" tabindex="-1"></a>  y_{it} = \alpha_i + \beta B_{it} + \epsilon_{it},\label{eq:resim}</span>
<span id="cb49-619"><a href="#cb49-619" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb49-620"><a href="#cb49-620" aria-hidden="true" tabindex="-1"></a>wobei $\alpha_i$ die individuellen Zufallseffekte. Wir wählen</span>
<span id="cb49-621"><a href="#cb49-621" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb49-622"><a href="#cb49-622" aria-hidden="true" tabindex="-1"></a>  &amp; \alpha_i \overset{u.i.v}{\sim} N(0,2.5^2), <span class="sc">\\</span></span>
<span id="cb49-623"><a href="#cb49-623" aria-hidden="true" tabindex="-1"></a>  &amp; \beta_1 = -1,<span class="sc">\\</span></span>
<span id="cb49-624"><a href="#cb49-624" aria-hidden="true" tabindex="-1"></a>  &amp; X_{it} \sim N(0,1),<span class="sc">\\</span></span>
<span id="cb49-625"><a href="#cb49-625" aria-hidden="true" tabindex="-1"></a>  &amp; \epsilon_{it} \overset{u.i.v}{\sim} N(0,0.75^2).</span>
<span id="cb49-626"><a href="#cb49-626" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb49-627"><a href="#cb49-627" aria-hidden="true" tabindex="-1"></a>Wie in <span class="in">`paneldata.csv`</span> erzeugen wir Daten für $n=12$ Individuen, die zu $T=8$ Zeitperioden beobachtet werden. Mit diesen Komponenten wird die Outcome-Variable $y_{it}$ wie in \eqref{eq:resim} generiert. Der nachstehende Code erzeugt die Daten als Matrizen für \texttt{X} und \texttt{y}, die  anschließend in ein langes Datenformat (<span class="in">`tibble`</span>) umgewandelt werden.</span>
<span id="cb49-628"><a href="#cb49-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-631"><a href="#cb49-631" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-632"><a href="#cb49-632" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plm)</span>
<span id="cb49-633"><a href="#cb49-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-634"><a href="#cb49-634" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb49-635"><a href="#cb49-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-636"><a href="#cb49-636" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter</span></span>
<span id="cb49-637"><a href="#cb49-637" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">12</span>  <span class="co"># Individuen</span></span>
<span id="cb49-638"><a href="#cb49-638" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">8</span>   <span class="co"># Perioden</span></span>
<span id="cb49-639"><a href="#cb49-639" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="co"># Behandlungseffekt</span></span>
<span id="cb49-640"><a href="#cb49-640" aria-hidden="true" tabindex="-1"></a>sigma_alpha <span class="ot">&lt;-</span> <span class="fl">2.5</span> <span class="co"># SD für RE</span></span>
<span id="cb49-641"><a href="#cb49-641" aria-hidden="true" tabindex="-1"></a>sigma_epsilon <span class="ot">&lt;-</span> <span class="fl">0.75</span> <span class="co"># SD für Fehler</span></span>
<span id="cb49-642"><a href="#cb49-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-643"><a href="#cb49-643" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Effects</span></span>
<span id="cb49-644"><a href="#cb49-644" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma_alpha)</span>
<span id="cb49-645"><a href="#cb49-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-646"><a href="#cb49-646" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrizen</span></span>
<span id="cb49-647"><a href="#cb49-647" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> n)</span>
<span id="cb49-648"><a href="#cb49-648" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> n)</span>
<span id="cb49-649"><a href="#cb49-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-650"><a href="#cb49-650" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation</span></span>
<span id="cb49-651"><a href="#cb49-651" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb49-652"><a href="#cb49-652" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb49-653"><a href="#cb49-653" aria-hidden="true" tabindex="-1"></a>    X[t, i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb49-654"><a href="#cb49-654" aria-hidden="true" tabindex="-1"></a>    epsilon_it <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma_epsilon)</span>
<span id="cb49-655"><a href="#cb49-655" aria-hidden="true" tabindex="-1"></a>    y[t, i] <span class="ot">&lt;-</span> alpha[i] <span class="sc">+</span> beta <span class="sc">*</span> X[t, i] <span class="sc">+</span> epsilon_it</span>
<span id="cb49-656"><a href="#cb49-656" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-657"><a href="#cb49-657" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-658"><a href="#cb49-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-659"><a href="#cb49-659" aria-hidden="true" tabindex="-1"></a><span class="co"># tibble erzeugen</span></span>
<span id="cb49-660"><a href="#cb49-660" aria-hidden="true" tabindex="-1"></a>RE_paneldata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb49-661"><a href="#cb49-661" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> m)),</span>
<span id="cb49-662"><a href="#cb49-662" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="at">times =</span> n),</span>
<span id="cb49-663"><a href="#cb49-663" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">as.vector</span>(X),</span>
<span id="cb49-664"><a href="#cb49-664" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">as.vector</span>(y)</span>
<span id="cb49-665"><a href="#cb49-665" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-666"><a href="#cb49-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-667"><a href="#cb49-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-668"><a href="#cb49-668" aria-hidden="true" tabindex="-1"></a>Für die Anpassung des Random-Effect-Schätzers an den simulierten Datensatz <span class="in">`RE_paneldata`</span> nutzen wir <span class="in">`plm::plm()`</span> mit <span class="in">`model = "random"`</span>.</span>
<span id="cb49-669"><a href="#cb49-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-672"><a href="#cb49-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-673"><a href="#cb49-673" aria-hidden="true" tabindex="-1"></a><span class="co"># Random-Effects-Modell anpassen</span></span>
<span id="cb49-674"><a href="#cb49-674" aria-hidden="true" tabindex="-1"></a>panel_RE <span class="ot">&lt;-</span> <span class="fu">plm</span>(</span>
<span id="cb49-675"><a href="#cb49-675" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> y <span class="sc">~</span> X, </span>
<span id="cb49-676"><a href="#cb49-676" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> RE_paneldata, </span>
<span id="cb49-677"><a href="#cb49-677" aria-hidden="true" tabindex="-1"></a>  <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"time"</span>), </span>
<span id="cb49-678"><a href="#cb49-678" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">"random"</span></span>
<span id="cb49-679"><a href="#cb49-679" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-680"><a href="#cb49-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-681"><a href="#cb49-681" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(panel_RE)</span>
<span id="cb49-682"><a href="#cb49-682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-683"><a href="#cb49-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-684"><a href="#cb49-684" aria-hidden="true" tabindex="-1"></a>Die Schätzung zeigt eine gute Anpassung an die Daten und der geschätzte Behandlungseffekt liegt mit $<span class="in">`r round(panel_RE$coefficients[2], 3)`</span>$ nahe am wahren Koeffizienten $\beta_1 = -1$.</span>
<span id="cb49-685"><a href="#cb49-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-686"><a href="#cb49-686" aria-hidden="true" tabindex="-1"></a>Mit <span class="in">`plm::ranef()`</span> erhalten wir *Differenzen* der geschätzten einheiten-spezifischen Effekte vom geschätzten Erwartungswert der unterstellten gemeinsamen Verteilung.</span>
<span id="cb49-687"><a href="#cb49-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-690"><a href="#cb49-690" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-691"><a href="#cb49-691" aria-hidden="true" tabindex="-1"></a><span class="co"># Gesch. Random Effects auslesen</span></span>
<span id="cb49-692"><a href="#cb49-692" aria-hidden="true" tabindex="-1"></a><span class="co"># (Differenzen zum geschätzten Mittelwert der gem. Verteilung)</span></span>
<span id="cb49-693"><a href="#cb49-693" aria-hidden="true" tabindex="-1"></a><span class="fu">ranef</span>(panel_RE)</span>
<span id="cb49-694"><a href="#cb49-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-695"><a href="#cb49-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-696"><a href="#cb49-696" aria-hidden="true" tabindex="-1"></a>Für die grafische Darstellung der Schätzung berechnen wir zunächst mit <span class="in">`fitted()`</span> die angepassten Werte. Für ein mit <span class="in">`plm()`</span> geschätztes Random-Effects-Modell werden die individuellen Effekte von <span class="in">`fitted()`</span> nicht berücksichtigt und müssen daher manuell hinzugefügt werden. Hierfür lesen wir zunächst den geschätzten Erwartungswert der gemeinsamen Verteilung $\widehat{\beta}_0$ aus und addieren anschließend die von <span class="in">`ranef()`</span> ausgegebenen Differenzen der individuellen Effekte gruppenweise.</span>
<span id="cb49-697"><a href="#cb49-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-700"><a href="#cb49-700" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-701"><a href="#cb49-701" aria-hidden="true" tabindex="-1"></a><span class="co"># Gesch. Erwartungswert der gem. Verteilung</span></span>
<span id="cb49-702"><a href="#cb49-702" aria-hidden="true" tabindex="-1"></a>hat_beta_0 <span class="ot">&lt;-</span> panel_RE<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb49-703"><a href="#cb49-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-704"><a href="#cb49-704" aria-hidden="true" tabindex="-1"></a><span class="co"># Gesch. Random Effects berücksichtigen</span></span>
<span id="cb49-705"><a href="#cb49-705" aria-hidden="true" tabindex="-1"></a>RE_paneldata <span class="ot">&lt;-</span> RE_paneldata <span class="sc">%&gt;%</span></span>
<span id="cb49-706"><a href="#cb49-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-707"><a href="#cb49-707" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_RE =</span> </span>
<span id="cb49-708"><a href="#cb49-708" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fitted</span>(panel_RE) </span>
<span id="cb49-709"><a href="#cb49-709" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> hat_beta_0 </span>
<span id="cb49-710"><a href="#cb49-710" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">rep</span>(<span class="fu">ranef</span>(panel_RE), <span class="at">each =</span> <span class="dv">8</span>)</span>
<span id="cb49-711"><a href="#cb49-711" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-712"><a href="#cb49-712" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-713"><a href="#cb49-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-716"><a href="#cb49-716" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-717"><a href="#cb49-717" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-repanelest</span></span>
<span id="cb49-718"><a href="#cb49-718" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "`RE_paneldata` -- Random-Effects-Schätzung für simulierte Daten"</span></span>
<span id="cb49-719"><a href="#cb49-719" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb49-720"><a href="#cb49-720" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> RE_paneldata, </span>
<span id="cb49-721"><a href="#cb49-721" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> </span>
<span id="cb49-722"><a href="#cb49-722" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb49-723"><a href="#cb49-723" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> X, </span>
<span id="cb49-724"><a href="#cb49-724" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> y, </span>
<span id="cb49-725"><a href="#cb49-725" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> id</span>
<span id="cb49-726"><a href="#cb49-726" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-727"><a href="#cb49-727" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb49-728"><a href="#cb49-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb49-729"><a href="#cb49-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb49-730"><a href="#cb49-730" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> fitted_RE, <span class="at">group =</span> id), </span>
<span id="cb49-731"><a href="#cb49-731" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> F</span>
<span id="cb49-732"><a href="#cb49-732" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-733"><a href="#cb49-733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb49-734"><a href="#cb49-734" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-735"><a href="#cb49-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-736"><a href="#cb49-736" aria-hidden="true" tabindex="-1"></a>Die Random-Effects-Methode findet bei kausalen Analyse in empirischen Anwendungen selten Anwendung, weil die Annahme von Unkorreliertheit mit den erklärenden Regressoren oft unplausibel ist. Falls diese Annahme (wie in den DAGs @fig-FEDAG1 und @fig-FEDAG2) verletzt ist, kann Random Effects die ensprechenden Backdoors nicht schließen: Der Random-Effects-Schätzer ist dann verzerrt und inkonsistent, ähnlich wie der naive KQ-Schätzer in einer Pooled Regression.</span>
<span id="cb49-737"><a href="#cb49-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-738"><a href="#cb49-738" aria-hidden="true" tabindex="-1"></a><span class="fu">### Verzerrung bei Endogenität</span></span>
<span id="cb49-739"><a href="#cb49-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-740"><a href="#cb49-740" aria-hidden="true" tabindex="-1"></a>Zur Illustration der Verzerrung des Random-Effects-Schätzers bei Endogenität von erklärenden Variablen verwenden wir erneut den anhand eines Fixed-Effects-DGPs simulierten Datensatz <span class="in">`paneldata.csv`</span>.</span>
<span id="cb49-741"><a href="#cb49-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-744"><a href="#cb49-744" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-745"><a href="#cb49-745" aria-hidden="true" tabindex="-1"></a><span class="co"># Random-Effects-Schätzung für `paneldata`</span></span>
<span id="cb49-746"><a href="#cb49-746" aria-hidden="true" tabindex="-1"></a>panel_RE <span class="ot">&lt;-</span> <span class="fu">plm</span>(</span>
<span id="cb49-747"><a href="#cb49-747" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> Y <span class="sc">~</span> X,  </span>
<span id="cb49-748"><a href="#cb49-748" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">"random"</span>,</span>
<span id="cb49-749"><a href="#cb49-749" aria-hidden="true" tabindex="-1"></a>  <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"ID"</span>, <span class="st">"time"</span>),  </span>
<span id="cb49-750"><a href="#cb49-750" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> paneldata</span>
<span id="cb49-751"><a href="#cb49-751" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-752"><a href="#cb49-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-753"><a href="#cb49-753" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(panel_RE)</span>
<span id="cb49-754"><a href="#cb49-754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-755"><a href="#cb49-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-756"><a href="#cb49-756" aria-hidden="true" tabindex="-1"></a>Offenbar weicht der Random-Effects-Schätzer des Effects von $X$ auf $Y$ deutlich vom wahren Parameter $\beta_1 = -1$ ab. Diese Abweichung ist auf die Endogenität von $X$ zurückzuführen.</span>
<span id="cb49-757"><a href="#cb49-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-758"><a href="#cb49-758" aria-hidden="true" tabindex="-1"></a>Die nächste Grafik vergleicht die Schätzungen des Behandlungseffekts für den Datensatz <span class="in">`paneldata.csv`</span> mit Pooling (schwarze Linie), Fixed Effects (farbige Linien) und Random Effects (gestrichelte schwarze Linie). Vorab erweitern wir <span class="in">`paneldata`</span> um die angepassten Werte für die Fixed- und die Random-Effects-Schätzung in <span class="in">`panel_FE`</span> und <span class="in">`panel_RE`</span>.^<span class="co">[</span><span class="ot">Für bessere Lesbarkeit erzeugen wir hier mit `predict()` eine Regressionsgerade, deren Achsenabschnitt dem geschätzten Erwartungswert der Random-Effects-Verteilung entspricht.</span><span class="co">]</span></span>
<span id="cb49-759"><a href="#cb49-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-762"><a href="#cb49-762" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-763"><a href="#cb49-763" aria-hidden="true" tabindex="-1"></a>paneldata <span class="ot">&lt;-</span> paneldata <span class="sc">%&gt;%</span> </span>
<span id="cb49-764"><a href="#cb49-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-765"><a href="#cb49-765" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vorhergesagte Werte für FE-Schätzung</span></span>
<span id="cb49-766"><a href="#cb49-766" aria-hidden="true" tabindex="-1"></a>    <span class="at">yhat_FE =</span> <span class="fu">fitted</span>(panel_FE),</span>
<span id="cb49-767"><a href="#cb49-767" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vorhergesagte Werte für RE-Schätzung</span></span>
<span id="cb49-768"><a href="#cb49-768" aria-hidden="true" tabindex="-1"></a>    <span class="at">yhat_RE =</span> <span class="fu">predict</span>(panel_RE)</span>
<span id="cb49-769"><a href="#cb49-769" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-770"><a href="#cb49-770" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-771"><a href="#cb49-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-774"><a href="#cb49-774" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-775"><a href="#cb49-775" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-panelcomparison</span></span>
<span id="cb49-776"><a href="#cb49-776" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "`paneldaten.csv` -- Vergleich von Schätzern bei Einheiten mit endogeneen Effekten"</span></span>
<span id="cb49-777"><a href="#cb49-777" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb49-778"><a href="#cb49-778" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> paneldata,</span>
<span id="cb49-779"><a href="#cb49-779" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)</span>
<span id="cb49-780"><a href="#cb49-780" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb49-781"><a href="#cb49-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb49-782"><a href="#cb49-782" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> col), </span>
<span id="cb49-783"><a href="#cb49-783" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> F</span>
<span id="cb49-784"><a href="#cb49-784" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-785"><a href="#cb49-785" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pooling</span></span>
<span id="cb49-786"><a href="#cb49-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb49-787"><a href="#cb49-787" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb49-788"><a href="#cb49-788" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> F,</span>
<span id="cb49-789"><a href="#cb49-789" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span></span>
<span id="cb49-790"><a href="#cb49-790" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-791"><a href="#cb49-791" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fixed Effects</span></span>
<span id="cb49-792"><a href="#cb49-792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb49-793"><a href="#cb49-793" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> yhat_FE, <span class="at">group =</span> ID, <span class="at">col =</span> col), </span>
<span id="cb49-794"><a href="#cb49-794" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> F</span>
<span id="cb49-795"><a href="#cb49-795" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-796"><a href="#cb49-796" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Random Effects</span></span>
<span id="cb49-797"><a href="#cb49-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb49-798"><a href="#cb49-798" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> yhat_RE), </span>
<span id="cb49-799"><a href="#cb49-799" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="st">"dashed"</span>, </span>
<span id="cb49-800"><a href="#cb49-800" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> F</span>
<span id="cb49-801"><a href="#cb49-801" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-802"><a href="#cb49-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb49-803"><a href="#cb49-803" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-804"><a href="#cb49-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-805"><a href="#cb49-805" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb49-806"><a href="#cb49-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-807"><a href="#cb49-807" aria-hidden="true" tabindex="-1"></a>**Interaktive Illustration von Panel-Schätzern**</span>
<span id="cb49-808"><a href="#cb49-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-809"><a href="#cb49-809" aria-hidden="true" tabindex="-1"></a>Die nachfolgende interaktive Illustration erlaubt einen Vergleich der in @fig-panelcomparison geplotteten geschätzten Regressionsfunktionen für <span class="in">`paneldata.csv`</span> mit dem wahren DGP (Show truth) unter Reproduktion der in @fig-panelcomparison gezeigten Komponenten. </span>
<span id="cb49-810"><a href="#cb49-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-811"><a href="#cb49-811" aria-hidden="true" tabindex="-1"></a>&lt;iframe width="100%" height="642" frameborder="0"</span>
<span id="cb49-812"><a href="#cb49-812" aria-hidden="true" tabindex="-1"></a>  src="https://observablehq.com/embed/@mca91/panelcomp?cells=viewof+showgroups%2Cviewof+showdgp%2Cviewof+regtype%2Ctheplot"&gt;</span>
<span id="cb49-813"><a href="#cb49-813" aria-hidden="true" tabindex="-1"></a>&lt;/iframe&gt;</span>
<span id="cb49-814"><a href="#cb49-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-815"><a href="#cb49-815" aria-hidden="true" tabindex="-1"></a><span class="fu">## Beispiel: Einkommen und Demokratie</span></span>
<span id="cb49-816"><a href="#cb49-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-817"><a href="#cb49-817" aria-hidden="true" tabindex="-1"></a>Eine Vielzahl polit-ökonomischer Standardwerke und Studien <span class="co">[</span><span class="ot">bspw. @Dahl1971; @Huntington1991; @Rueschemeyer1992</span><span class="co">]</span> liefert vermeindliche Belege für einen zentralen Grundsatz der <span class="co">[</span><span class="ot">Modernisierungstheorie</span><span class="co">](https://de.wikipedia.org/wiki/Modernisierungstheorie)</span>: Ein höheres Pro-Kopf-Einkommen erhöht die Nachfrage der Bevölkerung nach politischer Freiheit und demokratischen Insitutionen. @Acemogluetal2008 argumentieren, dass der in derartigen länderübergreifenden Analysen mit Pooling häufig als positiv geschätzte Zusammenhang zwischen Einkommen und Demokratisierung nicht kausal interpetiert werden sollte. Ein Grund hierfür ist, dass (unbeobachtbare) ausgelassene länderspezifische Faktoren, die sowohl die ökonomische Entwicklung als auch die Stärke demokratischer Institutionen beeinflussen, wahrscheinlich sind. Um diese mögliche Ursache für Endogenität des Zusammenhangs</span>
<span id="cb49-818"><a href="#cb49-818" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb49-819"><a href="#cb49-819" aria-hidden="true" tabindex="-1"></a>  \text{Demokratisierung}_i = \beta_0 + \beta_1\,\text{PK-Einkommen}_i + \epsilon_i</span>
<span id="cb49-820"><a href="#cb49-820" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb49-821"><a href="#cb49-821" aria-hidden="true" tabindex="-1"></a>zu adressieren, nutzen @Acemogluetal2008 einen Panel-Regressionsansatz ähnlich zu</span>
<span id="cb49-822"><a href="#cb49-822" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb49-823"><a href="#cb49-823" aria-hidden="true" tabindex="-1"></a>  \text{Demokratisierung}_{it} = \delta_i + \beta_1\,\text{PK-Einkommen}_{it} + \epsilon_{it}</span>
<span id="cb49-824"><a href="#cb49-824" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb49-825"><a href="#cb49-825" aria-hidden="true" tabindex="-1"></a>mit Fixed Effects $\delta_i$, die für länderspezifische zeit-invariante Einflüsse kontrollieren.</span>
<span id="cb49-826"><a href="#cb49-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-827"><a href="#cb49-827" aria-hidden="true" tabindex="-1"></a>Das Kernergebnis von @Acemogluetal2008 ist, dass es *keinen* kausalen Zusammenhang zwischen dem Einkommen (Wirtschaftswachstum) und der Demokratisierung gibt. Die Autoren zeigen, dass historische und geografische Faktoren, die sowohl das Einkommen als auch die politischen Institutionen beeinflussen, den beobachteten Zusammenhang verzerren können. </span>
<span id="cb49-828"><a href="#cb49-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-829"><a href="#cb49-829" aria-hidden="true" tabindex="-1"></a>Für die nachfolgenden Code-Beispiele nutzen wir einen Auszug des Datensatzes aus dem Replikationspaket zu @Acemogluetal2008, siehe @Acemogluetal2008data.</span>
<span id="cb49-830"><a href="#cb49-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-831"><a href="#cb49-831" aria-hidden="true" tabindex="-1"></a>Wir lesen zunächst den Datensatz <span class="in">`Acemogluetal2008.csv`</span> ein.</span>
<span id="cb49-832"><a href="#cb49-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-835"><a href="#cb49-835" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-836"><a href="#cb49-836" aria-hidden="true" tabindex="-1"></a>acem <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xls</span>(</span>
<span id="cb49-837"><a href="#cb49-837" aria-hidden="true" tabindex="-1"></a>  <span class="st">"~/Downloads/113251-V1/Income-and-Democracy-Data-AER-adjustment.xls"</span>, </span>
<span id="cb49-838"><a href="#cb49-838" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">"5 Year Panel"</span></span>
<span id="cb49-839"><a href="#cb49-839" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-840"><a href="#cb49-840" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-841"><a href="#cb49-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-844"><a href="#cb49-844" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-845"><a href="#cb49-845" aria-hidden="true" tabindex="-1"></a>acem <span class="ot">&lt;-</span> acem <span class="sc">%&gt;%</span> </span>
<span id="cb49-846"><a href="#cb49-846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb49-847"><a href="#cb49-847" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">between</span>(year, <span class="dv">1955</span>, <span class="dv">2000</span>),</span>
<span id="cb49-848"><a href="#cb49-848" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb49-849"><a href="#cb49-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(year) </span>
<span id="cb49-850"><a href="#cb49-850" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-851"><a href="#cb49-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-852"><a href="#cb49-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-855"><a href="#cb49-855" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-856"><a href="#cb49-856" aria-hidden="true" tabindex="-1"></a><span class="co"># Pooling</span></span>
<span id="cb49-857"><a href="#cb49-857" aria-hidden="true" tabindex="-1"></a><span class="fu">feols</span>(</span>
<span id="cb49-858"><a href="#cb49-858" aria-hidden="true" tabindex="-1"></a>  <span class="at">fml =</span> fhpolrigaug <span class="sc">~</span> lrgdpch,</span>
<span id="cb49-859"><a href="#cb49-859" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.id =</span> <span class="sc">~</span> country <span class="sc">+</span> year,</span>
<span id="cb49-860"><a href="#cb49-860" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> acem, </span>
<span id="cb49-861"><a href="#cb49-861" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-862"><a href="#cb49-862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-863"><a href="#cb49-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-866"><a href="#cb49-866" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-867"><a href="#cb49-867" aria-hidden="true" tabindex="-1"></a>acem_f <span class="ot">&lt;-</span> acem <span class="sc">%&gt;%</span></span>
<span id="cb49-868"><a href="#cb49-868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1970</span>, <span class="dv">1995</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-869"><a href="#cb49-869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(code) <span class="sc">%&gt;%</span></span>
<span id="cb49-870"><a href="#cb49-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb49-871"><a href="#cb49-871" aria-hidden="true" tabindex="-1"></a>    <span class="at">dlrgdpch =</span> <span class="fu">diff</span>(lrgdpch),</span>
<span id="cb49-872"><a href="#cb49-872" aria-hidden="true" tabindex="-1"></a>    <span class="at">dfhpolrigaug =</span> <span class="fu">diff</span>(fhpolrigaug)</span>
<span id="cb49-873"><a href="#cb49-873" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb49-874"><a href="#cb49-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb49-875"><a href="#cb49-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-876"><a href="#cb49-876" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(</span>
<span id="cb49-877"><a href="#cb49-877" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> dfhpolrigaug <span class="sc">~</span> dlrgdpch,</span>
<span id="cb49-878"><a href="#cb49-878" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> acem_f</span>
<span id="cb49-879"><a href="#cb49-879" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-880"><a href="#cb49-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb49-881"><a href="#cb49-881" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-882"><a href="#cb49-882" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-885"><a href="#cb49-885" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-886"><a href="#cb49-886" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb49-887"><a href="#cb49-887" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> acem_f,</span>
<span id="cb49-888"><a href="#cb49-888" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb49-889"><a href="#cb49-889" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> dlrgdpch,</span>
<span id="cb49-890"><a href="#cb49-890" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> dfhpolrigaug</span>
<span id="cb49-891"><a href="#cb49-891" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb49-892"><a href="#cb49-892" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-893"><a href="#cb49-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb49-894"><a href="#cb49-894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb49-895"><a href="#cb49-895" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> code),</span>
<span id="cb49-896"><a href="#cb49-896" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitter</span>(</span>
<span id="cb49-897"><a href="#cb49-897" aria-hidden="true" tabindex="-1"></a>      <span class="at">height =</span> .<span class="dv">05</span>, </span>
<span id="cb49-898"><a href="#cb49-898" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">1234</span></span>
<span id="cb49-899"><a href="#cb49-899" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb49-900"><a href="#cb49-900" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb49-901"><a href="#cb49-901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb49-902"><a href="#cb49-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb49-903"><a href="#cb49-903" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Diff. Log(Pro-Kopf-BIP) (1970 - 1995)"</span>,</span>
<span id="cb49-904"><a href="#cb49-904" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Diff. Demokratie-Index (1970 - 1995)"</span></span>
<span id="cb49-905"><a href="#cb49-905" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-906"><a href="#cb49-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb49-907"><a href="#cb49-907" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-908"><a href="#cb49-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-911"><a href="#cb49-911" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-912"><a href="#cb49-912" aria-hidden="true" tabindex="-1"></a><span class="co"># time + country fixed effects</span></span>
<span id="cb49-913"><a href="#cb49-913" aria-hidden="true" tabindex="-1"></a><span class="fu">feols</span>(</span>
<span id="cb49-914"><a href="#cb49-914" aria-hidden="true" tabindex="-1"></a>  <span class="at">fml =</span> fhpolrigaug <span class="sc">~</span> <span class="fu">l</span>(fhpolrigaug) <span class="sc">+</span> <span class="fu">l</span>(lrgdpch) </span>
<span id="cb49-915"><a href="#cb49-915" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span> year <span class="sc">+</span> country,</span>
<span id="cb49-916"><a href="#cb49-916" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.id =</span> <span class="sc">~</span> country <span class="sc">+</span> year,</span>
<span id="cb49-917"><a href="#cb49-917" aria-hidden="true" tabindex="-1"></a>  <span class="at">cluster =</span> <span class="sc">~</span> country,</span>
<span id="cb49-918"><a href="#cb49-918" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> acem, </span>
<span id="cb49-919"><a href="#cb49-919" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-920"><a href="#cb49-920" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-921"><a href="#cb49-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-924"><a href="#cb49-924" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-925"><a href="#cb49-925" aria-hidden="true" tabindex="-1"></a><span class="co"># time-fixed effects</span></span>
<span id="cb49-926"><a href="#cb49-926" aria-hidden="true" tabindex="-1"></a><span class="fu">feols</span>(</span>
<span id="cb49-927"><a href="#cb49-927" aria-hidden="true" tabindex="-1"></a>  <span class="at">fml =</span> fhpolrigaug <span class="sc">~</span> <span class="fu">l</span>(fhpolrigaug) <span class="sc">+</span> <span class="fu">l</span>(lrgdpch) </span>
<span id="cb49-928"><a href="#cb49-928" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span> year,</span>
<span id="cb49-929"><a href="#cb49-929" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.id =</span> <span class="sc">~</span> country <span class="sc">+</span> year,</span>
<span id="cb49-930"><a href="#cb49-930" aria-hidden="true" tabindex="-1"></a>  <span class="at">cluster =</span> <span class="sc">~</span> country,</span>
<span id="cb49-931"><a href="#cb49-931" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> acem, </span>
<span id="cb49-932"><a href="#cb49-932" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-933"><a href="#cb49-933" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-934"><a href="#cb49-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-935"><a href="#cb49-935" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>