<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Kausalanalyse und Machinelles Lernen mit R - 7&nbsp; Synthetic Control</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Literatur.html" rel="next">
<link href="./RegReg.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zus칛tzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zur칲cksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script><meta name="robots" content="noindex">
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.js" integrity="sha512-aoZChv+8imY/U1O7KIHXvO87EOzCuKO0GhFtpD6G2Cyjo/xPeTgdf3/bchB10iB+AojMTDkMHDPLKNxPJVqDcw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
<style>
.qwebr-code-output-stdout {background-color: powderblue;}

.qwebr-button-run {
 width = 100%; 
}

.centered-caption {
   text-align: center;
}
</style>
<script src="https://cdn.jsdelivr.net/npm/quizdown@latest/public/build/quizdown.js"></script><script>quizdown.init();</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/editor/editor.main.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
<style type="text/css">
.monaco-editor pre {
  background-color: unset !important;
}

.qwebr-editor-toolbar {
  width: 100%;
  display: flex;
  justify-content: space-between;
  box-sizing: border-box;
}

.qwebr-editor-toolbar-left-buttons, .qwebr-editor-toolbar-right-buttons {
  display: flex;
}

.qwebr-non-interactive-loading-container.qwebr-cell-needs-evaluation, .qwebr-non-interactive-loading-container.qwebr-cell-evaluated {
  justify-content: center;
  display: flex;
  background-color: rgba(250, 250, 250, 0.65);
  border: 1px solid rgba(233, 236, 239, 0.65);
  border-radius: 0.5rem;
  margin-top: 15px;
  margin-bottom: 15px;
}

.qwebr-r-project-logo {
  color: #2767B0; /* R Project's blue color */
}

.qwebr-icon-status-spinner {
  color: #7894c4;
}

.qwebr-icon-run-code {
  color: #0d9c29
}

.qwebr-output-code-stdout {
  color: #111;
}

.qwebr-output-code-stderr {
  color: #db4133;
}

.qwebr-editor {
  border: 1px solid #EEEEEE;
}

.qwebr-editor-toolbar {
  background-color: #EEEEEE;
  padding: 0.2rem 0.5rem;
}

.qwebr-button {
  background-color: #EEEEEE;
  display: inline-block;
  font-weight: 400;
  line-height: 1;
  text-decoration: none;
  text-align: center;
  color: #000;
  border-color: #dee2e6;
  border: 1px solid rgba(0,0,0,0);
  padding: 0.375rem 0.75rem;
  font-size: .9rem;
  border-radius: 0.25rem;
  transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;
}

.qwebr-button:hover {
  color: #000;
  background-color: #d9dce0;
  border-color: #c8ccd0;
}

.qwebr-button:disabled,.qwebr-button.disabled,fieldset:disabled .qwebr-button {
  pointer-events: none;
  opacity: .65
}

.qwebr-button-reset {
  color: #696969; /*#4682b4;*/
}

.qwebr-button-copy {
  color: #696969;
}


/* Custom styling for RevealJS Presentations*/

/* Reset the style of the interactive area */
.reveal div.qwebr-interactive-area {
  display: block;
  box-shadow: none;
  max-width: 100%;
  max-height: 100%;
  margin: 0;
  padding: 0;
} 

/* Provide space to entries */
.reveal div.qwebr-output-code-area pre div {
  margin: 1px 2px 1px 10px;
}

/* Collapse the inside code tags to avoid extra space between line outputs */
.reveal pre div code.qwebr-output-code-stdout, .reveal pre div code.qwebr-output-code-stderr {
  padding: 0;
  display: contents;
}

.reveal pre div code.qwebr-output-code-stdout {
  color: #111;
}

.reveal pre div code.qwebr-output-code-stderr {
  color: #db4133;
}


/* Create a border around console and output (does not effect graphs) */
.reveal div.qwebr-console-area {
  border: 1px solid #EEEEEE;
  box-shadow: 2px 2px 10px #EEEEEE;
}

/* Cap output height and allow text to scroll */
/* TODO: Is there a better way to fit contents/max it parallel to the monaco editor size? */
.reveal div.qwebr-output-code-area pre {
  max-height: 400px;
  overflow: scroll;
}

</style>
<script type="module">
// Document level settings ----

// Determine if we need to install R packages
globalThis.qwebrInstallRPackagesList = ['dplyr', 'ggplot2', 'sandwich', 'tidyr', 'readr', 'Synth'];

// Specify possible locations to search for the repository
globalThis.qwebrPackageRepoURLS = ['https://repo.r-wasm.org/'];

// Check to see if we have an empty array, if we do set to skip the installation.
globalThis.qwebrSetupRPackages = !(qwebrInstallRPackagesList.indexOf("") !== -1);
globalThis.qwebrAutoloadRPackages = true;

// Display a startup message?
globalThis.qwebrShowStartupMessage = true;
globalThis.qwebrShowHeaderMessage = false;

// Describe the webR settings that should be used
globalThis.qwebrCustomizedWebROptions = {
  "baseURL": "https://webr.r-wasm.org/v0.2.2/",
  "serviceWorkerUrl": "",
  "homedir": "/home/web_user", 
  "channelType": "ChannelType.Automatic"
};

// Store cell data
globalThis.qwebrCellDetails = [{"id":1,"code":"\n# install wabassem nlopt from astamm's repository\ninstall.packages('nloptr', repos = 'https://astamm.r-universe.dev')\n\n# create dataset directory\ndir.create(\"datasets\")\n# Download the dataset\ndownload.file(\n    \"https://raw.githubusercontent.com/mca91/kausal_data/main/brexit.csv\",\n    'datasets/brexit.csv',\n)\n\n# load the brexit data\nbrexit <- read_csv(\"datasets/brexit.csv\") %>% as.data.frame\n\n# load the Synth package\nlibrary(Synth)\noptions(pillar.sigfig = 2)","options":{"dpi":72,"message":"true","fig-cap":"","context":"setup","results":"markup","out-height":"","label":"unnamed-chunk-1","warning":"true","fig-width":7,"comment":"","fig-height":5,"autorun":"true","classes":"","out-width":"700px","output":"true"}}];

</script><script type="module">
// Declare startupMessageQWebR globally
globalThis.qwebrStartupMessage = document.createElement("p");


// Function to set the button text
globalThis.qwebrSetInteractiveButtonState = function(buttonText, enableCodeButton = true) {
  document.querySelectorAll(".qwebr-button-run").forEach((btn) => {
    btn.innerHTML = buttonText;
    btn.disabled = !enableCodeButton;
  });
}

// Function to update the status message in non-interactive cells
globalThis.qwebrUpdateStatusMessage = function(message) {
  document.querySelectorAll(".qwebr-status-text.qwebr-cell-needs-evaluation").forEach((elem) => {
    elem.innerText = message;
  });
}

// Function to update the status message
globalThis.qwebrUpdateStatusHeader = function(message) {
  qwebrStartupMessage.innerHTML = `
    <i class="fa-solid fa-spinner fa-spin qwebr-icon-status-spinner"></i>
    <span>${message}</span>`;
}

// Function that attaches the document status message and diagnostics
function displayStartupMessage(showStartupMessage, showHeaderMessage) {
  if (!showStartupMessage) {
    return;
  }

  // Get references to header elements
  const headerHTML = document.getElementById("title-block-header");
  const headerRevealJS = document.getElementById("title-slide");

  // Create the outermost div element for metadata
  const quartoTitleMeta = document.createElement("div");
  quartoTitleMeta.classList.add("quarto-title-meta");

  // Create the first inner div element
  const firstInnerDiv = document.createElement("div");
  firstInnerDiv.setAttribute("id", "qwebr-status-message-area");

  // Create the second inner div element for "WebR Status" heading and contents
  const secondInnerDiv = document.createElement("div");
  secondInnerDiv.setAttribute("id", "qwebr-status-message-title");
  secondInnerDiv.classList.add("quarto-title-meta-heading");
  secondInnerDiv.innerText = "WebR Status";

  // Create another inner div for contents
  const secondInnerDivContents = document.createElement("div");
  secondInnerDivContents.setAttribute("id", "qwebr-status-message-body");
  secondInnerDivContents.classList.add("quarto-title-meta-contents");

  // Describe the WebR state
  qwebrStartupMessage.innerText = "游리 Loading...";
  qwebrStartupMessage.setAttribute("id", "qwebr-status-message-text");
  // Add `aria-live` to auto-announce the startup status to screen readers
  qwebrStartupMessage.setAttribute("aria-live", "assertive");

  // Append the startup message to the contents
  secondInnerDivContents.appendChild(qwebrStartupMessage);

  // Add a status indicator for COOP and COEP Headers if needed
  if (showHeaderMessage) {
    const crossOriginMessage = document.createElement("p");
    crossOriginMessage.innerText = `${crossOriginIsolated ? '游릭' : '游리'} COOP & COEP Headers`;
    crossOriginMessage.setAttribute("id", "qwebr-coop-coep-header");
    secondInnerDivContents.appendChild(crossOriginMessage);
  }

  // Combine the inner divs and contents
  firstInnerDiv.appendChild(secondInnerDiv);
  firstInnerDiv.appendChild(secondInnerDivContents);
  quartoTitleMeta.appendChild(firstInnerDiv);

  // Determine where to insert the quartoTitleMeta element
  if (headerHTML || headerRevealJS) {
    // Append to the existing "title-block-header" element or "title-slide" div
    (headerHTML || headerRevealJS).appendChild(quartoTitleMeta);
  } else {
    // If neither headerHTML nor headerRevealJS is found, insert after "webr-monaco-editor-init" script
    const monacoScript = document.getElementById("qwebr-monaco-editor-init");
    const header = document.createElement("header");
    header.setAttribute("id", "title-block-header");
    header.appendChild(quartoTitleMeta);
    monacoScript.after(header);
  }
}

displayStartupMessage(qwebrShowStartupMessage, qwebrShowHeaderMessage);
</script><script type="module">
// Supported Evaluation Types for Context
globalThis.EvalTypes = Object.freeze({
  Interactive: 'interactive',
  Setup: 'setup',
  Output: 'output',
});

// Function that dispatches the creation request
globalThis.qwebrCreateHTMLElement = function (
  cellData
) {

  // Extract key components
  const evalType = cellData.options.context;
  const qwebrCounter = cellData.id;

  // We make an assumption that insertion points are defined by the Lua filter as:
  // qwebr-insertion-location-{qwebrCounter} 
  const elementLocator = document.getElementById(`qwebr-insertion-location-${qwebrCounter}`);

  // Figure out the routine to use to insert the element.
  let qwebrElement;
  switch ( evalType ) {
    case EvalTypes.Interactive:
      qwebrElement = qwebrCreateInteractiveElement(qwebrCounter, cellData.options);
      break;
    case EvalTypes.Output: 
      qwebrElement = qwebrCreateNonInteractiveOutputElement(qwebrCounter, cellData.options);
      break;
    case EvalTypes.Setup: 
      qwebrElement = qwebrCreateNonInteractiveSetupElement(qwebrCounter, cellData.options);
      break;
    default: 
      qwebrElement = document.createElement('div');
      qwebrElement.textContent = 'Error creating `quarto-webr` element';
  }

  // Insert the dynamically generated object at the document location.
  elementLocator.appendChild(qwebrElement);
};

// Function that setups the interactive element creation
globalThis.qwebrCreateInteractiveElement = function (qwebrCounter, qwebrOptions) {

  // Create main div element
  var mainDiv = document.createElement('div');
  mainDiv.id = 'qwebr-interactive-area-' + qwebrCounter;
  mainDiv.className = `qwebr-interactive-area`;
  if (qwebrOptions.classes) {
    mainDiv.className += " " + qwebrOptions.classes
  }

  // Add a unique cell identifier that users can customize
  if (qwebrOptions.label) {
    mainDiv.setAttribute('data-id', qwebrOptions.label);
  }

  // Create toolbar div
  var toolbarDiv = document.createElement('div');
  toolbarDiv.className = 'qwebr-editor-toolbar';
  toolbarDiv.id = 'qwebr-editor-toolbar-' + qwebrCounter;

  // Create a div to hold the left buttons
  var leftButtonsDiv = document.createElement('div');
  leftButtonsDiv.className = 'qwebr-editor-toolbar-left-buttons';

  // Create a div to hold the right buttons
  var rightButtonsDiv = document.createElement('div');
  rightButtonsDiv.className = 'qwebr-editor-toolbar-right-buttons';

  // Create Run Code button
  var runCodeButton = document.createElement('button');
  runCodeButton.className = 'btn btn-default qwebr-button qwebr-button-run';
  runCodeButton.disabled = true;
  runCodeButton.type = 'button';
  runCodeButton.id = 'qwebr-button-run-' + qwebrCounter;
  runCodeButton.textContent = '游리 Loading webR...';
  runCodeButton.title = `Run code (Shift + Enter)`;

  // Append buttons to the leftButtonsDiv
  leftButtonsDiv.appendChild(runCodeButton);

  // Create Reset button
  var resetButton = document.createElement('button');
  resetButton.className = 'btn btn-light btn-xs qwebr-button qwebr-button-reset';
  resetButton.type = 'button';
  resetButton.id = 'qwebr-button-reset-' + qwebrCounter;
  resetButton.title = 'Start over';
  resetButton.innerHTML = '<i class="fa-solid fa-arrows-rotate"></i>';

  // Create Copy button
  var copyButton = document.createElement('button');
  copyButton.className = 'btn btn-light btn-xs qwebr-button qwebr-button-copy';
  copyButton.type = 'button';
  copyButton.id = 'qwebr-button-copy-' + qwebrCounter;
  copyButton.title = 'Copy code';
  copyButton.innerHTML = '<i class="fa-regular fa-copy"></i>';

  // Append buttons to the rightButtonsDiv
  rightButtonsDiv.appendChild(resetButton);
  rightButtonsDiv.appendChild(copyButton);

  // Create console area div
  var consoleAreaDiv = document.createElement('div');
  consoleAreaDiv.id = 'qwebr-console-area-' + qwebrCounter;
  consoleAreaDiv.className = 'qwebr-console-area';

  // Create editor div
  var editorDiv = document.createElement('div');
  editorDiv.id = 'qwebr-editor-' + qwebrCounter;
  editorDiv.className = 'qwebr-editor';

  // Create output code area div
  var outputCodeAreaDiv = document.createElement('div');
  outputCodeAreaDiv.id = 'qwebr-output-code-area-' + qwebrCounter;
  outputCodeAreaDiv.className = 'qwebr-output-code-area';
  outputCodeAreaDiv.setAttribute('aria-live', 'assertive');

  // Create pre element inside output code area
  var preElement = document.createElement('pre');
  preElement.style.visibility = 'hidden';
  outputCodeAreaDiv.appendChild(preElement);

  // Create output graph area div
  var outputGraphAreaDiv = document.createElement('div');
  outputGraphAreaDiv.id = 'qwebr-output-graph-area-' + qwebrCounter;
  outputGraphAreaDiv.className = 'qwebr-output-graph-area';

  // Append buttons to the toolbar
  toolbarDiv.appendChild(leftButtonsDiv);
  toolbarDiv.appendChild(rightButtonsDiv);

  // Append all elements to the main div
  consoleAreaDiv.appendChild(editorDiv);
  mainDiv.appendChild(consoleAreaDiv);
  mainDiv.appendChild(toolbarDiv);
  mainDiv.appendChild(outputCodeAreaDiv);
  mainDiv.appendChild(outputGraphAreaDiv);

  return mainDiv;
}

// Function that adds output structure for non-interactive output
globalThis.qwebrCreateNonInteractiveOutputElement = function(qwebrCounter, qwebrOptions) {
  // Create main div element
  var mainDiv = document.createElement('div');
  mainDiv.id = 'qwebr-noninteractive-area-' + qwebrCounter;
  mainDiv.className = `qwebr-noninteractive-area`;
  if (qwebrOptions.classes) {
    mainDiv.className += " " + qwebrOptions.classes
  }
  
  // Add a unique cell identifier that users can customize
  if (qwebrOptions.label) {
    mainDiv.setAttribute('data-id', qwebrOptions.label);
  }
  
  // Create a status container div
  var statusContainer = createLoadingContainer(qwebrCounter);

  // Create output code area div
  var outputCodeAreaDiv = document.createElement('div');
  outputCodeAreaDiv.id = 'qwebr-output-code-area-' + qwebrCounter;
  outputCodeAreaDiv.className = 'qwebr-output-code-area';
  outputCodeAreaDiv.setAttribute('aria-live', 'assertive');

  // Create pre element inside output code area
  var preElement = document.createElement('pre');
  preElement.style.visibility = 'hidden';
  outputCodeAreaDiv.appendChild(preElement);

  // Create output graph area div
  var outputGraphAreaDiv = document.createElement('div');
  outputGraphAreaDiv.id = 'qwebr-output-graph-area-' + qwebrCounter;
  outputGraphAreaDiv.className = 'qwebr-output-graph-area';

  // Append all elements to the main div
  mainDiv.appendChild(statusContainer);
  mainDiv.appendChild(outputCodeAreaDiv);
  mainDiv.appendChild(outputGraphAreaDiv);

  return mainDiv;
};

// Function that adds a stub in the page to indicate a setup cell was used.
globalThis.qwebrCreateNonInteractiveSetupElement = function(qwebrCounter, qwebrOptions) {
  // Create main div element
  var mainDiv = document.createElement('div');
  mainDiv.id = `qwebr-noninteractive-setup-area-${qwebrCounter}`;
  mainDiv.className = `qwebr-noninteractive-setup-area`;
  if (qwebrOptions.classes) {
    mainDiv.className += " " + qwebrOptions.classes
  }


  // Add a unique cell identifier that users can customize
  if (qwebrOptions.label) {
    mainDiv.setAttribute('data-id', qwebrOptions.label);
  }

  // Create a status container div
  var statusContainer = createLoadingContainer(qwebrCounter);

  // Append status onto the main div
  mainDiv.appendChild(statusContainer);

  return mainDiv;
}


// Function to create loading container with specified ID
globalThis.createLoadingContainer = function(qwebrCounter) {

  // Create a status container
  const container = document.createElement('div');
  container.id = `qwebr-non-interactive-loading-container-${qwebrCounter}`;
  container.className = 'qwebr-non-interactive-loading-container qwebr-cell-needs-evaluation';

  // Create an R project logo to indicate its a code space
  const rProjectIcon = document.createElement('i');
  rProjectIcon.className = 'fa-brands fa-r-project fa-3x qwebr-r-project-logo';

  // Setup a loading icon from font awesome
  const spinnerIcon = document.createElement('i');
  spinnerIcon.className = 'fa-solid fa-spinner fa-spin fa-1x qwebr-icon-status-spinner';

  // Add a section for status text
  const statusText = document.createElement('p');
  statusText.id = `qwebr-status-text-${qwebrCounter}`;
  statusText.className = `qwebr-status-text qwebr-cell-needs-evaluation`;
  statusText.innerText = 'Loading webR...';

  // Incorporate an inner container
  const innerContainer = document.createElement('div');

  // Append elements to the inner container
  innerContainer.appendChild(spinnerIcon);
  innerContainer.appendChild(statusText);

  // Append elements to the main container
  container.appendChild(rProjectIcon);
  container.appendChild(innerContainer);

  return container;
}
</script><script type="module">
// Function to install a single package
async function qwebrInstallRPackage(packageName) {
  await mainWebR.evalRVoid(`webr::install('${packageName}');`);
}

// Function to load a single package
async function qwebrLoadRPackage(packageName) {
  await mainWebR.evalRVoid(`require('${packageName}', quietly = TRUE)`);
}

// Generic function to process R packages
async function qwebrProcessRPackagesWithStatus(packages, processType, displayStatusMessageUpdate = true) {
  // Switch between contexts
  const messagePrefix = processType === 'install' ? 'Installing' : 'Loading';

  // Modify button state
  qwebrSetInteractiveButtonState(`游리 ${messagePrefix} package ...`, false);

  // Iterate over packages
  for (let i = 0; i < packages.length; i++) {
    const activePackage = packages[i];
    const formattedMessage = `${messagePrefix} package ${i + 1} out of ${packages.length}: ${activePackage}`;

    // Display the update in header
    if (displayStatusMessageUpdate) {
      qwebrUpdateStatusHeader(formattedMessage);
    }

    // Display the update in non-active areas
    qwebrUpdateStatusMessage(formattedMessage);

    // Run package installation
    if (processType === 'install') {
      await qwebrInstallRPackage(activePackage);
    } else {
      await qwebrLoadRPackage(activePackage);
    }
  }

  // Clean slate
  if (processType === 'load') {
    await mainWebR.flush();
  }
}

// Start a timer
const initializeWebRTimerStart = performance.now();

// Encase with a dynamic import statement
globalThis.qwebrInstance = import(qwebrCustomizedWebROptions.baseURL + "webr.mjs").then(
  async ({ WebR, ChannelType }) => {
    // Populate WebR options with defaults or new values based on `webr` meta
    globalThis.mainWebR = new WebR(qwebrCustomizedWebROptions);

    // Initialization WebR
    await mainWebR.init();

    // Setup a shelter
    globalThis.mainWebRCodeShelter = await new mainWebR.Shelter();

    // Setup a pager to allow processing help documentation 
    await mainWebR.evalRVoid('webr::pager_install()'); 

    // Override the existing install.packages() to use webr::install()
    await mainWebR.evalRVoid('webr::shim_install()'); 

    // Specify the repositories to pull from
    // Note: webR does not use the `repos` option, but instead uses `webr_pkg_repos`
    // inside of `install()`. However, other R functions still pull from `repos`.
    await mainWebR.evalRVoid(`
      options(
        webr_pkg_repos = c(${qwebrPackageRepoURLS.map(repoURL => `'${repoURL}'`).join(',')}),
        repos = c(${qwebrPackageRepoURLS.map(repoURL => `'${repoURL}'`).join(',')})
      )
    `);

    // Check to see if any packages need to be installed
    if (qwebrSetupRPackages) {
      // Obtain only a unique list of packages
      const uniqueRPackageList = Array.from(new Set(qwebrInstallRPackagesList));

      // Install R packages one at a time (either silently or with a status update)
      await qwebrProcessRPackagesWithStatus(uniqueRPackageList, 'install', qwebrShowStartupMessage);

      if (qwebrAutoloadRPackages) {
        // Load R packages one at a time (either silently or with a status update)
        await qwebrProcessRPackagesWithStatus(uniqueRPackageList, 'load', qwebrShowStartupMessage);
      }
    }
  }
);

// Stop timer
const initializeWebRTimerEnd = performance.now();

</script><script type="module">
// Function to verify a given JavaScript Object is empty
globalThis.qwebrIsObjectEmpty = function (arr) {
    return Object.keys(arr).length === 0;
}

// Global version of the Escape HTML function that converts HTML 
// characters to their HTML entities.
globalThis.qwebrEscapeHTMLCharacters = function(unsafe) {
    return unsafe
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;");
  };

// Passthrough results
globalThis.qwebrIdentity = function(x) {
    return x;
};

// Append a comment
globalThis.qwebrPrefixComment = function(x, comment) {
    return `${comment}${x}`;
};

// Function to parse the pager results
globalThis.qwebrParseTypePager = async function (msg) { 

    // Split out the event data
    const { path, title, deleteFile } = msg.data; 

    // Process the pager data by reading the information from disk
    const paged_data = await mainWebR.FS.readFile(path).then((data) => {
        // Obtain the file content
        let content = new TextDecoder().decode(data);

        // Remove excessive backspace characters until none remain
        while(content.match(/.[\b]/)){
        content = content.replace(/.[\b]/g, '');
        }

        // Returned cleaned data
        return content;
    });

    // Unlink file if needed
    if (deleteFile) { 
        await mainWebR.FS.unlink(path); 
    } 

    // Return extracted data with spaces
    return paged_data;
} 

// Function to run the code using webR and parse the output
globalThis.qwebrComputeEngine = async function(
    codeToRun, 
    elements, 
    options) {

    // Call into the R compute engine that persists within the document scope.
    // To be prepared for all scenarios, the following happens: 
    // 1. We setup a canvas device to write to by making a namespace call into the {webr} package
    // 2. We use values inside of the options array to set the figure size.
    // 3. We capture the output stream information (STDOUT and STERR)
    // 4. While parsing the results, we disable image creation.

    // Create a canvas variable for graphics
    let canvas = undefined;

    // Create a pager variable for help/file contents
    let pager = [];

    // Handle how output is processed
    let showMarkup = options.results === "markup" && options.output !== "asis";
    let processOutput;

    if (showMarkup) {
        processOutput = qwebrEscapeHTMLCharacters;
    } else {
        processOutput = qwebrIdentity;
    }

    // ---- 
    // Convert from Inches to Pixels by using DPI (dots per inch)
    // for bitmap devices (dpi * inches = pixels)
    let fig_width = options["fig-width"] * options["dpi"]
    let fig_height = options["fig-height"] * options["dpi"]

    // Initialize webR
    await mainWebR.init();

    // Setup a webR canvas by making a namespace call into the {webr} package
    await mainWebR.evalRVoid(`webr::canvas(width=${fig_width}, height=${fig_height})`);

    const result = await mainWebRCodeShelter.captureR(codeToRun, {
        withAutoprint: true,
        captureStreams: true,
        captureConditions: false//,
        // env: webR.objs.emptyEnv, // maintain a global environment for webR v0.2.0
    });

    // -----

    // Start attempting to parse the result data
    processResultOutput:try {

        // Stop creating images
        await mainWebR.evalRVoid("dev.off()");
        
        // Avoid running through output processing
        if (options.results === "hide" || options.output === "false") { 
            break processResultOutput; 
        }

        // Merge output streams of STDOUT and STDErr (messages and errors are combined.)
        // Require both `warning` and `message` to be true to display `STDErr`. 
        const out = result.output
        .filter(
            evt => evt.type === "stdout" || 
            ( evt.type === "stderr" && (options.warning === "true" && options.message === "true")) 
        )
        .map((evt, index) => {
            const className = `qwebr-output-code-${evt.type}`;
            const outputResult = qwebrPrefixComment(processOutput(evt.data), options.comment);
            return `<code id="${className}-editor-${elements.id}-result-${index + 1}" class="${className}">${outputResult}</code>`;
        })
        .join("\n");


        // Clean the state
        // We're now able to process both graphics and pager events.
        // As a result, we cannot maintain a true 1-to-1 output order 
        // without individually feeding each line
        const msgs = await mainWebR.flush();

        // Output each image event stored
        msgs.forEach((msg) => {
        // Determine if old canvas can be used or a new canvas is required.
        if (msg.type === 'canvas'){
            // Add image to the current canvas
            if (msg.data.event === 'canvasImage') {
                canvas.getContext('2d').drawImage(msg.data.image, 0, 0);
            } else if (msg.data.event === 'canvasNewPage') {

                // Generate a new canvas element
                canvas = document.createElement("canvas");
                canvas.setAttribute("width", 2 * fig_width);
                canvas.setAttribute("height", 2 * fig_height);
                canvas.style.width = options["out-width"] ? options["out-width"] : `${fig_width}px`;
                if (options["out-height"]) {
                    canvas.style.height = options["out-height"];
                }
                canvas.style.display = "block";
                canvas.style.margin = "auto";
            }
        } 
        });

        // Use `map` to process the filtered "pager" events asynchronously
        const pager = await Promise.all(
            msgs.filter(msg => msg.type === 'pager').map(
                async (msg) => {
                    return await qwebrParseTypePager(msg);
                }
            )
        );

        // Nullify the output area of content
        elements.outputCodeDiv.innerHTML = "";
        elements.outputGraphDiv.innerHTML = "";

        // Design an output object for messages
        const pre = document.createElement("pre");
        if (/\S/.test(out)) {
            // Display results as HTML elements to retain output styling
            const div = document.createElement("div");
            div.innerHTML = out;
            pre.appendChild(div);
        } else {
            // If nothing is present, hide the element.
            pre.style.visibility = "hidden";
        }

        elements.outputCodeDiv.appendChild(pre);

        // Place the graphics on the canvas
        if (canvas) {
            // Create figure element
            const figureElement = document.createElement('figure');

            // Append canvas to figure
            figureElement.appendChild(canvas);

            if (options['fig-cap']) {
                // Create figcaption element
                const figcaptionElement = document.createElement('figcaption');
                figcaptionElement.innerText = options['fig-cap'];
                // Append figcaption to figure
                figureElement.appendChild(figcaptionElement);    
            }

            elements.outputGraphDiv.appendChild(figureElement);
        }

        // Display the pager data
        if (pager) {
        // Use the `pre` element to preserve whitespace.
        pager.forEach((paged_data, index) => {
            let pre_pager = document.createElement("pre");
            pre_pager.innerText = paged_data;
            pre_pager.classList.add("qwebr-output-code-pager");
            pre_pager.setAttribute("id", `qwebr-output-code-pager-editor-${elements.id}-result-${index + 1}`);
            elements.outputCodeDiv.appendChild(pre_pager);
        });
        }
    } finally {
        // Clean up the remaining code
        mainWebRCodeShelter.purge();
    }
}

// Function to execute the code (accepts code as an argument)
globalThis.qwebrExecuteCode = async function (
    codeToRun,
    id,
    options = {}) {

    // If options are not passed, we fall back on the bare minimum to handle the computation
    if (qwebrIsObjectEmpty(options)) {
        options = { 
            "context": "interactive", 
            "fig-width": 7, "fig-height": 5, 
            "out-width": "700px", "out-height": "", 
            "dpi": 72,
            "results": "markup", 
            "warning": "true", "message": "true",
        };
    }

    // Next, we access the compute areas values
    const elements = {
        runButton: document.getElementById(`qwebr-button-run-${id}`),
        outputCodeDiv: document.getElementById(`qwebr-output-code-area-${id}`),
        outputGraphDiv: document.getElementById(`qwebr-output-graph-area-${id}`),
        id: id,
    }

    // Disallowing execution of other code cells
    document.querySelectorAll(".qwebr-button-run").forEach((btn) => {
        btn.disabled = true;
    });

    if (options.context == EvalTypes.Interactive) {
        // Emphasize the active code cell
        elements.runButton.innerHTML = '<i class="fa-solid fa-spinner fa-spin qwebr-icon-status-spinner"></i> <span>Run Code</span>';
    }

    // Evaluate the code and parse the output into the document
    await qwebrComputeEngine(codeToRun, elements, options);

    // Switch to allowing execution of code
    document.querySelectorAll(".qwebr-button-run").forEach((btn) => {
        btn.disabled = false;
    });

    if (options.context == EvalTypes.Interactive) {
        // Revert to the initial code cell state
        elements.runButton.innerHTML = '<i class="fa-solid fa-play qwebr-icon-run-code"></i> <span>Run Code</span>';
    }
}

</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./SyntheticControl.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Synthetic Control</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a><a href="./index.html">Kausalanalyse mit R</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Lesemodus umschalten">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Start</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_Einfuehrung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistische Programmierung mit R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Matching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Matching</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DiD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Difference-in-Differences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RDD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regression Discontiniuty Designs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RegReg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regularisierte Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SyntheticControl.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Synthetic Control</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Literatur.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatur</span></a>
  </div>
</li>
    </ul>
</div>
    <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title"><a href="./index.html">칖bersicht</a></h2>
   
  <ul>
<li><a href="#sec-siscm" id="toc-sec-siscm" class="nav-link active" data-scroll-target="#sec-siscm"><span class="header-section-number">7.1</span> Sch칛tzung von Interventionseffekten mit SCM</a></li>
  <li>
<a href="#case-study-%C3%B6konomische-kosten-des-brexit" id="toc-case-study-칬konomische-kosten-des-brexit" class="nav-link" data-scroll-target="#case-study-%C3%B6konomische-kosten-des-brexit"><span class="header-section-number">7.2</span> Case Study: 칐konomische Kosten des Brexit</a>
  <ul class="collapse">
<li><a href="#placebo-tests-grafische-inferenz" id="toc-placebo-tests-grafische-inferenz" class="nav-link" data-scroll-target="#placebo-tests-grafische-inferenz"><span class="header-section-number">7.2.1</span> Placebo-Tests: Grafische Inferenz</a></li>
  <li><a href="#statistische-inferenz" id="toc-statistische-inferenz" class="nav-link" data-scroll-target="#statistische-inferenz"><span class="header-section-number">7.2.2</span> Statistische Inferenz</a></li>
  </ul>
</li>
  </ul></nav>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.js"></script><script type="module" id="qwebr-monaco-editor-init">

  // Configure the Monaco Editor's loader
  require.config({
    paths: {
      'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs'
    }
  });
</script><script type="module">
// Global dictionary to store Monaco Editor instances
globalThis.qwebrEditorInstances = {};

// Function that builds and registers a Monaco Editor instance    
globalThis.qwebrCreateMonacoEditorInstance = function (cellData) {

  const initialCode = cellData.code;
  const qwebrCounter = cellData.id;
  const qwebrOptions = cellData.options;

  // Retrieve the previously created document elements
  let runButton = document.getElementById(`qwebr-button-run-${qwebrCounter}`);
  let resetButton = document.getElementById(`qwebr-button-reset-${qwebrCounter}`);
  let copyButton = document.getElementById(`qwebr-button-copy-${qwebrCounter}`);
  let editorDiv = document.getElementById(`qwebr-editor-${qwebrCounter}`);
  
  // Load the Monaco Editor and create an instance
  let editor;
  require(['vs/editor/editor.main'], function () {
    editor = monaco.editor.create(editorDiv, {
      value: initialCode,
      language: 'r',
      theme: 'vs-light',
      automaticLayout: true,           // Works wonderfully with RevealJS
      scrollBeyondLastLine: false,
      minimap: {
        enabled: false
      },
      fontSize: '14pt',              // Bootstrap is 1 rem
      renderLineHighlight: "none",     // Disable current line highlighting
      hideCursorInOverviewRuler: true  // Remove cursor indictor in right hand side scroll bar
    });

    // Store the official counter ID to be used in keyboard shortcuts
    editor.__qwebrCounter = qwebrCounter;

    // Store the official div container ID
    editor.__qwebrEditorId = `qwebr-editor-${qwebrCounter}`;

    // Store the initial code value and options
    editor.__qwebrinitialCode = initialCode;
    editor.__qwebrOptions = qwebrOptions;

    // Set at the model level the preferred end of line (EOL) character to LF.
    // This prevent `\r\n` from being given to the webR engine if the user is on Windows.
    // See details in: https://github.com/coatless/quarto-webr/issues/94
    // Associated error text: 
    // Error: <text>:1:7 unexpected input

    // Retrieve the underlying model
    const model = editor.getModel();
    // Set EOL for the model
    model.setEOL(monaco.editor.EndOfLineSequence.LF);

    // Dynamically modify the height of the editor window if new lines are added.
    let ignoreEvent = false;
    const updateHeight = () => {
      const contentHeight = editor.getContentHeight();
      // We're avoiding a width change
      //editorDiv.style.width = `${width}px`;
      editorDiv.style.height = `${contentHeight}px`;
      try {
        ignoreEvent = true;

        // The key to resizing is this call
        editor.layout();
      } finally {
        ignoreEvent = false;
      }
    };

    // Helper function to check if selected text is empty
    function isEmptyCodeText(selectedCodeText) {
      return (selectedCodeText === null || selectedCodeText === undefined || selectedCodeText === "");
    }

    // Registry of keyboard shortcuts that should be re-added to each editor window
    // when focus changes.
    const addWebRKeyboardShortCutCommands = () => {
      // Add a keydown event listener for Shift+Enter to run all code in cell
      editor.addCommand(monaco.KeyMod.Shift | monaco.KeyCode.Enter, () => {

        // Retrieve all text inside the editor
        qwebrExecuteCode(editor.getValue(), editor.__qwebrCounter, editor.__qwebrOptions);
      });

      // Add a keydown event listener for CMD/Ctrl+Enter to run selected code
      editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.Enter, () => {

        // Get the selected text from the editor
        const selectedText = editor.getModel().getValueInRange(editor.getSelection());
        // Check if no code is selected
        if (isEmptyCodeText(selectedText)) {
          // Obtain the current cursor position
          let currentPosition = editor.getPosition();
          // Retrieve the current line content
          let currentLine = editor.getModel().getLineContent(currentPosition.lineNumber);

          // Propose a new position to move the cursor to
          let newPosition = new monaco.Position(currentPosition.lineNumber + 1, 1);

          // Check if the new position is beyond the last line of the editor
          if (newPosition.lineNumber > editor.getModel().getLineCount()) {
            // Add a new line at the end of the editor
            editor.executeEdits("addNewLine", [{
            range: new monaco.Range(newPosition.lineNumber, 1, newPosition.lineNumber, 1),
            text: "\n", 
            forceMoveMarkers: true,
            }]);
          }
          
          // Run the entire line of code.
          qwebrExecuteCode(currentLine, editor.__qwebrCounter, editor.__qwebrOptions);

          // Move cursor to new position
          editor.setPosition(newPosition);
        } else {
          // Code to run when Ctrl+Enter is pressed with selected code
          qwebrExecuteCode(selectedText, editor.__qwebrCounter, editor.__qwebrOptions);
        }
      });
    }

    // Register an on focus event handler for when a code cell is selected to update
    // what keyboard shortcut commands should work.
    // This is a workaround to fix a regression that happened with multiple
    // editor windows since Monaco 0.32.0 
    // https://github.com/microsoft/monaco-editor/issues/2947
    editor.onDidFocusEditorText(addWebRKeyboardShortCutCommands);

    // Register an on change event for when new code is added to the editor window
    editor.onDidContentSizeChange(updateHeight);

    // Manually re-update height to account for the content we inserted into the call
    updateHeight();

    // Store the editor instance in the global dictionary
    qwebrEditorInstances[editor.__qwebrCounter] = editor;

  });

  // Add a click event listener to the run button
  runButton.onclick = function () {
    qwebrExecuteCode(editor.getValue(), editor.__qwebrCounter, editor.__qwebrOptions);
  };

  // Add a click event listener to the reset button
  copyButton.onclick = function () {
    // Retrieve current code data
    const data = editor.getValue();
    
    // Write code data onto the clipboard.
    navigator.clipboard.writeText(data || "");
  };
  
  // Add a click event listener to the copy button
  resetButton.onclick = function () {
    editor.setValue(editor.__qwebrinitialCode);
  };
  
}
</script><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Synthetic Control</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><style>
.qwebr-code-output-stdout {background-color: powderblue;}

.qwebr-button-run, .qwebr-button-reset, .qwebr-button-copy {
  background-color:  rgba(0, 0, 0, 0);
  border-style: none;
  font-weight: 400;
  color: white; 
  transition: none;
}

.qwebr-editor-toolbar {
  width: 100%;
  display: flex;
  justify-content: space-between;
  box-sizing: border-box;
  border-radius: 0 0 6px 6px;
  background-color: darkgreen;
  border-color: darkgreen;
  border-width: 1px;
  border-style: solid;
  padding: 0 0; 
  transition: color .1s ease-in-out, background-color .1s ease-in-out,border-color .1s ease-in-out,box-shadow .1s ease-in-out;
}

.qwebr-editor-toolbar:hover {
  background-color: white;
  border-color: darkgreen;
  border-width: 1px;
}

.qwebr-editor-toolbar:hover * {
  color: darkgreen;
}

.overflow-guard, .qwebr-editor, .monaco-editor {
  border-radius: 6px 6px 0 0;
  border-width: 1px 1px 0 1px;
  border-color: darkgreen;
}

</style>
<div class="cell">

</div>
<div id="qwebr-insertion-location-1"></div>
<noscript>Please enable JavaScript to experience the dynamic code cell content on this page.</noscript>
<p>Synthetic Control Methoden (SCM) wurden in <span class="citation" data-cites="Abadieetal2010">A. D. Abadie Alberto und Hainmueller (<a href="Literatur.html#ref-Abadieetal2010" role="doc-biblioref">2010</a>)</span> f칲r die Auswertung kausaler Effekte von politischen Interventionen vorgeschlagen. SCM erm칬glicht es, die Auswirkungen einer Intervention oder eines Ereignisses auf ein spezifisches Untersuchungsobjekt (oftmals eine makro칬konomische Einheit wie ein Land, eine Region oder eine Stadt) in einem Forschungsdesign f칲r ein nat칲rliches Experiment zu sch칛tzen. SCM adressiert das bereits erl칛uterte Kernproblem, dass es schwierig, wenn nicht unm칬glich sein kann, eine ad칛quate Kontrollgruppe in Beobachtungsdaten zu finden. Hierzu wird eine k칲nstliche Kontrolleinheit (Synthetic Control) generiert, die der behandelten Einheit vor der Intervention m칬glichst 칛hnlich ist. Dieser synthetische Doppelg칛nger kann die unbeobachtbare Entwicklungen der behandelten Einheit <em>nach</em> der Intervention repr칛sentieren und so eine plausible Sch칛tzung des kausalen Effekts der Intervention f칲r die Post-Interventionsperioden gew칛hrleisten.</p>
<section id="sec-siscm" class="level2 page-columns page-full" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="sec-siscm">
<span class="header-section-number">7.1</span> Sch칛tzung von Interventionseffekten mit SCM</h2>
<p>츿hnlich wie bei manchen Matching-Methoden wird bei SCM die 츿hnlichkeit der synthetischen Einheit mit der untersuchten Einheit durch eine gewichtete Kombination von Kontrolleinheiten basierend auf ihren Pr칛-Interventionsmerkmalen erreicht. Seien <span class="math inline">\(i = 1, 2, \ldots, N\)</span> die Einheiten in der Stichprobe, wobei <span class="math inline">\(i = 1\)</span> die behandelte Einheit und <span class="math inline">\(i = 2, \ldots, N\)</span> potenziellen Kontrolleinheiten (auch <em>Donor pool</em> genannt) sind. Die Daten liegen f칲r die Perioden <span class="math inline">\(t = 1, 2, \ldots, T\)</span> vor, mit <span class="math inline">\(T_0\)</span> dem Zeitpunkt direkt vor der Intervention und <span class="math inline">\(T_1, \ldots, T\)</span> den Perioden nach der Intervention.</p>
<p>F칲r SCM bestimmen wir einen Vektor von Gewichten <span class="math inline">\(\mathbf{w}^* := (w_2^*, \ldots, w_k^*)^T\)</span>, der die Summe der quadrierten Differenzen zwischen den Auspr칛gungen von <span class="math inline">\(k\)</span> Charakteristika der behandelten Einheit vor der Intervention, <span class="math inline">\(X_{1,\,m}^{\text{Pre}}\)</span>, <span class="math inline">\(m=1,\dots,k\)</span>, und der gewichteten Summe dieser Charakteristika f칲r die Kontrolleinheiten, <span class="math inline">\(X_{i,\,m}^{\text{Pre}}\)</span>, minimiert:</p>
<p><span class="math display">\[\begin{align}
  \mathbf{w}^* := \arg\min_{\mathbf{w}} \sum_{m=1}^{k} v_m \left( X_{1,\,m}^{\text{Pre}} - \sum_{i=2}^{N} w_i X_{i,m}^{\text{Pre}} \right)^2,\label{eq:scopt}
\end{align}\]</span></p>
<p>unter der Nebenbedingung, dass <span class="math inline">\(\sum_{i=2}^{N} w_i = 1\)</span> und <span class="math inline">\(w_i \geq 0\)</span> f칲r alle <span class="math inline">\(i\)</span>. Die <span class="math inline">\(v_m\)</span> sind weitere Gewichte, welche die Relevanz der Variablen f칲r die Vorhersage der Outcome-Variable der interessierenden Einheit, <span class="math inline">\(Y_{1,\,t}\)</span>, beinflussen. Diese Gewichte werden meist in einem weiteren Optimierungsverfahren (bspw. mit Cross-Validation) bestimmt <span class="citation" data-cites="Abadieetal2014">(vgl. <a href="Literatur.html#ref-Abadieetal2014" role="doc-biblioref">A. Abadie, Diamond, und Hainmueller 2014</a>)</span>. Als Verlustfunktion hierbei wird meist der mittlere quadratische Fehler bei der Vorhersage von <span class="math inline">\(Y_{1,\,t}\)</span> (MSPE)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> vor der Behandlung anhand der synthetischen Einheit verwendet,</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;Engl. f칲r <em>Mean squared prediction error</em></p></div></div><p><span class="math display">\[\begin{align}
  \sum_{t=1}^{T_0} \left( Y_{1,\,t} - \sum_{i=2}^N w_i(\mathbf{v}) Y_{i,\,t} \right)^2, \label{eq:scopt2}
\end{align}\]</span> mit <span class="math inline">\(\mathbf{v} := (v_1,\dots,v_k)'\)</span>.</p>
<p>Durch die L칬sung des Optimierungsproblems <span class="math inline">\(\eqref{eq:scopt}\)</span> unter Ber칲cksichtigung von <span class="math inline">\(\eqref{eq:scopt2}\)</span> erhalten wir die gesch칛tzten Gewichte <span class="math inline">\(\widehat{w}_i\)</span>, welche den Einfluss der Kontrolleinheit <span class="math inline">\(i=2,\dots,N\)</span>-ten bei der Zusammensetzung der Kontrollgruppe festlegen. Anhand der <span class="math inline">\(\widehat{w}_i\)</span> wird die Outcome-Variable der synthetischen Kontrolleinheit konstruiert, welche als Referenz f칲r die Sch칛tzung des kausalen Effekts der Intervention dient. Die Outcome-Variable der synthetischen Kontrollgruppe f칲r die Nach-Interventionsperiode kann formal ausgedr칲ckt werden als</p>
<p><span class="math display">\[\begin{align}
  Y_{1,\,t}^{\text{Synth}} = \sum_{i=2}^{N} \widehat{w}_i Y_{i,\,t},\quad t &gt; T_0,\label{eq:dgkonst}
\end{align}\]</span></p>
<p>wobei <span class="math inline">\(Y_{1,t}^{\text{Synth}}\)</span> der Wert der Outcome-Variable <span class="math inline">\(Y\)</span> f칲r die synthetische Kontrollgruppe zum Zeitpunkt <span class="math inline">\(t\)</span> und <span class="math inline">\(Y_{i,t}\)</span> der entsprechende Wert des Outcomes f칲r die <span class="math inline">\(i\)</span>-te Kontrolleinheit ist. Bei SCM sch칛tzen wir den kausalen Effekt <span class="math inline">\(\tau_t\)</span> der Intervention zum Zeitpunkt <span class="math inline">\(t\)</span> als die Differenz der Post-Interventionswerte von <span class="math inline">\(Y\)</span> zwischen der behandelten Einheit und dem synthetischen Doppelg칛nger,</p>
<p><span class="math display">\[
\widehat{\tau}_t = Y_{1,\,t} - Y_{1,\,t}^{\text{synth}},\quad t &gt; T_0.
\]</span></p>
<p>Der mit SCM gesch칛tzte Effekt ermittelt also f칲r <span class="math inline">\(t &gt; T_0\)</span>, wie sich die Intervention auf die behandelte Einheit ausgewirkt hat durch einen Vergleich mit der Situation, die eingetreten w칛re, wenn die Einheit nicht behandelt worden w칛re, repr칛sentiert durch die synthetische Kontrollgruppe.</p>
<p>Der SCM-Sch칛tzer von <span class="citation" data-cites="Abadieetal2010">A. D. Abadie Alberto und Hainmueller (<a href="Literatur.html#ref-Abadieetal2010" role="doc-biblioref">2010</a>)</span> ist im R-Paket <code>Synth</code> <span class="citation" data-cites="Hainmuelleretal2011">(<a href="Literatur.html#ref-Hainmuelleretal2011" role="doc-biblioref"><strong>Hainmuelleretal2011?</strong></a>)</span> implementiert. Wir illustrieren die Methode nachfolgend mit einer empirischen Anwendung zu den Konsequenzen des Brexit auf die nachfolgende Entwicklung der britischen Volkswirtschaft.</p>
</section><section id="case-study-칬konomische-kosten-des-brexit" class="level2 page-columns page-full" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="case-study-칬konomische-kosten-des-brexit">
<span class="header-section-number">7.2</span> Case Study: 칐konomische Kosten des Brexit</h2>
<p><span class="citation" data-cites="Bornetal2019">Born u.&nbsp;a. (<a href="Literatur.html#ref-Bornetal2019" role="doc-biblioref">2019</a>)</span> untersuchen die 칬konomischen Kosten des Brexits mit einem kausalanalytischen Forschungsansatz. Der Kern der empirischen Analyse ist eine Kombination von quasi-experimenteller Identifikation und struktureller Zeitreihenanalyse. Hiermit k칬nnen nicht nur die aggregierten Kosten des EU-Ausstiegs f칲r Gro륵rittanien zu quantifiziert, sondern auch die Kan칛le indentifiziert werden, durch die die erwartete wirtschaftliche Desintegration die britische Makro칬konomie beeinflusst hat. Hierbei identifizieren <span class="citation" data-cites="Bornetal2019">Born u.&nbsp;a. (<a href="Literatur.html#ref-Bornetal2019" role="doc-biblioref">2019</a>)</span> einen Anstieg der wirtschaftspolitischen Unsicherheit und eine Abw칛rtskorrektur der Wachstumserwartungen als Haupttreiber f칲r den R칲ckgang der Wirtschaftsleistung.</p>
<p>Der quasi-experimentelle Ansatz betrachtet das Brexit-Referendum als ein nat칲rliches makro칬konomisches Experiment und untersucht die Konsequenzn der wirtschaftlichen Desintegration f칲r das Bruttoinlandsprodukt (BIP) im Nachfolgezeitraum mit SCM. Hierzu wird gem칛 der in <a href="#sec-siscm" class="quarto-xref"><span>Kapitel 7.1</span></a> erl칛uterten Vorgehensweise ein syntetischer Doppelg칛nger f칲r die britische Wirtschaft aus einem Donor Pool von 23 Volkswirtschaften konstruiert, und der Effekt des Referendums als Unterschied zwischen der tats칛chlichen und synthetischen Trajektorien des BIP f칲r Folgeperioden ermittelt. Die Analyse zeigt, dass das Brexit-Votum bis Ende 2018 zu einem BIP-R칲ckgang von etwa 1.7% bis 2.5% gef칲hrt hat.</p>
<p>Wie reproduzieren nun die wesentlichen Ergebnisse des SCM-Ansatzes der Studie mit R. Hierf칲r lesen zun칛chst den Datensatz <code>brexit.csv</code> (<a href="https://raw.githubusercontent.com/mca91/kausal_data/main/brexit.csv">hier verf칲gbar</a>) in R ein. Dieser enth칛lt viertelj칛hrliche Beobachtungen makro칬konomischer Variablen f칲r 24 L칛nder f칲r den Zeitraum 1995-Q12021-Q4.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Datensatz 'brexit.csv' einlesen</span></span>
<span><span class="va">brexit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"datasets/brexit.csv"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>brexit</code> ist ein Datensatz mit einer Panel-Struktur. Die Zeit- und Entit칛tsvariablen sind <code>Year</code>/<code>quarter</code> und <code>Country</code>/<code>ID</code>. Beachte, dass die Variable <code>Time</code> zus칛tzlich das Jahr und das Quartal als numerische Variable angibt.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 칖berblick 칲ber 'brexit'</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">brexit</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,496
Columns: 21
$ Time          &lt;dbl&gt; 1995.00, 1995.00, 1995.00, 1995.00, 1995.00, 1995.00, 19
$ Year          &lt;dbl&gt; 1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995, 19
$ quarter       &lt;chr&gt; "Q1", "Q1", "Q1", "Q1", "Q1", "Q1", "Q1", "Q1", "Q1", "Q
$ Country       &lt;chr&gt; "Australia", "Austria", "Belgium", "Canada", "Finland", 
$ real_con_raw  &lt;dbl&gt; 4.660970e+11, 1.214713e+11, 1.608240e+11, 5.558142e+11, 
$ real_inv_raw  &lt;dbl&gt; 1.683258e+11, 5.537994e+10, 6.118800e+10, 1.894910e+11, 
$ real_exp_raw  &lt;dbl&gt; 1.246639e+11, 6.634091e+10, 1.501160e+11, 3.353030e+11, 
$ real_imp_raw  &lt;dbl&gt; 9.781032e+10, 7.439282e+10, 1.468880e+11, 2.572610e+11, 
$ real_gdp_raw  &lt;dbl&gt; 8.495864e+11, 2.165699e+11, 2.910360e+11, 1.084659e+12, 
$ real_gdp_2016 &lt;dbl&gt; 0.5080841, 0.6832146, 0.6877292, 0.6057397, 0.6370480, 0
$ tot_emp_raw   &lt;dbl&gt; 8077377.2, 3737003.3, 3920400.0, 13274100.0, 2050262.7, 
$ pop_quarterly &lt;dbl&gt; 13144039.8, 6043266.6, 7666495.5, 21714093.3, 3827395.7,
$ lab_prod      &lt;dbl&gt; 0.9988637, 0.9863141, 0.9942753, 0.9997992, 0.9885239, 1
$ ConGDP        &lt;dbl&gt; 0.5486164, 0.5608871, 0.5525914, 0.5124322, 0.5244422, 0
$ InvGDP        &lt;dbl&gt; 0.1981267, 0.2557140, 0.2102420, 0.1747010, 0.2085606, 0
$ ExpGDP        &lt;dbl&gt; 0.14673485, 0.30632565, 0.51579873, 0.30913218, 0.268451
$ ImpGDP        &lt;dbl&gt; 0.1151270, 0.3435049, 0.5047073, 0.2371815, 0.2485870, 0
$ LPG           &lt;dbl&gt; -0.0078972729, -0.0093478618, 0.0033636783, 0.0054461911
$ EmpSha        &lt;dbl&gt; 0.6145277, 0.6183747, 0.5113679, 0.6113127, 0.5356809, 0
$ gdp           &lt;dbl&gt; -49.19159, -31.67854, -31.22708, -39.42603, -36.29520, -
$ ID            &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1</code></pre>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 'Time' zeigt Jahr + Quartal</span></span>
<span><span class="va">brexit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Country</span> <span class="op">==</span> <span class="st">"United Kingdom"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Time
1 1995.00
2 1995.25
3 1995.50
4 1995.75
5 1996.00</code></pre>
</div>
</div>
<p>F칲r die Sch칛tzung der Gewichte <span class="math inline">\(w_i\)</span> f칲r die Konstruktion des UK-Doppelg칛ngers werden die in gelisteten Charakteristika der Volkswirtschaften verwendet.</p>
<div id="tbl-Born2019preds" class="quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><div aria-describedby="tbl-Born2019preds-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 79%">
</colgroup>
<thead><tr class="header">
<th>Variable</th>
<th>Definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>gdp</code></td>
<td>Ver칛nderung des BIP relativ zu 2016</td>
</tr>
<tr class="even">
<td><code>ConGDP</code></td>
<td>Anteil: Konsum/BIP (%)</td>
</tr>
<tr class="odd">
<td><code>InvGDP</code></td>
<td>Anteil: Investitionen/BIP (%)</td>
</tr>
<tr class="even">
<td><code>ExpGDP</code></td>
<td>Anteil: Exporte/BIP (%)</td>
</tr>
<tr class="odd">
<td><code>ImpGDP</code></td>
<td>Anteil: Importe/BIP (%)</td>
</tr>
<tr class="even">
<td><code>EmpSha</code></td>
<td>Anteil: Besch칛ftigte/Erwerbsbev칬lkerung (%)</td>
</tr>
<tr class="odd">
<td><code>LPG</code></td>
<td>Wachstum der Arbeitsproduktivit칛t (%)</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-Born2019preds-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;7.1: <code>brexit</code>  Variablen und Definitionen
</figcaption></figure>
</div>
<p>Zur Berechnung von SCM mit dem R-Paket <code>Synth</code> m칲ssen die Daten zun칛chst mit der Funktion <code><a href="https://rdrr.io/pkg/Synth/man/dataprep.html">Synth::dataprep()</a></code> aufbereitet werden, s. <code>?Synth::dataprep()</code> f칲r weitere Details. Neben dem Datensatz (<code>foo</code>) unter expliziter Nennung der Pr칛diktoren (<code>predictors</code>) und der Outcome-Variable (<code>dependent</code>) 칲bergeben wir Variablen f칲r die Indentifikation von Einheiten (<code>ID</code>) und Zeitpunkten (<code>Time</code>), sowie Donor Pool (<code>controls.identifier</code>) und behandelter Einheit (<code>treatment.identifier</code>). Weiterhin werden die Vorbehandlungsperiode (<code>time.predictors.prior</code>) sowie der Zeitraum 칲ber den die Regressor-Gewichte <span class="math inline">\(v_m\)</span> bestimmt werden sollen (<code>time.optimize.ssr</code>), festgelegt. F칲r letztere 칲bergeben wir einen numerischen Vektor f칲r s칛mtliche Zeitpunkte von 1995-Q1 bis zum Brexit-Referendum in 2016-Q2.</p>
<p>Um einen ersten 칖berblick 칲ber die Entwicklung der BIP im Datensatz zu gewinnen, vergleichen wir die Zeitreihen f칲r Donor-Pool-L칛nder (grau) und Gro륵ritannien (blau) mit <code>ggplot</code>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">brexit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span></span>
<span>      <span class="va">Country</span> <span class="op">==</span> <span class="st">"United Kingdom"</span>, </span>
<span>      yes <span class="op">=</span> <span class="st">"UK"</span>, </span>
<span>      no <span class="op">=</span><span class="st">"else"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">Time</span>, </span>
<span>      y <span class="op">=</span> <span class="va">gdp</span>, </span>
<span>      color <span class="op">=</span> <span class="va">group</span>, </span>
<span>      group <span class="op">=</span> <span class="va">Country</span>, </span>
<span>      lwd <span class="op">=</span> <span class="va">group</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"UK"</span> <span class="op">=</span> <span class="st">"#00BFC4"</span>, <span class="st">"else"</span> <span class="op">=</span> <span class="fu">alpha</span><span class="op">(</span><span class="st">"gray"</span>, <span class="fl">.75</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_linewidth_manual</span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"UK"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"else"</span> <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Brexit-Referendum</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="fl">2016.25</span>, </span>
<span>    lty <span class="op">=</span> <span class="st">"dotted"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span></span>
<span>    lwd <span class="op">=</span> <span class="st">"none"</span>, </span>
<span>    color <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"inside"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.9</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-bipv" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-bipv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="SyntheticControl_files/figure-html/fig-bipv-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-bipv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;7.1: BIP relativ zu 2016
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-bipv" class="quarto-xref">Abbildung&nbsp;<span>7.1</span></a> zeigt, dass das BIP von Gro륵ritannien zwar auch nach dem Brexit-Referendum (gepunktete Linie) gewachsen ist, jedoch vergleichsweise schwach. Eine Analyse mit SCM kann statistische Evidenz f칲r den mutma륿ich negativen Effekt des Referendums auf das Wachstum in den Folgeperioden liefern.</p>
<p>Wir laden nun das Paket <code>Synth</code> und bereiten die Daten f칲r die Analyse vor.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># R-Paket 'Synth' laden</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://web.stanford.edu/~jhain/">Synth</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Daten f칲r die Optimierung vorbereiten</span></span>
<span><span class="va">dataprep_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Synth/man/dataprep.html">dataprep</a></span><span class="op">(</span></span>
<span>  foo <span class="op">=</span> <span class="va">brexit</span>, </span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"ConGDP"</span>, <span class="st">"InvGDP"</span>, </span>
<span>    <span class="st">"ExpGDP"</span>, <span class="st">"ImpGDP"</span>, </span>
<span>    <span class="st">"LPG"</span>, <span class="st">"EmpSha"</span></span>
<span>  <span class="op">)</span>, </span>
<span>  dependent <span class="op">=</span> <span class="st">"gdp"</span>, </span>
<span>  unit.variable <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>  time.variable <span class="op">=</span> <span class="st">"Time"</span>, </span>
<span>  treatment.identifier <span class="op">=</span> <span class="fl">23</span>, </span>
<span>  controls.identifier <span class="op">=</span> <span class="op">(</span><span class="va">brexit</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">23</span><span class="op">]</span>, </span>
<span>  time.predictors.prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1995</span>, <span class="fl">2016.25</span>, <span class="fl">.25</span><span class="op">)</span>,</span>
<span>  time.optimize.ssr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1995</span>, <span class="fl">2016.25</span>, <span class="fl">.25</span><span class="op">)</span>,</span>
<span>  unit.names.variable <span class="op">=</span> <span class="st">"Country"</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Anhand der vorbereiteten Daten <code>dataprep_out</code> wird nun die Bestimmung der Gewichte mit <code><a href="https://rdrr.io/pkg/Synth/man/synth.html">Synth::synth()</a></code> durchgef칲hrt.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Gewichte per Optimierung bestimmen</span></span>
<span><span class="va">synth_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Synth/man/synth.html">synth</a></span><span class="op">(</span><span class="va">dataprep_out</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
X1, X0, Z1, Z0 all come directly from dataprep object.


**************** 
 searching for synthetic control unit  
 

**************** 
**************** 
**************** 

MSPE (LOSS V): 0.6083746 

solution.v:
 0.1488472 0.08840361 0.1480946 0.153318 0.1815462 0.2797904 

solution.w:
 1.42199e-05 4.00616e-05 8.47284e-05 0.00014488 4.45754e-05 4.84009e-05 0.001608051 4.77577e-05 0.06654494 2.07094e-05 0.1446237 1.188e-05 2.377e-06 0.04837474 1.33542e-05 0.0001405933 4.61625e-05 0.0001592545 1.49993e-05 4.14211e-05 3.78112e-05 0.0002273924 0.737708 </code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/Synth/man/synth.html">Synth::synth()</a></code> gibt Infos 칲ber den Optimierungsprozess und dessen Ergebnisse automatisch in der Konsole aus. Wir k칬nnen diese mit <code><a href="https://rdrr.io/pkg/Synth/man/synth.tab.html">Synth::synth.tab()</a></code> leicht tabellarisch zusammenfassen und mit <code><a href="https://gt.rstudio.com/reference/gt.html">gt::gt()</a></code> darstellen.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Zusammenfassung der Ergebnisse</span></span>
<span><span class="op">(</span></span>
<span>  <span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Synth/man/synth.tab.html">synth.tab</a></span><span class="op">(</span></span>
<span>    synth.res <span class="op">=</span> <span class="va">synth_out</span>, </span>
<span>    dataprep.res <span class="op">=</span> <span class="va">dataprep_out</span></span>
<span>  <span class="op">)</span>  </span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$tab.pred
       Treated Synthetic Sample Mean
ConGDP   0.655     0.635       0.534
InvGDP   0.168     0.202       0.226
ExpGDP   0.254     0.219       0.454
ImpGDP   0.256     0.232       0.423
LPG      0.003     0.003       0.003
EmpSha   0.634     0.625       0.611

$tab.v
       v.weights
ConGDP 0.149    
InvGDP 0.088    
ExpGDP 0.148    
ImpGDP 0.153    
LPG    0.182    
EmpSha 0.28     

$tab.w
   w.weights      unit.names unit.numbers
1      0.000       Australia            1
2      0.000         Austria            2
3      0.000         Belgium            3
4      0.000          Canada            4
5      0.000         Finland            5
6      0.000          France            6
7      0.002         Germany            7
8      0.000         Hungary            8
9      0.067         Iceland            9
10     0.000         Ireland           10
11     0.145           Italy           11
12     0.000           Japan           12
13     0.000           Korea           13
14     0.048      Luxembourg           14
15     0.000     Netherlands           15
16     0.000     New Zealand           16
17     0.000          Norway           17
18     0.000        Portugal           18
19     0.000 Slovak Republic           19
20     0.000           Spain           20
21     0.000          Sweden           21
22     0.000     Switzerland           22
24     0.738   United States           24

$tab.loss
       Loss W    Loss V
[1,] 0.135733 0.6083746</code></pre>
</div>
</div>
<p>F칲r die tabellarische Darstellung mit <code><a href="https://gt.rstudio.com/reference/gt.html">gt::gt()</a></code> ber칲cksichtigen wir lediglich Volkswirtschaften mit Gewicht &gt; .0001.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Darstellung mit gt()</span></span>
<span><span class="va">tb</span><span class="op">$</span><span class="va">tab.w</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Ber칲cksichtige nur L칛nder mit relevanten Gewichten</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">w.weights</span> <span class="op">&gt;</span> <span class="fl">.0001</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">w.weights</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="va">tabopts</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-brexitcw" class="cell quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><div aria-describedby="tbl-brexitcw-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="kckdovbcyd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kckdovbcyd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kckdovbcyd thead, #kckdovbcyd tbody, #kckdovbcyd tfoot, #kckdovbcyd tr, #kckdovbcyd td, #kckdovbcyd th {
  border-style: none;
}

#kckdovbcyd p {
  margin: 0;
  padding: 0;
}

#kckdovbcyd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #000000;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kckdovbcyd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kckdovbcyd .gt_title {
  color: #000000;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kckdovbcyd .gt_subtitle {
  color: #000000;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kckdovbcyd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kckdovbcyd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kckdovbcyd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kckdovbcyd .gt_col_heading {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kckdovbcyd .gt_column_spanner_outer {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kckdovbcyd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kckdovbcyd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kckdovbcyd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kckdovbcyd .gt_spanner_row {
  border-bottom-style: hidden;
}

#kckdovbcyd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kckdovbcyd .gt_empty_group_heading {
  padding: 0.5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kckdovbcyd .gt_from_md > :first-child {
  margin-top: 0;
}

#kckdovbcyd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kckdovbcyd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kckdovbcyd .gt_stub {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kckdovbcyd .gt_stub_row_group {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kckdovbcyd .gt_row_group_first td {
  border-top-width: 2px;
}

#kckdovbcyd .gt_row_group_first th {
  border-top-width: 2px;
}

#kckdovbcyd .gt_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kckdovbcyd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kckdovbcyd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kckdovbcyd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kckdovbcyd .gt_grand_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kckdovbcyd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kckdovbcyd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kckdovbcyd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kckdovbcyd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#kckdovbcyd .gt_footnotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kckdovbcyd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kckdovbcyd .gt_sourcenotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kckdovbcyd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kckdovbcyd .gt_left {
  text-align: left;
}

#kckdovbcyd .gt_center {
  text-align: center;
}

#kckdovbcyd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kckdovbcyd .gt_font_normal {
  font-weight: normal;
}

#kckdovbcyd .gt_font_bold {
  font-weight: bold;
}

#kckdovbcyd .gt_font_italic {
  font-style: italic;
}

#kckdovbcyd .gt_super {
  font-size: 65%;
}

#kckdovbcyd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kckdovbcyd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kckdovbcyd .gt_indent_1 {
  text-indent: 5px;
}

#kckdovbcyd .gt_indent_2 {
  text-indent: 10px;
}

#kckdovbcyd .gt_indent_3 {
  text-indent: 15px;
}

#kckdovbcyd .gt_indent_4 {
  text-indent: 20px;
}

#kckdovbcyd .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id="w.weights" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">w.weights</th>
<th id="unit.names" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">unit.names</th>
<th id="unit.numbers" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">unit.numbers</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="w.weights">0.738</td>
<td class="gt_row gt_left" headers="unit.names">United States</td>
<td class="gt_row gt_right" headers="unit.numbers">24</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="w.weights">0.145</td>
<td class="gt_row gt_left" headers="unit.names">Italy</td>
<td class="gt_row gt_right" headers="unit.numbers">11</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="w.weights">0.067</td>
<td class="gt_row gt_left" headers="unit.names">Iceland</td>
<td class="gt_row gt_right" headers="unit.numbers">9</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="w.weights">0.048</td>
<td class="gt_row gt_left" headers="unit.names">Luxembourg</td>
<td class="gt_row gt_right" headers="unit.numbers">14</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="w.weights">0.002</td>
<td class="gt_row gt_left" headers="unit.names">Germany</td>
<td class="gt_row gt_right" headers="unit.numbers">7</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-brexitcw-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;7.2: Gewichte f칲r den synthetischen UK-Doppelg칛nger
</figcaption></figure>
</div>
</div>
<p>Der synthetische UK-Doppelg칛nger kann nun gem칛 der Vorschrift <span class="math inline">\(\eqref{eq:dgkonst}\)</span> konstruiert werden. Wir erzeugen hierzu ein <code>tibble</code>-Objekt mit den entsprechenden ID-Variablen.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Doppelg칛nger konstruieren</span></span>
<span><span class="va">doppelganger</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">brexit</span>, </span>
<span>  y <span class="op">=</span> <span class="va">tb</span><span class="op">$</span><span class="va">tab.w</span>, </span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Country"</span> <span class="op">=</span> <span class="st">"unit.names"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">Year</span>, <span class="va">Country</span>, <span class="va">gdp</span>, <span class="va">w.weights</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">Year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    gdp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">gdp</span> <span class="op">*</span> <span class="va">w.weights</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"Doppelgaenger"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">doppelganger</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 104
Columns: 4
$ Time &lt;dbl&gt; 1995.00, 1995.25, 1995.50, 1995.75, 1996.00, 1996.25, 1996.50, 19
$ Year &lt;dbl&gt; 1995, 1995, 1995, 1995, 1996, 1996, 1996, 1996, 1997, 1997, 1997,
$ gdp  &lt;dbl&gt; -36.87991, -36.70512, -36.32948, -35.72637, -35.34392, -34.57688,
$ type &lt;chr&gt; "Doppelgaenger", "Doppelgaenger", "Doppelgaenger", "Doppelgaenger</code></pre>
</div>
</div>
<p>F칲r die nachfolgenden Schritte der Analyse f칲hren wir das beobachtete GDP f칲r Gro륵ritannien mit dem syntethischen GDP des Doppelg칛ngers zusammen.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># tibble mit UK-GDP erstellen</span></span>
<span><span class="va">UK</span> <span class="op">&lt;-</span> <span class="va">brexit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Country</span> <span class="op">==</span> <span class="st">"United Kingdom"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">Year</span>, <span class="va">gdp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"UK"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># UK und Doppelg칛nger zusammenf칲hren</span></span>
<span><span class="va">the_gdps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">doppelganger</span>, <span class="va">UK</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>F칲r einen Vergleich von UK- und Doppelg칛nger-BIP folgen wir <span class="citation" data-cites="Bornetal2019">Born u.&nbsp;a. (<a href="Literatur.html#ref-Bornetal2019" role="doc-biblioref">2019</a>)</span> und berechnen die Differenz der BIP 칲ber den gesamten Zeitraum, die so genannte <em>Doppelg칛nger-Gap</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># UK-Doppelg칛nger-Gap berechnen</span></span>
<span><span class="va">gdp_gap</span> <span class="op">&lt;-</span> <span class="va">the_gdps</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span></span>
<span>    values_from <span class="op">=</span> <span class="va">gdp</span>, </span>
<span>    names_from <span class="op">=</span> <span class="st">"type"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>gdp_gap <span class="op">=</span> <span class="va">UK</span> <span class="op">-</span> <span class="va">Doppelgaenger</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Als ein Ma f칲r die Unsicherheit bei der Sch칛tzung des GDPs f칲r den Doppelg칛nger berechnen <span class="citation" data-cites="Bornetal2019">Born u.&nbsp;a. (<a href="Literatur.html#ref-Bornetal2019" role="doc-biblioref">2019</a>)</span> die Standardabweichung der Doppelg칛nger-Gap f칲r den Zeitraum <em>vor</em> dem Brexit-Referendum.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Standardabweichung der Gap vor dem Brexit-Vote</span></span>
<span><span class="va">sd_gap</span> <span class="op">&lt;-</span> <span class="va">gdp_gap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">&lt;</span> <span class="fl">2016.25</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">gdp_gap</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">sd</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir nutzen nun <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot2::ggplot()</a></code>, um den syntetischen Doppelg칛nger und das BIP f칲r Gro륵ritannien 칲ber den gesamten Zeitraum darzustellen. F칲r die Darstellung von Unsicherheit bei der Konstruktion des Doppelg칛ngers unterlegen wir die Doppelg칛nger-Zeitreihe mit einer Schattierung in der Breite der gesch칛tzten Standardabweichung von 0.78 f칲r die Periode vor dem Referendum.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span></span>
<span>  <span class="va">p_gdp</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># 1-SD-Band um das Doppelg칛nger-GDP</span></span>
<span>    <span class="fu">geom_ribbon</span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">the_gdps</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Doppelgaenger"</span><span class="op">)</span>, </span>
<span>      mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">Time</span>, </span>
<span>        ymin <span class="op">=</span> <span class="va">gdp</span> <span class="op">-</span> <span class="va">sd_gap</span>, </span>
<span>        ymax <span class="op">=</span> <span class="va">gdp</span> <span class="op">+</span> <span class="va">sd_gap</span></span>
<span>      <span class="op">)</span>, </span>
<span>      fill <span class="op">=</span> <span class="fu">alpha</span><span class="op">(</span><span class="st">"red"</span>, alpha <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>, </span>
<span>      color <span class="op">=</span> <span class="st">"white"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># UK- und Doppelg칛nger-GDP</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">the_gdps</span>, </span>
<span>      mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">Time</span>, </span>
<span>        y <span class="op">=</span> <span class="va">gdp</span>, </span>
<span>        col <span class="op">=</span> <span class="va">type</span></span>
<span>      <span class="op">)</span>,</span>
<span>      lwd <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Brexit-Referendum</span></span>
<span>    <span class="fu">geom_vline</span><span class="op">(</span></span>
<span>      xintercept <span class="op">=</span> <span class="fl">2016.25</span>, </span>
<span>      lty <span class="op">=</span> <span class="st">"dotted"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Legende hinzuf칲gen</span></span>
<span>    <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.025</span>, <span class="fl">.9</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-ukuksdg" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-ukuksdg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="SyntheticControl_files/figure-html/fig-ukuksdg-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-ukuksdg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;7.2: UK-BIP und synthetischer Doppelg칛nger
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-ukuksdg" class="quarto-xref">Abbildung&nbsp;<span>7.2</span></a> zeigt, dass der synthetische Doppelg칛nger 칲ber weite Teile der Vorperiode eine gute Anpassung an das beobachtete BIP von Gro륵ritannien aufweist, insbesondere f칲r den Zeitraum unmittelbar vor dem Brexit-Referendum. Nach dem Referendum zeigt sich bereits nach wenigen Quartalen eine deutliche Abweichung zwischen der gesch칛tzten und der beobachteten Trajektorie. Eine Beschr칛nkung der in <code>p_gdp</code> verwendeten Datenpunkte auf einen Bereich nahe des Referendums best칛rkt diese Schlussfolgerung.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Close-up im Bereich des Referendums</span></span>
<span><span class="va">p_gdp</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span></span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2015</span>, <span class="fl">2021</span><span class="op">)</span>, </span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-ukuksdgclose" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-ukuksdgclose-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="SyntheticControl_files/figure-html/fig-ukuksdgclose-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-ukuksdgclose-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;7.3: UK-BIP und synthetischer Doppelg칛nger  Close-Up
</figcaption></figure>
</div>
</div>
</div>
<p>In <a href="#fig-ukuksdg" class="quarto-xref">Abbildung&nbsp;<span>7.2</span></a> ist eine ab Mitte 2017 au른rhalb des Standardabweichungsbereichs verlaufende Divergenz der Zeitreihen zu erkennen. Diese stellen wir nachfolgend anhand der Doppelg칛nger-Gap mit <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot2::ggplot()</a></code> dar.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># BIP-Doppelg칛nger-Gap</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gdp_gap</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">gdp_gap</span><span class="op">)</span>,</span>
<span>    lwd <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">Time</span>, </span>
<span>      ymin <span class="op">=</span> <span class="va">gdp_gap</span> <span class="op">-</span> <span class="va">sd_gap</span>, </span>
<span>      ymax <span class="op">=</span> <span class="va">gdp_gap</span> <span class="op">+</span> <span class="va">sd_gap</span></span>
<span>    <span class="op">)</span>, </span>
<span>    fill <span class="op">=</span> <span class="fu">alpha</span><span class="op">(</span><span class="st">"darkgray"</span>, alpha <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"white"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Referendum</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="fl">2016.25</span>,</span>
<span>    lty <span class="op">=</span> <span class="st">"dotted"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span>, </span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2015</span>, <span class="fl">2021</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-ukdggap" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-ukdggap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="SyntheticControl_files/figure-html/fig-ukdggap-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-ukdggap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;7.4: UK-BIP und synthetischer Doppelg칛nger  Doppelg칛nger-Gap
</figcaption></figure>
</div>
</div>
</div>
<p>Die in <a href="#fig-ukdggap" class="quarto-xref">Abbildung&nbsp;<span>7.4</span></a> gezeigte Doppelg칛nger-Gap stimmt gut mit dem von <span class="citation" data-cites="Bornetal2019">Born u.&nbsp;a. (<a href="Literatur.html#ref-Bornetal2019" role="doc-biblioref">2019</a>)</span> gesch칛tzten verlorenen Wachstums des BIP relativ zu 2016 um bis zu 2.5% bis Ende des Jahres 2018 칲berein.</p>
<p>Als weiteres Ma f칲r den Effekt des Referendums im Folgezeitraum k칬nnen wir die mittlere Doppelg칛nger-Gap f칲r s칛mtliche Beobachtungsperioden nach dem Brexit-Referendum schnell bestimmen.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Mittlerer Unterschied nach dem Brexit-Referendum</span></span>
<span><span class="va">gdp_gap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">&gt;</span> <span class="fl">2016.25</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">gdp_gap</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.343273</code></pre>
</div>
</div>
<section id="placebo-tests-grafische-inferenz" class="level3 page-columns page-full" data-number="7.2.1"><h3 data-number="7.2.1" class="anchored" data-anchor-id="placebo-tests-grafische-inferenz">
<span class="header-section-number">7.2.1</span> Placebo-Tests: Grafische Inferenz</h3>
<p>Auch f칲r SCM sind Placebo-Tests ein hilfreiches Instrument zur 칖berpr칲fung der G칲ltigkeit von Studienergebnissen. Eine gr칲ndliche Placebo-Analyse kann festzustellen, ob der beobachtete Effekt tats칛chlich auf die Intervention zur칲ckzuf칲hren ist und nicht auf unber칲cksichtigte (m칬glicherweise unbeobachtbare) Faktoren.</p>
<p>Ein Ansatz ist hierf칲r ist es, den synthetische-Doppelg칛nger f칲r <em>fiktive Interventionszeitpunkte</em> vor dem tats칛chlichen Behandlungszeitpunkt zu konstruieren, und die entsprechenden Trajektorien mit dem urspr칲nglichen Doppelg칛nger zu vergleichen. So kann die Validit칛t der urspr칲nglichen Doppelg칛nger-Trajektorie im Hinblick auf m칬gliche anderweitige Ereignisse vor der Intervention gepr칲ft werden: Doppelg칛nger-Trajektorien f칲r fiktive, fr칲here Interventionen sollten sich nicht systematisch von der andhand von Daten bis zur tats칛chlichen Intervention berechneten Trajektorie unterscheiden.</p>
<p>Wir definieren hierzu eine Funktion <code>placebo()</code>, die einen syntethischen Doppelg칛nger des BIP Gro륵ritanniens mit Gewichten auf Basis eines vorgegebenen Interventionszeitpunktes (<code>treat</code>) zur칲ckgibt. Abgesehen vom fr칲heren Interventionszeitpunkt (und der damit einhergehenden verkleinerten Stichprobe) erfolgt die Berechnung der Gewichte mit derselben Spezifikation wie zuvor.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Funktion f칲r Placebo-Doppelg칛nger:</span></span>
<span><span class="co"># Fiktive fr칲here Intervention</span></span>
<span><span class="va">placebo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">treat</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Datenvorbereitung f칲r fiktives Datum 'treat'</span></span>
<span>  <span class="va">dataprep_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Synth/man/dataprep.html">dataprep</a></span><span class="op">(</span></span>
<span>    foo <span class="op">=</span> <span class="va">brexit</span>, </span>
<span>    predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"ConGDP"</span>, <span class="st">"InvGDP"</span>,</span>
<span>      <span class="st">"ExpGDP"</span>, <span class="st">"ImpGDP"</span>,</span>
<span>      <span class="st">"LPG"</span>, <span class="st">"EmpSha"</span></span>
<span>    <span class="op">)</span>, </span>
<span>    dependent <span class="op">=</span> <span class="st">"gdp"</span>, </span>
<span>    unit.variable <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>    time.variable <span class="op">=</span> <span class="st">"Time"</span>, </span>
<span>    treatment.identifier <span class="op">=</span> <span class="fl">23</span>, </span>
<span>    controls.identifier <span class="op">=</span> <span class="op">(</span><span class="va">brexit</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">23</span><span class="op">]</span>, </span>
<span>    time.predictors.prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1995</span>, <span class="va">treat</span>, <span class="fl">.25</span><span class="op">)</span>,</span>
<span>    time.optimize.ssr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1995</span>, <span class="va">treat</span>, <span class="fl">.25</span><span class="op">)</span>,</span>
<span>    unit.names.variable <span class="op">=</span> <span class="st">"Country"</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Doppelg칛nger bestimmen</span></span>
<span>  <span class="va">synth_out</span> <span class="op">&lt;-</span> <span class="fu">quietly</span><span class="op">(</span><span class="va">synth</span><span class="op">)</span><span class="op">(</span><span class="va">dataprep_out</span><span class="op">)</span><span class="op">$</span><span class="va">result</span></span>
<span>  </span>
<span>  <span class="co"># Ergebnisse auslesen</span></span>
<span>  <span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Synth/man/synth.tab.html">synth.tab</a></span><span class="op">(</span></span>
<span>    synth.res <span class="op">=</span> <span class="va">synth_out</span>, </span>
<span>    dataprep.res <span class="op">=</span> <span class="va">dataprep_out</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span></span>
<span>    </span>
<span>    <span class="co"># Doppelg칛nger konstruieren </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">brexit</span>, </span>
<span>      y <span class="op">=</span> <span class="va">tb</span><span class="op">$</span><span class="va">tab.w</span>, </span>
<span>      by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Country"</span> <span class="op">=</span> <span class="st">"unit.names"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">Country</span>, <span class="va">gdp</span>, <span class="va">w.weights</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>        gdp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">gdp</span> <span class="op">*</span> <span class="va">w.weights</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Placebo"</span>, <span class="va">treat</span><span class="op">)</span><span class="op">)</span>  </span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wie in <span class="citation" data-cites="Bornetal2019">Born u.&nbsp;a. (<a href="Literatur.html#ref-Bornetal2019" role="doc-biblioref">2019</a>)</span> berechnen wir nun 12 Placebo-Doppelg칛nger des BIP von Gro륵ritannien f칲r fiktive Zeitpunkte eines Referendums 칲ber s칛mtliche Quartale im Zeitraum 2010-Q1 bis 2016-Q1. Dies ist komfortabel durch Iteration von <code>placebo()</code> 칲ber diese Zeitpunkte mit <code><a href="https://purrr.tidyverse.org/reference/map_dfr.html">purrr::map_dfr()</a></code> umsetzbar.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Iteration 칲ber fiktive fr칲here Referenden</span></span>
<span><span class="va">placebos_tbl</span> <span class="op">&lt;-</span> <span class="fu">map_dfr</span><span class="op">(</span></span>
<span>  .x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2010</span>, <span class="fl">2016</span>, <span class="fl">.25</span><span class="op">)</span>, </span>
<span>  .f <span class="op">=</span>  \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">placebo</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>placebos_tbl</code> ist ein <code>tibble</code>-Objekt im tidy-Format. Wir k칬nnen die Placebo-Doppelg칛nger sowie den urspr칲nglich berechneten Doppelg칛nger und das tats칛chliche BIP also 칛hnlich wie in <a href="#fig-ukuksdg" class="quarto-xref">Abbildung&nbsp;<span>7.2</span></a> mit <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot2::ggplot()</a></code> darstellen.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Vergleich mit Placebo-Doppelg칛nger</span></span>
<span><span class="op">(</span></span>
<span>  <span class="va">p_UKDG</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">placebos_tbl</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">Time</span>, </span>
<span>      y <span class="op">=</span> <span class="va">gdp</span>, </span>
<span>      group <span class="op">=</span> <span class="va">type</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Placebos (mit jitter)</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span></span>
<span>      lwd <span class="op">=</span> <span class="fl">.25</span>, </span>
<span>      col <span class="op">=</span> <span class="st">"gray80"</span>,</span>
<span>      position <span class="op">=</span> <span class="fu">position_jitter</span><span class="op">(</span>height <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Urspr칲nglicher Doppelg칛nger</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">the_gdps</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Doppelgaenger"</span><span class="op">)</span>, </span>
<span>      mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>col <span class="op">=</span> <span class="va">type</span><span class="op">)</span>, </span>
<span>      lwd <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Beobachtetes BIP</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">the_gdps</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"UK"</span><span class="op">)</span>, </span>
<span>      mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>col <span class="op">=</span> <span class="va">type</span><span class="op">)</span>, </span>
<span>      lwd <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Intikator f칲r Referendum</span></span>
<span>    <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">2016.25</span>, lty <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Formatierung</span></span>
<span>    <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.05</span>, <span class="fl">.9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-pdgukbip" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-pdgukbip-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="SyntheticControl_files/figure-html/fig-pdgukbip-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pdgukbip-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;7.5: Placebo-Doppelg칛nger
</figcaption></figure>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Close-up bei Referendum</span></span>
<span><span class="va">p_UKDG</span> <span class="op">+</span></span>
<span>      <span class="fu">scale_x_continuous</span><span class="op">(</span></span>
<span>      limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2015</span>, <span class="fl">2021</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.05</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">scale_y_continuous</span><span class="op">(</span></span>
<span>      limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">13</span><span class="op">)</span>,  expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-pdgukbipcu" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-pdgukbipcu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="SyntheticControl_files/figure-html/fig-pdgukbipcu-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pdgukbipcu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;7.6: Placebo-Doppelg칛nger  Close-Up
</figcaption></figure>
</div>
</div>
</div>
<p>Beachte, dass <code>position = position_jitter(height = .25)</code> eine zuf칛llige, kleine Verschiebung (jitter) der Trajektorien der Placebo-Doppelg칛nger f칲r eine bessere Unterscheidbarkeit bewirkt. <a href="#fig-pdgukbip" class="quarto-xref">Abbildung&nbsp;<span>7.5</span></a> und <a href="#fig-pdgukbipcu" class="quarto-xref">Abbildung&nbsp;<span>7.6</span></a> zeigen, dass sich die Placebo-Pfade f칲r fiktive fr칲here Referenden (grau) nicht systematisch vom urspr칲nglich berechneten synthetischen Doppelg칛nger (rot) unterscheiden. Insbesondere finden wir keinen R칲ckgang der synthetischen BIP relativ zum beobachteten BIP f칲r Gro륵ritannien <em>vor</em> dem Referendum. Deutliche Abweichungen vom tats칛chlichen BIP ergeben sich erst jenseits der tats칛chlichen Referendums. Diese Placebo-Analyse bekr칛ftigt also die Validit칛t der Konstruktion des Benchmark-Doppelg칛ngers f칲r die Periode bis 2016-Q2 und die Sch칛tzung des kausalen Effekts des Referendums anhand der entsprechenden Doppelg칛nger-Gap.</p>
<p>Ein weiterer Placebo-Test in <span class="citation" data-cites="Bornetal2019">Born u.&nbsp;a. (<a href="Literatur.html#ref-Bornetal2019" role="doc-biblioref">2019</a>)</span> ist ein Vergleich der Doppelg칛nger-Gap Gro륵ritanniens mit Doppelg칛nger-Gaps f칲r fiktive Referenden in 2016-Q2 in L칛ndern mit wesentlichem Einfluss bei der Konstruktion des synthetischen Doppelg칛ngers f칲r Gro륵ritannien: Die Sch칛tzung des kausalen Effekts des Referendums auf das BIP in Gro륵ritannien ist glaubw칲rdig, wenn lediglich die Doppelg칛nger-Gap f칲r Gro륵ritannien durch das Referendum beeinflusst wird, <em>nicht</em> aber die Doppelg칛nger-Gaps f칲r L칛nder in der Kontrollgruppe.</p>
<p>F칲r diese grafische Placebo-Analyse modifizieren wir die Funktion <code>placebo()</code> entsprechend. <code>placebo_gap()</code> berechnet die Doppelg칛nger-Gap f칲r das mit <code>treat</code> identifizierte Land. Das <code>if</code>-Statement zu Beginn stellt sicher, dass Gro륵ritannien <em>nicht</em> als Kontroll-Einheit f칲r die Placebo-Gaps verwendet wird.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Funktion f칲r Placebo-Gaps</span></span>
<span><span class="va">placebo_gap</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">treat</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Kontrollgruppe definieren</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">treat</span> <span class="op">!=</span> <span class="fl">23</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">controls</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">23</span>, <span class="va">treat</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">controls</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">23</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Daten vorbereiten</span></span>
<span>  <span class="va">dataprep_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Synth/man/dataprep.html">dataprep</a></span><span class="op">(</span></span>
<span>    foo <span class="op">=</span> <span class="va">brexit</span>, </span>
<span>    predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"ConGDP"</span>, <span class="st">"InvGDP"</span>,</span>
<span>      <span class="st">"ExpGDP"</span>, <span class="st">"ImpGDP"</span>,</span>
<span>      <span class="st">"LPG"</span>, <span class="st">"EmpSha"</span></span>
<span>    <span class="op">)</span>, </span>
<span>    dependent <span class="op">=</span> <span class="st">"gdp"</span>, </span>
<span>    unit.variable <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>    time.variable <span class="op">=</span> <span class="st">"Time"</span>, </span>
<span>    treatment.identifier <span class="op">=</span> <span class="va">treat</span>, </span>
<span>    controls.identifier <span class="op">=</span> <span class="va">controls</span>, </span>
<span>    time.predictors.prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1995</span>, <span class="fl">2016.25</span>, <span class="fl">.25</span><span class="op">)</span>,</span>
<span>    time.optimize.ssr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1995</span>, <span class="fl">2016.25</span>, <span class="fl">.25</span><span class="op">)</span>,</span>
<span>    unit.names.variable <span class="op">=</span> <span class="st">"Country"</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Gewichte bestimmen</span></span>
<span>  <span class="va">synth_out</span> <span class="op">&lt;-</span> <span class="fu">quietly</span><span class="op">(</span><span class="va">synth</span><span class="op">)</span><span class="op">(</span><span class="va">dataprep_out</span><span class="op">)</span><span class="op">$</span><span class="va">result</span></span>
<span>  </span>
<span>  <span class="co"># Ergebnisse zusammenfassen</span></span>
<span>  <span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Synth/man/synth.tab.html">synth.tab</a></span><span class="op">(</span></span>
<span>    synth.res <span class="op">=</span> <span class="va">synth_out</span>, </span>
<span>    dataprep.res <span class="op">=</span> <span class="va">dataprep_out</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Doppelg칛nger bestimmen</span></span>
<span>  <span class="va">doppel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">brexit</span>, </span>
<span>    y <span class="op">=</span> <span class="va">tb</span><span class="op">$</span><span class="va">tab.w</span>, </span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Country"</span> <span class="op">=</span> <span class="st">"unit.names"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">gdp</span>, <span class="va">Country</span>, <span class="va">w.weights</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>      gdp_synth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">gdp</span> <span class="op">*</span> <span class="va">w.weights</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, </span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Beobachtetes BIP auslesen</span></span>
<span>  <span class="va">gdp</span> <span class="op">&lt;-</span> <span class="va">brexit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">==</span> <span class="va">treat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">gdp</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span></span>
<span>    </span>
<span>    <span class="co"># Doppelg칛nger-Gap berechnen</span></span>
<span>    <span class="va">doppel</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        ID <span class="op">=</span> <span class="va">treat</span>,</span>
<span>        gdp <span class="op">=</span> <span class="va">gdp</span>,</span>
<span>        gdp_gap <span class="op">=</span> <span class="va">gdp</span> <span class="op">-</span> <span class="va">gdp_synth</span></span>
<span>      <span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>F칲r die Berechnung der Placebo-Gaps iterieren wir 칲ber die Indizes der in <a href="#tbl-brexitcw" class="quarto-xref">Tabelle&nbsp;<span>7.2</span></a> gelisteten Volkswirtschaften der Kontrollgruppe f칲r Gro륵ritannien.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Indizes f칲r "Donor Countries" und UK</span></span>
<span><span class="va">donors_and_UK</span> <span class="op">&lt;-</span> <span class="va">brexit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">Country</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">Country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"United States"</span>, <span class="st">"Italy"</span>, <span class="st">"Iceland"</span>, </span>
<span>        <span class="st">"Luxembourg"</span>, <span class="st">"Germany"</span>, <span class="st">"United Kingdom"</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Placebo-Doppelg칛nger-Gaps berechnen</span></span>
<span><span class="va">placebo_gaps_tbl</span> <span class="op">&lt;-</span> <span class="fu">map_dfr</span><span class="op">(</span></span>
<span>  .x <span class="op">=</span> <span class="va">donors_and_UK</span>, </span>
<span>  .f <span class="op">=</span>  \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">placebo_gap</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>F칲r die grafische Darstellung erg칛nzen wir die Variable <code>Country</code> zur Unterscheidung der Doppelg칛nger-Gaps f칲r Gro륵ritannien und die Kontroll-L칛nder.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ID-Variable f칲r UK und Kontroll-L칛nder</span></span>
<span><span class="va">placebo_gaps_tbl</span> <span class="op">&lt;-</span> <span class="va">placebo_gaps_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    Country <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">23</span>, <span class="st">"UK"</span>, <span class="st">"else"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Um die Vergleichbarkeit der Doppelg칛nger-Gaps zu gew칛hrleisten, standardisieren <span class="citation" data-cites="Bornetal2019">Born u.&nbsp;a. (<a href="Literatur.html#ref-Bornetal2019" role="doc-biblioref">2019</a>)</span> die Sch칛tzungen der Gaps anhand der jeweiligen Mittelwerte f칲r das Jahr 2015 und der Standardabweichungen im Zeitraum vor dem Brexit-Referendum. Wir berechnen diese Statistiken zun칛chst.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Mittelwerte f칲r 2015</span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="va">placebo_gaps_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html">between</a></span><span class="op">(</span><span class="va">Time</span>, <span class="fl">2015</span>, <span class="fl">2015.75</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    mean2015 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gdp_gap</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Standardabweichungen vor Referendum</span></span>
<span><span class="va">sds</span> <span class="op">&lt;-</span> <span class="va">placebo_gaps_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">&lt;</span> <span class="fl">2016.25</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    thesd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">gdp_gap</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mit <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">dplyr::left_join()</a></code> f칲hren wir diese Statistiken mit <code>placebo_gaps_tbl</code> zusammen und berechnen die standardisierten Doppelg칛nger-Gaps.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Join + Standardisierung</span></span>
<span><span class="va">placebo_gaps_std</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">placebo_gaps_tbl</span>, <span class="va">means</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">sds</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>gdp_gap_std <span class="op">=</span> <span class="op">(</span><span class="va">gdp_gap</span> <span class="op">-</span> <span class="va">mean2015</span><span class="op">)</span><span class="op">/</span><span class="va">thesd</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Analog zum Code f칲r <a href="#fig-ukdggap" class="quarto-xref">Abbildung&nbsp;<span>7.4</span></a> plotten wir die Placebo-Gap-Zeitreihen mit <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot2::ggplot()</a></code>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Placebo-Gaps mit UK-Gap vergleichen</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">placebo_gaps_std</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Time</span>, </span>
<span>    y <span class="op">=</span> <span class="va">gdp_gap_std</span>,</span>
<span>    group <span class="op">=</span> <span class="va">ID</span>,</span>
<span>    lwd <span class="op">=</span> <span class="va">Country</span>,</span>
<span>    color <span class="op">=</span> <span class="va">Country</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Hilfslinie bei Differenz = 0</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Gaps</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Referendum</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">2016.25</span>, lty <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Formatierung</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"UK"</span> <span class="op">=</span> <span class="st">"steelblue"</span>, <span class="st">"else"</span> <span class="op">=</span> <span class="fu">alpha</span><span class="op">(</span><span class="st">"darkgray"</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_linewidth_manual</span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"UK"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"else"</span> <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span></span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2015</span>, <span class="fl">2021</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.05</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.05</span>, <span class="fl">.9</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-pdgukg" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-pdgukg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="SyntheticControl_files/figure-html/fig-pdgukg-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pdgukg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;7.7: Placebo- und UK-Doppelg칛nger-Gaps
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-pdgukg" class="quarto-xref">Abbildung&nbsp;<span>7.7</span></a> zeigt die standardisierten Placebo-Doppelg칛nger-Gaps f칲r ein fiktives Referendum zum Zeitpunkt 2016-Q2 in den 5 Kontroll-Volkswirtschaften, die f칲r Konstruktion des BIP-Doppelg칛ngers von Gro륵rittannien relevant sind (grau). Der Vergleich mit der standardisierten Doppelg칛nger-Gap f칲r Gro륵ritannien (blau). Der Verlauf der Placebo-Gaps zeigt an, dass keine Abweichungen mit negativem Trend von der Referenzlinie bei 0 (kein Unterschied zwischen beobachtetem und syntetischem BIP) nach dem Referendum vorliegen. Damit liefert die Grafik keine Hinweise auf einen Effekt fiktiver Interventionen in den Kontroll-L칛ndern. F칲r Gro륵ritannien jedoch ist, 칛hnlich wie in <a href="#fig-ukdggap" class="quarto-xref">Abbildung&nbsp;<span>7.4</span></a>, ein negativer Trend nach dem Referendum deutlich erkennbar.</p>
</section><section id="statistische-inferenz" class="level3 page-columns page-full" data-number="7.2.2"><h3 data-number="7.2.2" class="anchored" data-anchor-id="statistische-inferenz">
<span class="header-section-number">7.2.2</span> Statistische Inferenz</h3>
<p>Die bisherigen Placebo-Tests liefern lediglich grafische Evidenz f칲r die Signifikanz des negativen Effekts des Brexit-Referendums auf die Britische Volkswirtschaft. Methoden f칲r statistische Inferenz f칲r SCM sind Gegenstand aktueller Forschung. <span class="citation" data-cites="Bornetal2019">Born u.&nbsp;a. (<a href="Literatur.html#ref-Bornetal2019" role="doc-biblioref">2019</a>)</span> verwenden den End-Of-Sample Instability Test (<span class="math inline">\(S\)</span>) von <span class="citation" data-cites="Andrews2003">Andrews (<a href="Literatur.html#ref-Andrews2003" role="doc-biblioref">2003</a>)</span>. Dieses Verfahren kann f칲r einen Test auf einen Strukturbruch gegen Ende einer Zeitreihe verwendet werden. In der vorliegende Studie wird der Test angewendet, um zu 칲berpr칲fen, ob die Verteilung der Doppelg칛nger-Gap Gro륵ritanniens f칲r die letzen <span class="math inline">\(m\)</span> Perioden jenseits des Referendums signifikant verschieden ist von Verteilung vorheriger Perioden.</p>
<p>Wir zeigen nachfolgend, wie diese Analyse in R mit der Funktion <code><a href="https://rdrr.io/pkg/CPAT/man/Andrews.test.html">CPAT::Andrews.test()</a></code> aus dem Paket <code>CPAT</code> durchgef칲hrt werden kann. Wir testen zun칛chst auf eine signifikante Diskrepanz der Doppelg칛nger-Gap in Form eines Sturkturbruchs ab 2017 und fassen die Ergebnisse tabellarisch mit <code><a href="https://generics.r-lib.org/reference/tidy.html">broom::tidy()</a></code> und <code><a href="https://gt.rstudio.com/reference/gt.html">gt::gt()</a></code> zusammen.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">CPAT</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Andrews' (2003) Test f칲r 2017 durchf칲hren</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/CPAT/man/Andrews.test.html">Andrews.test</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">gdp_gap</span><span class="op">$</span><span class="va">gdp_gap</span>, </span>
<span>  M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gdp_gap</span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">2017</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="va">tabopts</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-growthpdssek" class="cell quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><div aria-describedby="tbl-growthpdssek-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="iovagawrlu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#iovagawrlu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#iovagawrlu thead, #iovagawrlu tbody, #iovagawrlu tfoot, #iovagawrlu tr, #iovagawrlu td, #iovagawrlu th {
  border-style: none;
}

#iovagawrlu p {
  margin: 0;
  padding: 0;
}

#iovagawrlu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #000000;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iovagawrlu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#iovagawrlu .gt_title {
  color: #000000;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#iovagawrlu .gt_subtitle {
  color: #000000;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#iovagawrlu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iovagawrlu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iovagawrlu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iovagawrlu .gt_col_heading {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iovagawrlu .gt_column_spanner_outer {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iovagawrlu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iovagawrlu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iovagawrlu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iovagawrlu .gt_spanner_row {
  border-bottom-style: hidden;
}

#iovagawrlu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#iovagawrlu .gt_empty_group_heading {
  padding: 0.5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iovagawrlu .gt_from_md > :first-child {
  margin-top: 0;
}

#iovagawrlu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iovagawrlu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iovagawrlu .gt_stub {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#iovagawrlu .gt_stub_row_group {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#iovagawrlu .gt_row_group_first td {
  border-top-width: 2px;
}

#iovagawrlu .gt_row_group_first th {
  border-top-width: 2px;
}

#iovagawrlu .gt_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iovagawrlu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#iovagawrlu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#iovagawrlu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iovagawrlu .gt_grand_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iovagawrlu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iovagawrlu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#iovagawrlu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#iovagawrlu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#iovagawrlu .gt_footnotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iovagawrlu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iovagawrlu .gt_sourcenotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iovagawrlu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iovagawrlu .gt_left {
  text-align: left;
}

#iovagawrlu .gt_center {
  text-align: center;
}

#iovagawrlu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iovagawrlu .gt_font_normal {
  font-weight: normal;
}

#iovagawrlu .gt_font_bold {
  font-weight: bold;
}

#iovagawrlu .gt_font_italic {
  font-style: italic;
}

#iovagawrlu .gt_super {
  font-size: 65%;
}

#iovagawrlu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#iovagawrlu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#iovagawrlu .gt_indent_1 {
  text-indent: 5px;
}

#iovagawrlu .gt_indent_2 {
  text-indent: 10px;
}

#iovagawrlu .gt_indent_3 {
  text-indent: 15px;
}

#iovagawrlu .gt_indent_4 {
  text-indent: 20px;
}

#iovagawrlu .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id="statistic" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">statistic</th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">p.value</th>
<th id="method" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">method</th>
</tr></thead>
<tbody class="gt_table_body"><tr class="odd">
<td class="gt_row gt_right" headers="statistic">14.196</td>
<td class="gt_row gt_right" headers="p.value">0.693</td>
<td class="gt_row gt_left" headers="method">Andrews' Test for Structural Change</td>
</tr></tbody>
</table>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-growthpdssek-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;7.3: Andrews (1993) End-of-Sample Instability Test
</figcaption></figure>
</div>
</div>
<p>Gem. des gro른n <span class="math inline">\(p\)</span>-Werts kann die Nullhypothese (keine strukturelle Ver칛nderung ab 2017) nicht abgelehnt werden. Wir f칲hren den Test nun f칲r s칛mtliche Zeitpunkte ab 2017 durch und plotten die <span class="math inline">\(p\)</span>-Werte nebst gepunkteten roten Hilfslinien f칲r die g칛ngigen Signifikanzniveaus (10%, 5%, 1%).</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Andrews' (1993) test f칲r </span></span>
<span><span class="co"># Post-Referendumsperioden</span></span>
<span><span class="va">pvals_andrews</span> <span class="op">&lt;-</span> <span class="fu">map</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2017</span>, <span class="fl">2020.5</span>, <span class="fl">.25</span><span class="op">)</span>, \<span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    Time <span class="op">=</span> <span class="va">time</span>,</span>
<span>    gap <span class="op">=</span> <span class="va">gdp_gap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">==</span> <span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">gdp_gap</span><span class="op">)</span>,</span>
<span>    pvalue <span class="op">=</span> <span class="fu">CPAT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CPAT/man/Andrews.test.html">Andrews.test</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">gdp_gap</span><span class="op">$</span><span class="va">gdp_gap</span>, </span>
<span>      M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gdp_gap</span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="va">time</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># p-Werte f칲r Post-Interventionsperioden</span></span>
<span><span class="va">pvals_andrews</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">pvalue</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span></span>
<span>    yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">.05</span>, <span class="fl">.01</span><span class="op">)</span>, </span>
<span>    lty <span class="op">=</span> <span class="st">"dotted"</span>, </span>
<span>    col <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-andrewspvals" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-andrewspvals-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="SyntheticControl_files/figure-html/fig-andrewspvals-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-andrewspvals-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;7.8: P-Werte f칲r Andrews (2003) Test
</figcaption></figure>
</div>
</div>
</div>
<p>Der Verlauf der <span class="math inline">\(p\)</span>-Werte zeigt deutlich, dass es f칲r Zeitpunkte jenseits von 2018-Q3 Evidenz f칲r eine strukturelle Ver칛nderung der Doppelg칛nger-Gap f칲r Gro륵rittannien gibt. Diese Ergebnisse untermauern die Signifikanz der in <span class="citation" data-cites="Bornetal2019">Born u.&nbsp;a. (<a href="Literatur.html#ref-Bornetal2019" role="doc-biblioref">2019</a>)</span> mit SCM gefundenen negativen Effekte des Brexit-Votums auf die Britische Volkswirtschaft weiter.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Abadieetal2014" class="csl-entry" role="listitem">
Abadie, Alberto, Alexis Diamond, und Jens Hainmueller. 2014. <span>뢲omparative Politics and the Synthetic Control Method: COMPARATIVE POLITICS AND THE SYNTHETIC CONTROL METHOD</span>. <em>American Journal of Political Science</em> 59 (2): 495510. <a href="https://doi.org/10.1111/ajps.12116">https://doi.org/10.1111/ajps.12116</a>.
</div>
<div id="ref-Abadieetal2010" class="csl-entry" role="listitem">
Abadie, Alexis Diamond, Alberto, und Jens Hainmueller. 2010. <span>룁ynthetic Control Methods for Comparative Case Stud- ies: Estimating the Effect of California뗩 Tobacco Control Program.</span> <em>Journal of the American Statistical Association</em> 105 (490): 493505. <a href="https://doi.org/10.1198/jasa.2009.ap08746">https://doi.org/10.1198/jasa.2009.ap08746</a>.
</div>
<div id="ref-Andrews2003" class="csl-entry" role="listitem">
Andrews, D. W. K. 2003. <span>뢴nd-of-Sample Instability Tests</span>. <em>Econometrica</em> 71 (6): 166194. <a href="https://doi.org/10.1111/1468-0262.00466">https://doi.org/10.1111/1468-0262.00466</a>.
</div>
<div id="ref-Bornetal2019" class="csl-entry" role="listitem">
Born, Benjamin, Gernot J M칲ller, Moritz Schularick, und Petr Sedl치캜ek. 2019. <span>룂he Costs of Economic Nationalism: Evidence from the Brexit Experiment*</span>. <em>The Economic Journal</em> 129 (623): 272244. <a href="https://doi.org/10.1093/ej/uez020">https://doi.org/10.1093/ej/uez020</a>.
</div>
</div>
</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "燁";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./RegReg.html" class="pagination-link" aria-label="Regularisierte Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regularisierte Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Literatur.html" class="pagination-link" aria-label="Literatur">
        <span class="nav-page-text">Literatur</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb37" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="an">webr:</span><span class="co"> </span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">  show-startup-message: true</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">  packages: [</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">            'dplyr',</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">            'ggplot2',</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">            'sandwich',</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co">            'tidyr',</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co">            'readr',</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co">            'Synth'</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co">            ]</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="in">.qwebr-code-output-stdout {background-color: powderblue;}</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="in">.qwebr-button-run, .qwebr-button-reset, .qwebr-button-copy {</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="in">  background-color:  rgba(0, 0, 0, 0);</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="in">  border-style: none;</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="in">  font-weight: 400;</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="in">  color: white; </span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a><span class="in">  transition: none;</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="in">.qwebr-editor-toolbar {</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a><span class="in">  width: 100%;</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a><span class="in">  display: flex;</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a><span class="in">  justify-content: space-between;</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a><span class="in">  box-sizing: border-box;</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a><span class="in">  border-radius: 0 0 6px 6px;</span></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a><span class="in">  background-color: darkgreen;</span></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a><span class="in">  border-color: darkgreen;</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a><span class="in">  border-width: 1px;</span></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a><span class="in">  border-style: solid;</span></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a><span class="in">  padding: 0 0; </span></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a><span class="in">  transition: color .1s ease-in-out, background-color .1s ease-in-out,border-color .1s ease-in-out,box-shadow .1s ease-in-out;</span></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a><span class="in">.qwebr-editor-toolbar:hover {</span></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a><span class="in">  background-color: white;</span></span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a><span class="in">  border-color: darkgreen;</span></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a><span class="in">  border-width: 1px;</span></span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a><span class="in">.qwebr-editor-toolbar:hover * {</span></span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a><span class="in">  color: darkgreen;</span></span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a><span class="in">.overflow-guard, .qwebr-editor, .monaco-editor {</span></span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a><span class="in">  border-radius: 6px 6px 0 0;</span></span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a><span class="in">  border-width: 1px 1px 0 1px;</span></span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a><span class="in">  border-color: darkgreen;</span></span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-59"><a href="#cb37-59" aria-hidden="true" tabindex="-1"></a><span class="fu"># Synthetic Control</span></span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-61"><a href="#cb37-61" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=F,message=F,warning=F}</span></span>
<span id="cb37-62"><a href="#cb37-62" aria-hidden="true" tabindex="-1"></a><span class="in"># Formatierung von gt-Tabellen</span></span>
<span id="cb37-63"><a href="#cb37-63" aria-hidden="true" tabindex="-1"></a><span class="in">library(gt)</span></span>
<span id="cb37-64"><a href="#cb37-64" aria-hidden="true" tabindex="-1"></a><span class="in">tabopts &lt;- function(x) {</span></span>
<span id="cb37-65"><a href="#cb37-65" aria-hidden="true" tabindex="-1"></a><span class="in">    fmt_number(x, decimals = 3, drop_trailing_zeros = T) %&gt;%</span></span>
<span id="cb37-66"><a href="#cb37-66" aria-hidden="true" tabindex="-1"></a><span class="in">    tab_options(table_body.hlines.color = "white",</span></span>
<span id="cb37-67"><a href="#cb37-67" aria-hidden="true" tabindex="-1"></a><span class="in">              column_labels.border.bottom.color = "black", </span></span>
<span id="cb37-68"><a href="#cb37-68" aria-hidden="true" tabindex="-1"></a><span class="in">             column_labels.border.top.color = "black",</span></span>
<span id="cb37-69"><a href="#cb37-69" aria-hidden="true" tabindex="-1"></a><span class="in">             table_body.border.bottom.color = "black", </span></span>
<span id="cb37-70"><a href="#cb37-70" aria-hidden="true" tabindex="-1"></a><span class="in">             table.border.bottom.color = "black",</span></span>
<span id="cb37-71"><a href="#cb37-71" aria-hidden="true" tabindex="-1"></a><span class="in">             column_labels.font.weight = "bold", </span></span>
<span id="cb37-72"><a href="#cb37-72" aria-hidden="true" tabindex="-1"></a><span class="in">             table.font.color = "black", </span></span>
<span id="cb37-73"><a href="#cb37-73" aria-hidden="true" tabindex="-1"></a><span class="in">             table.font.size = 16)</span></span>
<span id="cb37-74"><a href="#cb37-74" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb37-75"><a href="#cb37-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-76"><a href="#cb37-76" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb37-77"><a href="#cb37-77" aria-hidden="true" tabindex="-1"></a><span class="in"># load the brexit data</span></span>
<span id="cb37-78"><a href="#cb37-78" aria-hidden="true" tabindex="-1"></a><span class="in">download.file(</span></span>
<span id="cb37-79"><a href="#cb37-79" aria-hidden="true" tabindex="-1"></a><span class="in">    "https://raw.githubusercontent.com/mca91/kausal_data/main/brexit.csv",</span></span>
<span id="cb37-80"><a href="#cb37-80" aria-hidden="true" tabindex="-1"></a><span class="in">    'datasets/brexit.csv',</span></span>
<span id="cb37-81"><a href="#cb37-81" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb37-82"><a href="#cb37-82" aria-hidden="true" tabindex="-1"></a><span class="in">brexit &lt;- read_csv("datasets/brexit.csv") %&gt;% as.data.frame</span></span>
<span id="cb37-83"><a href="#cb37-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-84"><a href="#cb37-84" aria-hidden="true" tabindex="-1"></a><span class="in"># load the Synth package</span></span>
<span id="cb37-85"><a href="#cb37-85" aria-hidden="true" tabindex="-1"></a><span class="in">library(Synth)</span></span>
<span id="cb37-86"><a href="#cb37-86" aria-hidden="true" tabindex="-1"></a><span class="in">options(pillar.sigfig = 2)</span></span>
<span id="cb37-87"><a href="#cb37-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-88"><a href="#cb37-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-89"><a href="#cb37-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-90"><a href="#cb37-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr-r}</span></span>
<span id="cb37-91"><a href="#cb37-91" aria-hidden="true" tabindex="-1"></a><span class="in">#| context: setup</span></span>
<span id="cb37-92"><a href="#cb37-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-93"><a href="#cb37-93" aria-hidden="true" tabindex="-1"></a><span class="in"># install wabassem nlopt from astamm's repository</span></span>
<span id="cb37-94"><a href="#cb37-94" aria-hidden="true" tabindex="-1"></a><span class="in">install.packages('nloptr', repos = 'https://astamm.r-universe.dev')</span></span>
<span id="cb37-95"><a href="#cb37-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-96"><a href="#cb37-96" aria-hidden="true" tabindex="-1"></a><span class="in"># create dataset directory</span></span>
<span id="cb37-97"><a href="#cb37-97" aria-hidden="true" tabindex="-1"></a><span class="in">dir.create("datasets")</span></span>
<span id="cb37-98"><a href="#cb37-98" aria-hidden="true" tabindex="-1"></a><span class="in"># Download the dataset</span></span>
<span id="cb37-99"><a href="#cb37-99" aria-hidden="true" tabindex="-1"></a><span class="in">download.file(</span></span>
<span id="cb37-100"><a href="#cb37-100" aria-hidden="true" tabindex="-1"></a><span class="in">    "https://raw.githubusercontent.com/mca91/kausal_data/main/brexit.csv",</span></span>
<span id="cb37-101"><a href="#cb37-101" aria-hidden="true" tabindex="-1"></a><span class="in">    'datasets/brexit.csv',</span></span>
<span id="cb37-102"><a href="#cb37-102" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb37-103"><a href="#cb37-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-104"><a href="#cb37-104" aria-hidden="true" tabindex="-1"></a><span class="in"># load the brexit data</span></span>
<span id="cb37-105"><a href="#cb37-105" aria-hidden="true" tabindex="-1"></a><span class="in">brexit &lt;- read_csv("datasets/brexit.csv") %&gt;% as.data.frame</span></span>
<span id="cb37-106"><a href="#cb37-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-107"><a href="#cb37-107" aria-hidden="true" tabindex="-1"></a><span class="in"># load the Synth package</span></span>
<span id="cb37-108"><a href="#cb37-108" aria-hidden="true" tabindex="-1"></a><span class="in">library(Synth)</span></span>
<span id="cb37-109"><a href="#cb37-109" aria-hidden="true" tabindex="-1"></a><span class="in">options(pillar.sigfig = 2)</span></span>
<span id="cb37-110"><a href="#cb37-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-111"><a href="#cb37-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-112"><a href="#cb37-112" aria-hidden="true" tabindex="-1"></a>Synthetic Control Methoden (SCM) wurden in @Abadieetal2010 f칲r die Auswertung kausaler Effekte von politischen Interventionen vorgeschlagen. SCM erm칬glicht es, die Auswirkungen einer Intervention oder eines Ereignisses auf ein spezifisches Untersuchungsobjekt (oftmals eine makro칬konomische Einheit wie ein Land, eine Region oder eine Stadt) in einem Forschungsdesign f칲r ein nat칲rliches Experiment zu sch칛tzen. SCM adressiert das bereits erl칛uterte Kernproblem, dass es schwierig, wenn nicht unm칬glich sein kann, eine ad칛quate Kontrollgruppe in Beobachtungsdaten zu finden. Hierzu wird eine k칲nstliche Kontrolleinheit (Synthetic Control) generiert, die der behandelten Einheit vor der Intervention m칬glichst 칛hnlich ist. Dieser synthetische Doppelg칛nger kann die unbeobachtbare Entwicklungen der behandelten Einheit *nach* der Intervention repr칛sentieren und so eine plausible Sch칛tzung des kausalen Effekts der Intervention f칲r die Post-Interventionsperioden gew칛hrleisten. </span>
<span id="cb37-113"><a href="#cb37-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-114"><a href="#cb37-114" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sch칛tzung von Interventionseffekten mit SCM {#sec-siscm}</span></span>
<span id="cb37-115"><a href="#cb37-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-116"><a href="#cb37-116" aria-hidden="true" tabindex="-1"></a>츿hnlich wie bei manchen Matching-Methoden wird bei SCM die 츿hnlichkeit der synthetischen Einheit mit der untersuchten Einheit durch eine gewichtete Kombination von Kontrolleinheiten basierend auf ihren Pr칛-Interventionsmerkmalen erreicht. Seien $i = 1, 2, \ldots, N$ die Einheiten in der Stichprobe, wobei $i = 1$ die behandelte Einheit und $i = 2, \ldots, N$ potenziellen Kontrolleinheiten (auch *Donor pool* genannt) sind. Die Daten liegen f칲r die Perioden $t = 1, 2, \ldots, T$ vor, mit $T_0$ dem Zeitpunkt direkt vor der Intervention und $T_1, \ldots, T$ den Perioden nach der Intervention.</span>
<span id="cb37-117"><a href="#cb37-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-118"><a href="#cb37-118" aria-hidden="true" tabindex="-1"></a>F칲r SCM bestimmen wir einen Vektor von Gewichten $\mathbf{w}^* := (w_2^*, \ldots, w_k^*)^T$, der die Summe der quadrierten Differenzen zwischen den Auspr칛gungen von $k$ Charakteristika der behandelten Einheit vor der Intervention, $X_{1,\,m}^{\text{Pre}}$, $m=1,\dots,k$, und der gewichteten Summe dieser Charakteristika f칲r die Kontrolleinheiten, $X_{i,\,m}^{\text{Pre}}$, minimiert:</span>
<span id="cb37-119"><a href="#cb37-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-120"><a href="#cb37-120" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb37-121"><a href="#cb37-121" aria-hidden="true" tabindex="-1"></a>  \mathbf{w}^* := \arg\min_{\mathbf{w}} \sum_{m=1}^{k} v_m \left( X_{1,\,m}^{\text{Pre}} - \sum_{i=2}^{N} w_i X_{i,m}^{\text{Pre}} \right)^2,\label{eq:scopt}</span>
<span id="cb37-122"><a href="#cb37-122" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb37-123"><a href="#cb37-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-124"><a href="#cb37-124" aria-hidden="true" tabindex="-1"></a>unter der Nebenbedingung, dass $\sum_{i=2}^{N} w_i = 1$ und $w_i \geq 0$ f칲r alle $i$. Die $v_m$ sind weitere Gewichte, welche die Relevanz der Variablen f칲r die Vorhersage der Outcome-Variable der interessierenden Einheit, $Y_{1,\,t}$, beinflussen. Diese Gewichte werden meist in einem weiteren Optimierungsverfahren (bspw. mit Cross-Validation) bestimmt <span class="co">[</span><span class="ot">vgl. @Abadieetal2014</span><span class="co">]</span>. Als Verlustfunktion hierbei wird meist der mittlere quadratische Fehler bei der Vorhersage von $Y_{1,\,t}$ (MSPE)^<span class="co">[</span><span class="ot">Engl. f칲r *Mean squared prediction error*</span><span class="co">]</span> vor der Behandlung anhand der synthetischen Einheit verwendet,</span>
<span id="cb37-125"><a href="#cb37-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-126"><a href="#cb37-126" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb37-127"><a href="#cb37-127" aria-hidden="true" tabindex="-1"></a>  \sum_{t=1}^{T_0} \left( Y_{1,\,t} - \sum_{i=2}^N w_i(\mathbf{v}) Y_{i,\,t} \right)^2, \label{eq:scopt2}</span>
<span id="cb37-128"><a href="#cb37-128" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb37-129"><a href="#cb37-129" aria-hidden="true" tabindex="-1"></a>mit $\mathbf{v} := (v_1,\dots,v_k)'$.</span>
<span id="cb37-130"><a href="#cb37-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-131"><a href="#cb37-131" aria-hidden="true" tabindex="-1"></a>Durch die L칬sung des Optimierungsproblems \eqref{eq:scopt} unter Ber칲cksichtigung von \eqref{eq:scopt2} erhalten wir die gesch칛tzten Gewichte $\widehat{w}_i$, welche den Einfluss der Kontrolleinheit $i=2,\dots,N$-ten bei der Zusammensetzung der Kontrollgruppe festlegen. Anhand der $\widehat{w}_i$ wird die Outcome-Variable der synthetischen Kontrolleinheit konstruiert, welche als Referenz f칲r die Sch칛tzung des kausalen Effekts der Intervention dient. Die Outcome-Variable der synthetischen Kontrollgruppe f칲r die Nach-Interventionsperiode kann formal ausgedr칲ckt werden als</span>
<span id="cb37-132"><a href="#cb37-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-133"><a href="#cb37-133" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb37-134"><a href="#cb37-134" aria-hidden="true" tabindex="-1"></a>  Y_{1,\,t}^{\text{Synth}} = \sum_{i=2}^{N} \widehat{w}_i Y_{i,\,t},\quad t &gt; T_0,\label{eq:dgkonst}</span>
<span id="cb37-135"><a href="#cb37-135" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb37-136"><a href="#cb37-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-137"><a href="#cb37-137" aria-hidden="true" tabindex="-1"></a>wobei $Y_{1,t}^{\text{Synth}}$ der Wert der Outcome-Variable $Y$ f칲r die synthetische Kontrollgruppe zum Zeitpunkt $t$ und $Y_{i,t}$ der entsprechende Wert des Outcomes f칲r die $i$-te Kontrolleinheit ist. Bei SCM sch칛tzen wir den kausalen Effekt $\tau_t$ der Intervention zum Zeitpunkt $t$ als die Differenz der Post-Interventionswerte von $Y$ zwischen der behandelten Einheit und dem synthetischen Doppelg칛nger,</span>
<span id="cb37-138"><a href="#cb37-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-139"><a href="#cb37-139" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-140"><a href="#cb37-140" aria-hidden="true" tabindex="-1"></a>\widehat{\tau}_t = Y_{1,\,t} - Y_{1,\,t}^{\text{synth}},\quad t &gt; T_0.</span>
<span id="cb37-141"><a href="#cb37-141" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-142"><a href="#cb37-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-143"><a href="#cb37-143" aria-hidden="true" tabindex="-1"></a>Der mit SCM gesch칛tzte Effekt ermittelt also f칲r $t &gt; T_0$, wie sich die Intervention auf die behandelte Einheit ausgewirkt hat durch einen Vergleich mit der Situation, die eingetreten w칛re, wenn die Einheit nicht behandelt worden w칛re, repr칛sentiert durch die synthetische Kontrollgruppe.</span>
<span id="cb37-144"><a href="#cb37-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-145"><a href="#cb37-145" aria-hidden="true" tabindex="-1"></a>Der SCM-Sch칛tzer von @Abadieetal2010 ist im R-Paket <span class="in">`Synth`</span> <span class="co">[</span><span class="ot">@Hainmuelleretal2011</span><span class="co">]</span> implementiert. Wir illustrieren die Methode nachfolgend mit einer empirischen Anwendung zu den Konsequenzen des Brexit auf die nachfolgende Entwicklung der britischen Volkswirtschaft.</span>
<span id="cb37-146"><a href="#cb37-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-147"><a href="#cb37-147" aria-hidden="true" tabindex="-1"></a><span class="fu">## Case Study: 칐konomische Kosten des Brexit</span></span>
<span id="cb37-148"><a href="#cb37-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-149"><a href="#cb37-149" aria-hidden="true" tabindex="-1"></a>@Bornetal2019 untersuchen die 칬konomischen Kosten des Brexits mit einem kausalanalytischen Forschungsansatz. Der Kern der empirischen Analyse ist eine Kombination von quasi-experimenteller Identifikation und struktureller Zeitreihenanalyse. Hiermit k칬nnen nicht nur die aggregierten Kosten des EU-Ausstiegs f칲r Gro륵rittanien zu quantifiziert, sondern auch die Kan칛le indentifiziert werden, durch die die erwartete wirtschaftliche Desintegration die britische Makro칬konomie beeinflusst hat. Hierbei identifizieren @Bornetal2019 einen Anstieg der wirtschaftspolitischen Unsicherheit und eine Abw칛rtskorrektur der Wachstumserwartungen als Haupttreiber f칲r den R칲ckgang der Wirtschaftsleistung.  </span>
<span id="cb37-150"><a href="#cb37-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-151"><a href="#cb37-151" aria-hidden="true" tabindex="-1"></a>Der quasi-experimentelle Ansatz betrachtet das Brexit-Referendum als ein nat칲rliches makro칬konomisches Experiment und untersucht die Konsequenzn der wirtschaftlichen Desintegration f칲r das Bruttoinlandsprodukt (BIP) im Nachfolgezeitraum mit SCM. Hierzu wird gem칛 der in @sec-siscm erl칛uterten Vorgehensweise ein syntetischer Doppelg칛nger f칲r die britische Wirtschaft aus einem Donor Pool von 23 Volkswirtschaften konstruiert, und der Effekt des Referendums als Unterschied zwischen der tats칛chlichen und synthetischen Trajektorien des BIP f칲r Folgeperioden ermittelt. Die Analyse zeigt, dass das Brexit-Votum bis Ende 2018 zu einem BIP-R칲ckgang von etwa 1.7\% bis 2.5\% gef칲hrt hat.</span>
<span id="cb37-152"><a href="#cb37-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-153"><a href="#cb37-153" aria-hidden="true" tabindex="-1"></a>Wie reproduzieren nun die wesentlichen Ergebnisse des SCM-Ansatzes der Studie mit R. Hierf칲r lesen zun칛chst den Datensatz <span class="in">`brexit.csv`</span> (<span class="co">[</span><span class="ot">hier verf칲gbar</span><span class="co">](https://raw.githubusercontent.com/mca91/kausal_data/main/brexit.csv)</span>) in R ein. Dieser enth칛lt viertelj칛hrliche Beobachtungen makro칬konomischer Variablen f칲r 24 L칛nder f칲r den Zeitraum 1995-Q1--2021-Q4.</span>
<span id="cb37-154"><a href="#cb37-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-157"><a href="#cb37-157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-158"><a href="#cb37-158" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb37-159"><a href="#cb37-159" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb37-160"><a href="#cb37-160" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb37-161"><a href="#cb37-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-162"><a href="#cb37-162" aria-hidden="true" tabindex="-1"></a><span class="co"># Datensatz 'brexit.csv' einlesen</span></span>
<span id="cb37-163"><a href="#cb37-163" aria-hidden="true" tabindex="-1"></a>brexit <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datasets/brexit.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-164"><a href="#cb37-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb37-165"><a href="#cb37-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-166"><a href="#cb37-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-167"><a href="#cb37-167" aria-hidden="true" tabindex="-1"></a><span class="in">`brexit`</span> ist ein Datensatz mit einer Panel-Struktur. Die Zeit- und Entit칛tsvariablen sind <span class="in">`Year`</span>/<span class="in">`quarter`</span> und <span class="in">`Country`</span>/<span class="in">`ID`</span>. Beachte, dass die Variable <span class="in">`Time`</span> zus칛tzlich das Jahr und das Quartal als numerische Variable angibt.</span>
<span id="cb37-168"><a href="#cb37-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-171"><a href="#cb37-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-172"><a href="#cb37-172" aria-hidden="true" tabindex="-1"></a><span class="co"># 칖berblick 칲ber 'brexit'</span></span>
<span id="cb37-173"><a href="#cb37-173" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(brexit)</span>
<span id="cb37-174"><a href="#cb37-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-175"><a href="#cb37-175" aria-hidden="true" tabindex="-1"></a><span class="co"># 'Time' zeigt Jahr + Quartal</span></span>
<span id="cb37-176"><a href="#cb37-176" aria-hidden="true" tabindex="-1"></a>brexit <span class="sc">%&gt;%</span> </span>
<span id="cb37-177"><a href="#cb37-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">"United Kingdom"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-178"><a href="#cb37-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb37-179"><a href="#cb37-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb37-180"><a href="#cb37-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-181"><a href="#cb37-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-182"><a href="#cb37-182" aria-hidden="true" tabindex="-1"></a>F칲r die Sch칛tzung der Gewichte $w_i$ f칲r die Konstruktion des UK-Doppelg칛ngers werden die in gelisteten Charakteristika der Volkswirtschaften verwendet.</span>
<span id="cb37-183"><a href="#cb37-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-184"><a href="#cb37-184" aria-hidden="true" tabindex="-1"></a>| Variable      | Definition                                                |</span>
<span id="cb37-185"><a href="#cb37-185" aria-hidden="true" tabindex="-1"></a>|---------------|-----------------------------------------------------------|</span>
<span id="cb37-186"><a href="#cb37-186" aria-hidden="true" tabindex="-1"></a>| <span class="in">`gdp`</span>         | Ver칛nderung des BIP relativ zu 2016                       |  </span>
<span id="cb37-187"><a href="#cb37-187" aria-hidden="true" tabindex="-1"></a>| <span class="in">`ConGDP`</span>      | Anteil: Konsum/BIP (%)                                    |</span>
<span id="cb37-188"><a href="#cb37-188" aria-hidden="true" tabindex="-1"></a>| <span class="in">`InvGDP`</span>      | Anteil: Investitionen/BIP (%)                             |</span>
<span id="cb37-189"><a href="#cb37-189" aria-hidden="true" tabindex="-1"></a>| <span class="in">`ExpGDP`</span>      | Anteil: Exporte/BIP (%)                                   |</span>
<span id="cb37-190"><a href="#cb37-190" aria-hidden="true" tabindex="-1"></a>| <span class="in">`ImpGDP`</span>      | Anteil: Importe/BIP (%)                                   |</span>
<span id="cb37-191"><a href="#cb37-191" aria-hidden="true" tabindex="-1"></a>| <span class="in">`EmpSha`</span>      | Anteil: Besch칛ftigte/Erwerbsbev칬lkerung (%)               |</span>
<span id="cb37-192"><a href="#cb37-192" aria-hidden="true" tabindex="-1"></a>| <span class="in">`LPG`</span>         | Wachstum der Arbeitsproduktivit칛t (%)                     |</span>
<span id="cb37-193"><a href="#cb37-193" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-194"><a href="#cb37-194" aria-hidden="true" tabindex="-1"></a>: <span class="in">`brexit`</span> -- Variablen und Definitionen {#tbl-Born2019preds}</span>
<span id="cb37-195"><a href="#cb37-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-196"><a href="#cb37-196" aria-hidden="true" tabindex="-1"></a>Zur Berechnung von SCM mit dem R-Paket <span class="in">`Synth`</span> m칲ssen die Daten zun칛chst mit der Funktion <span class="in">`Synth::dataprep()`</span> aufbereitet werden, s. <span class="in">`?Synth::dataprep()`</span> f칲r weitere Details. Neben dem Datensatz (<span class="in">`foo`</span>) unter expliziter Nennung der Pr칛diktoren (<span class="in">`predictors`</span>) und der Outcome-Variable (<span class="in">`dependent`</span>) 칲bergeben wir Variablen f칲r die Indentifikation von Einheiten (<span class="in">`ID`</span>) und Zeitpunkten (<span class="in">`Time`</span>), sowie Donor Pool (<span class="in">`controls.identifier`</span>) und behandelter Einheit (<span class="in">`treatment.identifier`</span>). Weiterhin werden die Vorbehandlungsperiode (<span class="in">`time.predictors.prior`</span>) sowie der Zeitraum 칲ber den die Regressor-Gewichte $v_m$ bestimmt werden sollen (<span class="in">`time.optimize.ssr`</span>), festgelegt. F칲r letztere 칲bergeben wir einen numerischen Vektor f칲r s칛mtliche Zeitpunkte von 1995-Q1 bis zum Brexit-Referendum in 2016-Q2.</span>
<span id="cb37-197"><a href="#cb37-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-198"><a href="#cb37-198" aria-hidden="true" tabindex="-1"></a>Um einen ersten 칖berblick 칲ber die Entwicklung der BIP im Datensatz zu gewinnen, vergleichen wir die Zeitreihen f칲r Donor-Pool-L칛nder (grau) und Gro륵ritannien (blau) mit <span class="in">`ggplot`</span>. </span>
<span id="cb37-201"><a href="#cb37-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-202"><a href="#cb37-202" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "BIP relativ zu 2016"</span></span>
<span id="cb37-203"><a href="#cb37-203" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "fig-bipv"</span></span>
<span id="cb37-204"><a href="#cb37-204" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb37-205"><a href="#cb37-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-206"><a href="#cb37-206" aria-hidden="true" tabindex="-1"></a>brexit <span class="sc">%&gt;%</span></span>
<span id="cb37-207"><a href="#cb37-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-208"><a href="#cb37-208" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">ifelse</span>(</span>
<span id="cb37-209"><a href="#cb37-209" aria-hidden="true" tabindex="-1"></a>      Country <span class="sc">==</span> <span class="st">"United Kingdom"</span>, </span>
<span id="cb37-210"><a href="#cb37-210" aria-hidden="true" tabindex="-1"></a>      <span class="at">yes =</span> <span class="st">"UK"</span>, </span>
<span id="cb37-211"><a href="#cb37-211" aria-hidden="true" tabindex="-1"></a>      <span class="at">no =</span><span class="st">"else"</span></span>
<span id="cb37-212"><a href="#cb37-212" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-213"><a href="#cb37-213" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb37-214"><a href="#cb37-214" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-215"><a href="#cb37-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb37-216"><a href="#cb37-216" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb37-217"><a href="#cb37-217" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> Time, </span>
<span id="cb37-218"><a href="#cb37-218" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> gdp, </span>
<span id="cb37-219"><a href="#cb37-219" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> group, </span>
<span id="cb37-220"><a href="#cb37-220" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> Country, </span>
<span id="cb37-221"><a href="#cb37-221" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> group</span>
<span id="cb37-222"><a href="#cb37-222" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-223"><a href="#cb37-223" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-224"><a href="#cb37-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb37-225"><a href="#cb37-225" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb37-226"><a href="#cb37-226" aria-hidden="true" tabindex="-1"></a>      <span class="st">"UK"</span> <span class="ot">=</span> <span class="st">"#00BFC4"</span>, <span class="st">"else"</span> <span class="ot">=</span> <span class="fu">alpha</span>(<span class="st">"gray"</span>, .<span class="dv">75</span>)</span>
<span id="cb37-227"><a href="#cb37-227" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-228"><a href="#cb37-228" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-229"><a href="#cb37-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linewidth_manual</span>(</span>
<span id="cb37-230"><a href="#cb37-230" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"UK"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"else"</span> <span class="ot">=</span> .<span class="dv">5</span>)</span>
<span id="cb37-231"><a href="#cb37-231" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-232"><a href="#cb37-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb37-233"><a href="#cb37-233" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Brexit-Referendum</span></span>
<span id="cb37-234"><a href="#cb37-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb37-235"><a href="#cb37-235" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="fl">2016.25</span>, </span>
<span id="cb37-236"><a href="#cb37-236" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="st">"dotted"</span></span>
<span id="cb37-237"><a href="#cb37-237" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-238"><a href="#cb37-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb37-239"><a href="#cb37-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb37-240"><a href="#cb37-240" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="st">"none"</span>, </span>
<span id="cb37-241"><a href="#cb37-241" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">position =</span> <span class="st">"inside"</span>)</span>
<span id="cb37-242"><a href="#cb37-242" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-243"><a href="#cb37-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position.inside =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">9</span>))</span>
<span id="cb37-244"><a href="#cb37-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-245"><a href="#cb37-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-246"><a href="#cb37-246" aria-hidden="true" tabindex="-1"></a>@fig-bipv zeigt, dass das BIP von Gro륵ritannien zwar auch nach dem Brexit-Referendum (gepunktete Linie) gewachsen ist, jedoch vergleichsweise schwach. Eine Analyse mit SCM kann statistische Evidenz f칲r den mutma륿ich negativen Effekt des Referendums auf das Wachstum in den Folgeperioden liefern.</span>
<span id="cb37-247"><a href="#cb37-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-248"><a href="#cb37-248" aria-hidden="true" tabindex="-1"></a>Wir laden nun das Paket <span class="in">`Synth`</span> und bereiten die Daten f칲r die Analyse vor.</span>
<span id="cb37-249"><a href="#cb37-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-252"><a href="#cb37-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-253"><a href="#cb37-253" aria-hidden="true" tabindex="-1"></a><span class="co"># R-Paket 'Synth' laden</span></span>
<span id="cb37-254"><a href="#cb37-254" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Synth)</span>
<span id="cb37-255"><a href="#cb37-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-256"><a href="#cb37-256" aria-hidden="true" tabindex="-1"></a><span class="co"># Daten f칲r die Optimierung vorbereiten</span></span>
<span id="cb37-257"><a href="#cb37-257" aria-hidden="true" tabindex="-1"></a>dataprep_out <span class="ot">&lt;-</span> <span class="fu">dataprep</span>(</span>
<span id="cb37-258"><a href="#cb37-258" aria-hidden="true" tabindex="-1"></a>  <span class="at">foo =</span> brexit, </span>
<span id="cb37-259"><a href="#cb37-259" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictors =</span> <span class="fu">c</span>(</span>
<span id="cb37-260"><a href="#cb37-260" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ConGDP"</span>, <span class="st">"InvGDP"</span>, </span>
<span id="cb37-261"><a href="#cb37-261" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ExpGDP"</span>, <span class="st">"ImpGDP"</span>, </span>
<span id="cb37-262"><a href="#cb37-262" aria-hidden="true" tabindex="-1"></a>    <span class="st">"LPG"</span>, <span class="st">"EmpSha"</span></span>
<span id="cb37-263"><a href="#cb37-263" aria-hidden="true" tabindex="-1"></a>  ), </span>
<span id="cb37-264"><a href="#cb37-264" aria-hidden="true" tabindex="-1"></a>  <span class="at">dependent =</span> <span class="st">"gdp"</span>, </span>
<span id="cb37-265"><a href="#cb37-265" aria-hidden="true" tabindex="-1"></a>  <span class="at">unit.variable =</span> <span class="st">"ID"</span>,</span>
<span id="cb37-266"><a href="#cb37-266" aria-hidden="true" tabindex="-1"></a>  <span class="at">time.variable =</span> <span class="st">"Time"</span>, </span>
<span id="cb37-267"><a href="#cb37-267" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment.identifier =</span> <span class="dv">23</span>, </span>
<span id="cb37-268"><a href="#cb37-268" aria-hidden="true" tabindex="-1"></a>  <span class="at">controls.identifier =</span> (brexit<span class="sc">$</span>ID <span class="sc">%&gt;%</span> <span class="fu">unique</span>())[<span class="sc">-</span><span class="dv">23</span>], </span>
<span id="cb37-269"><a href="#cb37-269" aria-hidden="true" tabindex="-1"></a>  <span class="at">time.predictors.prior =</span> <span class="fu">seq</span>(<span class="dv">1995</span>, <span class="fl">2016.25</span>, .<span class="dv">25</span>),</span>
<span id="cb37-270"><a href="#cb37-270" aria-hidden="true" tabindex="-1"></a>  <span class="at">time.optimize.ssr =</span> <span class="fu">seq</span>(<span class="dv">1995</span>, <span class="fl">2016.25</span>, .<span class="dv">25</span>),</span>
<span id="cb37-271"><a href="#cb37-271" aria-hidden="true" tabindex="-1"></a>  <span class="at">unit.names.variable =</span> <span class="st">"Country"</span></span>
<span id="cb37-272"><a href="#cb37-272" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-273"><a href="#cb37-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-274"><a href="#cb37-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-275"><a href="#cb37-275" aria-hidden="true" tabindex="-1"></a>Anhand der vorbereiteten Daten <span class="in">`dataprep_out`</span> wird nun die Bestimmung der Gewichte mit <span class="in">`Synth::synth()`</span> durchgef칲hrt.</span>
<span id="cb37-276"><a href="#cb37-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-279"><a href="#cb37-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-280"><a href="#cb37-280" aria-hidden="true" tabindex="-1"></a><span class="co"># Gewichte per Optimierung bestimmen</span></span>
<span id="cb37-281"><a href="#cb37-281" aria-hidden="true" tabindex="-1"></a>synth_out <span class="ot">&lt;-</span> <span class="fu">synth</span>(dataprep_out)</span>
<span id="cb37-282"><a href="#cb37-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-283"><a href="#cb37-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-284"><a href="#cb37-284" aria-hidden="true" tabindex="-1"></a><span class="in">`Synth::synth()`</span> gibt Infos 칲ber den Optimierungsprozess und dessen Ergebnisse automatisch in der Konsole aus. Wir k칬nnen diese mit <span class="in">`Synth::synth.tab()`</span> leicht tabellarisch zusammenfassen und mit <span class="in">`gt::gt()`</span> darstellen.</span>
<span id="cb37-285"><a href="#cb37-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-288"><a href="#cb37-288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-289"><a href="#cb37-289" aria-hidden="true" tabindex="-1"></a><span class="co"># Zusammenfassung der Ergebnisse</span></span>
<span id="cb37-290"><a href="#cb37-290" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb37-291"><a href="#cb37-291" aria-hidden="true" tabindex="-1"></a>  tb <span class="ot">&lt;-</span> <span class="fu">synth.tab</span>(</span>
<span id="cb37-292"><a href="#cb37-292" aria-hidden="true" tabindex="-1"></a>    <span class="at">synth.res =</span> synth_out, </span>
<span id="cb37-293"><a href="#cb37-293" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataprep.res =</span> dataprep_out</span>
<span id="cb37-294"><a href="#cb37-294" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb37-295"><a href="#cb37-295" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-296"><a href="#cb37-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-297"><a href="#cb37-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-298"><a href="#cb37-298" aria-hidden="true" tabindex="-1"></a>F칲r die tabellarische Darstellung mit <span class="in">`gt::gt()`</span> ber칲cksichtigen wir lediglich Volkswirtschaften mit Gewicht &gt; .0001.</span>
<span id="cb37-299"><a href="#cb37-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-302"><a href="#cb37-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-303"><a href="#cb37-303" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Gewichte f칲r den synthetischen UK-Doppelg칛nger"</span></span>
<span id="cb37-304"><a href="#cb37-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-brexitcw</span></span>
<span id="cb37-305"><a href="#cb37-305" aria-hidden="true" tabindex="-1"></a><span class="co"># Darstellung mit gt()</span></span>
<span id="cb37-306"><a href="#cb37-306" aria-hidden="true" tabindex="-1"></a>tb<span class="sc">$</span>tab.w <span class="sc">%&gt;%</span> </span>
<span id="cb37-307"><a href="#cb37-307" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ber칲cksichtige nur L칛nder mit relevanten Gewichten</span></span>
<span id="cb37-308"><a href="#cb37-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(w.weights <span class="sc">&gt;</span> .<span class="dv">0001</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-309"><a href="#cb37-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(w.weights)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-310"><a href="#cb37-310" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-311"><a href="#cb37-311" aria-hidden="true" tabindex="-1"></a>  tabopts</span>
<span id="cb37-312"><a href="#cb37-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-313"><a href="#cb37-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-314"><a href="#cb37-314" aria-hidden="true" tabindex="-1"></a>Der synthetische UK-Doppelg칛nger kann nun gem칛 der Vorschrift \eqref{eq:dgkonst} konstruiert werden. Wir erzeugen hierzu ein <span class="in">`tibble`</span>-Objekt mit den entsprechenden ID-Variablen.</span>
<span id="cb37-315"><a href="#cb37-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-318"><a href="#cb37-318" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-319"><a href="#cb37-319" aria-hidden="true" tabindex="-1"></a><span class="co"># Doppelg칛nger konstruieren</span></span>
<span id="cb37-320"><a href="#cb37-320" aria-hidden="true" tabindex="-1"></a>doppelganger <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb37-321"><a href="#cb37-321" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> brexit, </span>
<span id="cb37-322"><a href="#cb37-322" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> tb<span class="sc">$</span>tab.w, </span>
<span id="cb37-323"><a href="#cb37-323" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Country"</span> <span class="ot">=</span> <span class="st">"unit.names"</span>)</span>
<span id="cb37-324"><a href="#cb37-324" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-325"><a href="#cb37-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Time, Year, Country, gdp, w.weights) <span class="sc">%&gt;%</span></span>
<span id="cb37-326"><a href="#cb37-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Time, Year) <span class="sc">%&gt;%</span></span>
<span id="cb37-327"><a href="#cb37-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb37-328"><a href="#cb37-328" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdp =</span> <span class="fu">sum</span>(gdp <span class="sc">*</span> w.weights, <span class="at">na.rm =</span> T)</span>
<span id="cb37-329"><a href="#cb37-329" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb37-330"><a href="#cb37-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"Doppelgaenger"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-331"><a href="#cb37-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb37-332"><a href="#cb37-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-333"><a href="#cb37-333" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(doppelganger)</span>
<span id="cb37-334"><a href="#cb37-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-335"><a href="#cb37-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-336"><a href="#cb37-336" aria-hidden="true" tabindex="-1"></a>F칲r die nachfolgenden Schritte der Analyse f칲hren wir das beobachtete GDP f칲r Gro륵ritannien mit dem syntethischen GDP des Doppelg칛ngers zusammen.</span>
<span id="cb37-337"><a href="#cb37-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-340"><a href="#cb37-340" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-341"><a href="#cb37-341" aria-hidden="true" tabindex="-1"></a><span class="co"># tibble mit UK-GDP erstellen</span></span>
<span id="cb37-342"><a href="#cb37-342" aria-hidden="true" tabindex="-1"></a>UK <span class="ot">&lt;-</span> brexit <span class="sc">%&gt;%</span> </span>
<span id="cb37-343"><a href="#cb37-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">"United Kingdom"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-344"><a href="#cb37-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Time, Year, gdp) <span class="sc">%&gt;%</span></span>
<span id="cb37-345"><a href="#cb37-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"UK"</span>)</span>
<span id="cb37-346"><a href="#cb37-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-347"><a href="#cb37-347" aria-hidden="true" tabindex="-1"></a><span class="co"># UK und Doppelg칛nger zusammenf칲hren</span></span>
<span id="cb37-348"><a href="#cb37-348" aria-hidden="true" tabindex="-1"></a>the_gdps <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb37-349"><a href="#cb37-349" aria-hidden="true" tabindex="-1"></a>  doppelganger, UK</span>
<span id="cb37-350"><a href="#cb37-350" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-351"><a href="#cb37-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-352"><a href="#cb37-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-353"><a href="#cb37-353" aria-hidden="true" tabindex="-1"></a>F칲r einen Vergleich von UK- und Doppelg칛nger-BIP folgen wir @Bornetal2019 und berechnen die Differenz der BIP 칲ber den gesamten Zeitraum, die so genannte *Doppelg칛nger-Gap*. </span>
<span id="cb37-354"><a href="#cb37-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-357"><a href="#cb37-357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-358"><a href="#cb37-358" aria-hidden="true" tabindex="-1"></a><span class="co"># UK-Doppelg칛nger-Gap berechnen</span></span>
<span id="cb37-359"><a href="#cb37-359" aria-hidden="true" tabindex="-1"></a>gdp_gap <span class="ot">&lt;-</span> the_gdps <span class="sc">%&gt;%</span> </span>
<span id="cb37-360"><a href="#cb37-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb37-361"><a href="#cb37-361" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> gdp, </span>
<span id="cb37-362"><a href="#cb37-362" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="st">"type"</span></span>
<span id="cb37-363"><a href="#cb37-363" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb37-364"><a href="#cb37-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp_gap =</span> UK <span class="sc">-</span> Doppelgaenger)</span>
<span id="cb37-365"><a href="#cb37-365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-366"><a href="#cb37-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-367"><a href="#cb37-367" aria-hidden="true" tabindex="-1"></a>Als ein Ma f칲r die Unsicherheit bei der Sch칛tzung des GDPs f칲r den Doppelg칛nger berechnen @Bornetal2019 die Standardabweichung der Doppelg칛nger-Gap f칲r den Zeitraum *vor* dem Brexit-Referendum.</span>
<span id="cb37-368"><a href="#cb37-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-371"><a href="#cb37-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-372"><a href="#cb37-372" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardabweichung der Gap vor dem Brexit-Vote</span></span>
<span id="cb37-373"><a href="#cb37-373" aria-hidden="true" tabindex="-1"></a>sd_gap <span class="ot">&lt;-</span> gdp_gap <span class="sc">%&gt;%</span></span>
<span id="cb37-374"><a href="#cb37-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Time <span class="sc">&lt;</span> <span class="fl">2016.25</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-375"><a href="#cb37-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb37-376"><a href="#cb37-376" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(gdp_gap)</span>
<span id="cb37-377"><a href="#cb37-377" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb37-378"><a href="#cb37-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sd)</span>
<span id="cb37-379"><a href="#cb37-379" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-380"><a href="#cb37-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-381"><a href="#cb37-381" aria-hidden="true" tabindex="-1"></a>Wir nutzen nun <span class="in">`ggplot2::ggplot()`</span>, um den syntetischen Doppelg칛nger und das BIP f칲r Gro륵ritannien 칲ber den gesamten Zeitraum darzustellen. F칲r die Darstellung von Unsicherheit bei der Konstruktion des Doppelg칛ngers unterlegen wir die Doppelg칛nger-Zeitreihe mit einer Schattierung in der Breite der gesch칛tzten Standardabweichung von <span class="in">`r round(sd_gap, 2)`</span> f칲r die Periode vor dem Referendum.</span>
<span id="cb37-382"><a href="#cb37-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-385"><a href="#cb37-385" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-386"><a href="#cb37-386" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "UK-BIP und synthetischer Doppelg칛nger"</span></span>
<span id="cb37-387"><a href="#cb37-387" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ukuksdg</span></span>
<span id="cb37-388"><a href="#cb37-388" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb37-389"><a href="#cb37-389" aria-hidden="true" tabindex="-1"></a>  p_gdp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb37-390"><a href="#cb37-390" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1-SD-Band um das Doppelg칛nger-GDP</span></span>
<span id="cb37-391"><a href="#cb37-391" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(</span>
<span id="cb37-392"><a href="#cb37-392" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> the_gdps <span class="sc">%&gt;%</span> </span>
<span id="cb37-393"><a href="#cb37-393" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Doppelgaenger"</span>), </span>
<span id="cb37-394"><a href="#cb37-394" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb37-395"><a href="#cb37-395" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> Time, </span>
<span id="cb37-396"><a href="#cb37-396" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymin =</span> gdp <span class="sc">-</span> sd_gap, </span>
<span id="cb37-397"><a href="#cb37-397" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymax =</span> gdp <span class="sc">+</span> sd_gap</span>
<span id="cb37-398"><a href="#cb37-398" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb37-399"><a href="#cb37-399" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">"red"</span>, <span class="at">alpha =</span> .<span class="dv">2</span>), </span>
<span id="cb37-400"><a href="#cb37-400" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"white"</span></span>
<span id="cb37-401"><a href="#cb37-401" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-402"><a href="#cb37-402" aria-hidden="true" tabindex="-1"></a>    <span class="co"># UK- und Doppelg칛nger-GDP</span></span>
<span id="cb37-403"><a href="#cb37-403" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(</span>
<span id="cb37-404"><a href="#cb37-404" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> the_gdps, </span>
<span id="cb37-405"><a href="#cb37-405" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb37-406"><a href="#cb37-406" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> Time, </span>
<span id="cb37-407"><a href="#cb37-407" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> gdp, </span>
<span id="cb37-408"><a href="#cb37-408" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> type</span>
<span id="cb37-409"><a href="#cb37-409" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb37-410"><a href="#cb37-410" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">1</span></span>
<span id="cb37-411"><a href="#cb37-411" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-412"><a href="#cb37-412" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Brexit-Referendum</span></span>
<span id="cb37-413"><a href="#cb37-413" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(</span>
<span id="cb37-414"><a href="#cb37-414" aria-hidden="true" tabindex="-1"></a>      <span class="at">xintercept =</span> <span class="fl">2016.25</span>, </span>
<span id="cb37-415"><a href="#cb37-415" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="st">"dotted"</span></span>
<span id="cb37-416"><a href="#cb37-416" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-417"><a href="#cb37-417" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb37-418"><a href="#cb37-418" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Legende hinzuf칲gen</span></span>
<span id="cb37-419"><a href="#cb37-419" aria-hidden="true" tabindex="-1"></a>    cowplot<span class="sc">::</span><span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb37-420"><a href="#cb37-420" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">9</span>))  </span>
<span id="cb37-421"><a href="#cb37-421" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-422"><a href="#cb37-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-423"><a href="#cb37-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-424"><a href="#cb37-424" aria-hidden="true" tabindex="-1"></a>@fig-ukuksdg zeigt, dass der synthetische Doppelg칛nger 칲ber weite Teile der Vorperiode eine gute Anpassung an das beobachtete BIP von Gro륵ritannien aufweist, insbesondere f칲r den Zeitraum unmittelbar vor dem Brexit-Referendum. Nach dem Referendum zeigt sich bereits nach wenigen Quartalen eine deutliche Abweichung zwischen der gesch칛tzten und der beobachteten Trajektorie. Eine Beschr칛nkung der in <span class="in">`p_gdp`</span> verwendeten Datenpunkte auf einen Bereich nahe des Referendums best칛rkt diese Schlussfolgerung.</span>
<span id="cb37-425"><a href="#cb37-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-428"><a href="#cb37-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-429"><a href="#cb37-429" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "UK-BIP und synthetischer Doppelg칛nger -- Close-Up"</span></span>
<span id="cb37-430"><a href="#cb37-430" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ukuksdgclose</span></span>
<span id="cb37-431"><a href="#cb37-431" aria-hidden="true" tabindex="-1"></a><span class="co"># Close-up im Bereich des Referendums</span></span>
<span id="cb37-432"><a href="#cb37-432" aria-hidden="true" tabindex="-1"></a>p_gdp <span class="sc">+</span></span>
<span id="cb37-433"><a href="#cb37-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb37-434"><a href="#cb37-434" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2015</span>, <span class="dv">2021</span>), </span>
<span id="cb37-435"><a href="#cb37-435" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">1</span>)</span>
<span id="cb37-436"><a href="#cb37-436" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-437"><a href="#cb37-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">12</span>))</span>
<span id="cb37-438"><a href="#cb37-438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-439"><a href="#cb37-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-440"><a href="#cb37-440" aria-hidden="true" tabindex="-1"></a>In @fig-ukuksdg ist eine ab Mitte 2017 au른rhalb des Standardabweichungsbereichs verlaufende Divergenz der Zeitreihen zu erkennen. Diese stellen wir nachfolgend anhand der Doppelg칛nger-Gap mit <span class="in">`ggplot2::ggplot()`</span> dar.</span>
<span id="cb37-441"><a href="#cb37-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-444"><a href="#cb37-444" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-445"><a href="#cb37-445" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "UK-BIP und synthetischer Doppelg칛nger -- Doppelg칛nger-Gap"</span></span>
<span id="cb37-446"><a href="#cb37-446" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ukdggap</span></span>
<span id="cb37-447"><a href="#cb37-447" aria-hidden="true" tabindex="-1"></a><span class="co"># BIP-Doppelg칛nger-Gap</span></span>
<span id="cb37-448"><a href="#cb37-448" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gdp_gap) <span class="sc">+</span></span>
<span id="cb37-449"><a href="#cb37-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb37-450"><a href="#cb37-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb37-451"><a href="#cb37-451" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> gdp_gap),</span>
<span id="cb37-452"><a href="#cb37-452" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">1</span></span>
<span id="cb37-453"><a href="#cb37-453" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb37-454"><a href="#cb37-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb37-455"><a href="#cb37-455" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb37-456"><a href="#cb37-456" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> Time, </span>
<span id="cb37-457"><a href="#cb37-457" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> gdp_gap <span class="sc">-</span> sd_gap, </span>
<span id="cb37-458"><a href="#cb37-458" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> gdp_gap <span class="sc">+</span> sd_gap</span>
<span id="cb37-459"><a href="#cb37-459" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb37-460"><a href="#cb37-460" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">"darkgray"</span>, <span class="at">alpha =</span> .<span class="dv">2</span>), </span>
<span id="cb37-461"><a href="#cb37-461" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span></span>
<span id="cb37-462"><a href="#cb37-462" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-463"><a href="#cb37-463" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Referendum</span></span>
<span id="cb37-464"><a href="#cb37-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb37-465"><a href="#cb37-465" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="fl">2016.25</span>,</span>
<span id="cb37-466"><a href="#cb37-466" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="st">"dotted"</span></span>
<span id="cb37-467"><a href="#cb37-467" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-468"><a href="#cb37-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb37-469"><a href="#cb37-469" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">1</span>), </span>
<span id="cb37-470"><a href="#cb37-470" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2015</span>, <span class="dv">2021</span>)</span>
<span id="cb37-471"><a href="#cb37-471" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-472"><a href="#cb37-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb37-473"><a href="#cb37-473" aria-hidden="true" tabindex="-1"></a>  cowplot<span class="sc">::</span><span class="fu">theme_cowplot</span>()</span>
<span id="cb37-474"><a href="#cb37-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-475"><a href="#cb37-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-476"><a href="#cb37-476" aria-hidden="true" tabindex="-1"></a>Die in @fig-ukdggap gezeigte Doppelg칛nger-Gap stimmt gut mit dem von @Bornetal2019 gesch칛tzten verlorenen Wachstums des BIP relativ zu 2016 um bis zu 2.5\% bis Ende des Jahres 2018 칲berein.</span>
<span id="cb37-477"><a href="#cb37-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-478"><a href="#cb37-478" aria-hidden="true" tabindex="-1"></a>Als weiteres Ma f칲r den Effekt des Referendums im Folgezeitraum k칬nnen wir die mittlere Doppelg칛nger-Gap f칲r s칛mtliche Beobachtungsperioden nach dem Brexit-Referendum schnell bestimmen.</span>
<span id="cb37-479"><a href="#cb37-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-482"><a href="#cb37-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-483"><a href="#cb37-483" aria-hidden="true" tabindex="-1"></a><span class="co"># Mittlerer Unterschied nach dem Brexit-Referendum</span></span>
<span id="cb37-484"><a href="#cb37-484" aria-hidden="true" tabindex="-1"></a>gdp_gap <span class="sc">%&gt;%</span> </span>
<span id="cb37-485"><a href="#cb37-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Time <span class="sc">&gt;</span> <span class="fl">2016.25</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-486"><a href="#cb37-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gdp_gap) <span class="sc">%&gt;%</span> </span>
<span id="cb37-487"><a href="#cb37-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>()</span>
<span id="cb37-488"><a href="#cb37-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-489"><a href="#cb37-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-490"><a href="#cb37-490" aria-hidden="true" tabindex="-1"></a><span class="fu">### Placebo-Tests: Grafische Inferenz</span></span>
<span id="cb37-491"><a href="#cb37-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-492"><a href="#cb37-492" aria-hidden="true" tabindex="-1"></a>Auch f칲r SCM sind Placebo-Tests ein hilfreiches Instrument zur 칖berpr칲fung der G칲ltigkeit von Studienergebnissen. Eine gr칲ndliche Placebo-Analyse kann festzustellen, ob der beobachtete Effekt tats칛chlich auf die Intervention zur칲ckzuf칲hren ist und nicht auf unber칲cksichtigte (m칬glicherweise unbeobachtbare) Faktoren. </span>
<span id="cb37-493"><a href="#cb37-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-494"><a href="#cb37-494" aria-hidden="true" tabindex="-1"></a>Ein Ansatz ist hierf칲r ist es, den synthetische-Doppelg칛nger f칲r *fiktive Interventionszeitpunkte* vor dem tats칛chlichen Behandlungszeitpunkt zu konstruieren, und die entsprechenden Trajektorien mit dem urspr칲nglichen Doppelg칛nger zu vergleichen. So kann die Validit칛t der urspr칲nglichen Doppelg칛nger-Trajektorie im Hinblick auf m칬gliche anderweitige Ereignisse vor der Intervention gepr칲ft werden: Doppelg칛nger-Trajektorien f칲r fiktive, fr칲here Interventionen sollten sich nicht systematisch von der andhand von Daten bis zur tats칛chlichen Intervention berechneten Trajektorie unterscheiden.</span>
<span id="cb37-495"><a href="#cb37-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-496"><a href="#cb37-496" aria-hidden="true" tabindex="-1"></a>Wir definieren hierzu eine Funktion <span class="in">`placebo()`</span>, die einen syntethischen Doppelg칛nger des BIP Gro륵ritanniens mit Gewichten auf Basis eines vorgegebenen Interventionszeitpunktes (<span class="in">`treat`</span>) zur칲ckgibt. Abgesehen vom fr칲heren Interventionszeitpunkt (und der damit einhergehenden verkleinerten Stichprobe) erfolgt die Berechnung der Gewichte mit derselben Spezifikation wie zuvor.</span>
<span id="cb37-497"><a href="#cb37-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-500"><a href="#cb37-500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-501"><a href="#cb37-501" aria-hidden="true" tabindex="-1"></a><span class="co"># Funktion f칲r Placebo-Doppelg칛nger:</span></span>
<span id="cb37-502"><a href="#cb37-502" aria-hidden="true" tabindex="-1"></a><span class="co"># Fiktive fr칲here Intervention</span></span>
<span id="cb37-503"><a href="#cb37-503" aria-hidden="true" tabindex="-1"></a>placebo <span class="ot">&lt;-</span> <span class="cf">function</span>(treat) {</span>
<span id="cb37-504"><a href="#cb37-504" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-505"><a href="#cb37-505" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Datenvorbereitung f칲r fiktives Datum 'treat'</span></span>
<span id="cb37-506"><a href="#cb37-506" aria-hidden="true" tabindex="-1"></a>  dataprep_out <span class="ot">&lt;-</span> <span class="fu">dataprep</span>(</span>
<span id="cb37-507"><a href="#cb37-507" aria-hidden="true" tabindex="-1"></a>    <span class="at">foo =</span> brexit, </span>
<span id="cb37-508"><a href="#cb37-508" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictors =</span> <span class="fu">c</span>(</span>
<span id="cb37-509"><a href="#cb37-509" aria-hidden="true" tabindex="-1"></a>      <span class="st">"ConGDP"</span>, <span class="st">"InvGDP"</span>,</span>
<span id="cb37-510"><a href="#cb37-510" aria-hidden="true" tabindex="-1"></a>      <span class="st">"ExpGDP"</span>, <span class="st">"ImpGDP"</span>,</span>
<span id="cb37-511"><a href="#cb37-511" aria-hidden="true" tabindex="-1"></a>      <span class="st">"LPG"</span>, <span class="st">"EmpSha"</span></span>
<span id="cb37-512"><a href="#cb37-512" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb37-513"><a href="#cb37-513" aria-hidden="true" tabindex="-1"></a>    <span class="at">dependent =</span> <span class="st">"gdp"</span>, </span>
<span id="cb37-514"><a href="#cb37-514" aria-hidden="true" tabindex="-1"></a>    <span class="at">unit.variable =</span> <span class="st">"ID"</span>,</span>
<span id="cb37-515"><a href="#cb37-515" aria-hidden="true" tabindex="-1"></a>    <span class="at">time.variable =</span> <span class="st">"Time"</span>, </span>
<span id="cb37-516"><a href="#cb37-516" aria-hidden="true" tabindex="-1"></a>    <span class="at">treatment.identifier =</span> <span class="dv">23</span>, </span>
<span id="cb37-517"><a href="#cb37-517" aria-hidden="true" tabindex="-1"></a>    <span class="at">controls.identifier =</span> (brexit<span class="sc">$</span>ID <span class="sc">%&gt;%</span> <span class="fu">unique</span>())[<span class="sc">-</span><span class="dv">23</span>], </span>
<span id="cb37-518"><a href="#cb37-518" aria-hidden="true" tabindex="-1"></a>    <span class="at">time.predictors.prior =</span> <span class="fu">seq</span>(<span class="dv">1995</span>, treat, .<span class="dv">25</span>),</span>
<span id="cb37-519"><a href="#cb37-519" aria-hidden="true" tabindex="-1"></a>    <span class="at">time.optimize.ssr =</span> <span class="fu">seq</span>(<span class="dv">1995</span>, treat, .<span class="dv">25</span>),</span>
<span id="cb37-520"><a href="#cb37-520" aria-hidden="true" tabindex="-1"></a>    <span class="at">unit.names.variable =</span> <span class="st">"Country"</span></span>
<span id="cb37-521"><a href="#cb37-521" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-522"><a href="#cb37-522" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-523"><a href="#cb37-523" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Doppelg칛nger bestimmen</span></span>
<span id="cb37-524"><a href="#cb37-524" aria-hidden="true" tabindex="-1"></a>  synth_out <span class="ot">&lt;-</span> <span class="fu">quietly</span>(synth)(dataprep_out)<span class="sc">$</span>result</span>
<span id="cb37-525"><a href="#cb37-525" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-526"><a href="#cb37-526" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ergebnisse auslesen</span></span>
<span id="cb37-527"><a href="#cb37-527" aria-hidden="true" tabindex="-1"></a>  tb <span class="ot">&lt;-</span> <span class="fu">synth.tab</span>(</span>
<span id="cb37-528"><a href="#cb37-528" aria-hidden="true" tabindex="-1"></a>    <span class="at">synth.res =</span> synth_out, </span>
<span id="cb37-529"><a href="#cb37-529" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataprep.res =</span> dataprep_out</span>
<span id="cb37-530"><a href="#cb37-530" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-531"><a href="#cb37-531" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-532"><a href="#cb37-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb37-533"><a href="#cb37-533" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-534"><a href="#cb37-534" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Doppelg칛nger konstruieren </span></span>
<span id="cb37-535"><a href="#cb37-535" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(</span>
<span id="cb37-536"><a href="#cb37-536" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> brexit, </span>
<span id="cb37-537"><a href="#cb37-537" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> tb<span class="sc">$</span>tab.w, </span>
<span id="cb37-538"><a href="#cb37-538" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Country"</span> <span class="ot">=</span> <span class="st">"unit.names"</span>)</span>
<span id="cb37-539"><a href="#cb37-539" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb37-540"><a href="#cb37-540" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(Time, Country, gdp, w.weights) <span class="sc">%&gt;%</span></span>
<span id="cb37-541"><a href="#cb37-541" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb37-542"><a href="#cb37-542" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(</span>
<span id="cb37-543"><a href="#cb37-543" aria-hidden="true" tabindex="-1"></a>        <span class="at">gdp =</span> <span class="fu">sum</span>(gdp <span class="sc">*</span> w.weights, <span class="at">na.rm =</span> T)</span>
<span id="cb37-544"><a href="#cb37-544" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb37-545"><a href="#cb37-545" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">paste0</span>(<span class="st">"Placebo"</span>, treat))  </span>
<span id="cb37-546"><a href="#cb37-546" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-547"><a href="#cb37-547" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-548"><a href="#cb37-548" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-549"><a href="#cb37-549" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-550"><a href="#cb37-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-551"><a href="#cb37-551" aria-hidden="true" tabindex="-1"></a>Wie in @Bornetal2019 berechnen wir nun 12 Placebo-Doppelg칛nger des BIP von Gro륵ritannien f칲r fiktive Zeitpunkte eines Referendums 칲ber s칛mtliche Quartale im Zeitraum 2010-Q1 bis 2016-Q1. Dies ist komfortabel durch Iteration von <span class="in">`placebo()`</span> 칲ber diese Zeitpunkte mit <span class="in">`purrr::map_dfr()`</span> umsetzbar.</span>
<span id="cb37-552"><a href="#cb37-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-555"><a href="#cb37-555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-556"><a href="#cb37-556" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb37-557"><a href="#cb37-557" aria-hidden="true" tabindex="-1"></a><span class="co"># Iteration 칲ber fiktive fr칲here Referenden</span></span>
<span id="cb37-558"><a href="#cb37-558" aria-hidden="true" tabindex="-1"></a>placebos_tbl <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb37-559"><a href="#cb37-559" aria-hidden="true" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">seq</span>(<span class="dv">2010</span>, <span class="dv">2016</span>, .<span class="dv">25</span>), </span>
<span id="cb37-560"><a href="#cb37-560" aria-hidden="true" tabindex="-1"></a>  <span class="at">.f =</span>  \(x) <span class="fu">placebo</span>(x) </span>
<span id="cb37-561"><a href="#cb37-561" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-562"><a href="#cb37-562" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-563"><a href="#cb37-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-564"><a href="#cb37-564" aria-hidden="true" tabindex="-1"></a><span class="in">`placebos_tbl`</span> ist ein <span class="in">`tibble`</span>-Objekt im tidy-Format. Wir k칬nnen die Placebo-Doppelg칛nger sowie den urspr칲nglich berechneten Doppelg칛nger und das tats칛chliche BIP also 칛hnlich wie in @fig-ukuksdg mit <span class="in">`ggplot2::ggplot()`</span> darstellen.</span>
<span id="cb37-565"><a href="#cb37-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-568"><a href="#cb37-568" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-569"><a href="#cb37-569" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Placebo-Doppelg칛nger"</span></span>
<span id="cb37-570"><a href="#cb37-570" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pdgukbip</span></span>
<span id="cb37-571"><a href="#cb37-571" aria-hidden="true" tabindex="-1"></a><span class="co"># Vergleich mit Placebo-Doppelg칛nger</span></span>
<span id="cb37-572"><a href="#cb37-572" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb37-573"><a href="#cb37-573" aria-hidden="true" tabindex="-1"></a>  p_UKDG <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb37-574"><a href="#cb37-574" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> placebos_tbl,</span>
<span id="cb37-575"><a href="#cb37-575" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb37-576"><a href="#cb37-576" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> Time, </span>
<span id="cb37-577"><a href="#cb37-577" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> gdp, </span>
<span id="cb37-578"><a href="#cb37-578" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> type</span>
<span id="cb37-579"><a href="#cb37-579" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-580"><a href="#cb37-580" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-581"><a href="#cb37-581" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Placebos (mit jitter)</span></span>
<span id="cb37-582"><a href="#cb37-582" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(</span>
<span id="cb37-583"><a href="#cb37-583" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> .<span class="dv">25</span>, </span>
<span id="cb37-584"><a href="#cb37-584" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"gray80"</span>,</span>
<span id="cb37-585"><a href="#cb37-585" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">height =</span> .<span class="dv">25</span>)</span>
<span id="cb37-586"><a href="#cb37-586" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-587"><a href="#cb37-587" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Urspr칲nglicher Doppelg칛nger</span></span>
<span id="cb37-588"><a href="#cb37-588" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(</span>
<span id="cb37-589"><a href="#cb37-589" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> the_gdps <span class="sc">%&gt;%</span> </span>
<span id="cb37-590"><a href="#cb37-590" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Doppelgaenger"</span>), </span>
<span id="cb37-591"><a href="#cb37-591" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">col =</span> type), </span>
<span id="cb37-592"><a href="#cb37-592" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">1</span></span>
<span id="cb37-593"><a href="#cb37-593" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-594"><a href="#cb37-594" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Beobachtetes BIP</span></span>
<span id="cb37-595"><a href="#cb37-595" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(</span>
<span id="cb37-596"><a href="#cb37-596" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> the_gdps <span class="sc">%&gt;%</span> </span>
<span id="cb37-597"><a href="#cb37-597" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"UK"</span>), </span>
<span id="cb37-598"><a href="#cb37-598" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">col =</span> type), </span>
<span id="cb37-599"><a href="#cb37-599" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">1</span></span>
<span id="cb37-600"><a href="#cb37-600" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-601"><a href="#cb37-601" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Intikator f칲r Referendum</span></span>
<span id="cb37-602"><a href="#cb37-602" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">2016.25</span>, <span class="at">lty =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb37-603"><a href="#cb37-603" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Formatierung</span></span>
<span id="cb37-604"><a href="#cb37-604" aria-hidden="true" tabindex="-1"></a>    cowplot<span class="sc">::</span><span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb37-605"><a href="#cb37-605" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">9</span>))</span>
<span id="cb37-606"><a href="#cb37-606" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-607"><a href="#cb37-607" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-608"><a href="#cb37-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-611"><a href="#cb37-611" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-612"><a href="#cb37-612" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Placebo-Doppelg칛nger -- Close-Up"</span></span>
<span id="cb37-613"><a href="#cb37-613" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pdgukbipcu</span></span>
<span id="cb37-614"><a href="#cb37-614" aria-hidden="true" tabindex="-1"></a><span class="co"># Close-up bei Referendum</span></span>
<span id="cb37-615"><a href="#cb37-615" aria-hidden="true" tabindex="-1"></a>p_UKDG <span class="sc">+</span></span>
<span id="cb37-616"><a href="#cb37-616" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(</span>
<span id="cb37-617"><a href="#cb37-617" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2015</span>, <span class="dv">2021</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">05</span>)</span>
<span id="cb37-618"><a href="#cb37-618" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-619"><a href="#cb37-619" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(</span>
<span id="cb37-620"><a href="#cb37-620" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">13</span>),  <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb37-621"><a href="#cb37-621" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-622"><a href="#cb37-622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-623"><a href="#cb37-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-624"><a href="#cb37-624" aria-hidden="true" tabindex="-1"></a>Beachte, dass <span class="in">`position = position_jitter(height = .25)`</span> eine zuf칛llige, kleine Verschiebung (jitter) der Trajektorien der Placebo-Doppelg칛nger f칲r eine bessere Unterscheidbarkeit bewirkt. @fig-pdgukbip und @fig-pdgukbipcu zeigen, dass sich die Placebo-Pfade f칲r fiktive fr칲here Referenden (grau) nicht systematisch vom urspr칲nglich berechneten synthetischen Doppelg칛nger (rot) unterscheiden. Insbesondere finden wir keinen R칲ckgang der synthetischen BIP relativ zum beobachteten BIP f칲r Gro륵ritannien *vor* dem Referendum. Deutliche Abweichungen vom tats칛chlichen BIP ergeben sich erst jenseits der tats칛chlichen Referendums. Diese Placebo-Analyse bekr칛ftigt also die Validit칛t der Konstruktion des "Benchmark-Doppelg칛ngers" f칲r die Periode bis 2016-Q2 und die Sch칛tzung des kausalen Effekts des Referendums anhand der entsprechenden Doppelg칛nger-Gap.</span>
<span id="cb37-625"><a href="#cb37-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-626"><a href="#cb37-626" aria-hidden="true" tabindex="-1"></a>Ein weiterer Placebo-Test in @Bornetal2019 ist ein Vergleich der Doppelg칛nger-Gap Gro륵ritanniens mit Doppelg칛nger-Gaps f칲r fiktive Referenden in 2016-Q2 in L칛ndern mit wesentlichem Einfluss bei der Konstruktion des synthetischen Doppelg칛ngers f칲r Gro륵ritannien: Die Sch칛tzung des kausalen Effekts des Referendums auf das BIP in Gro륵ritannien ist glaubw칲rdig, wenn lediglich die Doppelg칛nger-Gap f칲r Gro륵ritannien durch das Referendum beeinflusst wird, *nicht* aber die Doppelg칛nger-Gaps f칲r L칛nder in der Kontrollgruppe. </span>
<span id="cb37-627"><a href="#cb37-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-628"><a href="#cb37-628" aria-hidden="true" tabindex="-1"></a>F칲r diese grafische Placebo-Analyse modifizieren wir die Funktion <span class="in">`placebo()`</span> entsprechend. <span class="in">`placebo_gap()`</span> berechnet die Doppelg칛nger-Gap f칲r das mit <span class="in">`treat`</span> identifizierte Land. Das <span class="in">`if`</span>-Statement zu Beginn stellt sicher, dass Gro륵ritannien *nicht* als Kontroll-Einheit f칲r die Placebo-Gaps verwendet wird. </span>
<span id="cb37-629"><a href="#cb37-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-632"><a href="#cb37-632" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-633"><a href="#cb37-633" aria-hidden="true" tabindex="-1"></a><span class="co"># Funktion f칲r Placebo-Gaps</span></span>
<span id="cb37-634"><a href="#cb37-634" aria-hidden="true" tabindex="-1"></a>placebo_gap <span class="ot">&lt;-</span> <span class="cf">function</span>(treat) {</span>
<span id="cb37-635"><a href="#cb37-635" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-636"><a href="#cb37-636" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Kontrollgruppe definieren</span></span>
<span id="cb37-637"><a href="#cb37-637" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(treat <span class="sc">!=</span> <span class="dv">23</span>) {</span>
<span id="cb37-638"><a href="#cb37-638" aria-hidden="true" tabindex="-1"></a>    controls <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">23</span>, treat)]</span>
<span id="cb37-639"><a href="#cb37-639" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb37-640"><a href="#cb37-640" aria-hidden="true" tabindex="-1"></a>    controls <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>)[<span class="sc">-</span><span class="dv">23</span>]</span>
<span id="cb37-641"><a href="#cb37-641" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-642"><a href="#cb37-642" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-643"><a href="#cb37-643" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Daten vorbereiten</span></span>
<span id="cb37-644"><a href="#cb37-644" aria-hidden="true" tabindex="-1"></a>  dataprep_out <span class="ot">&lt;-</span> <span class="fu">dataprep</span>(</span>
<span id="cb37-645"><a href="#cb37-645" aria-hidden="true" tabindex="-1"></a>    <span class="at">foo =</span> brexit, </span>
<span id="cb37-646"><a href="#cb37-646" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictors =</span> <span class="fu">c</span>(</span>
<span id="cb37-647"><a href="#cb37-647" aria-hidden="true" tabindex="-1"></a>      <span class="st">"ConGDP"</span>, <span class="st">"InvGDP"</span>,</span>
<span id="cb37-648"><a href="#cb37-648" aria-hidden="true" tabindex="-1"></a>      <span class="st">"ExpGDP"</span>, <span class="st">"ImpGDP"</span>,</span>
<span id="cb37-649"><a href="#cb37-649" aria-hidden="true" tabindex="-1"></a>      <span class="st">"LPG"</span>, <span class="st">"EmpSha"</span></span>
<span id="cb37-650"><a href="#cb37-650" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb37-651"><a href="#cb37-651" aria-hidden="true" tabindex="-1"></a>    <span class="at">dependent =</span> <span class="st">"gdp"</span>, </span>
<span id="cb37-652"><a href="#cb37-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">unit.variable =</span> <span class="st">"ID"</span>,</span>
<span id="cb37-653"><a href="#cb37-653" aria-hidden="true" tabindex="-1"></a>    <span class="at">time.variable =</span> <span class="st">"Time"</span>, </span>
<span id="cb37-654"><a href="#cb37-654" aria-hidden="true" tabindex="-1"></a>    <span class="at">treatment.identifier =</span> treat, </span>
<span id="cb37-655"><a href="#cb37-655" aria-hidden="true" tabindex="-1"></a>    <span class="at">controls.identifier =</span> controls, </span>
<span id="cb37-656"><a href="#cb37-656" aria-hidden="true" tabindex="-1"></a>    <span class="at">time.predictors.prior =</span> <span class="fu">seq</span>(<span class="dv">1995</span>, <span class="fl">2016.25</span>, .<span class="dv">25</span>),</span>
<span id="cb37-657"><a href="#cb37-657" aria-hidden="true" tabindex="-1"></a>    <span class="at">time.optimize.ssr =</span> <span class="fu">seq</span>(<span class="dv">1995</span>, <span class="fl">2016.25</span>, .<span class="dv">25</span>),</span>
<span id="cb37-658"><a href="#cb37-658" aria-hidden="true" tabindex="-1"></a>    <span class="at">unit.names.variable =</span> <span class="st">"Country"</span></span>
<span id="cb37-659"><a href="#cb37-659" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-660"><a href="#cb37-660" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-661"><a href="#cb37-661" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Gewichte bestimmen</span></span>
<span id="cb37-662"><a href="#cb37-662" aria-hidden="true" tabindex="-1"></a>  synth_out <span class="ot">&lt;-</span> <span class="fu">quietly</span>(synth)(dataprep_out)<span class="sc">$</span>result</span>
<span id="cb37-663"><a href="#cb37-663" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-664"><a href="#cb37-664" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ergebnisse zusammenfassen</span></span>
<span id="cb37-665"><a href="#cb37-665" aria-hidden="true" tabindex="-1"></a>  tb <span class="ot">&lt;-</span> <span class="fu">synth.tab</span>(</span>
<span id="cb37-666"><a href="#cb37-666" aria-hidden="true" tabindex="-1"></a>    <span class="at">synth.res =</span> synth_out, </span>
<span id="cb37-667"><a href="#cb37-667" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataprep.res =</span> dataprep_out</span>
<span id="cb37-668"><a href="#cb37-668" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-669"><a href="#cb37-669" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-670"><a href="#cb37-670" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Doppelg칛nger bestimmen</span></span>
<span id="cb37-671"><a href="#cb37-671" aria-hidden="true" tabindex="-1"></a>  doppel <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb37-672"><a href="#cb37-672" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> brexit, </span>
<span id="cb37-673"><a href="#cb37-673" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> tb<span class="sc">$</span>tab.w, </span>
<span id="cb37-674"><a href="#cb37-674" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Country"</span> <span class="ot">=</span> <span class="st">"unit.names"</span>)</span>
<span id="cb37-675"><a href="#cb37-675" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb37-676"><a href="#cb37-676" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Time, gdp, Country, w.weights) <span class="sc">%&gt;%</span></span>
<span id="cb37-677"><a href="#cb37-677" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb37-678"><a href="#cb37-678" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb37-679"><a href="#cb37-679" aria-hidden="true" tabindex="-1"></a>      <span class="at">gdp_synth =</span> <span class="fu">sum</span>(gdp <span class="sc">*</span> w.weights, <span class="at">na.rm =</span> T), </span>
<span id="cb37-680"><a href="#cb37-680" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-681"><a href="#cb37-681" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-682"><a href="#cb37-682" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Beobachtetes BIP auslesen</span></span>
<span id="cb37-683"><a href="#cb37-683" aria-hidden="true" tabindex="-1"></a>  gdp <span class="ot">&lt;-</span> brexit <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ID <span class="sc">==</span> treat) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gdp)</span>
<span id="cb37-684"><a href="#cb37-684" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-685"><a href="#cb37-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb37-686"><a href="#cb37-686" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-687"><a href="#cb37-687" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Doppelg칛nger-Gap berechnen</span></span>
<span id="cb37-688"><a href="#cb37-688" aria-hidden="true" tabindex="-1"></a>    doppel <span class="sc">%&gt;%</span> </span>
<span id="cb37-689"><a href="#cb37-689" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb37-690"><a href="#cb37-690" aria-hidden="true" tabindex="-1"></a>        <span class="at">ID =</span> treat,</span>
<span id="cb37-691"><a href="#cb37-691" aria-hidden="true" tabindex="-1"></a>        <span class="at">gdp =</span> gdp,</span>
<span id="cb37-692"><a href="#cb37-692" aria-hidden="true" tabindex="-1"></a>        <span class="at">gdp_gap =</span> gdp <span class="sc">-</span> gdp_synth</span>
<span id="cb37-693"><a href="#cb37-693" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb37-694"><a href="#cb37-694" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-695"><a href="#cb37-695" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-696"><a href="#cb37-696" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-697"><a href="#cb37-697" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-698"><a href="#cb37-698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-699"><a href="#cb37-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-700"><a href="#cb37-700" aria-hidden="true" tabindex="-1"></a>F칲r die Berechnung der Placebo-Gaps iterieren wir 칲ber die Indizes der in @tbl-brexitcw gelisteten Volkswirtschaften der Kontrollgruppe f칲r Gro륵ritannien. </span>
<span id="cb37-701"><a href="#cb37-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-704"><a href="#cb37-704" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-705"><a href="#cb37-705" aria-hidden="true" tabindex="-1"></a><span class="co"># Indizes f칲r "Donor Countries" und UK</span></span>
<span id="cb37-706"><a href="#cb37-706" aria-hidden="true" tabindex="-1"></a>donors_and_UK <span class="ot">&lt;-</span> brexit <span class="sc">%&gt;%</span> </span>
<span id="cb37-707"><a href="#cb37-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Country) <span class="sc">%&gt;%</span> </span>
<span id="cb37-708"><a href="#cb37-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-709"><a href="#cb37-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb37-710"><a href="#cb37-710" aria-hidden="true" tabindex="-1"></a>    Country <span class="sc">%in%</span> </span>
<span id="cb37-711"><a href="#cb37-711" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb37-712"><a href="#cb37-712" aria-hidden="true" tabindex="-1"></a>        <span class="st">"United States"</span>, <span class="st">"Italy"</span>, <span class="st">"Iceland"</span>, </span>
<span id="cb37-713"><a href="#cb37-713" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Luxembourg"</span>, <span class="st">"Germany"</span>, <span class="st">"United Kingdom"</span></span>
<span id="cb37-714"><a href="#cb37-714" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb37-715"><a href="#cb37-715" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb37-716"><a href="#cb37-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(ID)</span>
<span id="cb37-717"><a href="#cb37-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-718"><a href="#cb37-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-721"><a href="#cb37-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-722"><a href="#cb37-722" aria-hidden="true" tabindex="-1"></a><span class="co"># Placebo-Doppelg칛nger-Gaps berechnen</span></span>
<span id="cb37-723"><a href="#cb37-723" aria-hidden="true" tabindex="-1"></a>placebo_gaps_tbl <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb37-724"><a href="#cb37-724" aria-hidden="true" tabindex="-1"></a>  <span class="at">.x =</span> donors_and_UK, </span>
<span id="cb37-725"><a href="#cb37-725" aria-hidden="true" tabindex="-1"></a>  <span class="at">.f =</span>  \(x) <span class="fu">placebo_gap</span>(x) </span>
<span id="cb37-726"><a href="#cb37-726" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-727"><a href="#cb37-727" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-728"><a href="#cb37-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-729"><a href="#cb37-729" aria-hidden="true" tabindex="-1"></a>F칲r die grafische Darstellung erg칛nzen wir die Variable <span class="in">`Country`</span> zur Unterscheidung der Doppelg칛nger-Gaps f칲r Gro륵ritannien und die Kontroll-L칛nder.</span>
<span id="cb37-730"><a href="#cb37-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-733"><a href="#cb37-733" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-734"><a href="#cb37-734" aria-hidden="true" tabindex="-1"></a><span class="co"># ID-Variable f칲r UK und Kontroll-L칛nder</span></span>
<span id="cb37-735"><a href="#cb37-735" aria-hidden="true" tabindex="-1"></a>placebo_gaps_tbl <span class="ot">&lt;-</span> placebo_gaps_tbl <span class="sc">%&gt;%</span></span>
<span id="cb37-736"><a href="#cb37-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-737"><a href="#cb37-737" aria-hidden="true" tabindex="-1"></a>    <span class="at">Country =</span> <span class="fu">ifelse</span>(ID <span class="sc">==</span> <span class="dv">23</span>, <span class="st">"UK"</span>, <span class="st">"else"</span>)</span>
<span id="cb37-738"><a href="#cb37-738" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-739"><a href="#cb37-739" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-740"><a href="#cb37-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-741"><a href="#cb37-741" aria-hidden="true" tabindex="-1"></a>Um die Vergleichbarkeit der Doppelg칛nger-Gaps zu gew칛hrleisten, standardisieren @Bornetal2019 die Sch칛tzungen der Gaps anhand der jeweiligen Mittelwerte f칲r das Jahr 2015 und der Standardabweichungen im Zeitraum vor dem Brexit-Referendum. Wir berechnen diese Statistiken zun칛chst.</span>
<span id="cb37-742"><a href="#cb37-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-745"><a href="#cb37-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-746"><a href="#cb37-746" aria-hidden="true" tabindex="-1"></a><span class="co"># Mittelwerte f칲r 2015</span></span>
<span id="cb37-747"><a href="#cb37-747" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> placebo_gaps_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb37-748"><a href="#cb37-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb37-749"><a href="#cb37-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(Time, <span class="dv">2015</span>, <span class="fl">2015.75</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-750"><a href="#cb37-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb37-751"><a href="#cb37-751" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean2015 =</span> <span class="fu">mean</span>(gdp_gap)</span>
<span id="cb37-752"><a href="#cb37-752" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-753"><a href="#cb37-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-754"><a href="#cb37-754" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardabweichungen vor Referendum</span></span>
<span id="cb37-755"><a href="#cb37-755" aria-hidden="true" tabindex="-1"></a>sds <span class="ot">&lt;-</span> placebo_gaps_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb37-756"><a href="#cb37-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb37-757"><a href="#cb37-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Time <span class="sc">&lt;</span> <span class="fl">2016.25</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-758"><a href="#cb37-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb37-759"><a href="#cb37-759" aria-hidden="true" tabindex="-1"></a>    <span class="at">thesd =</span> <span class="fu">sd</span>(gdp_gap)</span>
<span id="cb37-760"><a href="#cb37-760" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-761"><a href="#cb37-761" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-762"><a href="#cb37-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-763"><a href="#cb37-763" aria-hidden="true" tabindex="-1"></a>Mit <span class="in">`dplyr::left_join()`</span> f칲hren wir diese Statistiken mit <span class="in">`placebo_gaps_tbl`</span> zusammen und berechnen die standardisierten Doppelg칛nger-Gaps.</span>
<span id="cb37-764"><a href="#cb37-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-767"><a href="#cb37-767" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-768"><a href="#cb37-768" aria-hidden="true" tabindex="-1"></a><span class="co"># Join + Standardisierung</span></span>
<span id="cb37-769"><a href="#cb37-769" aria-hidden="true" tabindex="-1"></a>placebo_gaps_std <span class="ot">&lt;-</span> </span>
<span id="cb37-770"><a href="#cb37-770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(placebo_gaps_tbl, means) <span class="sc">%&gt;%</span> </span>
<span id="cb37-771"><a href="#cb37-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sds) <span class="sc">%&gt;%</span></span>
<span id="cb37-772"><a href="#cb37-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp_gap_std =</span> (gdp_gap <span class="sc">-</span> mean2015)<span class="sc">/</span>thesd)</span>
<span id="cb37-773"><a href="#cb37-773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-774"><a href="#cb37-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-775"><a href="#cb37-775" aria-hidden="true" tabindex="-1"></a>Analog zum Code f칲r @fig-ukdggap plotten wir die Placebo-Gap-Zeitreihen mit <span class="in">`ggplot2::ggplot()`</span>.</span>
<span id="cb37-776"><a href="#cb37-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-779"><a href="#cb37-779" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-780"><a href="#cb37-780" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Placebo- und UK-Doppelg칛nger-Gaps"</span></span>
<span id="cb37-781"><a href="#cb37-781" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pdgukg</span></span>
<span id="cb37-782"><a href="#cb37-782" aria-hidden="true" tabindex="-1"></a><span class="co"># Placebo-Gaps mit UK-Gap vergleichen</span></span>
<span id="cb37-783"><a href="#cb37-783" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb37-784"><a href="#cb37-784" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> placebo_gaps_std,</span>
<span id="cb37-785"><a href="#cb37-785" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb37-786"><a href="#cb37-786" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> Time, </span>
<span id="cb37-787"><a href="#cb37-787" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> gdp_gap_std,</span>
<span id="cb37-788"><a href="#cb37-788" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> ID,</span>
<span id="cb37-789"><a href="#cb37-789" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> Country,</span>
<span id="cb37-790"><a href="#cb37-790" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> Country</span>
<span id="cb37-791"><a href="#cb37-791" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-792"><a href="#cb37-792" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb37-793"><a href="#cb37-793" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Hilfslinie bei Differenz = 0</span></span>
<span id="cb37-794"><a href="#cb37-794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb37-795"><a href="#cb37-795" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Gaps</span></span>
<span id="cb37-796"><a href="#cb37-796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb37-797"><a href="#cb37-797" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Referendum</span></span>
<span id="cb37-798"><a href="#cb37-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">2016.25</span>, <span class="at">lty =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb37-799"><a href="#cb37-799" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Formatierung</span></span>
<span id="cb37-800"><a href="#cb37-800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb37-801"><a href="#cb37-801" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"UK"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"else"</span> <span class="ot">=</span> <span class="fu">alpha</span>(<span class="st">"darkgray"</span>, .<span class="dv">5</span>))</span>
<span id="cb37-802"><a href="#cb37-802" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-803"><a href="#cb37-803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linewidth_manual</span>(</span>
<span id="cb37-804"><a href="#cb37-804" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"UK"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"else"</span> <span class="ot">=</span> .<span class="dv">5</span>)</span>
<span id="cb37-805"><a href="#cb37-805" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-806"><a href="#cb37-806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb37-807"><a href="#cb37-807" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2015</span>, <span class="dv">2021</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">05</span>)</span>
<span id="cb37-808"><a href="#cb37-808" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-809"><a href="#cb37-809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb37-810"><a href="#cb37-810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">9</span>))</span>
<span id="cb37-811"><a href="#cb37-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-812"><a href="#cb37-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-813"><a href="#cb37-813" aria-hidden="true" tabindex="-1"></a>@fig-pdgukg zeigt die standardisierten Placebo-Doppelg칛nger-Gaps f칲r ein fiktives Referendum zum Zeitpunkt 2016-Q2 in den 5 Kontroll-Volkswirtschaften, die f칲r Konstruktion des BIP-Doppelg칛ngers von Gro륵rittannien relevant sind (grau). Der Vergleich mit der standardisierten Doppelg칛nger-Gap f칲r Gro륵ritannien (blau). Der Verlauf der Placebo-Gaps zeigt an, dass keine Abweichungen mit negativem Trend von der Referenzlinie bei 0 (kein Unterschied zwischen beobachtetem und syntetischem BIP) nach dem Referendum vorliegen. Damit liefert die Grafik keine Hinweise auf einen  Effekt fiktiver Interventionen in den Kontroll-L칛ndern. F칲r Gro륵ritannien jedoch ist, 칛hnlich wie in @fig-ukdggap, ein negativer Trend nach dem Referendum deutlich erkennbar.</span>
<span id="cb37-814"><a href="#cb37-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-815"><a href="#cb37-815" aria-hidden="true" tabindex="-1"></a><span class="fu">### Statistische Inferenz</span></span>
<span id="cb37-816"><a href="#cb37-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-817"><a href="#cb37-817" aria-hidden="true" tabindex="-1"></a>Die bisherigen Placebo-Tests liefern lediglich grafische Evidenz f칲r die Signifikanz des negativen Effekts des Brexit-Referendums auf die Britische Volkswirtschaft. Methoden f칲r statistische Inferenz f칲r SCM sind Gegenstand aktueller Forschung. @Bornetal2019 verwenden den End-Of-Sample Instability Test ($S$) von @Andrews2003. Dieses Verfahren kann f칲r einen Test auf einen Strukturbruch gegen Ende einer Zeitreihe verwendet werden. In der vorliegende Studie wird der Test angewendet, um zu 칲berpr칲fen, ob die Verteilung der Doppelg칛nger-Gap Gro륵ritanniens f칲r die letzen $m$ Perioden jenseits des Referendums signifikant verschieden ist von Verteilung vorheriger Perioden.</span>
<span id="cb37-818"><a href="#cb37-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-819"><a href="#cb37-819" aria-hidden="true" tabindex="-1"></a>Wir zeigen nachfolgend, wie diese Analyse in R mit der Funktion <span class="in">`CPAT::Andrews.test()`</span> aus dem Paket <span class="in">`CPAT`</span> durchgef칲hrt werden kann. Wir testen zun칛chst auf eine signifikante Diskrepanz der Doppelg칛nger-Gap in Form eines Sturkturbruchs ab 2017 und fassen die Ergebnisse tabellarisch mit <span class="in">`broom::tidy()`</span> und <span class="in">`gt::gt()`</span> zusammen.</span>
<span id="cb37-820"><a href="#cb37-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-823"><a href="#cb37-823" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-824"><a href="#cb37-824" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Andrews' (1993) End-of-Sample Instability Test"</span></span>
<span id="cb37-825"><a href="#cb37-825" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-growthpdssek</span></span>
<span id="cb37-826"><a href="#cb37-826" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CPAT)</span>
<span id="cb37-827"><a href="#cb37-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-828"><a href="#cb37-828" aria-hidden="true" tabindex="-1"></a><span class="co"># Andrews' (2003) Test f칲r 2017 durchf칲hren</span></span>
<span id="cb37-829"><a href="#cb37-829" aria-hidden="true" tabindex="-1"></a><span class="fu">Andrews.test</span>(</span>
<span id="cb37-830"><a href="#cb37-830" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> gdp_gap<span class="sc">$</span>gdp_gap, </span>
<span id="cb37-831"><a href="#cb37-831" aria-hidden="true" tabindex="-1"></a>  <span class="at">M =</span> <span class="fu">which</span>(gdp_gap<span class="sc">$</span>Time <span class="sc">==</span> <span class="dv">2017</span>)</span>
<span id="cb37-832"><a href="#cb37-832" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-833"><a href="#cb37-833" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-834"><a href="#cb37-834" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-835"><a href="#cb37-835" aria-hidden="true" tabindex="-1"></a>  tabopts</span>
<span id="cb37-836"><a href="#cb37-836" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-837"><a href="#cb37-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-838"><a href="#cb37-838" aria-hidden="true" tabindex="-1"></a>Gem. des gro른n $p$-Werts kann die Nullhypothese (keine strukturelle Ver칛nderung ab 2017) nicht abgelehnt werden. Wir f칲hren den Test nun f칲r s칛mtliche Zeitpunkte ab 2017 durch und plotten die $p$-Werte nebst gepunkteten roten Hilfslinien f칲r die g칛ngigen Signifikanzniveaus (10\%, 5\%, 1\%).</span>
<span id="cb37-839"><a href="#cb37-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-842"><a href="#cb37-842" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-843"><a href="#cb37-843" aria-hidden="true" tabindex="-1"></a><span class="co"># Andrews' (1993) test f칲r </span></span>
<span id="cb37-844"><a href="#cb37-844" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-Referendumsperioden</span></span>
<span id="cb37-845"><a href="#cb37-845" aria-hidden="true" tabindex="-1"></a>pvals_andrews <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="fu">seq</span>(<span class="dv">2017</span>, <span class="fl">2020.5</span>, .<span class="dv">25</span>), \(time) {</span>
<span id="cb37-846"><a href="#cb37-846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb37-847"><a href="#cb37-847" aria-hidden="true" tabindex="-1"></a>    <span class="at">Time =</span> time,</span>
<span id="cb37-848"><a href="#cb37-848" aria-hidden="true" tabindex="-1"></a>    <span class="at">gap =</span> gdp_gap <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Time <span class="sc">==</span> time) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gdp_gap),</span>
<span id="cb37-849"><a href="#cb37-849" aria-hidden="true" tabindex="-1"></a>    <span class="at">pvalue =</span> CPAT<span class="sc">::</span><span class="fu">Andrews.test</span>(</span>
<span id="cb37-850"><a href="#cb37-850" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> gdp_gap<span class="sc">$</span>gdp_gap, </span>
<span id="cb37-851"><a href="#cb37-851" aria-hidden="true" tabindex="-1"></a>      <span class="at">M =</span> <span class="fu">which</span>(gdp_gap<span class="sc">$</span>Time <span class="sc">==</span> time)</span>
<span id="cb37-852"><a href="#cb37-852" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">$</span>p.value</span>
<span id="cb37-853"><a href="#cb37-853" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-854"><a href="#cb37-854" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span> </span>
<span id="cb37-855"><a href="#cb37-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb37-856"><a href="#cb37-856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-857"><a href="#cb37-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-860"><a href="#cb37-860" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-861"><a href="#cb37-861" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "P-Werte f칲r Andrews' (2003) Test"</span></span>
<span id="cb37-862"><a href="#cb37-862" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-andrewspvals</span></span>
<span id="cb37-863"><a href="#cb37-863" aria-hidden="true" tabindex="-1"></a><span class="co"># p-Werte f칲r Post-Interventionsperioden</span></span>
<span id="cb37-864"><a href="#cb37-864" aria-hidden="true" tabindex="-1"></a>pvals_andrews <span class="sc">%&gt;%</span></span>
<span id="cb37-865"><a href="#cb37-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> pvalue)) <span class="sc">+</span> </span>
<span id="cb37-866"><a href="#cb37-866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb37-867"><a href="#cb37-867" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span> <span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">05</span>, .<span class="dv">01</span>), </span>
<span id="cb37-868"><a href="#cb37-868" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="st">"dotted"</span>, </span>
<span id="cb37-869"><a href="#cb37-869" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"red"</span></span>
<span id="cb37-870"><a href="#cb37-870" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-871"><a href="#cb37-871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb37-872"><a href="#cb37-872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb37-873"><a href="#cb37-873" aria-hidden="true" tabindex="-1"></a>  cowplot<span class="sc">::</span><span class="fu">theme_cowplot</span>()</span>
<span id="cb37-874"><a href="#cb37-874" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-875"><a href="#cb37-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-876"><a href="#cb37-876" aria-hidden="true" tabindex="-1"></a>Der Verlauf der $p$-Werte zeigt deutlich, dass es f칲r Zeitpunkte jenseits von 2018-Q3 Evidenz f칲r eine strukturelle Ver칛nderung der Doppelg칛nger-Gap f칲r Gro륵rittannien gibt. Diese Ergebnisse untermauern die Signifikanz der in @Bornetal2019 mit SCM gefundenen negativen Effekte des Brexit-Votums auf die Britische Volkswirtschaft weiter.</span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<script type="module">
// Handle cell initialization initialization
qwebrCellDetails.map(
  (entry) => {
    // Handle the creation of the element
    qwebrCreateHTMLElement(entry);
    // In the event of interactive, initialize the monaco editor
    if (entry.options.context == EvalTypes.Interactive) {
      qwebrCreateMonacoEditorInstance(entry);
    }
  }
);

// Identify non-interactive cells (in order)
const filteredEntries = qwebrCellDetails.filter(entry => {
  const contextOption = entry.options && entry.options.context;
  return ['output', 'setup'].includes(contextOption) || (contextOption == "interactive" && entry.options && entry.options.autorun === 'true');
});

// Condition non-interactive cells to only be run after webR finishes its initialization.
qwebrInstance.then(
  async () => {
    const nHiddenCells = filteredEntries.length;
    var currentHiddenCell = 0;


    // Modify button state
    qwebrSetInteractiveButtonState(`游리 Running hidden code cells ...`, false);

    // Begin processing non-interactive sections
    // Due to the iteration policy, we must use a for() loop.
    // Otherwise, we would need to switch to using reduce with an empty
    // starting promise
    for (const entry of filteredEntries) {

      // Determine cell being examined
      currentHiddenCell = currentHiddenCell + 1;
      const formattedMessage = `Evaluating hidden cell ${currentHiddenCell} out of ${nHiddenCells}`;

      // Update the document status header
      if (qwebrShowStartupMessage) {
        qwebrUpdateStatusHeader(formattedMessage);
      }

      // Display the update in non-active areas
      qwebrUpdateStatusMessage(formattedMessage);

      // Extract details on the active cell
      const evalType = entry.options.context;
      const cellCode = entry.code;
      const qwebrCounter = entry.id;

      if (['output', 'setup'].includes(evalType)) {
        // Disable further global status updates
        const activeContainer = document.getElementById(`qwebr-non-interactive-loading-container-${qwebrCounter}`);
        activeContainer.classList.remove('qwebr-cell-needs-evaluation');
        activeContainer.classList.add('qwebr-cell-evaluated');

        // Update status on the code cell
        const activeStatus = document.getElementById(`qwebr-status-text-${qwebrCounter}`);
        activeStatus.innerText = " Evaluating hidden code cell...";
        activeStatus.classList.remove('qwebr-cell-needs-evaluation');
        activeStatus.classList.add('qwebr-cell-evaluated');
      }

      switch (evalType) {
        case 'interactive':
          // TODO: Make this more standardized.
          // At the moment, we're overriding the interactive status update by pretending its
          // output-like. 
          const tempOptions = entry.options;
          tempOptions["context"] = "output"
          // Run the code in a non-interactive state that is geared to displaying output
          await qwebrExecuteCode(`${cellCode}`, qwebrCounter, tempOptions);
          break;
        case 'output':
          // Run the code in a non-interactive state that is geared to displaying output
          await qwebrExecuteCode(`${cellCode}`, qwebrCounter, entry.options);
          break;
        case 'setup':
          const activeDiv = document.getElementById(`qwebr-noninteractive-setup-area-${qwebrCounter}`);
          // Run the code in a non-interactive state with all output thrown away
          await mainWebR.evalRVoid(`${cellCode}`);
          break;
        default: 
          break; 
      }

      if (['output', 'setup'].includes(evalType)) {
        // Disable further global status updates
        const activeContainer = document.getElementById(`qwebr-non-interactive-loading-container-${qwebrCounter}`);
        // Disable visibility
        activeContainer.style.visibility = 'hidden';
        activeContainer.style.display = 'none';
      }
    }
  }
).then(
  () => {
    // Release document status as ready

    if (qwebrShowStartupMessage) {
      qwebrStartupMessage.innerText = "游릭 Ready!"
    }
  
    qwebrSetInteractiveButtonState(
      `<i class="fa-solid fa-play qwebr-icon-run-code"></i> <span>Run Code</span>`, 
      true
    );  
  }
);
</script>


</body></html>