<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>11&nbsp; Regression Discontiniuty Designs – Kausalanalyse und maschinelles Lernen mit R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./SyntheticControl.html" rel="next">
<link href="./EventStudies.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="site_libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script><script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script><link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script type="ojs-define">
{"contents":[{"name":"house_binned","value":{"StimmenT":[0.5996,0.5657,0.4273,0.5637,0.6869,0.6021,0.6342,0.6262,0.5889,0.6009,0.6335,0.7085,0.5499,0.4435,0.3688,0.5605,0.6516,0.6568,0.5941,0.712,0.6585,0.5359,0.423,0.3899,0.5695,0.6088,0.6767,0.6359,0.5694,0.6549,0.7062,0.4224,0.4063,0.3234,0.5195,0.4101,0.3685,0.3765,0.3403,0.2912,0.3594,0.449,0.5843,0.474,0.333,0.5685,0.4022,0.3829,0.2665,0.431,0.6004,0.3798,0.6755,0.3451,0.361,0.3392,0.4477,0.3727,0.6436,0.2885,0.3929,0.6847,0.2521,0.6267,0.752,0.6738,0.6698,0.648,0.7298,0.6817,0.4228,0.5884,0.6412,0.7038,0.3165,0.3434,0.2347,0.3663,0.341,0.3379,0.7199,0.378,0.6993,0.3068,0.3521,0.6846,0.4195,0.388,0.5331,0.3921,0.3432,0.3202,0.243,0.6711,0.3342,0.3022,0.6197,0.2669,0.3059,0.691],"StimmenTm1":[0.1048,0.135,-0.0757,0.0846,0.3951,0.165,0.2545,0.2649,0.1554,0.2053,0.2342,0.4851,0.0351,-0.0158,-0.1846,0.0654,0.1949,0.3045,0.0949,0.3457,0.275,0.0046,-0.0553,-0.1954,0.1257,0.1151,0.335,0.185,0.0546,0.3251,0.4346,-0.1154,-0.1456,-0.3747,0.0161,-0.0442,-0.2359,-0.1651,-0.4052,-0.4451,-0.2245,-0.0359,0.075,-0.0241,-0.3354,0.0449,-0.0857,-0.2145,-0.4746,-0.0653,0.1749,-0.2446,0.2849,-0.2747,-0.2853,-0.3249,-0.0049,-0.2543,0.2444,-0.4248,-0.0959,0.4738,-0.4549,0.2249,0.4946,0.4546,0.3754,0.3146,0.4148,0.4246,-0.1058,0.1452,0.2149,0.4047,-0.465,-0.3049,-0.4952,-0.2056,-0.2958,-0.3154,0.4446,-0.135,0.4654,-0.3941,-0.3459,0.3845,-0.155,-0.1748,0.0262,-0.1251,-0.2654,-0.3648,-0.4843,0.2956,-0.3556,-0.4342,0.355,-0.3854,-0.4149,0.3647]}},{"name":"house","value":{"StimmenTm1":[0.1049,0.1393,-0.0736,0.0868,0.3994,0.1681,0.2516,0.2675,0.1528,0.2024,0.2378,0.488,0.5449,0.4858,0.486,0.0329,-0.0138,-0.181,0.0658,0.2653,0.1301,0.0871,0.1981,0.3098,0.3984,0.092,0.3477,0.2724,0.0001,0.0665,0.0067,-0.0533,-0.2,0.1245,0.2779,0.1161,0.1154,0.337,0.1119,0.1811,0.0541,0.3929,0.3299,0.269,0.4328,-0.1176,-0.1483,-0.3723,0.0181,0.0362,0.0192,-0.0408,-0.08,-0.2395,-0.1673,-0.4079,-0.0708,-0.4471,-0.5064,-0.2283,-0.0366,-0.055,-0.2385,0.076,0.346,0.1813,0.1263,-0.0244,-0.3376,0.0464,-0.0884,-0.2178,-0.4728,-0.0667,0.0613,0.1749,-0.0122,-0.2458,0.273,0.1366,0.284,-0.2797,-0.2835,-0.3301,-0.3238,-0.007,-0.0045,-0.0201,-0.229,0.1208,0.25,0.1004,0.049,-0.0011,0.0515,0.1325,-0.0036,-0.1475,-0.2567,-0.2704,0.0942,0.2644,-0.0379,0.1063,0.2401,0.1352,0.1141,-0.4274,-0.5746,-0.0997,-0.5313,-0.5466,-0.3242,0.0495,0.4712,-0.1436,-0.1117,-0.2761,-0.1106,-1,-1,-1,-0.4228,-0.2755,-1,-0.4586,-0.556,0.6546,1,0.0548,0.0973,0.1927,0.2244,1,1,1,0.4729,1,0.4998,0.4567,0.3739,0.3188,0.6051,0.2221,0.4979,0.4789,1,0.4188,1,1,0.4207,0.2013,0.1109,1,0.5049,0.3483,1,1,-0.1044,0.0762,0.1835,0.1426,0.1886,0.2758,0.4351,1,0.219,0.1612,0.0415,1,0.484,0.7771,0.4063,1,0.4332,-1,-1,-0.4656,-0.3204,-0.3002,-0.4962,-0.2082,0.2128,0.3462,0.2402,0.0671,1,0.6823,0.3971,1,-1,-0.4236,-1,-1,-0.2921,-0.3141,-0.3216,1,0.1348,0.0752,0.4394,1,0.3942,-0.0312,0.0013,0.5841,-1,0.2894,0.5117,0.539,0.4899,0.2503,0.5956,0.5933,0.6968,0.4283,1,1,0.289,0.3971,-0.0207,0.0639,0.0957,0.3271,1,1,1,0.81,0.5575,0.5375,0.8382,0.4444,0.6087,1,0.6869,-0.1334,-0.1316,-0.2218,-0.0938,0.657,1,0.6589,0.7863,0.4643,0.8599,1,0.6757,1,0.3955,0.4449,-0.3907,-0.0132,-0.0593,-0.0436,-0.2596,-0.022,-0.3474,-0.2831,-1,-0.2229,0.1142,0.3863,0.3335,0.3752,0.1261,1,0.5646,0.5062,0.6079,1,0.4956,1,1,0.3798,0.8347,1,1,0.6164,1,1,0.6497,1,-0.1925,-0.1001,-1,0.4957,1,1,-0.1312,-0.1599,-0.1125,0.0701,-0.2275,-0.2402,-0.2477,-0.2208,-0.1159,-0.0043,-0.148,-0.1741,0.027,-0.1246,-0.2674,0.0427,0.3769,0.2512,-0.1783,-0.1271,-0.2063,-0.3689,-0.0342,-0.1565,-0.2084,-0.3194,-0.1711,-0.0024,-0.3363,-0.4229,-0.2846,-0.2107,-0.3626,-0.5445,-0.4844,-0.1426,-0.0549,-0.0704,0.2404,0.1826,0.1154,0.257,0.3251,0.1357,0.2191,0.4584,0.2599,0.2248,0.3709,0.1542,-0.1127,0.083,0.4137,0.1931,0.2102,0.0442,0.267,0.627,0.2932,0.2248,0.5645,0.5399,0.0522,-0.3548,-0.4363,-0.4425,0.3597,0.3275,-0.388,-0.8924,-0.2234,-0.2159,-0.2275,-0.3426,0.0293,-0.1288,-0.3128,-1,-0.1293,-0.348,-0.5602,-0.388,-0.8924,-0.2234,-0.4997,-0.4594,0.1704,0.3271,0.3503,-0.0158,0.0982,-0.0391,0.0046,0.1314,-0.1154,-0.1735,-0.5852,-0.0384,-0.1703,0.1704,0.3271,0.3503,-0.4418,-0.4209,-0.0725,-0.0884,-0.1681,-0.0095,-0.1251,-0.051,-0.1708,0.1901,0.4118,0.593,0.4408,0.5204,0.4034,0.4453,0.5511,-0.2418,-0.2716,-0.3582,-0.0735,0.0157,-0.0467,-0.1082,0.1603,0.2344,0.3285,0.2647,0.3962,0.3262,-0.2924,-0.2231,-0.1854,-0.1512,-0.3064,-0.1214,0.0083,0.0605,0.1584,0.3902,0.2502,0.125,0.0752,0.174,0.0421,-0.3517,-0.3095,0.2301,0.1672,0.0907,0.2598,0.3523,0.1266,-0.0691,0.3366,0.3423,0.2419,-0.2262,-0.2284,-0.3229,-0.3726,-0.2992,-0.161,-0.1853,-0.291,-0.1165,-0.2715,-0.4368,-0.3825,-0.099,-0.3552,-0.4511,-0.4234,-0.4914,-0.5205,-0.5235,-0.4654,-0.1449,0.1413,-0.0209,-0.0424,-0.1948,-0.3627,-0.3175,-0.07,-0.1907,-0.2198,0.1305,0.4007,0.2304,0.2283,0.2518,-0.1293,-0.264,-0.4133,-0.1961,-0.1339,-0.3283,-0.2549,0.0525,0.1309,0.0591,-0.4877,-0.5808,-0.4922,-0.2085,-0.1356,-0.0012,-0.0965,-0.2208,-0.1691,0.3526,0.2137,0.2316,0.4931,0.4155,0.4891,0.2578,0.2558,1,-0.013,0.0324,-0.2449,-0.2047,-0.3592,-0.1543,0.0109,0.0176,0.0119,0.3157,-0.0876,-0.1105,0.2528,0.3805,0.3482,0.2648,0.1358,0.0499,0.2675,0.1224,0.2909,0.4898,0.3155,0.2944,0.6585,0.666,0.7371,0.6734,0.9187,0.647,0.5398,0.6954,0.0156,0.1501,0.0491,0.1868,0.3927,0.175,0.3225,0.3983,0.3649,0.4206,-0.1152,-0.3604,-0.4096,-0.4324,-0.3541,-0.0364,-0.0613,-0.2099,-0.0737,0.0641,-0.4998,-0.4313,0.3261,-0.4687,-0.4674,-0.3067,-0.2697,-0.3938,-0.3797,-0.038,0.3611,0.3384,0.0005,0.4123,0.5565,0.4366,0.207,0.1456,0.0251,-0.0368,-0.2229,-0.3072,-0.3896,0.4569,0.6147,0.2558,0.2748,-0.067,0.2989,0.4921,0.3944,0.2438,0.6378,0.0467,0.4334,0.3245,0.4397,0.3672,0.2629,0.1546,0.098,0.4351,0.2874,0.0245,-0.3438,-0.2642,-0.3167,-0.1493,0.2985,0.2524,-0.1801,0.3637,0.356,-0.1432,-0.0619,0.0895,0.0159,-0.0601,-0.0944,-0.3871,-0.2786,-0.3493,-0.2108,-0.0329,-0.2052,0.4053,0.0414,0.1469,0.0972,0.0939,0.3191,0.2329,-0.402,-0.3103,-0.2122,-0.1667,-0.2386,-0.0883,0.0138,0.0051,-0.1183,0.0569,0.052,0.0293,0.0309,0.1587,0.1659,-0.1926,-0.1316,0.0301,-0.1391,-0.1162,-0.0513,-0.0994,-0.2762,0.4289,-0.0994,-0.1162,-0.3364,-0.408,-0.3591,-0.4251,-0.1288,0.1698,0.067,-0.0783,-0.1712,-0.0842,0.1159,0.0126,-0.0141,-0.0847,-0.1135,-0.1675,-0.2737,-0.3632,-0.3181,0.1173,0.2865,0.148,0.0898,0.137,0.2712,-0.1411,-0.2961,0.2745,0.3341,0.285,0.2711,0.6549,0.3548,0.7175,0.6089,0.6971,0.1995,0.1793,0.0007,0.2228,0.4147,0.4092,-0.2176,1,0.8996,0.8978,0.385,0.5473,1,0.7428,0.4215,0.391,0.5534,0.3129,0.4331,0.5263,0.4754,0.4814,0.58,0.5593,0.6272,0.2554,0.8038,1,0.6624,0.6605,0.3108,0.4378,0.2559,0.4414,0.3659,0.1351,0.0699,0.8603,0.902,0.0975,0.0555,0.4471,1,0.4523,0.535,0.3004,0.5534,0.4643,0.5221,0.7507,0.6414,0.4106,0.7124,0.8654,0.9005,0.4616,0.8662,0.6062,0.798,0.8336,0.2466,0.6708,0.5548,0.6275,0.6021,0.4876,0.5123,0.5801,0.5728,0.569,0.7207,0.8074,0.7977,0.794,0.8391,0.2851,-0.0262,-0.1521,-0.1278,0.6337,0.4831,0.4026,0.6631,0.763,0.7554,0.8272,0.8551,0.8603,0.8594,0.7097,0.1708,0.5965,0.4232,0.5228,0.5049,0.4327,0.5207,0.6363,0.6733,0.6228,0.3181,0.6764,0.494,-0.4631,-0.2685,0.557,0.476,0.2839,0.4113,0.5487,0.5238,0.3601,0.5802,0.7127,0.5847,-0.4032,-0.3905,-0.266,0.2883,0.487,0.6275,-0.0343,-0.2369,-0.0563,0.072,0.1368,0.2691,0.2058,0.3252,0.3977,-0.121,-0.1601,-0.246,0.9303,0.8654,0.0536,0.6169,0.498,0.8162,0.2279,0.1481,0.155,0.5778,0.6575,0.6901,0.9491,0.9438,0.9548,0.9258,0.9341,-0.1605,-0.0032,-0.0183,-0.0781,-0.6654,-0.0148,0.0888,0.3216,0.4517,0.2117,0.6476,0.7146,0.6873,0.5972,0.7165,-0.0515,0.76,0.1597,0.2555,0.7419,0.5654,0.6508,0.579,0.5519,-0.065,0.7992,0.8816,0.8411,0.1634,0.3161,0.5449,0.4915,0.3688,0.4626,0.487,0.3152,0.2005,0.9374,0.9473,0.937,0.8964,0.8307,0.2882,-0.1533,-0.069,0.3139,0.3658,0.2753,0.341,0.6691,0.5406,0.6218,0.6314,0.7047,0.6929,0.0437,-0.0931,0.0284,-0.3813,-0.1944,-0.0143,0.3569,0.3297,0.4499,0.702,0.6715,0.588,0.9338,0.9714,0.9592,-0.5666,-0.5527,-0.5139,0.3583,0.3921,0.5957,0.5001,0.3938,0.447,0.6978,0.5494,0.6423,0.7615,0.7591,0.6818,-0.4102,-0.4231,-0.4415,-0.4686,-0.2095,0.6599,0.6273,0.4664,0.5372,0.5122,0.5451,0.4375,-0.1524,0.0105,0.0537,0.5586,0.9277,0.2349,-0.4743,-0.383,0.261,0.3176,0.2241,0.2797,-0.2594,-0.3049,0.2671,0.1567,0.1019,0.1335,-0.4631,-0.4087,-0.4477,-0.5711,-0.4611,0.6433,-0.0729,-0.2382,-0.1552,0.1244,0.0929,0.2388,-0.3172,-0.4108,-0.5693,-0.4558,-0.4657,-1,-0.1522,-0.1022,0.2061,-0.2801,-0.349,-0.2639,-0.1265,-0.4393,-0.4506,-0.1549,-0.3236,-0.3236,-0.412,-1,-0.5008,0.0064,0.1291,-0.0873,-0.1437,-0.1613,-0.1639,0.0327,0.0274,-0.0293,0.0965,0.3326,0.1152,-0.0864,-0.0056,-0.1567,-0.4906,-0.1977,-0.2997,-0.3221,-0.2432,-0.2157,0.0637,0.0396,-0.025,0.6338,0.5855,0.5661,0.1514,0.3661,0.8636,0.1657,0.1451,-0.2366,-0.348,-0.4282,-0.2672,0.385,-0.0816,-0.1488,0.0899,0.0195,-0.0804,-0.4533,-0.4646,-0.4223,0.1216,0.2398,-0.2969,0.2239,0.1158,0.2934,-0.0055,-0.3003,-0.3305,-0.1002,-0.1144,-0.2102,-0.6248,0.0198,0.1738,-0.3403,-0.0963,-0.1387,-0.3249,-0.4365,-0.2759,-0.1203,-0.352,-0.1756,-0.2192,-0.33,-1,-0.4997,-0.1549,-0.0677,-0.8478,-0.4621,0.1453,-0.2295,-0.3493,0.0806,-0.0681,-0.4454,-0.3516,0.1818,0.1071,0.0631,0.341,0.8076,0.4545,-0.3005,-0.3797,-0.4544,-0.2963,-0.1678,-0.3167,-0.3706,-0.351,-0.4175,-0.1642,0.5514,0.7018,1,-0.2311,-0.1875,-0.1492,-0.0159,0.0241,0.1682,0.0754,-0.3848,-0.3555,-0.8714,0.0973,-0.2029,-0.9647,0.0011,-0.2728,-0.3488,-0.0765,0.2796,0.3165,0.3991,-0.1714,-0.285,-0.4307,-0.0423,-0.3678,-0.391,-0.2942,-0.1351,-0.447,-0.4696,0.1912,0.3328,0.5063,-0.2922,-0.433,-0.433,-0.316,-0.1014,-0.377,-0.4315,0.5042,0.597,0.5907,-0.1608,-0.4377,-0.4343,-0.1636,-0.1686,-0.3794,-0.3035,-0.4428,-0.5632,-0.9484,-0.3037,-0.2956,-0.4093,-0.303,0.0551,0.0462,0.1265,-0.2307,0.2358,0.169,-0.0273,-0.2378,-0.2868,-0.2385,-0.0523,-0.2248,-0.3075,-0.1978,-0.2624,-0.2883,0.0061,0.6417,0.5438,0.5519,-0.0441,-0.152,-0.1833,-0.1772,0.0397,-0.3127,-0.3733,-0.2971,0.0553,-0.2364,0.0685,0.2301,0.2539,0.2939,0.4366,0.3213,0.4947,0.5255,0.4889,0.0831,0.4986,0.4949,0.5263,0.6304,0.7501,0.087,0.2249,0.2465,0.3257,0.6049,0.1985,0.4004,0.4801,0.4869,0.0831,0.8273,0.9679,0.8743,0.7176,0.7598,-0.0406,0.1072,0.1989,0.2707,0.4404,0.1328,0.226,0.5071,0.4707,0.0831,0.2816,0.2356,0.2642,0.2535,0.3779,0.1579,0.3146,0.3824,0.4511,0.2825,0.0377,0.1961,0.4195,0.3504,0.0831,0.1358,0.2172,0.4031,0.2834,0.2845,0.0145,0.1005,0.0668,0.1051,0.3042,0.1827,0.3815,-0.1919,-0.191,0.0831,-0.3387,-0.3148,-0.5642,1,-0.2056,-0.1393,-0.0119,-0.0307,0.1081,0.241,0.1228,0.0391,0.5057,0.4835,0.0831,-1,0.3823,0.2702,0.135,0.1786,-0.2358,-0.2176,-0.2382,-0.1841,-0.023,-0.2645,-0.1386,0.1158,0.0823,0.0831,0.0017,-0.2257,-0.3563,-0.3934,-0.3455,-0.1841,-0.0248,-0.1187,-0.0857,-0.0218,-0.191,-0.2086,-0.1531,0.0069,0.0831,0.0179,0.1007,0.153,-0.3944,-0.2381,-0.3415,-0.253,-0.3678,-0.2386,-0.1537,-0.2524,-0.2749,-0.1303,-1,0.0831,-0.3309,-1,-1,1,-0.4745,0.1702,-0.01,-0.1159,0.0087,-0.0158,-0.3354,-0.3385,-0.2989,-0.2513,0.0831,-0.5422,-0.4933,-0.4649,-0.3461,-0.2356,0.0365,0.0186,0.0611,0.234,0.5487,0.3447,0.4146,0.4908,0.4193,0.0831,0.1714,0.4122,1,0.3306,0.3601,-0.2112,-0.1096,-0.129,-0.0976,-0.1713,-0.3387,-0.3595,0.1613,0.3537,0.0831,0.3956,0.3484,1,0.3783,0.3999,0.0392,-0.2867,-0.3348,-0.2577,-0.1816,-0.4497,-0.252,-0.2497,-0.2681,0.0831,-0.1223,-0.1704,-0.3314,-0.042,-0.0003,-0.3037,0.2397,0.0297,0.1717,0.4968,0.3654,0.4078,0.5491,0.451,0.0831,0.5669,0.8443,0.5728,0.3173,0.2172,-0.231,0.2318,0.1118,0.2213,0.3211,0.0455,0.2012,1,0.3077,0.0831,-0.1625,-0.1355,-0.1495,0.0031,0.1348,-0.3373,-0.1952,-0.2099,-0.1325,-0.2827,-0.3841,-0.4135,-0.2853,-0.2555,0.0831,-0.556,-0.4911,-0.4796,-0.3943,-0.2191,-0.2896,-0.1306,-0.1712,-0.1207,-0.16,-0.3238,-0.3442,-0.0423,0.0223,0.0831,-0.4522,-0.4729,-1,-1,-0.4447,-0.2737,-0.1185,-0.1973,-0.1265,-0.2522,-0.3427,-0.2742,-0.4418,0.1891,0.0831,0.2604,0.2601,0.2561,0.0964,0.1562,-0.274,0.0207,-0.0764,0.0293,0.0166,-0.0333,-0.1697,-0.0387,-0.4119,0.0831,-0.5199,-0.4577,-0.545,-1,-0.267,0.1755,-0.1256,-0.2595,-0.2971,0.4885,0.3173,0.419,0.6341,0.5046,0.0831,0.5192,0.9695,0.9693,0.0618,0.0779,0.0739,0.2211,0.1369,0.1829,0.3169,0.2848,0.2561,0.3989,0.1881,0.0831,-0.313,-0.617,-0.5749,-0.0257,-0.0136,-0.208,-0.0375,-0.1388,-0.1397,-0.1394,-0.3497,-0.1606,0.3188,0.1149,0.0831,0.5851,1,0.4481,0.0865,-0.2374,-0.3219,-0.2229,-0.0978,-0.256,-0.2342,-0.0548,0.1309,0.0831,-0.0326,-0.1096,-0.2474,0.3081,-0.0407,-0.1551,-0.0766,0.0153,0.1053,0.2311,0.1726,-0.1166,0.0831,-0.0515,0.0691,0.0264,0.1775,0.4069,0.2903,0.273,-0.0764,-0.1358,0.0831,0.1076,0.306,0.2374,0.2958,0.3628,0.2811,0.3005,0.2434,-0.2555,-0.3208,-0.2826,-0.2547,-0.3536,-0.3475,-0.0909,0.3015,0.155,0.3458,0.0841,-0.212,-0.2942,-0.2725,-0.0062,0.3801,0.1961,0.3336,-0.1278,0.4532,0.3847,0.3776,0.5056,0.2883,0.4443,0.6982,0.4516,0.6913,0.8826,0.8491,0.1731,0.9128,0.928,0.921,0.5147,0.7304,0.036,0.2311,0.1055,0.3744,0.3457,0.1831,0.3072,0.7504,0.6935,0.742,0.6596,0.6766,0.6549,1,0.8814,0.0582,0.0755,-0.029,0.1722,0.1828,0.0398,0.0807,0.0519,0.1841,0.3038,0.2882,0.3235,0.2446,0.0832,0.3332,0.0422,-0.043,-0.2006,-0.0391,-0.1786,-0.4407,-0.3662,-0.1847,-0.3158,-0.3374,-0.2796,-0.031,0.0057,0.5044,0.8715,0.4489,0.4638,0.2358,0.5215,0.2743,0.1248,0.1072,0.7207,0.5389,0.68,0.2712,0.4072,0.2255,-0.0886,0.2824,0.3974,0.4342,0.2403,0.4622,0.6675,0.1407,0.1939,-0.0677,-0.2119,-0.3238,-0.5019,-0.5077,-0.4736,-0.4988,-0.3088,0.4734,0.5689,0.4332,0.6606,0.7186,0.617,0.6628,0.9738,0.6954,0.726,0.5673,0.616,1,0.5912,0.6755,0.301,0.3685,0.1906,0.4918,0.322,0.1978,0.2556,0.7309,0.6108,0.7192,0.4261,0.5747,0.5063,-0.2986,-0.2615,0.1073,0.2065,0.0807,0.3407,0.2772,0.1972,0.2888,1,0.443,0.5066,0.3509,0.4328,0.3313,0.322,0.268,-0.1626,-0.1451,-0.2889,-0.0868,-0.2168,-0.3888,-0.3359,0.0174,0.0009,0.0036,-0.4524,-0.5024,-0.4496,-0.501,-0.3818,0.0156,-0.0178,-0.1092,0.1349,0.1372,0.018,0.1153,0.4471,0.3479,0.4745,0.2522,0.4139,0.2902,-0.2125,-0.0354,-0.0527,0.0821,0.0634,0.2153,-0.1718,-0.3816,-0.4087,-0.2218,-0.4568,-0.5908,-0.556,-0.5543,-0.5036,0.3184,0.4502,-0.36,-0.392,-0.4316,-0.3421,-0.1565,-0.5202,-0.4547,-0.0902,-0.365,-0.2233,-0.34,-0.4678,-0.4032,-0.4623,-0.1987,-0.3662,-0.4477,-0.4114,-0.2865,-0.1796,-0.4348,-0.4226,-0.3319,-0.4885,-0.5013,-0.2433,-0.0474,-0.4742,-0.5296,-0.2879,-0.1286,-0.2566,-0.2916,-0.0503,-0.1689,-0.4456,-0.3743,0.0641,-0.0782,-0.2477,-0.4645,-1,-0.4345,-0.363,-0.1466,-0.1703,-1,-0.2746,-0.2274,-0.1276,-0.4601,-0.3469,-0.2677,-0.3584,-0.3093,-0.1686,-0.3372,-0.2786,-0.4127,-0.2058,-0.2556,-0.2996,-0.2989,-0.2201,-0.1287,-0.3486,-0.3054,-0.0295,-0.1643,-0.4124,0.1334,0.1129,0.2974,0.0906,0.0466,-0.0419,-0.149,-0.1759,-0.1896,-0.0797,-0.1688,-0.2177,-0.0952,-0.1546,-0.3176,-0.221,-0.2521,-0.0941,-0.2094,-0.1851,-0.08,-0.1299,-0.1162,-0.0092,0.0481,-0.046,-0.2696,-0.3059,-0.37,-1,0.0452,0.3283,0.2848,0.1677,0.3485,-0.0614,-0.2581,-0.1929,-0.1095,-0.0962,-0.2441,-0.3237,-0.0966,-0.2714,-0.3927,0.2253,0.3619,0.3775,0.0968,-0.0051,0.0623,0.0956,0.0696,0.1753,0.2996,0.1239,0.0829,-0.3158,-0.4893,-0.5655,0.2031,0.0072,0.0519,-0.0636,-0.2408,-0.2452,-0.2095,-0.059,-0.2669,-0.2863,0.1967,0.2287,-0.0798,0.0051,0.0647,0.2976,-0.0351,-0.0588,-0.0513,0.0014,0.0911,0.1287,0.0797,0.6099,0.5725,0.4834,-0.0129,0.3831,0.3642,0.5211,0.5143,0.4297,0.4264,0.1911,0.3475,0.3126,0.39,0.0522,0.0767,0.1643,-0.0374,0.0339,0.2207,0.2328,0.0535,0.3343,0.2768,0.1661,0.1369,0.3727,0.4261,0.6094,0.4186,0.4778,0.5419,0.1291,0.3994,-0.1126,-0.1917,-0.248,-0.0446,-0.0578,-0.1499,-0.1012,0.2213,0.1029,0.2028,0.0714,0.2442,0.064,-0.0893,-0.1785,0.0448,-0.0119,-0.0614,0.1386,0.213,0.1154,0.0448,0.2811,0.138,0.1225,-0.0509,-0.0003,-0.0858,0.1037,0.1702,0.025,-0.2013,-0.2711,-0.0019,-0.0417,-0.2697,-0.0284,0.0532,-0.0979,-0.306,-0.2234,-0.3953,-0.2429,-0.1086,-0.1905,0.0516,-0.0688,-0.1331,0.0736,0.1036,0.0222,-0.2593,-0.1311,-0.2349,-0.3523,-0.364,0.0337,0.1263,-0.4122,-0.2919,-0.0036,-0.0505,-0.1022,0.0296,-0.0827,-0.3218,-0.2978,0.0487,0.0982,0.0455,-0.4598,-0.375,-0.4577,-0.5406,-0.5179,0.0833,-0.1099,-0.1447,-0.0756,-0.0832,-0.0866,-0.1953,-0.1501,-0.2539,-0.1262,-0.3582,-0.3518,-0.2347,-0.302,-0.2731,0.1129,0.0463,0.0036,0.2298,0.1293,-0.0217,-0.0892,0.0684,0.0093,-0.0399,-0.0018,0.065,0.2363,-0.0486,-0.0166,-0.0384,-0.0332,-0.0712,0.006,0.0883,0.0767,0.0885,0.4215,1,0.3127,0.306,0.4424,0.4144,0.0406,0.1397,-0.0618,-0.1251,-0.1296,0.0149,-0.0089,-0.268,-0.0775,0.0873,0.1968,0.1327,0.1846,0.1658,0.2109,0.0691,0.0811,0.0226,-0.101,-0.189,0.0418,0.0099,0.1149,0.0616,0.0497,0.214,0.1461,0.674,0.77,0.7219,0.8102,0.6805,0.6843,1,0.8205,0.8583,0.8575,0.792,0.7931,0.8336,0.1488,0.4344,-0.1275,-0.1972,-0.2649,-0.1801,0.0099,-0.0209,-0.0945,-0.0687,-0.0018,-0.3594,-0.3818,-0.1808,-0.0991,-0.5154,-0.3233,-0.2067,-0.1925,-0.2801,-0.2124,0.0536,-0.0449,-0.3031,-0.0361,-0.0202,0.0267,0.0586,0.2074,0.1468,-0.5032,-0.3914,-0.3147,-0.2464,-0.2392,-0.2004,-0.0858,-0.3555,-0.3126,-0.076,-0.2127,-0.4236,-0.3389,-0.2527,-0.4169,-0.4767,-0.3279,-0.222,-0.2652,-0.3428,-0.274,-0.2244,-0.3709,-0.256,0.092,-0.0711,-0.0071,-0.2422,-0.4248,-0.452,0.3371,0.418,-0.0053,0.0254,-0.0173,-0.0446,-0.1312,-0.3453,-0.2827,0.0043,0.0625,0.1347,0.057,0.1335,0.1931,-0.4795,-0.3704,-0.1872,-0.0579,-0.0737,0.0161,0.3144,-0.0818,-0.2132,0.315,0.4165,0.5485,0.8631,0.6006,0.5212,-0.3285,-0.1213,-0.2424,-0.257,-0.2845,-0.2439,-0.0949,-0.3971,-0.3768,0.1143,0.1865,0.3314,0.2884,0.4527,0.4416,-0.0672,0.0962,-0.1804,-0.1176,-0.1195,-0.1357,-0.1486,-0.3342,-0.3494,-0.1442,-0.4057,-0.392,-0.4213,-0.2884,-0.3957,0.0419,0.2038,-0.2759,-0.228,-0.312,-0.2242,-0.1324,-0.3487,-0.3186,-0.0778,-0.1368,0.0296,-0.0063,-0.023,-0.4634,0.2453,0.108,-0.2793,-0.0983,-0.1216,-0.0463,0.0652,-0.0362,-0.1758,-0.0214,-0.0992,-0.0984,-0.1724,-0.2641,-0.1967,-0.3771,-0.2526,-0.1379,-0.118,-0.1268,-0.1415,0.4968,0.3024,0.4105,0.4463,0.0525,0.0982,0.1741,0.3271,0.0812,0.054,0.1686,0.2531,0.3213,0.3953,0.4574,0.7192,0.6607,0.7285,0.7625,0.794,0.5843,0.7325,0.7136,0.7546,0.0676,0.1527,0.1421,0.1663,0.1356,0.2857,0.3383,0.1946,0.261,0.4415,0.3372,0.3472,0.1883,0.4618,0.2627,0.6487,0.738,0.3041,0.4553,0.4825,0.5727,0.419,0.3566,0.421,0.5732,0.4928,0.602,0.1986,0.5103,0.2907,0.6997,0.7852,0.2563,0.3617,0.2848,0.4395,0.4693,0.2536,0.4802,0.5725,0.532,0.5451,0.2799,0.5564,0.9478,0.1938,0.2635,-0.0591,0.0461,0.0679,0.2079,0.4579,0.3836,0.5002,0.4009,0.2979,0.8174,1,0.5397,0.416,-0.0776,-0.1345,-0.055,-0.1908,-0.3565,-0.2017,0.1855,0.3336,0.5015,-0.5974,-0.4754,-0.5362,0.0678,-0.1408,-0.1607,-0.2602,-0.3413,-0.4258,0.1623,0.0002,0.0398,-0.0329,-0.2863,-0.2944,-0.1327,0.0377,-0.0586,-0.3446,-0.0188,-0.3114,-0.3059,0.1483,0.2345,0.1293,-0.1217,-0.1081,0.057,-0.1676,-0.3093,-0.0946,-0.2109,-0.4143,-0.3479,-0.067,0.0275,0.0471,-0.3723,-0.4149,-0.4463,-0.5488,-0.4938,0.1639,-0.0516,-0.1807,-0.0479,0.0405,-0.0759,-0.5632,-1,-0.4609,0.0943,1,0.4731,0.5378,0.1859,0.3055,-0.1146,-0.352,-0.3763,-0.2203,-0.1134,-0.272,-0.9994,-0.2306,-0.4012,-0.3699,-0.55,-0.5805,-0.9967,-1,-0.3447,-0.0429,-0.1907,-0.2465,-0.0783,-0.3178,-0.5065,-0.4238,-0.2509,-0.3488,-0.2524,-0.2516,-0.3006,-0.2123,-0.4673,-0.2713,0.0616,0.0436,0.09,0.24,-0.201,-0.3585,-0.4474,-0.3764,-0.2297,-0.2977,-0.4823,-0.4242,-0.4862,-0.019,0.0265,-1,-0.2778,-0.3189,-0.2103,-0.1353,-1,-0.2758,-0.3273,-0.297,-1,-0.4995,-1,-0.4775,-1,-0.4149,-0.0899,-0.261,-0.2691,-0.2253,-0.2352,-0.341,-0.4275,-0.0448,-0.3988,-0.4282,-0.5376,-0.6807,-0.517,-1,-0.4421,0.0757,0.0287,0.105,0.232,0.2579,0.2152,0.148,0.0565,0.1019,0.3304,0.116,0.5503,0.6262,0.5068,0.5628,-0.1573,-0.2333,-1,0.0589,0.0477,-0.0404,-0.385,-0.4073,-0.3753,-0.4785,-0.4596,-0.4088,-0.4327,-0.1324,0.0274,-0.017,-0.3055,-0.1684,0.0061,-0.1073,-0.3861,-0.5069,-0.2104,-0.4348,-0.3979,0.3351,0.4759,0.2298,0.5443,0.6598,-0.0426,-0.23,-0.2357,-0.0876,-0.1081,-0.2834,-0.3513,-0.0172,-0.008,-0.1387,-0.3892,-0.468,-0.6028,-0.3334,-0.3071,-0.183,-0.1823,-0.4137,-0.1789,-0.0949,-0.3106,-0.2375,-0.1509,0.3558,0.3029,0.3634,0.2563,0.3961,0.0354,0.2519,0.1497,-0.0924,-0.1778,-0.2026,-0.0934,-0.1929,-0.1021,0.5085,0.4978,0.4491,0.4271,0.0745,0.4947,0.0387,0.1262,0.1271,-0.0803,-0.2105,-0.1452,0.3225,-0.1982,-0.4646,-0.2301,-0.31,-0.422,-0.4277,-0.2736,-0.5029,-0.4168,-0.416,0.0526,-0.1659,-0.1042,-0.1484,-0.0438,-0.222,-0.1912,-0.3121,-0.3487,-0.5602,-0.4469,-0.5268,-0.5711,-0.4999,-0.4073,-0.0578,-0.2927,-0.3299,0.0338,-0.0298,-0.1067,-0.2983,-0.0549,-0.1359,-0.3477,0.079,0.4451,0.5428,0.5481,0.8193,0.0829,0.1454,0.1911,0.4309,0.3762,0.283,0.2054,0.3124,0.383,0.1901,0.5175,1,0.5524,-0.0795,-0.0386,0.3613,0.3503,0.3744,0.5003,0.5264,0.4375,0.393,0.4545,0.0235,-0.0135,0.1249,0.0956,0.4098,-0.0499,-0.1372,1,0.3532,0.3051,0.5887,0.4885,0.5211,0.4476,0.7386,0.6414,1,0.9928,0.6973,0.6516,0.519,0.5198,0.4326,0.6074,0.8023,0.6338,0.4944,0.6391,0.7249,0.7215,0.6762,0.631,0.7136,-0.0934,-0.167,-0.3339,-0.106,-0.1327,-0.1175,0.0942,0.573,0.4856,0.4271,-0.3508,-0.379,-0.3304,-0.3443,-0.4645,-0.039,0.0425,0.464,0.4954,0.0323,-0.1699,-0.407,0.0406,0.0434,-0.1429,-0.2096,-0.0431,-0.0888,-0.1414,0.0116,0.0304,-0.0207,-0.0178,0.4098,0.3086,0.0898,0.1242,0.5016,0.5233,-0.0066,-0.0183,-0.0823,-0.0798,-0.1065,0.0418,0.2722,0.1606,0.1976,0.2954,0.3121,0.1634,0.2731,0.113,0.1701,-0.4055,-0.1638,-0.3877,-0.2412,-0.224,-0.0241,-0.2124,-0.3769,-0.2737,0.0366,0.1624,0.256,-0.3672,-0.2822,-0.367,-0.1472,0.0419,0.164,0.4217,0.3131,0.4826,0.4834,0.4861,0.4525,0.4868,1,0.3217,0.3386,1,1,0.0891,0.1547,0.0833,0.045,0.155,0.3891,0.5192,0.4036,0.3634,0.5994,0.5678,0.4714,0.9623,1,0.2843,0.2609,0.4879,-0.1174,-0.25,-0.3436,-0.0554,0.0155,-0.0476,-0.2965,-0.2409,-0.2671,-0.4002,-0.5166,-0.9668,-0.4849,-1,-0.4915,-0.2637,-0.1823,-0.2369,-0.2093,-0.2351,-0.3029,-0.2824,0.4112,0.4721,0.2531,0.2247,0.2521,0.2438,0.0865,0.1415,-0.1409,-0.2407,-0.2929,-0.1464,-0.1912,-0.2254,-0.3598,0.0888,0.0392,-0.1589,-0.3708,-0.3471,-0.3941,-0.2746,0.0408,-0.9814,0.1082,0.0284,0.2618,-0.1064,-0.2829,-0.2621,-0.0794,-0.3183,-0.223,-0.4725,-0.5644,-0.4981,-1,-0.49,-0.1325,-0.1951,-0.2909,-0.342,-0.1231,-0.3308,-0.3188,-0.0762,-0.1406,-0.1596,-0.0679,0.0203,-0.0337,-0.0601,0.0872,-0.0411,-0.2771,-0.3354,-0.3275,-0.2233,-0.2235,-0.0722,-0.0775,-0.1085,-0.0276,0.0225,0.0437,0.0792,0.101,0.0301,0.0129,-0.0518,-0.278,-0.2268,-0.1355,-0.1259,-0.0756,-0.1688,-0.2427,-0.1711,-0.0733,-0.0025,-0.241,-0.281,-0.0169,-0.1291,-0.4965,-0.2141,0.0923,0.2674,-0.1683,0.0171,-0.0337,-0.1115,-0.0141,0.0397,0.0729,-0.0331,-0.0785,0.284,0.3819,0.2939,0.2136,0.3673,0.4336,-0.0615,-0.0532,-0.0231,-0.1113,-0.0226,0.0455,0.3992,0.2148,0.2425,0.0218,0.3072,0.1786,-0.0155,-0.1844,-0.2775,-0.2185,-0.3185,-0.1169,-0.2068,0.0015,0.165,0.0668,-0.1517,-0.3009,0.0925,0.3597,0.3257,0.2405,-0.019,-0.2877,-0.1376,-0.2074,-0.1072,-0.03,0.0705,-0.1808,-0.2966,-0.1083,-0.2765,-0.2017,-0.0545,-0.2094,-0.0863,-0.0724,-0.0379,-0.0232,-0.3725,-0.029,-0.2544,-0.4537,-1,-0.526,-0.5304,-1,-0.5482,-0.49,-0.0371,-0.0932,-0.097,0.015,-0.0229,-0.2568,-0.3515,0.1116,0.0326,-0.0406,0.2097,0.4128,0.4654,-0.3129,-0.0672,-0.1001,-0.1076,-0.1008,0.0345,-0.2433,-0.0792,-0.2567,-0.2784,-0.3974,-1,-0.1483,-1,-0.4715,-0.1319,-0.0441,-0.1119,-0.1242,-0.0768,-0.0134,-0.1872,-0.3739,-0.2942,-0.0638,0.0181,0.3909,0.4882,0.29,0.2793,-0.0582,-0.0349,-0.2993,-0.2971,0.0105,0.0629,-0.1276,-0.217,-0.2895,-0.1035,-0.2449,-0.1566,-0.4831,-0.4214,-0.4032,-0.1513,-0.0664,-0.0217,-0.0026,-0.6139,-0.6089,-0.6146,-0.5695,-0.5531,-0.6591,-0.6875,-0.6259,-0.6825,-0.562,0.1398,-0.7238,-0.7012,-0.1047,-0.055,-0.6387,-0.5788,-0.638,-0.5707,-0.5835,-0.6621,-0.5949,-0.531,-0.6034,-0.7039,-0.2614,-0.516,-0.5782,0.0701,0.1384,-0.5463,-0.5443,-0.5197,-0.5164,-0.5699,-0.6543,-0.6478,-0.604,-0.6609,-0.6573,-0.4638,-0.7014,-0.6834,-0.4715,-0.4041,-0.5943,-0.6301,-0.6407,-0.5636,-0.7301,-0.5339,-0.6133,-0.7603,-0.6644,-0.5804,0.4834,-0.7288,-0.7244,0.1299,0.2024,-0.5396,-0.5576,-0.5601,-0.5734,-0.619,-0.5965,-0.5754,-0.7375,-0.7066,-0.6233,0.4351,-0.727,-0.7412,0.2478,0.3587,-0.5171,-0.6192,-0.5619,-0.643,-0.5179,-0.5136,-0.562,-0.5536,-0.5979,-0.5528,0.2094,-0.6581,-0.6552,0.0024,0.1185,-0.5247,-0.5262,-0.559,-0.533,-0.5078,-0.6323,-0.5125,-0.7501,-0.7204,-0.5235,-0.1409,-0.4968,-0.5458,0.0256,0.3617,-0.6664,-0.7181,-0.7318,-0.7559,-0.6944,-1,-0.6763,-0.6199,-1,-0.8725,0.3511,-0.7256,-0.7452,0.3148,0.4212,-0.5464,-0.5122,-0.5267,-0.5074,0.1523,0.3252,0.3254,0.5151,0.5377,0.2787,0.283,0.3666,0.3111,0.353,0.3653,0.3229,0.4457,0.3056,0.4253,0.1346,-0.094,-0.0367,-0.0383,-0.0627,-0.3245,0.0644,0.2195,0.0218,0.1284,0.0425,-0.0384,-0.3373,-0.3665,-0.2424,0.142,0.4209,0.3929,0.5834,0.4333,0.4226,0.4683,0.4995,0.2738,0.6378,1,0.3793,0.2653,0.1796,0.2024,0.2846,0.0321,0.0354,0.2804,0.2775,0.217,0.1572,0.3571,0.1173,0.456,0.3385,1,0.436,0.3551,0.2987,0.1173,0.1783,0.1444,0.4005,0.3585,0.2232,0.3071,0.3924,0.3992,0.4537,0.3426,0.4327,0.4182,0.1311,0.3852,0.0278,0.0726,0.039,0.2981,0.2936,0.1593,0.0911,0.5783,-0.1801,-0.1188,-0.2966,-0.1344,-0.1867,0.3229,0.3936,-0.0792,-0.0726,0.0059,0.0745,-0.0342,-0.246,-0.2752,-0.0468,-0.2404,-0.2236,-0.3921,-0.3397,-0.0693,-0.1755,-0.3322,0.1447,0.1449,0.0854,0.2861,0.3039,0.1625,0.1551,0.3971,0.3672,0.2092,-0.3084,-0.0505,-0.1621,-0.4352,-0.1319,0.2333,0.18,1,0.2952,0.2477,0.1055,0.0447,0.3278,0.1186,0.4939,0.0577,0.1496,0.3583,0.0544,-0.0236,0.4326,0.2788,1,0.4134,0.3488,0.2208,0.0792,0.4556,0.4414,0.306,0.3097,0.106,0.0162,0.1389,0.1037,0.4113,-0.1449,-0.1718,-0.3391,-0.0687,0.0265,-0.0233,-0.107,-0.0664,-0.4637,-0.1626,-0.4821,-0.2892,-0.3391,-0.2527,-0.4011,0.0285,-0.059,-0.0844,-0.2949,-0.0628,-0.2849,-0.1034,-0.103,0.0922,0.0463,-0.299,-0.1718,0.0135,-0.0096,-0.1671,-0.296,-0.3049,-0.002,0.1018,-0.0564,-0.4595,-0.3566,-0.0847,-0.4822,-0.6003,-0.6658,-0.3966,-0.5806,-0.5739,-0.5491,-0.2721,-0.4076,-0.3149,0.0452,-0.0477,-0.3241,-0.3526,0.574,0.5213,0.4271,0.0508,-0.0389,-0.0117,-0.1142,-0.2648,-0.3618,0.574,0.5213,0.4271,0.0728,0.1184,-0.0708,-0.1599,0.048,0.0689,-0.151,-0.334,-0.1599,-0.5527,-0.604,0.0011,0.1473,0.1836,0.4347,-0.3182,-0.2788,-0.1172,-0.1118,-0.1192,-0.2102,-0.1869,-0.3563,-0.3972,-0.1209,0.1473,0.1836,0.4347,0.232,-0.2068,0.6139,1,0.0166,1,0.5742,1,0.5838,1,-0.011,-0.4411,-0.1927,-0.1204,-0.4652,-0.5079,-1,0.2673,0.489,0.5286,1,0.4711,1,-0.0843,-0.1998,-0.3138,-1,-1,0.0759,0.2503,0.1815,0.2969,0.4868,0.1603,0.1814,0.5228,0.0051,1,0.2051,0.7902,0.7612,0.7571,-0.8562,-0.3739,-1,0.5889,0.6429,1,1,1,0.743,0.3892,0.5062,0.4303,-0.1135,-0.0606,-1,1,1,1,0.2323,0.5726,0.9907,1,0.3474,1,0.2694,0.1236,0.2786,1,1,1,1,0.6307,0.105,0.0657,0.25,0.3002,-0.249,-0.245,-0.1389,-0.1249,-0.6169,-0.8538,-0.1819,-0.6224,-1,0.0705,0.3974,0.2776,-1,-0.3617,0.2087,0.4835,0.3808,0.5327,0.3921,0.185,0.1124,-0.055,-0.8178,-0.2858,-0.163,-1,-1,-0.8419,-0.5485,0.1329,0.3324,0.3452,1,0.3877,-0.1449,-0.2988,0.1529,0.09,0.0337,-0.1239,-0.2355,-0.2465,0.201,0.3831,0.0482,0.0129,0.082,0.5313,0.1645,-0.0744,-0.1978,-0.0179,-0.147,-0.2375,0.0403,1,0.268,0.1757,0.3431,-0.0838,-0.1332,-0.0583,-0.0134,-0.1667,-0.1963,0.0841,0.1588,0.0671,-0.2502,-0.204,-0.3622,-0.8747,-0.4688,-0.076,-0.2961,1,1,1,1,-0.1982,-0.3151,-0.1868,-0.2253,-0.2504,-0.2787,-0.02,-1,-0.193,-0.3462,-0.306,1,1,1,1,-0.2508,-0.093,-0.2115,-0.3222,-0.1521,-0.08,-0.2178,-0.334,-0.9425,-0.4716,-0.278,1,0.9999,1,1,1,1,0.824,0.9177,0.9794,1,0.9241,0.6113,0.9216,0.272,-0.0309,0.6996,1,0.4682,1,-0.1801,0.1734,0.707,0.9951,0.6076,1,1,0.5499,0.9232,1,-0.017,1,1,1,1,0.0597,1,0.3342,0.9999,1,0.9368,0.9177,0.5781,0.2982,0.0101,0.1349,0.647,1,1,1,-0.2113,-0.2688,-0.2977,-0.1565,-0.1399,-0.2341,0.1976,0.4567,0.3359,-0.5815,-0.4364,1,0.5783,1,1,-0.1911,0.2872,0.5465,0.8454,1,0.8985,0.9359,0.1954,0.3619,0.5388,0.4403,0.7673,0.8325,0.6013,1,1,0.426,0.6103,0.7419,1,0.3175,0.7267,1,0.9999,1,-0.0209,0.0949,0.1185,0.3775,0.8119,0.3771,-0.2968,0.9441,0.2844,0.1864,0.0681,0.0845,1,1,1,-0.0209,0.1779,0.7277,-0.0247,0.0563,0.5147,0.6692,0.1476,0.0469,0.3728,0.9999,0.2271,-0.0209,0.0949,-0.0629,-0.3425,-0.0365,0.5524,-0.5689,0.6528,-0.5961,-0.4938,-0.3543,-0.1385,0.7551,0.9999,1,-0.0209,0.0949,0.2998,0.0175,0.9579,0.6202,0.3839,-0.0361,-0.2701,0.7389,0.9999,1,-0.0209,1,1,1,-0.0209,1,1,-0.015,-0.127,-0.1757,1,1,0.6931,-0.0369,0.1164,0.2652,0.0547,0.275,0.3377,-0.2321,-0.4515,0.8229,1,1,1,0.4536,0.5252,1,-0.0369,0.1164,0.635,0.0547,0.9887,0.9948,0.2266,0.1896,1,1,0.7915,1,0.3145,1,0.5779,-0.0369,0.1164,0.2081,0.0547,0.1257,-0.0203,0.153,0.2239,0.6204,1,0.2184,1,0.2784,1,0.0568,0.3637,0.1164,0.4624,0.2957,0.1257,-0.0032,-0.2001,-0.1373,0.413,1,0.0288,0.3395,1,-1,-0.2334,-0.0798,-0.1795,-0.0214,0.0547,0.1257,-0.0203,0.1441,0.2336,0.333,1,0.0948,0.4303,0.3209,1,0.2397,-0.5161,-0.3038,-0.5751,0.9723,0.4032,-0.0692,-1,-0.3436,0.1091,0.2482,1,1,0.2636,0.1,-0.0369,0.3143,0.2081,0.1766,0.1257,-0.0203,-0.4678,-0.2412,1,1,1,1,-0.4164,-1,0.1349,0.1603,0.2081,-0.6052,0.1257,-0.4602,-1,-0.3496,1,1,0.1232,-0.5332,-0.5617,0.2298,-0.5717,-0.4167,-0.9989,-1,-0.3732,1,-0.2213,-0.0973,-0.4736,-0.3265,0.2081,-0.2383,-0.4235,-0.4694,-0.2001,-0.3321,-0.2112,1,0.5316,-0.0369,0.8223,0.1057,0.2103,0.4543,0.2169,0.0315,0.1582,-0.2117,0.1389,0.1408,-0.0191,-0.078,0.2328,0.0547,-0.9938,-0.0203,-0.2995,-0.2314,-0.0369,0.5666,0.2081,0.0547,-0.4994,-0.4232,-0.2001,-0.2876,0.381,0.4574,0.2626,0.108,0.4751,0.097,-0.2001,-0.4698,0.4105,0.4085,0.4835,-0.3143,0.1257,-0.322,-0.0759,-0.0852,0.1274,0.3931,0.3881,-0.1613,-0.2801,0.0547,0.1257,-0.0203,1,0.7751,0.2106,0.4707,-0.0203,-0.2001,-1,0.2852,0.3811,0.4478,0.3215,0.3115,0.2249,0.2999,-1,-1,-0.2672,-0.2373,-0.2001,0.4692,0.9998,0.6742,0.5738,1,0.4452,0.1607,0.3637,0.722,1,1,0.6317,1,0.3401,-0.531,-0.3642,1,1,0.9998,1,0.9992,1,1,1,1,1,1,1,0.2338,0.3234,0.0793,1,1,0.9999,1,-0.149,0.2331,1,0.7541,0.7747,1,0.6276,0.9948,1,-0.3106,-0.2221,1,1,1,0.9999,0.1384,-0.0033,-0.1505,0.1016,0.3663,0.6183,-0.0621,-0.0646,0.2058,-0.1574,0.1552,0.9938,0.2877,0.184,1,0.0806,-0.2026,-0.1129,0.4329,0.3336,0.5096,1,0.5062,0.564,0.3826,1,1,1,1,1,1,0.3582,1,0.0291,0.0342,-0.0881,-0.3829,-0.1909,-0.1783,-0.2833,-0.1561,1,0.9999,0.9927,0.9999,0.0945,0.2993,1,0.0057,0.1019,0.3305,0.1044,0.3276,0.2956,-0.0385,-0.1561,1,1,0.9999,1,0.9996,0.5403,1,1,0.3949,1,1,0.7279,1,-0.253,-0.0512,1,1,1,1,0.2104,1,1,0.4969,0.5816,0.5386,0.3496,1,0.2576,0.1578,-0.3109,1,1,1,1,1,0.3143,1,0.3673,1,1,1,0.3453,0.2796,-0.3049,-0.0469,0.3119,-0.2861,1,0.6462,1,1,1,1,1,1,0.0381,0.6333,0.0181,0.2685,-0.7216,1,1,0.2903,0.8361,0.101,0.3726,0.0245,0.6717,0.8513,0.6333,0.0181,0.8341,0.7894,-0.122,-0.0828,0.3286,1,1,1,0.2457,0.1935,1,-0.1702,-0.4662,0.6333,0.0181,0.2685,-0.7868,1,1,0.3613,1,1,1,1,1,1,0.6333,0.0181,0.2685,-0.6371,-0.122,-0.0828,1,1,1,1,1,1,1,1,0.051,0.6333,0.0181,0.4551,0.5117,-0.122,-0.1655,1,1,1,1,0.2585,0.5315,0.5905,0.7553,-0.3044,0.6333,0.0181,-0.0601,-0.1633,-0.122,-0.0828,1,1,1,1,1,1,0.6989,0.7857,0.667,0.6333,0.0181,0.1405,-0.1633,-0.122,1,1,1,1,0.0904,1,1,1,0.8843,0.6333,0.0181,-0.0272,-0.1351,1,1,1,1,1,0.4743,1,0.7636,1,0.3555,0.7671,0.3284,0.5634,-0.2612,-0.3702,1,1,1,1,1,0.6693,1,0.3841,0.2726,0.235,-0.0178,0.0341,0.3028,0.1479,0.2166,1,1,1,1,1,0.6485,1,1,0.8789,0.8473,1,1,0.7764,0.3524,-0.2487,0.9676,1,1,1,-0.114,0.3268,0.4009,-0.4141,-0.5444,-0.2527,0.1063,0.4302,0.1082,0.3693,-0.2483,1,1,1,1,1,0.4004,1,-0.5861,-0.3642,-1,-0.6933,-0.6469,-0.0996,0.2021,0.182,1,1,1,1,1,0.8541,0.8491,0.7721,1,0.6511,0.2269,0.3245,0.5492,0.5334,0.6022,0.3425,0.3908,0.3039,0.2214,0.3278,0.9224,1,1,1,1,0.2989,1,1,1,0.5802,0.3543,0.4913,1,-0.1209,0.0686,0.5763,0.5456,0.5764,0.5819,0.3484,1,0.0795,1,0.375,0.4217,0.2821,0.2891,1,-0.0542,-0.2613,0.5663,1,1,0.5113,0.0358,-0.1305,0.0291,0.3004,0.212,0.8872,-0.0128,0.1131,0.1601,-0.0079,0.1063,0.4669,0.3249,0.1936,0.4329,0.0319,0.0612,-0.0481,0.0439,0.086,0.0836,0.0149,0.0824,0.0523,-0.1457,-0.2664,0.4661,0.485,1,1,0.2275,0.0324,0.0728,0.2772,0.9434,0.368,-0.0131,-0.0005,-0.2494,-1,-0.4805,0.6903,0.625,0.6797,0.7793,1,1,1,1,0.626,0.3976,0.1832,0.2841,0.3451,0.0314,0.0706,0.254,0.1828,0.1898,0.2681,-0.086,-0.4302,-0.0232,0.1396,0.3323,0.1795,0.0172,0.1574,0.0298,0.0475,0.1148,0.1914,0.0439,0.0772,0.3298,-0.1037,-0.2667,-1,-0.1027,-0.0745,-0.3759,-0.0015,-0.0263,-0.3188,-0.2998,-0.2757,0.1951,-0.1497,-0.2532,-0.0384,0.1729,0.1225,-0.0969,0.4675,-0.1957,-1,-0.4674,-0.1498,-0.2206,-0.4304,-0.4125,0.2985,0.3495,1,1,0.2106,0.0555,0.1257,0.4675,0.0277,0.0681,-0.0195,0.0139,0.0071,-0.2022,-0.1824,0.2616,0.2309,0.0893,0.2506,0.3165,0.4478,0.7824,0.955,0.9999,0.9997,0.9997,1,1,0.4686,0.3778,0.2119,-0.2347,-0.0408,-0.2755,-0.3394,-0.9644,0.9289,0.9537,0.9999,0.9999,0.9633,-0.2868,-0.1517,-0.1307,-0.1574,-0.1464,-0.2537,-0.072,-0.061,-1,-0.8993,0.9568,0.9864,0.8605,0.9975,0.9997,0.1551,0.3448,0.2363,1,0.6391,0.1786,0.3686,0.0814,-0.2012,-0.2156,0.8975,0.9845,0.7024,1,1,1,0.2234,0.265,0.471,-0.0598,-0.2878,0.0412,0.043,-0.4713,-0.4314,0.9428,0.9999,1,1,0.3342,0.9836,0.529,0.2362,0.031,0.6549,0.8754,1,0.3968,0.0428,0.0882,0.9428,0.9778,0.9999,1,0.3002,0.2348,0.1842,0.0391,0.1142,1,0.2114,0.5108,0.5216,0.2763,0.3939,1,1,1,1,0.4915,1,1,0.3721,0.6743,0.5615,1,1,0.2448,0.1443,0.0482,0.8653,1,1,1,0.2538,1,1,1,0.9008,0.4018,0.1852,0.1629,0.7534,0.1407,0.0664,0.7736,1,0.6699,1,0.1865,0.0684,-0.1871,-0.2942,-0.4808,-1,-0.6599,-0.9409,-0.6364,-0.9096,0.0196,1,1,1,1,0.6275,1,1,0.499,0.2544,0.2292,0.1593,0.4332,0.3433,0.1896,0.2947,0.9686,-0.0582,-0.1123,-0.0516,0.1491,0.2199,0.2284,-0.0413,0.0939,0.0121,1,0.178,0.2261,0.0271,0.0196,0.9965,1,1,1,0.6434,1,1,0.6605,0.3252,0.302,-0.1321,-0.116,-0.3528,-0.536,0.0196,1,1,1,0.9344,0.6728,-0.1465,1,-0.5832,-1,-0.7024,-0.7334,-0.755,-0.5827,-1,0.0196,0.7094,0.2464,0.2248,0.7636,0.5354,0.8462,0.4111,0.4442,0.2144,0.2302,-0.291,-0.368,-1,-0.9205,-0.5158,1,1,1,1,0.5055,1,0.2114,0.2382,1,0.2656,0.177,0.2305,1,-0.0619,-0.0255,1,1,1,1,0.5154,0.497,0.2417,0.6084,0.5364,0.5264,0.9964,0.4464,0.869,0.1651,0.1484,0.9246,1,1,1,0.6304,0.8981,0.9306,0.6441,0.1481,0.0328,1,1,0.9072,0.1837,0.1446,0.7822,0.9767,1,1,0.3699,1,1,0.5739,0.5204,0.37,0.9999,0.3743,0.9871,0.3735,-0.1674,1,1,1,1,0.5037,0.1414,0.1155,0.1545,0.1891,0.4972,-0.0603,-0.2985,0.0493,-0.1084,-0.3458,0.7811,0.8767,0.7457,1,0.5507,1,1,1,0.2284,0.4489,-0.0261,-0.0465,0.0734,0.1122,-0.0345,1,1,1,1,0.3872,1,1,1,0.4873,0.3241,1,1,0.8771,0.1955,0.2557,0.9894,1,0.2914,1,0.1134,1,0.4704,1,0.1558,0.4002,0.1488,0.3138,1,0.1422,0.4303,1,1,1,1,0.5284,1,1,1,1,0.3625,1,1,1,0.0732,0.0427,0.7732,0.2979,1,1,0.0997,-0.1892,-0.3045,0.7076,0.7151,0.935,0.5989,0.8039,0.8576,0.4908,0.0196,0.9111,1,1,1,0.5524,1,1,1,0.0927,0.0648,-0.1626,-0.2397,-0.3541,-1,-0.6075,0.505,1,1,1,0.2928,0.7935,0.6297,1,1,1,1,1,0.4318,0.2504,0.2931,1,1,1,1,0.5626,1,0.2168,0.0408,0.4431,-0.1409,-0.619,-0.2209,-0.9324,-0.8996,-0.5402,0.8682,0.8541,0.2875,0.162,1,0.2471,0.4118,0.0014,-0.0111,-0.3063,-0.4353,-0.3607,-0.4994,0.0196,0.4207,0.9273,1,1,1,0.7942,1,0.8136,0.3096,-0.252,-0.2547,0.5563,0.2733,0.0812,0.1894,0.3445,0.8521,0.0565,0.0196,0.2809,1,0.4367,0.0729,0.3324,-0.0251,-0.362,-0.3853,-0.5397,0.0196,0.2728,1,1,0.1875,0.308,0.4331,0.5198,0.4687,0.0196,0.4697,0.0196,0.7608,0.97,0.9061,0.3418,0.7416,0.6179,1,1,1,0.7004,1,0.4113,1,0.5946,0.6401,1,1,1,0.901,-0.0193,-0.071,0.2678,1,0.0459,0.5217,0.3689,0.1785,0.1281,0.5965,0.2071,1,0.2427,1,0.2122,-0.196,-0.1619,-0.0663,-0.004,-0.1358,0.0432,0.0763,-0.1803,-0.119,0.431,0.1597,0.344,0.3602,0.4688,0.3939,0.0028,-0.0052,0.189,1,0.1258,1,0.2331,-0.0799,-0.2993,-0.0349,-0.1174,-0.3168,-0.073,-0.1118,-0.4844,-0.4829,-0.3677,0.3244,0.2201,0.1184,0.4385,-0.0628,-0.5071,-0.4703,-0.3883,-0.3395,-0.5835,-0.5176,-1,-1,-0.5885,-1,0.2143,0.2182,0.0543,0.8947,0.4119,0.3009,0.1413,0.4801,0.8799,-0.0453,-0.434,-0.4851,-0.4796,0.1767,0.1139,0.2095,0.2074,0.048,0.3159,0.3936,0.3785,0.2393,0.5121,0.4646,0.5295,0.473,0.5922,0.1743,0.2039,-0.2715,-0.4336,-0.3608,-1,-0.0472,-0.111,-0.1144,0.0112,-0.0619,-0.4279,-0.4718,-0.0597,-0.0813,-0.2701,0.168,0.3363,0.0081,-0.354,-0.2312,0.1277,-0.1223,-0.1629,0.219,0.318,0.3854,0.1812,0.5422,0.5295,0.3281,-0.0274,-0.1731,-0.429,-0.2551,-0.2365,0.4069,0.9431,0.395,0.6796,1,1,0.6249,0.6768,0.4919,1,0.3774,0.5822,0.458,0.4194,0.3462,0.2632,0.1445,0.0767,0.4323,0.5551,0.4857,0.3119,-0.1629,-0.1533,-0.2409,-0.3249,0.0033,0.3661,0.5006,0.7038,0.1938,0.0744,0.1362,0.5027,0.2194,0.0771,-0.0545,0.0512,0.154,0.544,0.4435,0.6387,0.5726,0.1762,0.1384,-0.1068,-0.0288,-0.0849,0.028,-0.0895,-0.4189,-0.06,0.4742,0.4167,0.7933,0.3026,0.4445,0.5072,-0.319,-0.1366,0.0908,0.1805,0.471,0.5899,0.5197,0.5924,1,0.8879,0.7739,1,0.7337,1,0.6302,0.6694,0.3649,-0.0879,-0.2179,-0.3184,-0.046,0.0253,0.4369,-0.0574,-0.255,-0.4056,-0.2264,0.3879,0.1917,0.1133,0.0651,-0.1766,-0.1431,-0.0249,-0.2704,-0.3931,-0.1863,0.3578,0.0886,0.1986,0.0496,-0.1198,-0.0527,-0.2536,-0.406,0.4121,0.294,0.2049,0.5812,0.2282,0.0723,0.0978,0.1811,0.0794,0.0961,0.4811,0.4653,0.2974,-0.0413,-0.1095,0.6777,0.6661,0.5358,0.8178,0.5806,0.5445,0.3678,0.1652,0.6477,0.0774,0.5552,0.5626,0.0658,0.4754,-0.062,0.4411,1,0.2223,0.4811,1,0.005,0.0724,0.1652,0.5295,0.2066,0.2825,0.5236,0.0658,-0.0837,-0.1779,0.3488,0.3208,0.2748,0.6469,0.4162,0.3925,0.4728,0.0337,-0.0247,-0.5979,-0.5376,-0.4124,-0.4434,-0.7815,-0.4266,0.4735,0.3864,0.3781,0.3343,0.1332,-0.0271,-0.1065,0.0882,0.4215,0.4836,0.1786,0.2039,0.4618,-0.4041,-0.2776,0.5874,0.1605,-0.6947,-0.2492,-0.4429,-0.1737,-0.4347,-0.8708,-0.7048,-0.2848,-0.1676,-0.2902,-1,-0.3776,-0.6044,-0.4834,-0.3248,-0.5801,-0.1609,-1,-0.3555,-0.0935,-0.5771,-0.676,-0.4175,-0.2561,-0.6369,-0.5469,-0.5242,-0.1247,-0.905,-0.4211,0.3608,0.1835,0.0749,1,-0.0921,-0.2844,-0.1405,0.0524,0.3637,0.7778,0.0488,0.0787,0.1479,-0.0664,-0.1375,0.2859,-1,0.9677,0.9999,1,0.8002,0.5173,0.9986,0.8807,1,0.5033,1,1,-0.1462,-0.1671,1,0.8152,0.4901,0.8885,0.1954,0.26,0.0655,0.9968,0.8488,0.1746,1,0.1796,1,0.2151,0.4854,0.644,0.9876,1,0.9439,0.5646,0.5925,0.1871,-0.1334,-0.2892,-0.4927,0.2563,0.5365,0.5295,0.0121,0.1285,0.9999,1,1,1,0.1672,0.0221,0.3223,1,1,0.4581,-1,-0.4461,-0.6024,-0.2156,-0.3212,0.383,1,1,1,0.8774,0.5036,1,0.0055,0.2221,0.4063,1,0.608,0.2488,0.276,0.3741,0.8213,0.6701,0.4349,1,0.0527,-0.0432,-0.2256,0.4309,0.6731,0.6315,0.1559,0.2384,0.8615,0.5863,0.5863,0.5863,0.3551,0.3551,0.3551,0.8154,0.827,0.1451,0.0542,-0.0059,-0.0918,-0.2286,-0.4183,0.0773,0.1935,0.1607,0.2683,0.0885,1,0.4908,0.406,1,0.0934,0.0996,0.0474,0.253,0.2989,0.2068,0.2306,0.2875,0.4714,0.1065,0.1194,0.3894,1,0.2742,0.3777,0.1421,0.1772,0.0299,0.1986,0.3079,0.2324,0.2097,0.3707,1,0.1839,0.3588,0.2983,0.4869,0.2777,1,0.0614,0.0045,-0.0564,0.0297,0.2242,0.1944,0.2846,1,0.0901,1,0.3332,0.425,0.226,0.3017,0.3489,0.2136,0.9967,0.3995,0.2716,0.323,0.25,0.2546,0.148,0.3215,0.1742,-0.0626,-0.0987,-0.1849,-0.1056,-0.3429,-0.4324,-0.0876,-0.1665,-0.4194,-0.5615,-0.4269,-0.4423,-0.1699,-0.2036,0.278,0.2416,0.2013,0.218,0.1746,0.1916,0.4059,0.2391,0.1883,0.0711,0.7546,0.5001,0.4668,0.2966,0.3426,0.0297,-0.1388,-0.2672,-0.022,0.0518,0.699,-0.4532,-1,-0.4028,-0.4025,-0.3303,-0.1067,-0.0038,-0.302,-0.9997,-0.2915,-0.8714,-0.2422,-0.3356,-0.0272,-0.297,-0.356,-0.3899,-0.4283,-0.1313,-0.0097,0.2967,0.1151,0.1555,0.3332,0.3562,0.1206,0.0427,0.1764,0.0705,0.2444,0.2568,0.3674,0.3986,0.2008,0.1673,-0.0382,-0.1062,-0.0677,0.0844,0.0129,-0.0458,-0.2571,0.0388,0.01,0.0579,0.0767,0.0293,0.2547,0.1351,0.1878,0.014,-0.0601,-0.0047,-0.0043,0.0231,0.0343,0.0424,0.3589,0.0402,0.0026,-0.1517,0.0372,0.5609,-0.3924,-0.3774,0.0372,0.0698,0.2352,0.2722,0.2603,0.1721,0.0939,-0.041,-0.1847,-0.225,-0.4371,-0.3959,-0.4615,-0.446,-0.181,-0.1924,-0.3286,-0.2537,-0.5718,-0.3954,-0.5026,-1,-0.4387,-0.894,-0.3147,-0.274,-0.4185,-0.2447,0.0601,0.0975,0.1026,0.2483,0.0344,-0.0365,-0.1888,-0.1654,-0.0921,-0.1985,-0.3725,-0.3325,-0.3157,-0.1087,-0.0243,-0.0221,-0.2167,-0.1995,-0.1004,-0.0444,-0.4065,-0.0871,-0.1131,-0.0116,-0.1461,0.0008,0.0871,0.2959,-0.4994,-0.3927,0.3626,0.1196,0.241,0.3898,0.078,0.0166,0.0723,0.0958,0.3289,0.146,0.3371,0.2333,0.2155,-0.0201,-0.0123,0.0175,0.2197,-0.0821,-0.2035,-0.357,0.2601,-0.0991,-0.1372,-0.3185,-0.0693,-0.1105,0.0643,-0.0926,0.1368,0.1005,0.3028,-0.0094,-0.066,-0.4543,-0.1683,-0.1665,-0.343,-0.2329,0.013,-0.0902,0.0843,0.3374,0.2659,0.3526,0.4429,0.1934,0.6498,0.4814,0.1334,0.064,-0.0621,-0.1892,-0.4469,-0.2506,-0.3096,-0.4179,-0.0329,-0.4786,-0.195,0.1334,0.064,-0.014,0.3487,0.4066,1,-0.4866,-0.2576,-1,-0.314,-0.1187,0.2307,0.4259,0.4622,0.2952,0.3671,0.1692,0.1692,0.1692,0.2353,0.1182,-0.0381,0.1692,0.1692,0.1692,0.0315,0.0097,-0.0381,0.1808,-0.0673,-0.2185,-0.0779,-0.1195,-0.3299,-0.3624,0.3111,0.1835,0.0485,-0.4301,-0.0312,-0.1961,-0.2908,-0.3834,0.1491,-0.1433,-0.1527,0.0223,0.1508,-0.225,0.233,0.0256,-0.1326,-0.2695,-0.0023,0.1145,0.1634,-0.0997,-0.1256,-0.495,-0.3384,-0.3596,0.1912,-0.0387,-0.4916,-0.3894,-0.348,-0.0305,-0.1237,-0.1638,-0.0716,0.0159,-0.046,-0.2547,0.094,0.1289,-0.1726,-0.4916,-0.3894,-0.348,-0.1193,-0.1442,-0.545,-0.1817,-0.0712,0.0984,-0.1817,-0.3024,-0.5396,0.7157,0.4789,0.187,0.1881,0.409,0.3448,-0.0656,-0.0618,-1,-1,-1,0.2191,0.2926,0.4186,0.2318,-0.1034,-0.1499,-0.0669,-0.389,-0.1866,-0.2028,-0.3812,-0.2707,-0.8436,0.3063,0.3717,-1,0.4862,0.3492,0.142,0.4467,0.4571,0.0687,1,0.5189,0.4235,0.0365,0.1242,0.0334,-0.2456,-0.2385,-0.1994,0.4385,0.1891,0.1413,1,0.004,0.1075,0.247,0.4032,0.9859,-0.2642,-0.2436,-1,-1,-1,-1,1,0.4252,0.4907,0.2187,0.2369,0.3369,0.4853,0.5309,0.5713,0.3951,0.4429,-1,-0.018,-0.0747,-0.0191,-0.2729,-0.5317,-0.4674,0.4945,0.3906,0.4032,0.3827,0.4771,0.467,0.2056,0.2784,-0.5138,-0.0602,-0.0556,0.0188,0.3226,0.2883,0.3323,0.112,0.5142,0.297,0.3343,0.3312,0.3683,0.4226,0.4952,-0.7991,0.3079,0.312,-1,0.405,0.3088,0.2804,0.1708,0.2739,0.1473,0.2065,0.2215,0.3536,0.6369,0.7195,0.0441,-0.0901,-0.2057,-0.1758,0.3952,0.263,0.1311,0.4117,0.4367,0.3488,0.4358,0.3943,0.4592,0.4964,0.5856,-0.7129,-0.2241,-0.2132,-0.0911,-0.2624,-0.382,-0.364,0.5399,0.4754,0.3425,0.2815,0.4384,0.7241,-0.2066,0.0145,-0.8078,-0.0512,0.0615,0.3869,-0.0957,-0.1886,-0.5984,0.5455,0.2564,0.2493,0.4167,0.4817,0.4655,-0.2722,-0.2316,-0.8782,0.0758,0.4599,0.6224,-0.2386,-0.5454,-0.9013,-0.3819,-0.3495,-0.5154,-0.2563,-0.2229,-0.0563,0.3483,0.4799,-0.5265,-0.0492,-0.1916,-0.1404,-0.1478,-0.3496,-0.317,0.1019,0.3562,0.1796,0.3228,0.3946,0.373,0.3438,0.3476,0.328,0.3025,0.2597,-1,-0.2977,0.1287,0.4501,0.4678,0.4508,-0.1077,-0.4943,-0.4548,-0.2519,0.2121,0.3362,-0.8301,-0.1383,-0.1579,-0.0409,0.4179,0.1409,0.0768,0.4403,0.4441,0.2022,0.3277,0.4387,0.4157,0.1981,-0.2367,-0.5704,-0.2165,-0.2153,-0.1562,0.3353,0.4277,0.271,-0.0141,0.0684,0.2274,0.4306,0.5918,0.5716,0.2993,0.3549,-1,0.2019,0.2988,0.5063,0.3534,0.2161,0.0256,0.0378,0.3138,-0.0899,-0.4497,-0.2041,-0.4293,0.0768,0.211,0.0627,-0.1004,-0.185,-0.2008,0.3343,-0.1176,-0.3173,-0.0539,-0.284,-0.1851,0.3456,0.4254,0.3988,0.3384,0.339,0.4229,0.4961,0.4761,0.6687,0.3086,0.2452,0.288,-0.1254,-0.2876,-0.4746,-0.3642,-0.4513,-0.0173,-0.1714,-0.3825,-0.8158,-0.4235,-0.416,-0.319,-0.3576,-0.4678,-0.4031,-0.2245,-0.3449,-0.3276,-0.4178,-0.4523,-0.4399,0.1339,0.1738,0.1256,-0.1744,-0.2527,-0.0371,0.8066,0.6962,0.8314,0.4702,0.3771,0.2364,-0.4643,-0.4018,-0.4023,-0.4049,-0.3935,-1,-0.1632,-0.1968,-0.1073,0.0108,0.0691,0.1549,-0.1158,-0.2522,-0.2927,-0.8524,-0.5077,-0.4356,-0.0075,0.0422,0.1259,0.4363,-0.7094,-1,-0.1089,-0.348,-0.3013,0.4286,0.2036,0.3129,0.2471,0.3395,0.3035,-0.387,-0.2448,-0.1377,-0.2388,-0.1271,-0.3588,-0.5253,-0.4567,0.3101,0.3556,0.3007,0.3016,0.8043,0.485,0.0183,0.0585,-0.3037,-0.2769,0.0022,0.1089,-0.051,-0.3734,1,0.499,0.3477,0.4758,0.5477,0.7673,-0.3345,-0.2922,0.202,0.3767,0.4446,0.4079,0.2465,0.3409,-0.1784,-0.3117,-1,0.2559,0.3013,0.4068,0.3032,0.3726,0.295,-1,0.4454,-0.0346,-0.307,-0.4432,-0.314,-0.0937,-0.02,0.1318,0.2942,0.379,-0.1084,-0.07,-0.3246,-0.2904,-0.1639,-0.3116,-0.4459,-0.4451,0.603,0.6039,1,0.5321,0.5504,0.5623,-0.3662,-0.2373,-0.159,0.0309,0.2477,0.1712,0.0225,0.0454,1,0.7418,0.6999,0.7327,0.7001,0.6917,0.3972,0.4302,-0.2083,-0.335,-0.1067,0.326,0.3282,0.3479,0.4845,0.4877,0.4283,0.0843,0.2702,0.2356,0.3794,0.5361,0.2801,0.2672,0.1977,0.4361,1,0.3551,0.4142,0.4263,0.4602,0.1827,0.3952,-0.3786,-0.6021,-0.4979,0.7849,0.4445,0.4899,0.2403,0.3903,0.3732,0.6003,0.6996,0.0347,-0.0696,-0.3427,-0.103,-0.1016,-0.1196,-0.4468,-0.4489,-0.429,0.6293,0.6801,0.165,0.1158,0.0173,0.0351,0.0143,-0.1005,0.1965,0.2067,0.2823,0.2757,0.4181,-0.3003,-0.4614,-0.4742,0.006,0.0652,0.0803,-0.8547,-0.5371,-0.4276,0.5625,0.7341,-0.1811,-0.4578,-0.4322,0.3036,0.281,0.2583,0.1312,0.1423,0.1152,0.0041,0.0856,0.165,0.2234,0.2931,-0.3029,-0.4501,-0.2657,-0.2715,-0.2737,-0.312,0.5524,0.7,0.0563,0.0902,0.2721,0.1275,0.2723,0.1722,-0.0818,-0.129,-0.2395,-0.2165,-0.0985,-0.149,-0.1715,-0.2742,-0.5241,-0.5049,-0.511,-0.3734,-0.3087,-0.3243,-0.185,-0.319,-0.304,-0.2203,-0.3717,-0.4136,-0.3594,-0.1144,-0.1531,-0.1627,-0.2978,-0.3745,-0.3471,-0.2426,-0.2551,0.3974,0.5198,0.4747,-0.4834,-0.4814,-0.3122,0.0228,0.0096,-0.2077,-0.2999,-0.3731,-0.5129,-0.4913,-0.4601,-0.1639,-0.1679,0.4167,0.3113,0.232,-0.1755,-0.1921,-0.5229,-0.5567,-0.4999,-0.3819,-0.2774,-0.1986,0.0096,-0.467,-0.368,-0.5114,-0.3896,-0.0252,-0.1071,0.2131,0.2945,-0.3922,-0.3615,-0.3291,-0.3569,-0.3047,-0.2602,-0.094,-0.0982,-0.0613,-0.4867,-0.6121,0.1212,0.1731,0.2578,0.0619,0.2341,0.3918,0.0012,0.0663,-0.1631,-0.0512,0.0131,0.2213,0.3612,0.2652,0.2784,0.5627,0.4398,0.3849,-0.1396,-0.2037,-0.2532,-0.1855,-0.2515,-0.1844,0.0484,0.2316,0.3156,0.3138,0.3391,0.3971,0.4102,0.6804,0.697,0.4463,0.7199,1,0.5321,0.4069,-0.6658,-0.118,0.0255,0.1265,0.2961,-0.254,-0.1787,0.0576,0.1492,0.1254,0.1634,0.0813,0.4397,0.3364,0.379,-0.0899,-0.2095,-0.0032,-0.0302,0.0518,0.0397,-0.0526,-0.1625,-0.4025,-0.1981,-0.6053,-0.2369,-0.4085,-0.4602,-0.3024,-0.1252,-0.0277,-0.1077,-0.0331,-0.0748,0.2604,-0.0429,-0.1204,-0.0752,0.0974,0.2467,0.1246,0.2081,0.0025,0.0279,0.2005,0.4439,1,-0.0933,-0.0075,-0.0413,-0.2977,-0.1302,-0.2202,0.4032,0.315,0.1352,0.2282,0.4276,0.1728,0.4215,0.471,0.0029,-0.0746,-0.0036,-0.0632,-0.2204,-0.0082,-0.083,-0.3051,-0.3178,-0.3362,0.1782,0.168,0.223,-0.5224,-0.4413,-0.4906,-0.0668,-0.0592,-0.092,-0.1714,-0.0753,-0.0685,0.069,0.1309,0.1357,0.2869,0.1742,0.0525,0.3936,0.4945,0.5278,-0.0184,-0.1117,-0.1421,-0.1049,-0.0807,-0.0759,0.0418,0.2073,0.1268,0.4366,0.4816,0.2349,0.3385,0.4242,0.352,0.1668,0.3566,-0.1056,-0.0581,0.4184,0.1112,0.2673,0.3154,0.4213,0.4763,0.0664,0.4155,0.4527,0.5266,0.5027,0.6191,-0.2487,-0.304,-0.4173,-0.5214,-0.3078,-0.0358,0.0288,0.1506,0.1708,-0.0724,-0.1335,-0.1541,-0.2531,0.1424,0.1424,0.149,0.0304,-0.033,-0.0845,-0.0767,-0.42,-0.11,-0.1335,-0.1541,-0.2531,-0.2422,-0.2301,0.7289,0.7289,0.7289,0.1864,0.0458,0.5206,0.6789,-0.2175,-0.1155,0.1026,0.0388,0.7289,0.7289,0.7289,0.2523,0.6419,0.7435,0.6756,0.5433,0.7788,0.4596,0.2954,0.4874,0.4874,0.4874,0.4291,0.524,1,1,0.0157,-0.1982],"StimmenT":[0.581,0.4611,0.5434,0.5846,0.5803,0.6244,0.4873,0.571,0.5955,0.6304,0.7419,0.7724,0.714,0.7355,0.5805,0.4918,0.4095,0.5329,0.4988,0.5621,0.5405,0.4674,0.6507,0.6992,0.5337,0.6738,0.6362,0.5971,0.5159,0.6101,0.5192,0.4,0.5622,0.5491,0.5311,0.54,0.5456,0.5463,0.5813,0.4646,0.6965,0.6649,0.521,0.7135,0.7132,0.4205,0.3113,0.5091,0.4796,0.5096,0.4733,0.4263,0.3706,0.4164,0.3742,0.4646,0.2707,0.2344,0.3763,0.2987,0.4566,0.3807,0.538,0.551,0.5906,0.5632,0.5475,0.3275,0.5232,0.5037,0.3911,0.2636,0.4725,0.5205,0.4988,0.4768,0.3771,0.5107,0.5662,0.642,0.5896,0.3582,0.3327,0.2563,0.4893,0.3959,0.4855,0.3855,0.5604,0.5398,0.5417,0.5197,0.4975,0.5038,0.5662,0.5916,0.4262,0.358,0.3151,0.5316,0.6322,0.602,0.5532,0.6033,0.5676,0.5571,0.6421,0.1965,0.4085,0.2149,0.2267,0.3379,0.4897,0.7194,0.762,0.3109,0.3599,0.4424,0.3118,0,0,0,0.3622,0,0.2511,0.222,0.8273,0.2244,0.5274,0.7172,0.5464,0.6122,1,1,1,0.7365,1,0.7236,0.7284,0.672,0.6594,0.8025,1,0.7175,1,0.7153,0.7094,1,1,0.7104,0.4783,0.3766,1,0.7525,0.7231,1,1,1,0.5315,0.5696,0.5694,0.5943,0.6379,0.6453,1,0.6095,0.5433,0.5207,1,0.519,0.8885,0.7031,0.6553,0.7166,1,0.2388,0.2672,0.3398,0.4549,0.2519,0.3959,0.367,0.6731,0.5221,0.6597,1,0.8412,0.5218,1,0.7073,0.2629,0,0,0.3407,0.3429,0.3392,0.6169,0.5481,0.5376,0.5082,1,0.6971,0.6506,0.4823,0.5457,0.7847,0.6447,0.7558,1,0.7449,0.6252,0.7222,0.7691,0.8484,1,1,1,1,0.6985,0.7065,0.4611,0.5478,0.6636,0.6575,1,1,1,0.7445,0.7461,0.7839,0.7222,0.8043,0.7228,0.8435,0.8184,0.4131,0.3891,0.4531,0.4429,1,0.8294,0.5915,0.6956,0.9183,1,0.8379,1,0.7028,0.7225,1,0.4151,0.4704,0.4782,0.4178,0.489,0.3263,0.4296,0,0.3886,0.3938,0.6511,0.6667,0.5341,0.5446,0.7006,0.8228,0.7531,0.8039,1,0.7478,1,1,0.6899,0.9173,1,1,0.8082,1,0.8404,0.8248,1,1,0.45,0,0.4962,1,1,0.7322,0.3733,0.4438,0.5351,0.5853,0.3526,0.3762,0.3896,0.3969,0.4248,0.426,0.4104,0.4345,0.4377,0.3663,0.3258,0.6804,0.6166,0.6079,0.4365,0.3969,0.4476,0.4664,0.3315,0.3554,0.3403,0.4127,0.3969,0.3312,0.2886,0.3037,0.3947,0.3187,0.3586,0.2578,0.4253,0.5269,0.435,0.4477,0.6315,0.5577,0.6285,0.6623,0.5659,0.6037,0.6095,0.6239,0.6124,0.6761,0.5771,0.4437,0.4484,0.6942,0.6683,0.6078,0.5221,0.633,0.7037,0.6466,0.6124,0.6613,0.765,0.5261,0.4469,0.2819,0.2788,0.5921,0.6447,0.7204,0,0.1889,0.3973,0.2557,0.3287,0.5147,0.4283,0.3436,0,0.2912,0.326,0.1929,0,0,0.1889,0.3973,0.0937,0,0.6616,0.6752,0.6553,0.4335,0.4804,0.5023,0.5049,0.4423,0.4133,0.4456,0.4769,0.4117,0.3751,0.6616,0.6752,0.6553,0.2745,0.3182,0.4325,0.4149,0.4931,0.4224,0.4625,0.4095,0.3844,0.701,0.794,0.7671,0.7564,0.6989,0.5429,0.7612,0.7319,0.4566,0.3203,0.4608,0.4321,0.4686,0.4444,0.4832,0.6172,0.6643,0.5746,0.6826,0.6573,0.8817,0.3801,0.3078,0.3699,0.3468,0.4393,0.469,0.5269,0.5776,0.5516,0.6211,0.5596,0.4993,0.587,0.5164,0.4909,0.3326,0.3514,0.5216,0.5453,0.6299,0.6022,0.5616,0.4644,0.5835,0.663,0.6108,0.4064,0.3828,0.3345,0.3436,0.3371,0.3495,0.3837,0.3536,0.4402,0.4125,0.2708,0.2994,0.3182,0.3134,0.2745,0.205,0.2543,0.2364,0.2243,0.2475,0.3326,0.3778,0.485,0.4685,0.414,0.3065,0.3395,0.4408,0.3969,0.3838,0.4131,0.69,0.611,0.5053,0.6125,0.57,0.3033,0.2934,0.4003,0.3602,0.3359,0.3669,0.4142,0.5655,0.5255,0.4653,0.2096,0.2539,0.2316,0.4183,0.4443,0.3598,0.3873,0.4119,0.5203,0.5961,0.6137,0.6099,0.7059,0.7446,0.6715,0.6279,1,0.769,0.512,0.6208,0.3282,0.3189,0.4196,0.416,0.5088,0.4984,0.566,0.4434,0.3789,0.3833,0.6902,0.6715,0.5703,0.5577,0.6456,0.6101,0.5612,0.639,0.6526,0.6428,0.638,0.6998,0.8265,0.8635,0.8533,0.9594,0.7735,0.8148,0.8416,0.835,0.5158,0.5168,0.5934,0.6139,0.5829,0.6547,0.6846,0.6762,0.7054,0.6299,0.3198,0.2952,0.326,0.3086,0.2964,0.4467,0.3869,0.453,0.4773,0.2394,0.2843,0.338,0.2626,0.2663,0.209,0.3651,0.2989,0.3107,0.4665,0.5012,0.5193,0.4497,0.6613,0.683,0.7183,0.5554,0.7111,0.5037,0.4816,0.2636,0.3464,0.3052,0.3947,0.7883,0.8006,0.5923,0.4561,0.6285,0.5735,0.6796,0.5846,0.6973,0.4986,0.6361,0.6418,0.7067,0.6734,0.6607,0.5696,0.5457,0.6106,0.5904,0.4828,0.5342,0.4918,0.3417,0.4254,0.5037,0.5894,0.3592,0.5222,0.6532,0.4193,0.4188,0.5124,0.5079,0.563,0.4528,0.3587,0.3121,0.3254,0.3946,0.3901,0.3414,0.6902,0.3386,0.5706,0.5486,0.5635,0.6427,0.6165,0.5576,0.3319,0.2955,0.3364,0.3807,0.4558,0.4589,0.5026,0.4023,0.5441,0.5195,0.5086,0.4747,0.5644,0.5721,0.5329,0.4214,0.3489,0.5418,0.4419,0.4744,0.4492,0.3205,0.7013,0.3506,0.4419,0.3245,0.3108,0.289,0.2762,0.3186,0.5749,0.526,0.4838,0.4144,0.437,0.5418,0.4988,0.4929,0.4608,0.4433,0.4163,0.4235,0.2895,0.3325,0.4089,0.6366,0.65,0.568,0.5685,0.6356,0.6562,0.2943,0.5751,0,0.6179,0.6003,0.4719,0.6774,0.8587,0.7306,0.8485,1,0.5698,0.5003,0.6114,0.6068,0.649,0.3912,0.9075,0.9465,0.9489,0.9534,0.7737,1,1,0.7107,0.6902,0.6194,0.6565,0.7165,0.729,0.6963,0.698,0.6283,0.7783,0.7865,0.7563,0.9019,1,0.7226,0.8228,0.86,0.9098,0.628,0.7207,0.723,0.5352,0.4966,0.9189,0.951,0.5417,0.5834,0.6938,1,0.6437,0.7479,0.6643,0.6708,0.7322,0.7611,0.7659,0.8207,0.7053,0.7297,0.916,0.9503,0.9445,0.9331,0.7844,0.8042,0.9127,0.923,0.6291,0.7774,0.8138,0.8163,0.7063,0.6967,0.7857,0.7406,0.7845,0.7119,0.8943,0.8869,0.9291,0.9195,0.8999,0.616,0.424,0.3989,0.5042,0.7268,0.6653,0.8178,0.8705,0.8777,0.8711,0.9149,0.9301,0.949,0.8461,0.8362,0.5686,0.7116,0.7614,0.7541,0.6191,0.6818,0.7704,0.8366,0.8114,0.7945,0.824,0.747,0.8041,0.3471,0.3417,0.7062,0.6419,0.7057,0.7057,0.7619,0.6389,0.5516,0.8496,0.7691,0.7611,0.2974,0.367,0.3547,0.7243,0.7739,0.7279,0.3816,0.4718,0.472,0.5684,0.5758,0.6466,0.6324,0.6812,0.502,0.42,0.3671,0.3717,0.9131,0.9309,0.5048,0.6973,0.9081,0.7159,0.574,0.4875,0.5164,0.8287,0.8191,0.7747,0.9641,0.9709,0.9723,0.9631,0.9545,0.415,0.4908,0.461,0.3981,0.4623,0.5168,0.6201,0.6557,0.5425,0.3499,0.8547,0.8437,0.8045,0.8498,0.88,0.578,0.5798,0.5937,0.5834,0.7405,0.8077,0.8676,0.7508,0.4675,0.4267,0.9351,0.9106,0.9321,0.6364,0.8277,0.6642,0.6844,0.7313,0.7243,0.5776,0.5326,0.5226,0.9703,0.9635,0.9621,0.9016,0.5602,0.6121,0.3941,0.3359,0.6212,0.6376,0.6705,0.5572,0.7477,0.7881,0.7874,0.8324,0.8464,0.8239,0.4456,0.503,0.6284,0.3763,0.3883,0.329,0.6648,0.725,0.7463,0.8358,0.7196,0.8371,0.9857,0.9796,0.9821,0.2124,0.2356,0.2439,0.6611,0.7422,0.6349,0.6406,0.6524,0.6499,0.7424,0.7619,0.7159,0.8635,0.8409,0.8391,0.2717,0.2667,0.2661,0.3952,0.4206,0.5633,0.685,0.7146,0.7058,0.7337,0.7188,0.7617,0.4637,0.5161,0.5622,0.9639,0.6175,0.6407,0.2604,0,0.6246,0.5469,0.5623,0.5658,0.3341,0.6053,0.6986,0.5451,0.5607,0.5944,0.2956,0.2762,0.3186,0.2501,0.21,0.4679,0.3554,0.4224,0.3546,0.5465,0.5856,0.37,0.2946,0.213,0.1904,0.2241,0,0,0.4489,0.3061,0.5138,0.3255,0.368,0.4743,0.2539,0.2306,0.1567,0.3289,0.2998,0.2029,0,0.2496,0,0.5521,0.6178,0.4269,0.4193,0.4181,0.4033,0.4722,0.4494,0.5221,0.6663,0.5576,0.5505,0.4909,0.4179,0.3478,0.4012,0.4268,0.2977,0.3784,0.3811,0.4131,0.5028,0.4564,0.2473,0.7903,0.7629,0.7789,0.6831,0.9318,0.6482,0.5725,0.6479,0.3679,0.2859,0.3664,0.4326,0.4511,0.4199,0.6621,0.4699,0.4598,0.333,0.2425,0.266,0.2463,0.6199,0.5702,0.3197,0.5579,0.6467,0.6286,0.3499,0.3348,0.4294,0.4428,0.3949,0.3157,0.5099,0.5687,0.5902,0.4518,0.3223,0.338,0.2817,0.3621,0.396,0.324,0.4086,0.2762,0.335,0,0.2255,0.4197,0.4661,0.4345,0.2535,0.2533,0.588,0.3254,0.5403,0.623,0.2773,0.2894,0.3423,0.5478,0.5242,0.2928,0.8645,0.7272,0.5501,0.293,0.2728,0.3519,0.3586,0.3401,0.3147,0.3347,0.2673,0.3953,0.2256,0.8509,1,0.7751,0.3178,0.4254,0.492,0.4466,0.551,0.5131,0.4051,0.3031,0,0.2072,0.3986,0,0.29,0.4621,0.3216,0.4617,0.4463,0.6583,0.6938,0.519,0.3575,0.2628,0.2532,0.3807,0.3045,0.3529,0.4741,0.2261,0.2339,0.2226,0.6664,0.7411,0.7174,0.3539,0.2835,0.342,0.3657,0.2996,0.279,0.294,0.7819,0.7855,0.8299,0.3124,0.2829,0.4182,0.4245,0.2929,0.3309,0.2857,0.2184,0,0.1845,0.3258,0.2953,0.3485,0.4032,0.5231,0.546,0.4839,0.6179,0.5845,0.5474,0.332,0.3566,0.3694,0.4351,0.3876,0.3403,0.3664,0.35,0.3559,0.503,0.5624,0.764,0.776,0.7974,0.4143,0.4033,0.4114,0.4239,0.4799,0.3133,0.3407,0.347,0.4828,0.3309,0.5377,0.627,0.6469,0.7695,0.6607,0.7474,0.6922,0.7445,0.5401,0.5401,0.7474,0.7632,0.7943,0.8751,0.8116,0.5696,0.6232,0.6628,0.7226,0.5992,0.7002,0.6822,0.7435,0.5401,0.5401,0.9839,0.9371,0.921,0.8799,0.8653,0.4966,0.5994,0.6354,0.6966,0.5664,0.613,0.5636,0.7354,0.5401,0.5401,0.6178,0.6321,0.6002,0.689,0.5935,0.5748,0.6912,0.7255,0.7841,0.5188,0.5931,0.5941,0.6752,0.5401,0.5401,0.604,0.698,0.559,0.6422,0.6382,0.5549,0.5334,0.5525,0.6096,0.5914,0.6908,0.6688,0.4045,0.5401,0.5401,0.3426,0.2179,0.5711,0.3972,0,0.4971,0.4846,0.554,0.5958,0.5614,0.5143,0.6503,0.7383,0.5401,0.5401,0.6911,0.6314,0.5701,0.5855,0.61,0.3733,0.3809,0.408,0.4704,0.3677,0.4265,0.4079,0.5412,0.5401,0.5401,0.3871,0.3218,0.6529,0.3238,0.282,0.4184,0.4407,0.4571,0.439,0.4045,0.3709,0.397,0.495,0.5401,0.5401,0.5503,0.5681,0.5663,0.3529,0.3261,0.3278,0.3161,0.3807,0.334,0.3738,0.3543,0.4085,0,0.5401,0.5401,0,0,0,0.2628,0,0.5151,0.442,0.5043,0.4522,0.3323,0.3279,0.3282,0.3744,0.5401,0.5401,0.2534,0.2676,0,0.3623,0.4841,0.5437,0.5305,0.617,0.6709,0.6724,0.6996,0.9663,0.7096,0.5401,0.5401,0.7061,1,1,0.6801,0.6684,0.4318,0.4355,0.4512,0.4765,0.3307,0.3152,0.3341,0.6768,0.5401,0.5401,0.6742,1,0.6174,0.7,0.6849,0.4983,0.3326,0.3712,0.3823,0.2752,0.368,0.3933,0.3659,0.5401,0.5401,0.4148,0.3343,0.397,0.4887,0.5155,0.3911,0.5134,0.5828,0.5378,0.6827,0.6944,0.7651,0.7255,0.5401,0.5401,0.8962,0.7864,0.718,0.6069,0.6052,0.3662,0.5559,0.6107,0.5517,0.5228,0.5884,0.6685,0.6539,0.5401,0.5401,0.4323,0.4252,0.3943,0.5481,0.4501,0.3385,0.3951,0.4338,0.3749,0.3079,0.2752,0.3053,0.3723,0.5401,0.5401,0.2545,0.2602,0.3387,0.375,0.2946,0.3725,0.4144,0.4396,0.4332,0.3381,0.3174,0.3988,0.5072,0.5401,0.5401,0.2636,0,0,0.2776,0,0.3635,0.4013,0.4368,0.3768,0.3287,0.3525,0.377,0.5946,0.5401,0.5401,0.63,0.6267,0.4855,0.5601,0.6769,0.3724,0.4618,0.5147,0.4678,0.4834,0.4075,0.4404,0.294,0.5401,0.5401,0.2712,0.2275,0,0.3588,0.2856,0.5832,0.3702,0.3514,0.3223,0.6587,0.702,0.7698,0.7523,0.5401,0.5401,0.9848,0.9846,0.6559,0.539,1,0.522,0.5684,0.5915,0.5602,0.6424,0.628,0.685,0.594,0.5401,0.5401,0.1915,0.2126,0,0.4932,0.3661,0.4051,0.4306,0.4302,0.4265,0.3252,0.4197,0.4147,0.5575,0.5401,0.5401,1,0.7241,0.6326,0.4823,0.3391,0.3886,0.3676,0.372,0.3804,0.4208,0.5654,0.5401,0.5401,0.4452,0.373,0.4061,0.5908,0.4224,0.4617,0.4902,0.5527,0.6108,0.6676,0.4417,0.5401,0.5401,0.4757,0.5132,0.5887,0.5806,0.6452,0.6306,0.6968,0.4321,0.5401,0.5401,0.475,0.6187,0.6479,0.6361,0.6406,0.6361,0.6842,0.5707,0.3396,0.3587,0.4092,0.3232,0.3194,0.3834,0.4303,0.5775,0.6729,0.6781,0.469,0.3529,0.3638,0.4076,0.4353,0.598,0.6668,0.6856,0.3252,0.6871,0.6581,0.6158,0.6442,0.7222,0.7781,0.7258,0.8456,0.9096,0.9231,0.5865,0.9548,0.964,0.9605,0.9377,0.8567,0.8711,0.4643,0.5528,0.6831,0.6656,0.5916,0.6536,0.7472,0.8468,0.86,0.8816,0.8383,0.8274,0.7822,0.9407,0.8939,0.4545,0.4855,0.5645,0.5908,0.5199,0.5404,0.6894,0.5887,0.6519,0.689,0.6618,0.6223,0.7093,0.6534,0.7248,0.4417,0.3997,0.4804,0.443,0.2797,0.3169,0.32,0.3421,0.3313,0.3203,0.4845,0.5029,0.592,0.9357,0.8175,0.6559,0.6179,0.7608,0.712,0.5624,0.5536,0.6883,0.7695,0.84,0.7964,0.7036,0.6128,0.6634,0.6412,0.7397,0.6458,0.6201,0.7311,0.7173,0.5703,0.5969,0.5615,0.394,0.3381,0.3303,0.2462,0.2632,0.3331,0.3341,0.3012,0.7177,0.7166,0.8303,0.5445,0.8085,0.8314,0.8726,0.8477,0.863,0.8508,0.802,1,0.7993,0.8259,0.9292,0.5932,0.5953,0.7459,0.6716,0.5989,0.6278,0.7386,0.8054,0.8596,0.8467,0.7873,0.7464,0.7911,0.3608,0.3135,0.5178,0.5403,0.6704,0.6005,0.5986,0.6444,0.7577,0.7215,0.7533,0.7308,0.7164,0.6608,0.7121,0.634,0.746,0.3348,0.3555,0.4566,0.4291,0.3056,0.332,0.3776,0.5005,0.5018,0.3926,0.2488,0.2752,0.3079,0.3091,0,0.4327,0.4454,0.5674,0.5398,0.509,0.5576,0.7194,0.6739,0.7373,0.698,0.707,0.6451,0.5362,0.4823,0.4119,0.4381,0.5317,0.6076,0.5078,0.3092,0.2956,0.3791,0.2716,0.2046,0.2591,0.2229,0.2482,0,0.7159,0.6036,0.259,0.2842,0.3289,0.3399,0.2399,0.2726,0.4203,0.303,0.3884,0.2835,0.2661,0.2984,0.342,0.4007,0.3898,0.2576,0.2943,0.3567,0.3623,0.2826,0.2887,0.3447,0.2557,0.2493,0.2321,0.4763,0.2629,0.331,0.3561,0.3024,0.367,0.3542,0.4749,0.4955,0.2772,0.3129,0.3112,0.4609,0.3762,0.2325,0,0.2828,0,0.4267,0.3842,0.3271,0.3627,0.3863,0.3768,0.2699,0.3265,0.3323,0.3208,0.345,0.3258,0.3314,0.3607,0.5459,0.3971,0,0.332,0.3506,0.3899,0.3867,0.3257,0.3473,0.3775,0.4179,0.2938,0.3417,0.5565,0.6487,0.6652,0.5191,0.5156,0.3841,0.412,0.4052,0.4074,0.4156,0.3911,0.3394,0.4227,0.3412,0.3785,0.3739,0.4529,0,0.4075,0,0.4104,0.4419,0.4954,0.4941,0.477,0.3652,0.3184,0.315,0,0.2663,0.6641,0.6424,0.663,0.6668,0.5829,0.407,0.4035,0.4452,0.4443,0.3779,0.3381,0.3246,0.3643,0.3036,0.4399,0.681,0.6887,0.662,0.4974,0.3871,0.528,0.5348,0.5877,0.5474,0.562,0.5415,0.6248,0.2554,0.2173,0.3244,0.5036,0.526,0.6604,0.3929,0.3774,0.3952,0.3858,0.3666,0.3569,0.4101,0.6143,0.4601,0.3115,0.5323,0.6488,0.8373,0.4406,0.4744,0.5007,0.5157,0.5643,0.5398,0.5397,0.7863,0.7417,0.6438,0.4468,0.6821,0.7605,0.7222,0.7148,0.7132,0.7422,0.6738,0.6563,0.4912,0.6486,0.5383,0.5822,0.579,0.4882,0.4616,0.5256,0.5256,0.6643,0.6471,0.583,0.5674,0.6564,0.713,0.8026,0.7201,0.7344,0.7709,0.6603,0.6916,0.7251,0.4216,0.3743,0.4777,0.4221,0.425,0.4494,0.4962,0.5476,0.5653,0.5406,0.6186,0.532,0.5937,0.3998,0.3801,0.4643,0.4693,0.5693,0.5242,0.5577,0.5224,0.5754,0.569,0.5553,0.4502,0.4979,0.4571,0.5089,0.5792,0.581,0.4312,0.3634,0.499,0.4184,0.3652,0.4858,0.5187,0.4459,0.3376,0.391,0.3002,0.3785,0.6059,0.3932,0.3669,0.4528,0.4312,0.5368,0.5,0.5111,0.3704,0.44,0.3826,0.3239,0.383,0.5145,0.5632,0.5314,0.3012,0.3603,0.4723,0.4479,0.5148,0.4803,0.3355,0.3511,0.3932,0.5491,0.5218,0.5023,0.3086,0.2711,0.3653,0.2314,0.1676,0.4933,0.4277,0.4622,0.3987,0.4567,0.4023,0.4292,0.373,0.4369,0.3316,0.3161,0.3826,0.4222,0.3465,0.2813,0.5105,0.5005,0.6149,0.5321,0.4891,0.4554,0.4741,0.5046,0.4801,0.4484,0.5302,0.6181,0.5472,0.483,0.4598,0.4462,0.4629,0.503,0.4942,0.5383,0.5442,0.625,1,0.6563,0.6437,0.719,0.7072,0.6899,0.5648,0.5076,0.4047,0.4332,0.5075,0.4287,0.366,0.4613,0.492,0.5984,0.561,0.5337,0.5775,0.6054,0.6643,0.5295,0.5834,0.4303,0.4046,0.5209,0.4619,0.5575,0.5308,0.5831,0.6041,0.5724,0.5725,0.8219,0.8609,0.9036,0.8844,0.8421,1,0.8817,0.9237,0.9287,0.9467,0.8915,0.912,0.8928,0.7069,0.5867,0.3903,0.3659,0.4083,0.4021,0.4896,0.4489,0.3747,0.4957,0.3162,0.414,0.4096,0.4474,0.3317,0.3296,0.2976,0.3764,0.3577,0.3919,0.3924,0.4775,0.3484,0.4373,0.4856,0.5133,0.5201,0.6037,0.5734,0.5786,0.2947,0.2471,0.3076,0.3804,0.3981,0.375,0.3222,0.3437,0.381,0.3875,0.2828,0.2397,0.3664,0.2915,0.4223,0.3272,0,0.3292,0.3286,0.3624,0.3308,0.3146,0.3715,0.3849,0.4623,0.4873,0.458,0.2876,0.274,0.2458,0.7,0.712,0.4631,0.4903,0.4766,0.4331,0.3274,0.3587,0.3975,0.5274,0.5673,0.4938,0.5667,0.5893,1,0.307,0.2807,0.3664,0.4631,0.5067,0.5331,0.4591,0.3934,0.2922,0.6997,0.7663,0.9275,0.796,0.7577,0.6838,0.4289,0.4008,0.3867,0.3561,0.3781,0.3764,0.3015,0.3116,0.3414,0.5901,0.6657,0.6074,0.7264,0.7208,0.6861,0.5377,0.5741,0.4499,0.4402,0.4314,0.4028,0.3329,0.3253,0.3507,0.2939,0.304,0,0.3558,0.3022,0.4524,0.592,0.5594,0.3376,0.344,0.387,0.3779,0.3256,0.3407,0.4087,0.4281,0.5148,0.5241,0.4885,0.264,0.332,0.5438,0.5241,0.3322,0.4392,0.4762,0.451,0.4819,0.4121,0.3838,0.4483,0.4508,0.3385,0.3657,0.3998,0.3873,0.359,0.337,0.3827,0.4366,0.4289,0.3912,0.6512,0.7034,0.7614,0.5242,0.5491,0.5534,0.6635,0.536,0.647,0.574,0.5587,0.6143,0.6976,0.7272,0.7137,0.8304,0.8642,0.8615,0.8901,0.7921,0.9155,0.8517,0.8697,0.8013,0.5658,0.5814,0.5153,0.5678,0.6423,0.6268,0.5973,0.6305,0.7005,0.665,0.6736,0.5326,0.7289,0.6256,0.6361,0.8586,0.8694,0.6406,0.7405,0.7849,0.7942,0.6783,0.7105,0.7995,0.7399,0.7958,0.6767,0.7523,0.6384,0.612,0.8837,0.8696,0.6069,0.6409,0.7179,0.6603,0.6268,0.7388,0.7914,0.7589,0.7648,0.6988,0.7782,0.9739,0.6658,0.6204,0.6661,0.4413,0.533,0.6027,0.5759,0.6918,0.7483,0.7967,0.6425,0.9087,0.7308,0.7645,0.702,0.6969,0.4327,0.4712,0.4402,0.3218,0.3969,0.354,0.6612,0.7447,0.6525,0.2623,0.2241,0.3364,0.4296,0.4197,0.4052,0.3255,0.2871,0.2592,0.5001,0.5193,0.5318,0.4095,0.3528,0.4336,0.411,0.4707,0.3277,0.3087,0.3362,0.3387,0.2319,0.6173,0.5646,0.5109,0.4336,0.4701,0.4735,0.3454,0.4527,0.4258,0.2928,0.3261,0.4412,0.5137,0.5236,0.5872,0.2926,0.2769,0.3558,0.2263,0.2421,0.5446,0.4096,0.476,0.3796,0.4621,0.2184,0.228,0.233,0.5381,0.5727,0.7365,0.7689,1,0.6414,0.6932,0.3324,0.3118,0.3899,0.3463,0.364,0,0.356,0.2994,0.315,0.2766,0.1708,0,0.3829,0.3034,0.3619,0.4251,0.3768,0.4608,0.3269,0.2467,0.2881,0.2885,0.3256,0.3738,0.2964,0.3497,0.3939,0.2513,0.3403,0.3331,0.5084,0.545,0.62,0.4481,0.3208,0.2763,0.3217,0.3852,0.3511,0.454,0.2785,0.2569,0.288,0.5133,0.5696,0.3156,0.3405,0.3949,0.3455,0,0.3621,0.3063,0.3515,0,0.2388,0,0.2612,0.3792,0.2636,0.277,0.3727,0.3655,0.3873,0.3233,0.3295,0.2863,0,0.2877,0.2859,0.2403,0,0.2415,0.3888,0.2607,0.2925,0.3243,0.5525,0.616,0.5687,0.6076,0.574,0.7092,0.542,0.6339,0.3986,0.7752,0.8129,0.7769,0.7709,0.8118,0.3479,0,0.5294,0.5254,0.4798,0.3075,0.3347,0.3124,0.2608,0.2563,0.2956,0.2837,0.3677,0.4906,0.6677,0.4687,0.4158,0.5031,0.5103,0.3069,0.2465,0.3175,0.2826,0.2831,0.2762,0.7245,0.6149,0.6572,0.8123,0.8041,0.3594,0.3822,0.4562,0.3933,0.3583,0.3243,0.4233,0.4566,0.4306,0.5256,0.266,0.1986,0.2801,0.3317,0.3283,0.2913,0.2932,0.4106,0.4857,0.3447,0.3812,0.3829,0.6602,0.6515,0.6382,0.6282,0.6981,0.5667,0.6081,0.6155,0.4783,0.4111,0.3987,0.385,0.4035,0.4488,0.5643,0.7409,0.7245,0.6487,0.5372,0.7473,0.5956,0.5435,0.6272,0.616,0.3948,0.4274,0.4878,0.4009,0.266,0.2944,0.345,0.289,0.2741,0.3632,0.2486,0.408,0.292,0.2849,0.4933,0.4479,0.4258,0.3748,0.389,0.4044,0.4376,0.3198,0.2199,0.2073,0.2366,0.2144,0.4109,0.28,0.36,0.3575,0.335,0.5169,0.4696,0.4467,0.3508,0.3448,0.432,0.3262,0.271,0.7226,0.7714,0.7771,0.9096,0.6819,0.5078,0.5955,0.7155,0.6555,0.6415,0.6027,0.6829,0.6291,0.595,0.761,1,0.7762,0.7428,0.4633,0.3973,0.638,0.6872,0.7502,0.6885,0.7187,0.6965,0.5845,0.5024,0.4933,0.4193,0.5478,0.7049,0.6477,0.4098,0.3358,0.7421,0.6525,0.7943,0.6779,0.7605,0.7238,0.8131,0.8099,1,1,0.8486,0.8258,0.7335,0.7545,0.7163,0.8037,0.7297,0.8169,0.7472,0.7762,0.8383,0.8608,1,0.8155,0.8568,0.7995,0.3728,0.333,0.447,0.4309,0.4413,0.5471,0.7152,0.7273,0.6604,0.5521,0.3105,0.3348,0.3268,0.2678,0.4805,0.3977,0.732,0.7477,1,0.415,0.2965,0.4509,0.4609,0.4286,0.3951,0.4367,0.4282,0.4293,0.5058,0.473,0.4896,0.4911,0.6093,0.649,0.5449,0.5624,0.7426,0.7616,1,0.4908,0.428,0.422,0.4468,0.5209,0.5337,0.5803,0.5988,0.6849,0.656,0.5768,0.5398,0.5554,0.585,0.4676,0.4103,0.5292,0.4104,0.388,0.488,0.4537,0.3116,0.3631,0.4453,0.5812,0.628,0.4901,0.3589,0.3165,0.3899,0.521,0.7155,0.6088,0.6566,0.7413,0.7171,0.7431,0.7262,0.8035,1,0.6609,0.7002,1,1,0.6928,0.5774,0.5799,0.4839,0.5775,0.6946,0.5772,0.7002,0.6778,0.7594,0.7777,0.7307,0.7703,1,0.6421,0.6816,0.7343,0.7833,0.3495,0.3282,0.4723,0.442,0.4762,0.3433,0.3078,0.3665,0.296,0.4065,0,0.2575,0,0.2391,0,0.3168,0.3815,0.3954,0.3288,0.3485,0.3588,0.6761,0.7327,0.6218,0.6468,0.6214,0.6178,0.6214,0.5707,0.6064,0.3789,0.3535,0.4268,0.4116,0.3873,0.3201,0.4356,0.5085,0.4206,0.588,0.3264,0.303,0.4645,0.5204,0.4539,0.2919,0.5142,0.6309,0.5655,0.3585,0.3689,0.4797,0.3409,0.3885,0.588,0.2178,0.2509,0,0.255,0,0.4302,0.3546,0.329,0,0.3346,0.3406,0.4883,0.3801,0.4202,0.466,0.3911,0.4792,0.4699,0.492,0.4783,0.3576,0.3489,0.3362,0.3839,0,0.4564,0.4227,0.4118,0.4862,0.5112,0.4744,0.5396,0.5505,0.6048,0.5034,0.4709,0.4509,0.3866,0.4322,0.488,0.4587,0.44,0.3552,0.4145,0.4634,0.4369,0.3795,0.3595,0.4102,0.4354,0.2518,0.4846,0.5462,0.6337,1,0.4937,0.5691,0.4282,0.4929,0.5199,0.4343,0.4834,0.4607,0.4539,0.6909,0.647,0.5393,0.6836,0.7168,1,0.4674,0.339,0.4274,0.4887,0.5228,0.5298,0.6044,0.6213,0.6489,0.6486,0.5893,0.6022,0.4078,0.3612,0.3199,0.3362,0,0.3501,0.5008,0.5825,0.5363,0.4225,0.3496,0.4302,0.6743,0.6629,0.643,0.4905,0.3561,0.2817,0.3773,0.4464,0.485,0.4416,0.4089,0.3517,0.3728,0.3569,0.3991,0.4728,0.425,0.3351,0.4584,0.4744,0.369,0.3137,0.4855,0.4319,0.2649,0,0.3771,0.2348,0,0.3735,0.2449,0.1933,0.4777,0.4515,0.5075,0.4768,0.3716,0.3243,0.5234,0.5069,0.4797,0.4613,0.7064,0.7327,0.6282,0.4548,0.3905,0.4532,0.4496,0.5172,0.4881,0.45,0.3717,0.4571,0.2897,0,0.4182,0,0.2643,0.3991,0.4542,0.5239,0.4115,0.4616,0.4933,0.4478,0.3131,0.3529,0.3494,0.5027,0.6954,0.6893,0.645,0.6397,0.7076,0.4663,0.3856,0.3901,0.5052,0.5314,0.5546,0.3915,0.3553,0.3392,0.3617,0.4139,0.2403,0.2893,0.2984,0.4074,0.4045,0.4892,0.4896,0.4075,0,0,0,0,0,0,0,0,0,0,0,0,0,0.4725,0.4524,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5496,0.5712,0,0,0,0,0,0,0,0,0,0,0,0,0,0.298,0.235,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5706,0.5372,0,0,0,0,0,0,0,0,0,0,0,0,0,0.644,0.6696,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5592,0.5001,0,0,0,0,0,0,0,0,0,0,0,0,0,0.6808,0.7185,0,0,0,0,0,0,0,0,0,0,0,0,0,0.6736,0.6603,0,0,0,0,0.5437,0.6627,0.7575,0.7078,0.6394,0.6415,0.9053,0.6556,0.6661,0.7024,0.6615,0.7157,0.609,0.7016,0.7264,0.53,0.4816,0.4809,0.433,0.3378,0.5322,0.5759,0.5109,0.5642,0.6445,0.4808,0.326,0.5001,0.3708,0.2833,0.5111,0.6965,0.7917,0.7331,0.7113,0.7341,0.7476,0.6369,0.8189,0.7762,0.6897,0.6282,0.568,0.5899,0.5581,0.6155,0.5177,0.6402,0.5399,0.6085,0.5786,0.601,0.5587,0.728,0.6782,1,0.718,0.6185,0.6378,0.7098,0.5445,0.5722,0.7003,0.6102,0.6116,0.6535,0.6133,0.6802,0.7197,0.7011,0.7086,0.7032,0.6209,0.674,0.6592,0.4927,0.5195,0.649,0.5458,0.5797,0.5455,0.5361,0.4053,0.4406,0.2936,0.4328,0.4067,0.4807,0.6862,0.7095,0.4131,0.5029,0.5373,0.4513,0.377,0.3624,0,0.3798,0.3882,0.3222,0.3302,0.4618,0.4785,0.3165,0.2428,0.5465,0.5427,0.6431,0.5799,0.5813,0.575,0.6435,0.6732,0.6046,0.4286,0.4747,0.419,0.4272,0.3728,0.3569,0.6145,1,0.6476,0.5983,0.5527,0.5224,0.63,0.5593,0.7469,0.5645,0.5748,0.6791,0.5753,0.4703,0.3551,1,1,0.7067,1,0.6104,0.5396,0.5598,0.7207,0.653,0.4485,0.6454,0.5081,0.5694,0.5012,0.4903,0.6816,0.4546,0.3305,0.4657,0.4424,0.4883,0.434,0.2319,0.2682,0.4187,0.2134,0.3554,0.3304,0.3525,0.2994,0.2641,0.3653,0.4495,0.3525,0.3337,0.3575,0.4483,0.4808,0.5461,0.5231,0.438,0.4141,0.5067,0.5806,0.4021,0.3429,0.3306,0.499,0.5509,0.4874,0.2703,0.3217,0.4047,0.2467,0.1999,0.1605,0.3017,0.2097,0.4887,0.2255,0,0.3417,0.3425,0.5226,0.4888,0.3379,0.3151,0.3431,0.7552,0.7087,0.6519,0.4805,0.4874,0.5026,0.3597,0.3087,0.5679,0.7552,0.7087,0.6519,0.5507,0,0.3923,0.524,0.5344,0.4515,0.333,0.4201,0.5598,0.1938,0.5005,0.6579,0.5918,0.7174,0.6755,0.397,0.4414,0.4441,0.4025,0.3949,0.4065,0.5226,0.3014,0.4396,0.4162,0.5918,0.7174,0.6755,0.3699,0.2492,0.81,0.5083,1,0.8247,1,0.7296,1,0.4746,0.2794,0.0952,0.4398,0.2674,0.4901,0,0,1,0.7643,1,0.7594,1,0.4579,0.3829,0.3431,0,0,0.4948,0.6055,0.7761,0.6484,1,0.8973,0.5907,0.7614,0.7802,1,0.6025,0.6724,0.8806,0.8785,0.3262,0.2965,0,0.308,0.8214,0.7691,1,1,0.8715,1,0.7531,0.7152,0.6102,0.4697,0,0.393,1,1,0.7855,0.7863,1,1,0.6737,1,1,0.5618,0.5459,0.7303,1,1,1,0.8154,0.5419,1,0.6082,1,1,0.3759,0.4285,0,0.1916,0.0731,0.2541,0,0,0,0.6987,0.6388,0.8367,0.3085,0.3069,0.6941,0.6904,0.7664,1,0.5925,0.5443,0.3824,0,0.3571,0,0,0,0.4181,0.2029,0,0.5723,0.6726,1,0.7615,0.4276,0.3506,0.3625,0.5162,0.505,0.4826,0.3822,0.3768,0.518,0.6649,0.6686,0.5837,0.541,0.7657,0.5802,0.4628,0.4011,0.3908,0.4265,0.3812,0.3063,1,0.634,1,0.6502,0.6092,0.429,0.4647,0.4498,0.4167,0.4018,0.4555,0.5474,0.5335,0.4886,0.398,0.3189,0.3396,0.2518,0.2522,0.3454,0,1,1,1,1,0.3424,0.3844,0.2622,0.3748,0.3606,0,0,0.3997,0,0.3389,0,1,1,1,1,0.4535,0.3421,0.2557,0.424,0.46,0.3668,0.333,0,0.4871,0.3547,0.3067,1,1,1,1,1,0.908,0.8913,0.9897,1,1,0.8057,0.9608,0.7373,0.4735,0.419,0.9371,0.7341,1,1,0.5867,0.8138,0.8371,0.8038,1,0.9794,0.775,0.9616,1,0.4825,0.4357,1,1,1,1,1,0.5624,0.7592,1,0.9684,0.9413,0.789,0.6438,0.6714,0.5569,0.6973,1,1,1,1,0.3656,0.2957,0.3765,0.4269,0.3829,0.4657,0.7272,0.6653,0.9283,0.2731,0.2816,1,1,1,1,0.6436,0.7611,1,1,0.9381,0.7257,0.5977,0.6774,0.7053,0.7119,1,1,0.8007,1,0.7916,0.713,0.7606,0.8485,1,0.6587,0.8634,0.6728,1,1,0.4896,0.827,0.5592,0.6888,0.333,0.6886,0.3516,0.2099,0.6422,0.5932,0.6431,0.5279,0.3348,1,1,0.4896,0.827,0.8638,0.4877,0.2099,0.7571,0.8346,0.6041,0.5235,0.5797,1,0.6135,0.4896,0.827,0.4686,0.3288,0.333,0.7762,0.2156,0.2099,0.202,0.2531,0.295,0.4185,0,1,1,0.4896,0.827,0.6499,0.5088,0.333,0.7745,0.6919,0.7237,0.365,0.4248,1,1,0.4896,0.827,1,1,0.4896,0.827,1,1,0.4365,0.4122,0.4157,1,0.8466,0.8017,0.5582,0.6326,0.6121,0.6375,0.6688,0.5223,0.2743,0,1,1,1,0.8248,0.7626,1,0.5654,0.5582,0.8175,0.7059,0.9944,0.9974,0.5693,0.5948,0.952,1,0.8957,1,1,1,0.789,0.5654,0.5582,0.604,0.7703,0.5626,0.4898,0.7265,0.612,0.5545,0.8213,0.6092,1,0.7049,1,0.5283,0.5777,0.5582,0.7312,0.6577,0.5626,0.4984,0.4408,0.43,0,0.7653,0.5144,0.6697,1,0,0.3833,0.2421,0.4103,0.4893,0.4424,0.5626,0.4898,0.4011,0.6168,1,1,0.5474,0.7152,0.6198,1,0.6198,0.7227,0.348,0.2125,0.6225,0.7016,0.4654,0.4077,0.3282,0.4577,0.6241,1,0.6142,0.6318,0.55,0.5336,0.6572,0.604,0.7177,0.5626,0.4898,0.6756,0.3794,0.4577,1,1,1,0.2918,0,0.3284,0.5802,0.604,0.6926,0.5626,0.2699,0.5101,0.3252,0.3421,1,0.5616,0.7063,0.2192,0.6149,0.7037,0.2917,0,0.419,0.3134,0.4577,0.3893,0.4514,0.4589,0.3368,0.604,0.2105,0.2883,0.2653,0.5101,0.3339,0.4577,1,0.7658,0.5654,0.9112,0.5529,0.5946,0.7271,0.6084,0.5194,0.5791,0.6487,0.5694,0.5704,0.7171,0.4609,0.6164,0.4546,0,0.4898,0.5101,0.3843,0.4577,0.7833,0.604,0.749,0.2503,0.2884,0.5101,0.3562,0.4577,0.7287,0.6313,0.7495,0.7376,0.5485,0.6604,0.2651,0.4577,0.7042,0.7417,0.6537,0.5626,0.339,0,0.429,0.3692,0.6965,0.694,0.5101,0.36,0.4577,0.5626,0.4898,0.7832,0.8875,0.4577,0.7354,0.4898,0.3962,0,0.4577,0.6905,0.7239,0.6198,0.6557,0.4577,0.6499,0.4577,0,0.2525,0.3814,0.4577,0.7346,0.4577,0.9999,0.7869,1,1,0.5801,0.6818,1,1,1,1,1,0.67,0.7122,0.3179,0,1,0.9999,1,1,1,1,0.9178,1,1,0.7359,1,0.6169,0.7302,0.5397,0.5679,0.9999,1,1,1,0.6116,1,1,0.8873,1,1,0.9974,1,0.6316,0.3889,0,1,1,0.9999,1,0.4984,0.4248,0.3484,0.6831,0.8091,0.6943,0.4677,0.6029,0.5243,0.5776,0.6107,0.9999,0.592,1,0.9966,0.3987,0.4436,0.4264,0.6668,0.7548,0.7404,0.7531,0.782,0.7559,1,1,1,1,1,1,0.6791,1,1,0.5171,0.4559,0.4094,0.4046,0.4108,0.4969,0.422,0.293,1,0.9954,0.9999,0.7417,0.6497,1,0.7251,0.5509,0.6652,0.6812,0.6638,0.6478,0.6011,0.422,0.4463,1,0.9999,1,1,0.7701,1,1,0.6975,1,0.7459,0.864,1,0.6875,0.4744,0.3763,0.9999,1,1,1,1,1,0.7172,0.7908,0.7693,0.6802,1,0.6288,0.5583,0.3445,0,1,1,1,1,0.6571,1,1,1,1,0.8022,0.6726,0.6398,0.5829,0.4765,0.404,0.3569,0.3068,1,1,1,0.8215,1,1,0.8735,0.4722,0.8108,0.8108,0.6196,0.0633,0.4746,1,0.6452,0.9181,0.7803,0.6863,0.5123,0.6927,0.9256,0.8108,0.8108,0.9068,0.8947,0.4746,0.443,0.0496,1,1,1,0.836,0.5968,1,1,0.2669,0.8108,0.8108,0.6196,0.1066,0.4746,1,0.6806,1,0.7416,1,1,1,1,0.8108,0.8108,0.6196,0.0484,0.4746,0.443,0.2711,1,1,1,1,1,1,1,0.5255,0.8108,0.8108,0.6849,0.7113,0.4746,0.4172,0.2711,1,1,1,0.856,0.7658,0.7952,1,0.3478,0.8108,0.8108,0.4496,0.3761,0.4746,0.443,0.4926,1,1,1,1,1,0.8495,1,0.8335,0.8108,0.8108,0.5703,0.3761,0.4746,0.4688,1,1,1,1,1,1,1,0.9422,0.8108,0.8108,0.4864,0.4324,0.4746,0.9249,1,1,0.9363,0.6877,1,1,1,0.6658,0.6298,0.6642,0.7817,0.6487,0.3061,0.3064,1,1,1,1,0.8347,1,0.8646,0.6301,0.6175,0.6958,0.5171,0.6474,0.8411,0.5962,0.7116,0.925,1,1,0.9269,0.8243,1,0.6366,0.9394,0.9236,1,1,0.8882,1,0.3649,0,0.958,1,1,1,0.6525,0.7005,1,0.2161,0.2637,0.294,0.7151,0.548,0.806,0.3639,0.5339,0.9755,1,1,1,0.7002,1,0.9039,0.3179,0,0.2608,0.1766,0.4502,0.8137,0.5828,0.7781,0.8789,1,1,1,0.9644,0.9276,0.8861,1,0.8655,0.6135,0.6622,0.7023,0.7588,0.8011,1,0.6954,0.6519,0.6479,0.659,0.6225,1,1,1,0.8776,0.6495,1,1,1,0.7824,0.7342,0.7456,1,0.7474,0.5254,0.5739,1,0.7882,0.791,0.7123,1,0.5397,0.6013,0.6875,0.7108,0.683,0.6446,1,0.593,0.3653,0.3709,0.7276,1,0.7557,0.6661,0.4347,0.5145,0.5235,0.606,0.9436,0.5263,0.5566,0.5801,0.5807,0.544,0.5743,1,0.5968,0.7164,0.5763,0.5306,0.476,0.4187,0.5423,0.5418,0.51,0.5412,0.5261,0.5911,0.3544,0.3166,0.7536,1,1,0.5963,0.5162,0.5364,0.6598,0.9633,0.684,0.4894,0.4997,0.3753,0.3341,0.2539,0,0.8401,0.8398,0.8896,0.7653,1,1,0.7201,0.813,0.6988,0.6874,0.642,0.6725,0.6565,0.5288,0.9125,0.5959,0.5949,0.634,0.5633,0.2849,0.4884,0.4388,0.6572,0.5897,0.5853,0.5787,0.5149,0.5497,0.5518,0.4817,0.6115,0.5386,0.6649,0.531,0.3666,0,0.3336,0.4607,0.3074,0.4141,0.4869,0.3406,0.3798,0.3541,0.2949,0.5234,0.3734,0.4808,0.4145,0.5613,0.4515,0.4294,0.4022,0,0.3029,0.4251,0.3897,0.3818,0.2873,0,0.6893,1,1,0.6106,0.5278,0.5629,0.6703,0.509,0.5341,0.4649,0.5069,0.5036,0.4934,0.4002,0.4225,0.6369,0.5446,0.6253,0.5204,0.7149,0.5596,0.9996,0.9999,0.9999,0.9998,1,1,1,0.6889,0.6059,0.4835,0.4796,0.3622,0.3449,0,0,0.9997,0.9999,0.9999,0.9999,0.3566,0.4242,0.4637,0.418,0.4268,0.4428,0.464,0.4665,0.8903,0,0.4106,0.9995,0.9288,0.9987,0.9998,0.5776,0.6613,0.7524,1,0.8196,0.5979,0.6843,0.5371,0.5806,0.3874,0,0.9994,0.8512,1,1,1,0.6117,1,0.7355,0.4615,0,0.5143,0.5215,0.6148,0.2779,0.4039,0.9999,1,1,0.9983,0.9918,0.747,0.6594,0.5143,0.8274,0.875,1,0.6984,1,0.5409,0.5806,0.9996,0.9999,1,0.9999,0.6174,0.5829,0.6409,0.5546,1,0.4822,0.7554,0.7608,1,0.6942,0.7262,1,1,1,1,1,1,0.7848,0.8372,0.7807,1,1,0.6224,0.6104,0.5156,0.5941,1,1,1,0.6972,1,1,1,0.9504,0.7009,0.6925,0.5676,0.8767,0.5557,0.5225,0.5843,0.9114,0.835,1,1,0.5342,0.4064,0.3941,0.2596,0,0.1805,0,0.1818,0,0.4918,0,1,1,1,1,1,1,1,0.6272,0.6146,0.5226,0.7166,0.6641,0.9964,0.6377,0.576,1,0.4438,0.4742,0.4268,0.61,0.6142,0.5972,0.5397,0.5032,0.511,0.5852,0.6073,0.5958,0.4918,0.4344,0.9808,1,1,1,1,1,1,0.6593,0.651,0.7088,0.442,0.3236,0.3314,0.4918,0.259,1,1,0.9672,1,0.4242,1,0.3519,0,0.1488,0.1643,0.1188,0.2086,0,0.4918,0,0.7784,0.6045,0.8818,0.6858,0.9231,0.7055,1,0.6065,0.6151,0.4825,0.316,0,0,0,0,1,1,1,0.9428,1,0.6057,0.6449,1,0.6328,1,0.6152,1,0.5774,0.4872,0.6367,1,1,1,0.9808,0.7428,0.6208,1,0.7682,0.7632,0.5911,0.7232,0.9345,0.6488,0.562,0.8521,1,1,1,1,0.949,0.9653,1,0.574,0.5164,1,1,0.9536,0.5345,0.5683,0.8243,0.8065,1,1,1,1,1,1,0.7583,0.685,0.5992,0.6872,0.9927,0.7131,0.4104,0.3628,1,1,1,1,0.5707,0.5578,0.6489,0.593,0.7486,0.55,0.3507,0.5246,0.5648,0.3229,0.3099,1,0.8728,1,1,1,1,1,0.6142,0.7245,0.5677,0.4767,0.5324,0.5431,0.4762,0.4461,1,1,1,1,1,1,0.7617,0.7437,0.662,0.7002,1,0.9386,1,0.623,0.5836,1,0.6457,1,0.5885,1,0.7352,0.8271,0.5779,0.7001,0.8464,0.6569,1,0.9563,0.7063,0.8791,1,1,1,0.7764,1,1,1,1,0.6812,1,1,1,1,0.5165,0.5357,0.5246,1,1,1,0.4054,0.3478,0,0.8551,0.9675,0.799,0.902,0.9288,0.9956,0.4918,0.8995,0.9388,1,1,0.8567,1,1,1,0.5464,0.5324,0.9351,0.3801,0.3229,0,0.1963,0.1635,1,1,1,1,0.8714,0.8148,1,1,1,0.8191,1,0.707,1,0.6372,0.6317,1,1,1,1,1,0.6084,0.6136,0.7104,0.4295,0.2276,0.3852,0,0.2515,0.224,0,0.9267,0.617,0.583,1,0.6235,0.5565,0.5007,0.4944,0.4831,0.2823,0.3135,0.2876,0.4918,0.3369,0.9637,1,1,1,0.8971,0.6985,0.9068,0.6453,0.6349,0.3637,0.3511,0.6339,0.5406,0.6129,0.6722,0.9261,1,0.4918,0.5748,1,0.7137,1,0.6662,0.5786,0.319,0.3073,0.296,0.4918,0,1,1,1,0.6464,0.6328,0.7537,0.9054,0.4918,0.9275,0.4918,0.7223,0.985,0.9518,0.8881,0.8693,0.8089,0.7905,1,1,0.8502,1,0.7056,1,1,0.82,1,1,1,0.9505,0.8689,0.4645,0.4482,1,0.523,0.7609,1,0.5892,0.564,1,0.6036,1,0.6567,1,0.6061,0.6604,0.4191,0.3531,0.4447,0.4321,0.5216,0.5025,0.4099,0.4405,0.4852,0.5719,0.6567,0.6374,0.7304,0.697,0.6056,0.4974,0.4752,1,0.5629,1,1,0.4595,0.3503,0.3341,0.4413,0.3416,0.3302,0.4391,0.2578,0.3067,0.3161,0.5341,0.633,0.5592,0.7192,0.5542,0.2464,0.2576,0.1956,0.3265,0.2083,0.3252,0,0,0,0,0.2177,1,0.5271,0.9474,0.5466,0.6505,0.5651,0.649,0.9399,0.4612,0.4048,0.2574,0.2602,0,0.557,0.4595,0.5611,0.5236,0.658,0.5612,0.6892,0.6196,0.7527,0.7323,0.7647,1,0.7961,0.5872,0.5081,0.605,0.2832,0.3196,0.282,0,0.4296,0.4428,0.5056,0.5363,0.2861,0.2641,0.2366,0.4593,0.365,0.5175,0.6681,0.504,0.4316,0.3844,0.3081,0.4871,0.4186,0.6095,0.5862,0.6927,0.5906,0.6846,0.7091,0.664,0.5736,0.4135,0.2855,0.2564,0.3817,0.3724,0.657,0.6975,0.8398,0.803,1,0.8125,1,0.7459,1,0.7613,0.7911,0.729,0.6973,0.6731,0.7761,0.5683,0.5383,0.7161,0.6547,0.7428,0.6559,0.7005,0.4233,0.3796,0.2814,0.5016,0.683,0.5885,0.8519,0.8572,0.575,0.5681,0.7514,0.6219,0.5386,0.4728,0.3859,0.577,0.772,0.805,0.8193,0.7863,0.8066,0.5692,0.6537,0.3811,0.4575,0.514,0.4797,0.2906,0.47,0.5081,0.7084,0.8967,0.699,0.7223,0.7536,0.6535,0.4317,0.3658,0.5903,0.7355,0.6453,0.7598,0.7962,0.5866,0.9439,0.887,0.8847,0.8668,1,0.8499,0.8347,0.8574,0.456,0.3911,0.3662,0.4222,0.5127,0.5933,0.4713,0.3725,0.2224,0.3868,0.3966,0.5958,0.5566,0.5585,0.4712,0.4284,0.483,0.3618,0.3034,0.4068,0.443,0.5397,0.5993,0.5837,0.4281,0.4737,0.4404,0.2756,0.3822,0.6617,0.6024,0.7906,0.5696,0.5362,0.5489,0.7077,0.5397,0.5481,0.5398,0.7327,0.6487,0.613,0.4453,0.3982,0.828,0.7654,0.9089,0.7491,0.7722,0.6839,1,0.8196,0.5387,0.512,0.7813,0.5329,0.8039,0.4524,0.3804,0.6811,0.6111,0.7405,0.6073,0.5025,0.5362,0.6369,0.7494,0.6033,0.51,0.7618,0.5329,0.7357,0.3989,0.3849,0.5883,0.6374,0.8234,0.6655,0.6962,0.7364,0.7312,0.4738,0.201,0.2798,0.2938,0.2783,0.3041,0.2707,0.3182,0.6706,0.6891,0.6671,0.504,0.4864,0.4468,0.3582,0.7107,0.7418,0.6468,0.5995,0.7309,0.7999,0.3612,0.3318,0.6712,0.4584,0.2547,0.2785,0.4131,0.2459,0,0.1476,0.3213,0.4119,0.3549,0,0.3112,0.1978,0,0.3229,0.3083,0.4781,0,0.3215,0,0.2115,0.1477,0.2574,0.372,0.1815,0.2394,0.2379,0.4377,0,0.2857,0,1,0.5374,1,1,0.3578,0.4297,0.4567,0.6748,0.8889,0.6109,0.5394,0.5739,0.5302,0.4255,0.3266,1,0.9838,1,1,0.9001,0.7587,0.8262,0.9403,1,0.7929,1,1,0.6743,0.4118,0.4042,1,0.7451,0.9442,1,0.63,0.4872,0.7055,0.9244,0.5864,0.6538,0.5786,1,0.7244,0.7238,0.8281,0.6594,1,0.972,1,0.7963,0.5936,0.8169,0.3554,0.2536,0,0.7683,0.7648,0.667,0.5442,0.5465,0.9999,1,1,1,0.5061,0.6612,0.7422,1,0.729,0.773,0.2769,0.1988,0.3799,0.333,0,0.9999,1,1,1,0.7518,1,1,0.6067,0.6969,1,0.804,0.6244,1,0.6739,1,1,0.7175,1,1,0.4784,0.3679,0.3714,0.8365,0.8158,0.5814,0.611,0.7875,1,0.7315,0.7315,0.7315,0.6064,0.6064,0.6064,0.9026,0.8994,0.5174,0.4971,0.4541,0.3969,0.2909,0.5386,0.6153,0.5804,0.6341,0.6363,1,0.7454,0.6714,1,0.8468,0.5435,0.5237,0.6265,0.6027,0.6034,0.6153,0.6267,0.7357,0.5532,0.4405,0.6947,1,0.5547,0.6889,0.7297,0.5441,0.515,0.5993,0.5978,0.6162,0.6049,0.6537,1,0.592,0.4733,0.6491,0.7434,1,1,0.866,0.5165,0.4718,0.5148,0.5317,0.5972,0.6423,0.6739,0.4558,1,0.7655,0.7125,0.613,0.5195,0.6575,0.6068,0.9984,0.6948,0.6358,0.6615,0.7044,0.6161,0.574,0.6608,0.6179,0.6058,0.4507,0.4075,0.4077,0.3285,0.2838,0.3151,0.4069,0.2903,0.2143,0.2866,0.2788,0,0.3982,0.3538,0.691,0.6006,0.609,0.5575,0.5958,0.7029,0.6903,0.5823,0.5254,0.5814,0.7328,0.7334,0.6589,0.6501,0.6778,0.4306,0.3664,0.3792,0.4747,0.8495,0.6435,0,0.2859,0.4341,0.3348,0.3274,0.4825,0.349,0.3736,0.3542,0,0.3866,0.3322,0.3119,0.3515,0.322,0.3525,0.2591,0.4518,0.466,0.4366,0.5031,0.5778,0.6666,0.6001,0.5603,0.4574,0.4524,0.5322,0.6146,0.5977,0.6837,0.6993,0.6371,0.5693,0.6691,0.4198,0.4662,0.5389,0.4239,0.4709,0.3715,0.3661,0.505,0.5289,0.5642,0.5146,0.6274,0.6067,0.5704,0.4988,0.4837,0.4977,0.4979,0.4795,0.5171,0.5212,0.6367,0.5098,0.4926,0.5489,0.5186,0.7804,0.7019,0.3113,0.3147,0.573,0.6176,0.6361,0.6854,0.5861,0.5469,0.5508,0.3524,0.3875,0.295,0.302,0.2692,0.4595,0.3804,0.4066,0.3357,0.3441,0.2532,0.3023,0.2487,0.3005,0.2806,0.2595,0.3353,0.3563,0.355,0.3776,0.415,0.4953,0.5513,0.6242,0.6039,0.4817,0.4056,0.4183,0.4539,0.4008,0.4629,0.3208,0.3421,0.5301,0.4755,0.4473,0.4287,0.4002,0.4498,0.5115,0.2968,0.4387,0.3158,0.4942,0.4269,0.4118,0.5435,0.6338,0.6362,0.295,0.4469,0.6025,0.6205,0.6949,0.5327,0.5083,0.5362,0.4952,0.6645,0.573,0.6143,0.6167,0.6077,0.6113,0.4479,0.5087,0.6098,0.491,0.3982,0.3215,0.6409,0.4504,0.4314,0.4094,0.4653,0.4448,0.3704,0.4315,0.4436,0.5409,0.6397,0.6141,0.435,0.4924,0.4159,0.4061,0.3401,0.3526,0,0.5278,0.5422,0.6687,0.5754,0.6763,0.7214,0.8246,0.7705,0.7242,0.6995,0.532,0.4664,0.4079,0.274,0.3747,0.4899,0.291,0.4728,0.2978,0.371,0.419,0.532,0.4908,0.5081,0.7033,1,1,0.3712,0,0,0.4407,0.4207,0.713,0.7311,0.7446,0.6725,0.5317,0.5832,0.5832,0.5801,0.5591,0.4786,0.458,0.5832,0.5832,0.5863,0.5049,0.4786,0.458,0.5108,0.3908,0.461,0.5003,0.335,0.3188,0.5127,0.5817,0.5104,0.479,0.4844,0.402,0.438,0.2997,0.3042,0.5341,0.4236,0.5111,0.5082,0.3875,0.6165,0.4661,0.4337,0.353,0.3025,0.5518,0.574,0.576,0.4244,0.4346,0.3274,0.3086,0.5835,0.4727,0,0.3053,0.3182,0.4491,0.4551,0.4181,0.4642,0.4771,0.477,0.3726,0.5026,0.5644,0.4137,0.3143,0.3053,0.3182,0.4491,0.4082,0.3869,0.4602,0.4644,0.5492,0.5163,0.3488,0.2126,0.3665,0.7395,0.5935,0.3984,0.6748,0.6288,0.419,0.4346,0.6184,0,0,0.6095,0.6269,0.7093,0.6074,0.7788,0.4102,0.4527,0.4196,0.3959,0.3854,0.312,0.3374,0.345,0,0.6858,0,1,0.6746,0.56,0.6156,0.7286,0.5344,0.7056,0.7595,0.7118,0.6032,0.5352,0.4504,0.6719,0.3807,0.4003,0.3469,0.5945,0.5563,0.6796,0.4671,0.5537,0.6528,0.7016,0.9928,0.5469,0.361,0.344,0,0,0,0.8373,0.7126,0.7278,0.7081,0.6184,0.6684,0.5111,0.7517,0.7641,0.7718,0.7044,0.7191,0,0.4627,0.4904,0.4128,0.2342,0.2663,0.4664,0.6607,0.683,0.6937,0.7385,0.7335,0.6807,0.6183,0.6801,0.4474,0.4722,0.5094,0.5705,0.6441,0.6286,0.5732,0.7472,0.6345,0.6328,0.6656,0.6842,0.6051,0.7181,0.7667,0,0.656,0,0.6201,0.6544,0.6402,0.69,0.621,0.5736,0.5546,0.6001,0.6657,0.613,0.8434,0.8583,0.4801,0.3972,0.4121,0.4076,0.6315,0.5655,0.6915,0.7081,0.6538,0.5532,0.6972,0.7296,0.5843,0.7703,0.8283,0.4643,0.3934,0.4545,0.4107,0.309,0.309,0.3676,0.7205,0.6713,0.6213,0.7046,0.8621,0.6267,0.4863,0.5346,0.4793,0.5307,0.6934,0.6542,0.4057,0.1956,0.2102,0.6108,0.6052,0.4639,0.7408,0.7096,0.659,0.3619,0.3625,0.3991,0.73,0.8112,0,0.2273,0.0245,0.3392,0.3125,0.2153,0.1859,0.3719,0.4604,0.3368,0.7169,0.7398,0,0.4042,0.4298,0.3498,0.3252,0.3415,0.4076,0.6677,0.5749,0.5888,0.6973,0.6712,0.5803,0.6518,0.712,0.4935,0.6299,0,0.5647,0.5644,0.7158,0.7455,0.7254,0.4262,0.3622,0.2612,0.374,0.4853,0.6479,0.6864,0,0.4211,0.4795,0.4868,0.5704,0.5384,0.6311,0.722,0.6011,0.7181,0.7103,0.6975,0.6619,0.3484,0.3792,0.4075,0.3923,0.4219,0.4461,0.7138,0.6246,0.6642,0.5342,0.6137,0.71,0.7838,0.7858,0.7416,0.6565,0.7282,0,0.6494,0.7531,0.6772,0.608,0.507,0.6224,0.6569,0.4551,0.294,0.3979,0.2853,0.5454,0.5887,0.6455,0.5049,0.4075,0.3996,0.3003,0.4412,0.3345,0.3555,0.358,0.4074,0.2897,0.7127,0.6994,1,0.6572,0.8679,0,0.7381,0.8344,0.7823,0.6226,0.631,0.7039,0.3562,0.2426,0.1765,0.2675,0.4852,0.4444,0.2832,0,0,0.292,0.3405,0.2991,0.2661,0.2906,0.2968,0.3275,0.3362,0.1699,0.2739,0.2709,0.3446,0.5651,0.6073,0.5743,0.3737,0.4815,0.4157,0.8481,0.9157,0.9453,0.6651,0.5951,0.4818,0.2822,0.2883,0.3402,0.2652,0,0,0.4016,0.4464,0.5112,0.5346,0.5689,0.5937,0.3739,0.3536,0.3186,0.2303,0.2599,0.3406,0.4845,0.5496,0.5101,0,0,0.7422,0.326,0.3493,0.3666,0.6018,0.6564,0.632,0.6575,0.6349,0.6173,0.351,0.3993,0.3806,0.4364,0.4027,0.2373,0.2716,0.3239,0.6778,0.6266,0.6377,0.8793,0.7225,0.6889,0.4943,0.5731,0.3616,0.5011,0.4644,0.4745,0.3133,0.3508,0.719,0.6739,0.66,0.7607,0.8548,0.7003,0.3317,0,0.6884,0.7223,0.7338,0.6232,0.6543,0.7128,0.3441,0,0.2437,0.6507,0.7034,0.6106,0.6587,0.8247,0,0.7227,0.6679,0.3465,0.2784,0.3047,0.4532,0.49,0.4647,0.637,0.6754,0.5821,0.4318,0.4644,0.3548,0.418,0.391,0.277,0.2677,0.2592,0.802,1,0.7919,0.7635,0.7607,0.7268,0.3694,0.3926,0.5155,0.6239,0.5705,0.5112,0.5227,0.6259,0.8542,0.85,0.8612,0.8454,0.8284,0.794,0.6763,0.7387,0.3325,0.4467,0.4069,0.6641,0.674,0.6826,0.7438,0.7142,0.7215,0.625,0.5989,0.5821,0.7232,0.8125,0.6336,0.5889,0.7318,1,0.6776,0.6441,0.7024,0.7156,0.6715,0.6747,0.7002,0.199,0.2407,0.2654,0.7222,0.7143,0.6591,0.6846,0.6692,0.6152,0.8236,0.8669,0.4652,0.3201,0.2783,0.4492,0.4402,0.2915,0.268,0.2625,0.314,0.821,0.8719,0.5579,0.5086,0.5446,0.507,0.4367,0.2412,0.6033,0.6319,0.607,0.6843,0.6763,0.2693,0.251,0.3026,0.5326,0.5401,0.4538,0.2315,0.2767,0.3293,0.855,0.8932,0.2711,0.2839,0.2422,0.6156,0.6292,0.5254,0.5711,0.54,0.5271,0.5246,0.4657,0.6117,0.6466,0.7212,0.2607,0.3483,0.2512,0.3632,0.3306,0.4479,0.85,0.8506,0.5451,0.6266,0.4878,0.6362,0.5861,0.5554,0.4238,0.3556,0.4191,0.4273,0.4432,0.4143,0.3629,0.2373,0.2398,0.2274,0.308,0.3193,0.3397,0.4075,0.3405,0.2181,0.3773,0.2988,0.3236,0.2896,0.319,0.4235,0.4186,0.4322,0.3037,0.3086,0.4358,0.3301,0.407,0.7599,0.7374,0.4673,0.2469,0.3301,0.3646,0.5048,0.5529,0.35,0.3134,0.1343,0.24,0.2566,0,0.3795,0.3782,0.6423,0.597,0.4481,0.3856,0.3572,0.2121,0.2402,0,0.3324,0.3733,0.4666,0.5643,0.2886,0.2951,0.269,0,0.4191,0.4657,0.6186,1,0.2893,0.3466,0.2978,0,0.3351,0.453,0.4509,0.3493,0.2566,0.1939,0.282,0.5866,0.6289,0.3405,0.617,0.6959,0.6308,0.5197,0.5015,0.4459,0.5065,0.6106,0.5959,0.6326,0.6392,0.7131,0.7199,0.6925,0.475,0.3981,0.3734,0.3196,0.3656,0.3489,0.4363,0.6158,0.6578,0.6388,0.6696,0.6985,0.7372,0.8402,0.8485,0.7196,0.86,1,0.8084,0.6707,0.8501,0.4052,0.5128,0.5633,0.4892,0.373,0.4107,0.4165,0.5002,0.5627,0.5481,0.5407,0.7198,0.8601,0.6677,0.7021,0.3953,0.4984,0.5507,0.5125,0.5493,0.5137,0.4188,0.2987,0.2983,0.1973,0.3769,0.3196,0.2583,0.3374,0.1814,0.4862,0.4461,0.4795,0.4626,0.4977,0.6118,0.4398,0.461,0.3984,0.6068,0.5623,0.7274,0.4927,0.5139,0.6622,0.722,1,0.5055,0.4776,0.4481,0.4675,0.4349,0.3886,0.5343,0.6575,0.5676,0.5915,0.708,0.5864,0.6267,0.7355,0.5014,0.5376,0.4982,0.5466,0.357,0.4959,0.4568,0.4118,0.3029,0.3319,0.5258,0.5778,0.6115,0.4264,0.2794,0.2547,0.2934,0.4704,0.2444,0.4523,0.4623,0.4633,0.4062,0.5654,0.5679,0.6703,0.5801,0.48,0.519,0.7472,0.7639,0.6881,0.4441,0.3806,0.3895,0.4596,0.4587,0.4355,0.6036,0.5582,0.6937,0.7348,0.6087,0.5364,0.7121,0.676,0.6137,0.659,0.6837,0.471,0.7092,0.5004,0.6277,0.6557,0.666,0.73,0.5332,0.5726,0.7264,0.7633,0.7231,0.8096,0.8821,0.348,0.2913,0.4379,0.3461,0.4027,0.5014,0.6469,0.5854,0.4623,0.4264,0.4113,0.3735,0.4808,0.5712,0.5745,0.568,0.4835,0.4577,0.5511,0.29,0.445,0.2592,0.4113,0.3735,0.4808,0.3645,0.3466,0.8645,0.8645,0.7289,0.4364,0.7326,0.7977,0.3745,0.4316,0.6,0.5037,0.6156,0.8645,0.8645,1,0.7951,0.8573,0.899,0.7606,0.8894,0.6627,0.6033,0.694,0.7437,0.7437,0.7437,0.696,0.8088,1,0.7605,0.2714,0.802]}},{"name":"SRDD","value":{"Y":[-3.1736,-3.9609,-3.2184,-2.6594,-3.3131,-2.5369,-3.7784,-2.327,-2.3222,-2.937,-2.1106,-3.0682,-2.6311,-2.3604,-1.8669,-2.7394,-2.3509,-2.2299,-2.6261,-2.5851,-2.317,-2.4933,-2.9247,-1.6287,-2.66,-2.0489,-2.19,-2.3513,-2.5186,-2.5655,-3.0446,-2.2927,-1.4729,-2.2142,-2.0624,-2.6114,-2.5099,-1.8949,-1.9756,-1.7563,-2.7142,-2.9237,-2.5276,-2.6344,-2.3914,-2.0935,-2.404,-2.0082,-1.466,-2.4623,-2.0741,-2.3927,-1.6427,-1.6324,-1.9755,-2.1811,-1.9026,-1.6939,-2.7156,-1.019,-2.8246,-1.5527,-2.2878,-2.0446,-1.849,-3.361,-1.3917,-1.3259,-2.5984,-2.1195,-1.2268,-2.0221,-2.0889,-1.6388,-1.8653,-1.6338,-2.3653,-2.2637,-1.8911,-2.5051,-2.0933,-1.6899,-1.2648,-1.1887,-1.5539,-2.3787,-2.7613,-1.6169,-1.3883,-1.0683,-1.7133,-2.6938,-1.9652,-2.2856,-1.651,-2.3091,-2.4146,-2.4644,-1.6146,-2.4874,-2.2323,-2.3878,-2.2557,-1.3641,-1.3299,-1.1213,-1.4883,-1.762,-1.4354,-1.3509,-2.3382,-2.1954,-1.1498,-2.0637,-2.2612,-1.8483,-1.9991,-1.6623,-1.632,-0.9975,-1.6728,-1.0152,-1.414,-1.0671,-1.7831,-0.7504,-1.5925,-2.4728,-1.1994,-2.3509,-1.9168,-1.1851,-0.6206,-1.5209,-1.8586,-2.069,-2.0123,-2.0563,-1.8047,-1.6361,-1.5153,-0.9303,-1.5315,-2.0158,-1.4371,-2.0278,-1.0878,-1.7548,-1.9761,-1.5951,-1.6973,-1.9253,-1.3279,-1.8642,-0.5646,-1.232,-1.293,-1.5813,-1.5305,-1.0745,-1.6275,-0.1591,-1.2263,-1.5048,-1.2933,-1.5259,-1.9862,-0.4708,-1.1973,-0.5082,-1.1874,-1.2053,-2.1173,-1.8546,-0.7867,-0.6476,-0.9289,-0.7978,-1.5973,-0.9146,-1.425,-1.56,-0.6666,-1.3705,-0.2907,-0.4424,-0.9212,-1.5566,-2.1442,-1.1743,-0.9195,-2.4699,-1.3164,-1.1717,0.0155,-0.6042,-0.5692,-2.1098,-1.7252,-0.1433,-0.9285,-0.5903,-1.3572,-2.7669,-0.2815,-1.3298,-1.0353,-0.9356,-0.9849,-0.8262,-0.5547,-0.8198,-0.6543,-0.758,-1.4062,-0.8998,-1.5374,-1.3221,-0.5411,-1.556,-0.8875,-0.7234,-0.7244,-1.9338,-1.028,-1.16,-1.2351,-0.159,-0.8955,-1.9456,-0.8305,-0.626,-1.2429,-0.5222,-0.551,-1.9938,-0.0165,-1.1222,-1.1004,-0.6309,-1.1575,-1.245,-1.3115,-0.1761,-0.8026,-0.7798,-1.0303,-1.2504,-1.0398,-1.6598,-0.8309,0.0995,-0.3381,-0.7301,-0.4626,-0.7417,-1.0487,-0.8795,-1.1834,-0.0074,-0.6398,-0.2583,-0.702,-1.2101,-0.0605,-1.2878,0.1187,-0.7159,-0.4972,-0.4366,-0.5588,0.1697,-1.1566,-0.098,0.0956,0.1957,-0.5688,-0.4792,-0.2515,-0.7614,0.127,0.308,-0.9385,0.4135,-0.9539,-0.4422,-0.7472,-0.5388,-0.3836,-0.574,-0.6657,-1.4176,-0.5332,-0.3033,-0.4605,-1.423,-0.3351,-0.1731,-0.6342,-0.0645,-0.4307,-1.0176,-0.1788,-0.4764,-1.0683,-0.1128,-0.8229,-0.3463,-0.6405,-0.2075,-0.9447,-0.6327,-0.3954,-0.0643,0.3496,-0.6929,0.1313,-0.9495,0.3068,-0.607,-0.0795,-0.1125,-0.7289,-0.5851,-0.4123,-0.4095,-0.4262,-0.3654,-0.2857,0.5555,-0.1428,0.056,-0.3486,0.0916,-0.4484,-0.924,-0.6893,-0.8773,-0.7189,0.4139,0.0861,0.1913,0.3626,0.3597,0.1205,-0.5692,0.071,-0.9855,-0.2605,-0.1281,0.7947,-0.2499,-0.3002,-0.0057,0.0142,-0.9896,-0.0218,-0.0698,0.4672,-0.0213,0.1545,1.2248,0.8915,1.0779,1.871,0.908,0.8954,1.2068,1.2768,1.6275,2.0661,1.9358,1.4903,1.6191,0.3758,2.261,1.7858,1.187,1.6569,1.4321,1.9873,1.1963,1.2926,1.5692,1.7718,0.8846,1.3564,1.6367,1.1143,1.852,2.5055,1.5708,2.0852,1.2396,2.3166,1.6176,1.5915,2.1858,0.8437,1.7651,1.3332,2.1125,1.457,1.9489,1.1627,1.769,2.4264,1.4093,1.829,1.1241,1.1783,2.1341,2.4859,1.1165,1.2429,1.5098,2.4138,1.4645,1.5845,2.321,2.2738,2.048,1.6484,1.6785,1.7458,2.1023,1.3401,1.6547,1.4574,0.8903,2.0394,3.0076,2.3657,2.3522,2.365,1.0824,1.7331,1.4022,1.8391,1.8899,2.1996,2.1734,1.8779,0.4192,2.3859,2.211,1.4262,1.9915,1.5605,2.3334,1.2602,1.5279,2.808,1.9234,2.2076,1.4249,2.3511,1.7887,2.1653,1.7494,2.1354,2.139,2.1241,1.3744,1.985,2.0939,1.7166,2.627,1.6815,1.4039,2.4174,1.7491,2.1936,1.1372,1.5969,2.1209,1.9323,2.2879,2.6002,2.0549,1.4429,0.9888,2.477,1.3583,2.1004,1.5572,2.1997,2.2512,2.641,2.2467,1.5394,1.2998,2.3084,1.7475,1.7823,1.5262,1.9716,2.3051,1.4363,2.7086,0.5381,2.6438,2.3567,2.2979,2.2752,2.1577,1.6468,1.5874,2.1021,1.7975,2.937,2.2057,1.8172,2.5747,1.8369,1.4912,2.6181,2.5133,2.1784,1.3345,3.129,2.1123,1.6447,2.1364,2.085,1.9878,1.9468,1.278,1.4175,3.482,1.936,2.5672,1.1529,2.8328,2.5224,1.371,1.6871,1.9949,1.5753,1.4596,2.0963,2.4104,1.7795,1.7609,1.8112,2.1918,1.9286,1.8047,1.7963,1.3236,1.6216,1.7843,1.4805,1.8689,1.8797,1.8009,1.4045,1.6549,1.2299,2.2904,1.676,1.5598,1.7313,1.0935,1.8397,1.083,2.035,1.8976,1.2962,2.0993,1.5503,1.61,1.2025,1.9184,1.2383,1.6457,1.6681,1.6335,2.4294,1.8759,1.2833,1.1592,1.6571,2.0293,0.8162,1.5331,2.5691,1.9605,1.571,1.1047,1.6135,1.3013,1.7692,1.9476,1.6319,1.7459,1.7955,1.4266,0.1848,1.6084,1.4779,1.0448,1.9357,1.1575,0.9925,1.4919,1.5309,1.5964,1.1039,0.6765,1.2363,1.4441,2.6198,1.9186,1.3177,1.3378,1.1084,1.9005,1.0602,2.1344,1.5585,0.6074,1.9125,1.6798,2.2786,1.7791,1.092,1.3497,0.9202,0.847,1.8998,0.7092,1.1897,1.1176,1.3973,1.4339,1.9834,1.7113,1.1848,2.4223,2.4176,2.0778,2.131,1.2379,1.1194,0.5782,1.1301,0.6087,-0.1234,1.2679,1.6929,1.3831,1.2218,1.8802,1.4036,1.1446,0.2141,1.1868,1.2831,2.2611,0.4789,1.1623,0.1262,1.6234,0.6224,0.9796,1.4257,0.7076,0.6622,0.9879,0.7835,2.0971,0.8226,0.7706,1.1182,2.2826,0.1742,1.3233,1.6619,0.5791,0.7603,0.9293,0.9516,0.7727,1.2862,1.157,0.2618,0.938,0.2179,1.2612,0.5171,0.3336,1.0236,1.1418,1.358,0.0333,-0.0237,0.6568,0.6826,0.3694,-0.1862,-0.3648,1.3602,1.63,0.2895,0.71,0.1077,0.2172,1.115,0.0591,0.9687,0.0855,0.4846,0.5337,0.5763,-0.3063,-0.8923,0.3098,0.4226,0.4009,0.8777,0.7103,0.9049,0.4992,0.4006,0.8046,0.4427,0.5572,0.114,0.4373,0.2608,0.0947,-0.9425,1.2088,0.6593,0.4469,-0.1673,0.3009,0.4657,-0.1005,-0.3801,-0.2663,0.8018,-0.7462,-0.1004,0.4043,0.5567,-0.0022,0.126,-0.0273],"X":[-4.9939,-4.9914,-4.9785,-4.9685,-4.9672,-4.9464,-4.905,-4.9047,-4.8972,-4.879,-4.8779,-4.8625,-4.8537,-4.8404,-4.8116,-4.7779,-4.7431,-4.7328,-4.7237,-4.7214,-4.7044,-4.6861,-4.6669,-4.6639,-4.6579,-4.6454,-4.6136,-4.6132,-4.6107,-4.6019,-4.6017,-4.6,-4.5814,-4.5501,-4.5423,-4.5068,-4.5054,-4.5041,-4.5011,-4.4986,-4.4835,-4.4598,-4.4376,-4.4311,-4.4059,-4.3977,-4.349,-4.3439,-4.2995,-4.2728,-4.2622,-4.2612,-4.2392,-4.2187,-4.1784,-4.1604,-4.1502,-4.1173,-4.1151,-4.1004,-4.0732,-4.0121,-4.0075,-4.0059,-3.9929,-3.9923,-3.992,-3.9897,-3.9476,-3.9471,-3.933,-3.9216,-3.8972,-3.8951,-3.863,-3.8485,-3.8457,-3.8386,-3.8357,-3.8308,-3.8254,-3.8001,-3.7939,-3.7852,-3.7818,-3.7778,-3.7653,-3.7257,-3.721,-3.7186,-3.7173,-3.7004,-3.6944,-3.6839,-3.6746,-3.6645,-3.6626,-3.6592,-3.6385,-3.5938,-3.5793,-3.5738,-3.5392,-3.47,-3.4675,-3.4494,-3.4419,-3.4294,-3.4095,-3.3997,-3.3491,-3.3361,-3.3295,-3.2978,-3.2963,-3.2581,-3.2535,-3.2472,-3.189,-3.1494,-3.1366,-3.1328,-3.1308,-3.1267,-3.1212,-3.113,-3.1005,-3.0937,-3.0779,-3.0739,-3.0673,-3.051,-3.0383,-3.0333,-3.016,-3.0137,-3.0007,-2.993,-2.9887,-2.9875,-2.961,-2.958,-2.956,-2.9401,-2.9326,-2.9144,-2.9121,-2.8776,-2.8513,-2.8414,-2.841,-2.8341,-2.8287,-2.812,-2.8034,-2.7764,-2.7655,-2.7515,-2.714,-2.6777,-2.6745,-2.6643,-2.6534,-2.6318,-2.6097,-2.6091,-2.5834,-2.5689,-2.5607,-2.556,-2.5311,-2.5223,-2.5088,-2.4845,-2.4747,-2.453,-2.4251,-2.4185,-2.4184,-2.4184,-2.4122,-2.4119,-2.3764,-2.3611,-2.3489,-2.3481,-2.3332,-2.3318,-2.3255,-2.3158,-2.2842,-2.2785,-2.2779,-2.244,-2.2084,-2.2046,-2.1974,-2.1962,-2.1923,-2.1903,-2.1727,-2.1654,-2.1535,-2.1378,-2.1281,-2.1246,-2.1073,-2.0768,-2.065,-2.0474,-1.998,-1.9836,-1.9803,-1.9731,-1.9702,-1.9698,-1.9533,-1.9485,-1.9453,-1.9303,-1.93,-1.9278,-1.9233,-1.9198,-1.9191,-1.9097,-1.9035,-1.9031,-1.8991,-1.8957,-1.8913,-1.8874,-1.8818,-1.8339,-1.8282,-1.8251,-1.8155,-1.8142,-1.7936,-1.7561,-1.7472,-1.7432,-1.7255,-1.7203,-1.7028,-1.7023,-1.6792,-1.6516,-1.6339,-1.6285,-1.622,-1.612,-1.6072,-1.6066,-1.5643,-1.564,-1.5551,-1.5536,-1.5517,-1.5178,-1.47,-1.4449,-1.4371,-1.4308,-1.4301,-1.4276,-1.4167,-1.3641,-1.336,-1.3282,-1.3082,-1.303,-1.2773,-1.2718,-1.2583,-1.244,-1.2404,-1.2133,-1.1971,-1.1967,-1.1573,-1.1395,-1.1304,-1.1081,-1.105,-1.0823,-1.0688,-1.0645,-1.0503,-1.049,-1.0281,-1.0059,-0.9707,-0.9583,-0.9431,-0.9275,-0.9241,-0.9159,-0.8947,-0.8942,-0.8809,-0.865,-0.8478,-0.8409,-0.8337,-0.8308,-0.7972,-0.7864,-0.7767,-0.7695,-0.7597,-0.7589,-0.7416,-0.7302,-0.7262,-0.712,-0.7075,-0.7056,-0.6898,-0.6762,-0.6749,-0.6447,-0.6096,-0.6051,-0.603,-0.5944,-0.5597,-0.4985,-0.4752,-0.4481,-0.4391,-0.4317,-0.3974,-0.3505,-0.3401,-0.3284,-0.3221,-0.2809,-0.2738,-0.2297,-0.2154,-0.212,-0.2106,-0.2078,-0.1863,-0.1847,-0.1595,-0.1588,-0.1581,-0.1501,-0.1386,-0.1327,-0.1317,-0.1211,-0.1048,-0.0604,-0.0556,-0.0303,-0.0246,-0.0209,-0.0045,0.0179,0.02,0.0275,0.0326,0.0393,0.0455,0.0636,0.0731,0.0855,0.087,0.0892,0.0914,0.0942,0.0965,0.1158,0.1177,0.1199,0.1204,0.1303,0.1425,0.1427,0.1695,0.1725,0.1919,0.2005,0.2358,0.257,0.2631,0.2836,0.3191,0.365,0.3888,0.4004,0.4112,0.4427,0.4476,0.4497,0.4531,0.4651,0.4846,0.511,0.5333,0.5513,0.5527,0.5691,0.5794,0.6006,0.6042,0.6054,0.6089,0.6302,0.6308,0.6457,0.646,0.6508,0.6597,0.6631,0.6678,0.6696,0.6711,0.6832,0.722,0.727,0.7359,0.7397,0.7431,0.7588,0.7681,0.8427,0.8952,0.9009,0.9198,0.9244,0.929,0.9591,0.9626,0.9662,0.9774,0.9864,0.9905,0.9934,0.9977,1.0071,1.0182,1.019,1.0425,1.0567,1.0656,1.0736,1.0869,1.0927,1.1131,1.1232,1.1322,1.1504,1.1606,1.207,1.2182,1.223,1.2236,1.2338,1.2462,1.2516,1.252,1.252,1.2529,1.2748,1.2935,1.3044,1.3174,1.3244,1.3254,1.341,1.3591,1.373,1.3819,1.3869,1.3891,1.3919,1.392,1.4031,1.4641,1.4986,1.526,1.5515,1.554,1.5561,1.5707,1.5726,1.5776,1.5802,1.5903,1.6034,1.6051,1.6075,1.6205,1.6349,1.645,1.6483,1.6565,1.6608,1.6757,1.685,1.6892,1.7136,1.7443,1.7489,1.7709,1.805,1.8088,1.8211,1.8624,1.8684,1.8716,1.8912,1.9171,1.9359,1.9367,1.9629,1.9687,2.0075,2.0279,2.0649,2.0799,2.0884,2.0888,2.1036,2.131,2.133,2.1727,2.2384,2.2468,2.2939,2.313,2.323,2.3244,2.3273,2.3389,2.355,2.3783,2.3988,2.3989,2.416,2.4212,2.4257,2.4351,2.4428,2.4544,2.464,2.4748,2.4762,2.4816,2.4875,2.4958,2.5093,2.512,2.5703,2.5729,2.5795,2.5806,2.5827,2.5896,2.5912,2.5934,2.5967,2.6151,2.6334,2.639,2.6546,2.6786,2.6815,2.6882,2.7352,2.7494,2.7579,2.7597,2.7651,2.7732,2.8312,2.8384,2.839,2.8434,2.9063,2.9209,2.9361,2.9411,2.9692,2.9705,2.9716,2.9847,2.9946,3.0104,3.0214,3.024,3.0296,3.0393,3.0471,3.0687,3.0717,3.0735,3.0765,3.078,3.1008,3.106,3.1465,3.1559,3.1608,3.192,3.2076,3.2123,3.2185,3.248,3.2551,3.286,3.2956,3.3029,3.3039,3.3135,3.3451,3.3454,3.347,3.3542,3.3548,3.373,3.378,3.3808,3.4165,3.4171,3.4356,3.4371,3.4463,3.4589,3.4839,3.5026,3.5031,3.5546,3.6051,3.6092,3.6181,3.6258,3.647,3.6483,3.6701,3.6916,3.7002,3.7368,3.779,3.7803,3.7882,3.797,3.8232,3.8241,3.8324,3.8334,3.8473,3.9022,3.917,3.9284,3.9477,3.9619,3.9858,4.0042,4.0772,4.0817,4.1265,4.1309,4.1342,4.14,4.1432,4.1466,4.1597,4.1851,4.2041,4.2092,4.2318,4.2343,4.243,4.2465,4.264,4.2707,4.2758,4.2936,4.2945,4.3016,4.3032,4.3152,4.3217,4.3235,4.343,4.3539,4.3709,4.3943,4.4236,4.4391,4.4585,4.4605,4.4678,4.4704,4.4736,4.4808,4.4937,4.4952,4.502,4.503,4.5114,4.5183,4.5335,4.5536,4.5584,4.5599,4.6012,4.6222,4.6484,4.6594,4.66,4.673,4.707,4.7192,4.7213,4.7402,4.7434,4.7579,4.7636,4.7705,4.777,4.7831,4.7979,4.8021,4.8079,4.8096,4.8304,4.8364,4.8492,4.8563,4.8566,4.8665,4.8783,4.8817,4.885,4.8971,4.902,4.9161,4.9215,4.9252,4.945,4.946,4.9825,4.9874,4.9883],"B":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"Y_true":[-2.4969,-2.4957,-2.4893,-2.4843,-2.4836,-2.4732,-2.4525,-2.4524,-2.4486,-2.4395,-2.4389,-2.4313,-2.4269,-2.4202,-2.4058,-2.389,-2.3715,-2.3664,-2.3618,-2.3607,-2.3522,-2.343,-2.3335,-2.332,-2.329,-2.3227,-2.3068,-2.3066,-2.3054,-2.301,-2.3009,-2.3,-2.2907,-2.2751,-2.2711,-2.2534,-2.2527,-2.252,-2.2506,-2.2493,-2.2418,-2.2299,-2.2188,-2.2155,-2.2029,-2.1989,-2.1745,-2.1719,-2.1497,-2.1364,-2.1311,-2.1306,-2.1196,-2.1093,-2.0892,-2.0802,-2.0751,-2.0586,-2.0575,-2.0502,-2.0366,-2.006,-2.0038,-2.003,-1.9965,-1.9962,-1.996,-1.9949,-1.9738,-1.9736,-1.9665,-1.9608,-1.9486,-1.9475,-1.9315,-1.9242,-1.9229,-1.9193,-1.9179,-1.9154,-1.9127,-1.9,-1.897,-1.8926,-1.8909,-1.8889,-1.8826,-1.8628,-1.8605,-1.8593,-1.8587,-1.8502,-1.8472,-1.8419,-1.8373,-1.8323,-1.8313,-1.8296,-1.8192,-1.7969,-1.7896,-1.7869,-1.7696,-1.735,-1.7337,-1.7247,-1.7209,-1.7147,-1.7048,-1.6999,-1.6745,-1.668,-1.6648,-1.6489,-1.6481,-1.6291,-1.6268,-1.6236,-1.5945,-1.5747,-1.5683,-1.5664,-1.5654,-1.5634,-1.5606,-1.5565,-1.5502,-1.5469,-1.539,-1.537,-1.5336,-1.5255,-1.5191,-1.5167,-1.508,-1.5068,-1.5003,-1.4965,-1.4943,-1.4938,-1.4805,-1.479,-1.478,-1.4701,-1.4663,-1.4572,-1.456,-1.4388,-1.4257,-1.4207,-1.4205,-1.4171,-1.4143,-1.406,-1.4017,-1.3882,-1.3828,-1.3758,-1.357,-1.3389,-1.3372,-1.3321,-1.3267,-1.3159,-1.3049,-1.3046,-1.2917,-1.2845,-1.2804,-1.278,-1.2656,-1.2611,-1.2544,-1.2423,-1.2374,-1.2265,-1.2126,-1.2093,-1.2092,-1.2092,-1.2061,-1.206,-1.1882,-1.1806,-1.1744,-1.1741,-1.1666,-1.1659,-1.1627,-1.1579,-1.1421,-1.1392,-1.139,-1.122,-1.1042,-1.1023,-1.0987,-1.0981,-1.0961,-1.0951,-1.0863,-1.0827,-1.0767,-1.0689,-1.064,-1.0623,-1.0536,-1.0384,-1.0325,-1.0237,-0.999,-0.9918,-0.9901,-0.9865,-0.9851,-0.9849,-0.9766,-0.9742,-0.9727,-0.9651,-0.965,-0.9639,-0.9617,-0.9599,-0.9595,-0.9549,-0.9518,-0.9516,-0.9495,-0.9478,-0.9456,-0.9437,-0.9409,-0.9169,-0.9141,-0.9125,-0.9078,-0.9071,-0.8968,-0.8781,-0.8736,-0.8716,-0.8627,-0.8602,-0.8514,-0.8511,-0.8396,-0.8258,-0.8169,-0.8142,-0.811,-0.806,-0.8036,-0.8033,-0.7821,-0.782,-0.7775,-0.7768,-0.7758,-0.7589,-0.735,-0.7225,-0.7186,-0.7154,-0.7151,-0.7138,-0.7083,-0.682,-0.668,-0.6641,-0.6541,-0.6515,-0.6387,-0.6359,-0.6292,-0.622,-0.6202,-0.6067,-0.5986,-0.5983,-0.5787,-0.5697,-0.5652,-0.5541,-0.5525,-0.5411,-0.5344,-0.5323,-0.5252,-0.5245,-0.5141,-0.503,-0.4853,-0.4791,-0.4716,-0.4637,-0.462,-0.4579,-0.4474,-0.4471,-0.4405,-0.4325,-0.4239,-0.4204,-0.4169,-0.4154,-0.3986,-0.3932,-0.3883,-0.3848,-0.3798,-0.3795,-0.3708,-0.3651,-0.3631,-0.356,-0.3537,-0.3528,-0.3449,-0.3381,-0.3375,-0.3223,-0.3048,-0.3025,-0.3015,-0.2972,-0.2798,-0.2492,-0.2376,-0.224,-0.2195,-0.2159,-0.1987,-0.1753,-0.17,-0.1642,-0.161,-0.1405,-0.1369,-0.1148,-0.1077,-0.106,-0.1053,-0.1039,-0.0931,-0.0924,-0.0798,-0.0794,-0.0791,-0.075,-0.0693,-0.0663,-0.0659,-0.0606,-0.0524,-0.0302,-0.0278,-0.0152,-0.0123,-0.0104,-0.0023,1.5089,1.5099,1.5136,1.5161,1.5194,1.5224,1.5312,1.5357,1.5416,1.5423,1.5434,1.5445,1.5458,1.5468,1.5559,1.5568,1.5578,1.558,1.5626,1.5682,1.5683,1.5804,1.5818,1.5904,1.5942,1.6096,1.6186,1.6212,1.6297,1.6443,1.6625,1.6717,1.6761,1.6802,1.692,1.6937,1.6945,1.6957,1.7001,1.7071,1.7163,1.724,1.73,1.7305,1.736,1.7393,1.7462,1.7473,1.7477,1.7488,1.7555,1.7557,1.7603,1.7604,1.7619,1.7646,1.7656,1.767,1.7675,1.768,1.7716,1.7828,1.7842,1.7867,1.7878,1.7887,1.793,1.7956,1.8148,1.8274,1.8287,1.833,1.834,1.8351,1.8416,1.8423,1.8431,1.8454,1.8472,1.8481,1.8487,1.8495,1.8514,1.8536,1.8537,1.8582,1.8609,1.8625,1.8639,1.8662,1.8673,1.8707,1.8724,1.8738,1.8767,1.8783,1.885,1.8865,1.8871,1.8872,1.8886,1.8902,1.8908,1.8909,1.8909,1.891,1.8936,1.8958,1.897,1.8984,1.8991,1.8992,1.9008,1.9025,1.9037,1.9045,1.9049,1.9051,1.9053,1.9054,1.9062,1.9105,1.9124,1.9137,1.9147,1.9148,1.9148,1.9153,1.9153,1.9155,1.9155,1.9158,1.9161,1.9161,1.9161,1.9163,1.9165,1.9166,1.9166,1.9167,1.9167,1.9167,1.9166,1.9166,1.9163,1.9158,1.9157,1.915,1.9138,1.9136,1.9131,1.9109,1.9106,1.9104,1.9091,1.9073,1.9058,1.9057,1.9035,1.903,1.8992,1.8971,1.8929,1.8911,1.89,1.8899,1.888,1.8843,1.884,1.8783,1.8676,1.8662,1.8577,1.854,1.852,1.8518,1.8512,1.8489,1.8456,1.8407,1.8363,1.8362,1.8324,1.8313,1.8302,1.8281,1.8263,1.8236,1.8213,1.8187,1.8184,1.817,1.8156,1.8135,1.8102,1.8095,1.7942,1.7935,1.7917,1.7914,1.7908,1.7889,1.7885,1.7878,1.7869,1.7817,1.7765,1.7749,1.7703,1.7631,1.7622,1.7602,1.7454,1.7408,1.738,1.7375,1.7357,1.733,1.7132,1.7107,1.7105,1.7089,1.6862,1.6807,1.6749,1.673,1.6622,1.6617,1.6612,1.6561,1.6521,1.6458,1.6414,1.6403,1.638,1.634,1.6308,1.6218,1.6205,1.6198,1.6185,1.6179,1.6081,1.6059,1.5882,1.584,1.5818,1.5677,1.5605,1.5583,1.5554,1.5416,1.5382,1.5233,1.5186,1.5151,1.5146,1.5099,1.4941,1.4939,1.4931,1.4895,1.4892,1.48,1.4774,1.4759,1.4574,1.4571,1.4473,1.4465,1.4416,1.4348,1.4213,1.411,1.4108,1.382,1.353,1.3507,1.3455,1.3409,1.3284,1.3276,1.3146,1.3016,1.2964,1.2738,1.2473,1.2465,1.2415,1.2359,1.2191,1.2185,1.2131,1.2125,1.2034,1.167,1.1571,1.1494,1.1362,1.1265,1.1099,1.097,1.0451,1.0418,1.009,1.0058,1.0033,0.9991,0.9967,0.9942,0.9844,0.9653,0.9509,0.947,0.9297,0.9277,0.9211,0.9183,0.9047,0.8995,0.8956,0.8816,0.8808,0.8753,0.8739,0.8645,0.8593,0.8579,0.8423,0.8335,0.8198,0.8007,0.7766,0.7637,0.7475,0.7459,0.7397,0.7375,0.7348,0.7288,0.7179,0.7166,0.7108,0.7099,0.7028,0.6969,0.6839,0.6665,0.6623,0.661,0.625,0.6064,0.5831,0.5732,0.5727,0.561,0.5301,0.519,0.5171,0.4996,0.4968,0.4833,0.478,0.4716,0.4655,0.4598,0.446,0.442,0.4366,0.435,0.4152,0.4096,0.3974,0.3906,0.3903,0.3808,0.3694,0.3662,0.363,0.3513,0.3465,0.3329,0.3276,0.324,0.3046,0.3036,0.2675,0.2626,0.2617]}}]}
</script><meta name="robots" content="noindex">
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.js" integrity="sha512-aoZChv+8imY/U1O7KIHXvO87EOzCuKO0GhFtpD6G2Cyjo/xPeTgdf3/bchB10iB+AojMTDkMHDPLKNxPJVqDcw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
<style>
  .panel-tabset .tab-content {
    border: 0;
    padding: 1em 0 0 0;
  }
  
  .panel-tabset .nav-item a {
    border-radius: 5px 5px 0 0;
  }
  
  .scientific_borders {
    border: 0;
    border-top: 2px solid black !important; 
    border-bottom: 2px solid black !important;
  }
  .table:not(.gt_table) > :not(caption)>*>* {
    border-bottom-width: 0;
  }
  .table:not(.gt_table) > thead {
    border-bottom: 1px solid black;
  }
  .soft-box-shadow {
    border: 1px solid rgba(233,236,239,.9) !important;
    border-radius: .5rem !important;
    background-color: rgba(250,250,250,.9) !important;
    box-shadow: 0px 1px 2px rgba(0,0,0,.1),
                0px 3px 7px rgba(0,0,0,.1),
                0px 12px 30px rgba(0,0,0,.08);
    margin-top: 2rem !important;
    margin-bottom: 2.5rem !important;
    padding: .25rem !important;
  }
  .obs-soft-box-shadow {
    border: 1px solid rgba(233,236,239,.9) !important;
    border-radius: .5rem !important;
    background-color: white !important;
    box-shadow: 0px 1px 2px rgba(0,0,0,.1),
                0px 3px 7px rgba(0,0,0,.1),
                0px 12px 30px rgba(0,0,0,.08);
    margin-top: 2rem !important;
    margin-bottom: 2.5rem !important;
    padding: .25rem !important;
  }
  
</style>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    
    var gt_tables = document.querySelectorAll(".gt_table");
    gt_tables.forEach(function(table) {
      table.classList.remove("table-striped");
    });
    
    var tables = document.querySelectorAll("table.table:not(.gt_table)");
    tables.forEach(function(table) {
      table.classList.remove("table-striped");
      table.classList.add("scientific_borders");
    });
    
    document.querySelectorAll("div.sourceCode").forEach(function(block) {
      block.classList.add("soft-box-shadow");
    });
    
    document.querySelectorAll("div.bg-white").forEach(function(block) {
      block.classList.remove("bg-white");
    });
    
const elements = document.querySelectorAll('[id^="qwebr-interactive-area"]');

    elements.forEach(element => {
        element.classList.add('box-shadow');
    });
    
    document.querySelectorAll('[id^="webr"]').forEach(function(block) {
      block.classList.add("box-shadow");
    });
    
        document.querySelectorAll('.card-header').forEach(function(block) {
      block.classList.add("box-shadow");
    });
    
  });
</script><style>
.qwebr-code-output-stdout {background-color: powderblue;}

.qwebr-button-run {
 width = 100%; 
}

.centered-caption {
   text-align: center;
}
</style>
<script src="https://cdn.jsdelivr.net/npm/quizdown@latest/public/build/quizdown.js"></script><script>quizdown.init();</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="custom_styles.css">
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Matching.html">Kausale Inferenz</a></li><li class="breadcrumb-item"><a href="./RDD.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Regression Discontiniuty Designs</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a><a href="./index.html">Kausalanalyse mit R</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Lesemodus umschalten">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Einleitung</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Grundlagen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_Einfuehrung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistische Programmierung mit R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reproduzierbarkeit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Simulation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Kausale Inferenz</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Matching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Matching</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedEffects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Panel-Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IV.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">IV-Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DiD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Difference-in-Differences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EventStudies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Event Studies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RDD.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Regression Discontiniuty Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SyntheticControl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Synthetic Control</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RegReg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Regularisierte Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Support Vector Machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./trees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Baum-basierte Methoden</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Machine Learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Neuronale Netzwerke</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Literatur.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatur</span></a>
  </div>
</li>
    </ul>
</div>
    <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title"><a href="./index.html">Übersicht</a></h2>
   
  <ul>
<li><a href="#sharp-regression-discontinuity-design" id="toc-sharp-regression-discontinuity-design" class="nav-link active" data-scroll-target="#sharp-regression-discontinuity-design"><span class="header-section-number">11.1</span> Sharp Regression Discontinuity Design</a></li>
  <li>
<a href="#manipulation-am-schwellenwert" id="toc-manipulation-am-schwellenwert" class="nav-link" data-scroll-target="#manipulation-am-schwellenwert"><span class="header-section-number">11.2</span> Manipulation am Schwellenwert</a>
  <ul>
<li><a href="#case-study-amtsinhaber-vorteil-lee2008" id="toc-case-study-amtsinhaber-vorteil-lee2008" class="nav-link" data-scroll-target="#case-study-amtsinhaber-vorteil-lee2008"><span class="header-section-number">11.2.1</span> Case Study: Amtsinhaber-Vorteil <span class="citation" data-cites="Lee2008">(Lee 2008)</span></a></li>
  </ul>
</li>
  <li><a href="#fuzzy-regression-discontinuity-design" id="toc-fuzzy-regression-discontinuity-design" class="nav-link" data-scroll-target="#fuzzy-regression-discontinuity-design"><span class="header-section-number">11.3</span> Fuzzy Regression Discontinuity Design</a></li>
  <li>
<a href="#case-study-protestantische-arbeitsethik" id="toc-case-study-protestantische-arbeitsethik" class="nav-link" data-scroll-target="#case-study-protestantische-arbeitsethik"><span class="header-section-number">11.4</span> Case Study: Protestantische Arbeitsethik</a>
  <ul>
<li><a href="#aufbereitung-der-daten" id="toc-aufbereitung-der-daten" class="nav-link" data-scroll-target="#aufbereitung-der-daten"><span class="header-section-number">11.4.1</span> Aufbereitung der Daten</a></li>
  <li><a href="#deskriptive-statistiken" id="toc-deskriptive-statistiken" class="nav-link" data-scroll-target="#deskriptive-statistiken"><span class="header-section-number">11.4.2</span> Deskriptive Statistiken</a></li>
  <li><a href="#modellspezifikation-und-first-stage-ergebnisse" id="toc-modellspezifikation-und-first-stage-ergebnisse" class="nav-link" data-scroll-target="#modellspezifikation-und-first-stage-ergebnisse"><span class="header-section-number">11.4.3</span> Modellspezifikation und First-Stage-Ergebnisse</a></li>
  <li><a href="#second-stage-ergebnisse" id="toc-second-stage-ergebnisse" class="nav-link" data-scroll-target="#second-stage-ergebnisse"><span class="header-section-number">11.4.4</span> Second-Stage-Ergebnisse</a></li>
  <li><a href="#addendum-frdd-sch%C3%A4tzung-mit-rdrobust" id="toc-addendum-frdd-schätzung-mit-rdrobust" class="nav-link" data-scroll-target="#addendum-frdd-sch%C3%A4tzung-mit-rdrobust"><span class="header-section-number">11.4.5</span> Addendum: FRDD-Schätzung mit <code>rdrobust()</code></a></li>
  </ul>
</li>
  </ul></nav>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Matching.html">Kausale Inferenz</a></li><li class="breadcrumb-item"><a href="./RDD.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Regression Discontiniuty Designs</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Regression Discontiniuty Designs</span>
</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>Regression Discontinuity Design (RDD) ist ein Ansatz für die Schätzung von Behandlungseffekten mit Regression, wenn durch einen experimentell oder natürlich gegebenen Umstand die Behandlung an einem Schwellenwert (<span class="math inline">\(c\)</span>) einer <em>Laufvariable</em> (<span class="math inline">\(X\)</span>) sprunghaft beeinflusst wird. Ein RDD-Schätzer wird so implementiert, dass lediglich Beobachtungen mit Ausprägungen von <span class="math inline">\(X\)</span>, die knapp ober- oder knapp unterhalb von <span class="math inline">\(c\)</span> liegen, berücksichtigt werden. Die zentrale Idee hierbei ist, dass Individuen nahe bei <span class="math inline">\(c\)</span> im Durchschnitt ähnliche Merkmale aufweisen. Beobachtungen nahe <span class="math inline">\(c\)</span> sind dann insbesondere hinsichtlich potentieller Backdoor-Variablen vergleichbar, sodass deren problematische Pfade geschlossen sind. Das kausale Diagram in <a href="#fig-CDRDD" class="quarto-xref">Abbildung&nbsp;<span>11.1</span></a> zeigt den grundsätzlichen Zusammenhang.</p>
<div class="cell page-columns page-full" data-fig-width="5" data-fig-height="3" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-CDRDD" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-CDRDD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<svg width="480" height="288" viewbox="0.00 0.00 361.90 188.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 184)"><title>Causal Diagramm RDD</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-184 357.9,-184 357.9,4 -4,4"></polygon><!-- X --><g id="node1" class="node"><title>X</title>
<text text-anchor="middle" x="38.9" y="-157.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">X</text></g><!-- Y --><g id="node2" class="node"><title>Y</title>
<text text-anchor="middle" x="326.9" y="-13.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Y</text></g><!-- X&#45;&gt;Y --><g id="edge1" class="edge"><title>X-&gt;Y</title>
<path fill="none" stroke="black" d="M66,-148.45C117.99,-122.45 231.8,-65.55 290.41,-36.24"></path><polygon fill="black" stroke="black" points="292.29,-39.22 299.67,-31.62 289.16,-32.96 292.29,-39.22"></polygon></g><!-- Oberhalb c --><g id="node3" class="node"><title>Oberhalb c</title>
<text text-anchor="middle" x="38.9" y="-13.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Oberhalb c</text></g><!-- X&#45;&gt;Oberhalb c --><g id="edge4" class="edge"><title>X-&gt;Oberhalb c</title>
<path fill="none" stroke="black" d="M38.9,-143.76C38.9,-119.2 38.9,-75.25 38.9,-46.35"></path><polygon fill="black" stroke="black" points="42.4,-46.09 38.9,-36.09 35.4,-46.09 42.4,-46.09"></polygon></g><!-- Behandlung B --><g id="node5" class="node"><title>Behandlung B</title>
<text text-anchor="middle" x="182.9" y="-13.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Behandlung B</text></g><!-- Oberhalb c&#45;&gt;Behandlung B --><g id="edge5" class="edge"><title>Oberhalb c-&gt;Behandlung B</title>
<path fill="none" stroke="black" d="M77.87,-18C92.22,-18 108.8,-18 124.49,-18"></path><polygon fill="black" stroke="black" points="124.64,-21.5 134.64,-18 124.64,-14.5 124.64,-21.5"></polygon></g><!-- Z --><g id="node4" class="node"><title>Z</title>
<text text-anchor="middle" x="326.9" y="-157.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Z</text></g><!-- Z&#45;&gt;X --><g id="edge2" class="edge"><title>Z-&gt;X</title>
<path fill="none" stroke="black" d="M299.81,-162C248.13,-162 135.41,-162 76.48,-162"></path><polygon fill="black" stroke="black" points="76.13,-158.5 66.13,-162 76.13,-165.5 76.13,-158.5"></polygon></g><!-- Z&#45;&gt;Y --><g id="edge3" class="edge"><title>Z-&gt;Y</title>
<path fill="none" stroke="black" d="M326.9,-143.76C326.9,-119.2 326.9,-75.25 326.9,-46.35"></path><polygon fill="black" stroke="black" points="330.4,-46.09 326.9,-36.09 323.4,-46.09 330.4,-46.09"></polygon></g><!-- Behandlung B&#45;&gt;Y --><g id="edge6" class="edge"><title>Behandlung B-&gt;Y</title>
<path fill="none" stroke="black" d="M231.25,-18C250.38,-18 272.01,-18 289.85,-18"></path><polygon fill="black" stroke="black" points="289.87,-21.5 299.87,-18 289.87,-14.5 289.87,-21.5"></polygon></g></g></svg>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-CDRDD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;11.1: Kausales Diagramm für Sharp RDD
</figcaption></figure>
</div>
</div>
</div>
<p>RDD isoliert Variation auf dem Pfad <em>Oberhalb C → Behandlung B → Y</em>. Somit können Backdoor-Pfade über <span class="math inline">\(X\)</span> oder weitere (möglichweise unbeobachtbare) Confounder (<span class="math inline">\(Z\)</span>) vermieden werden, siehe <a href="#fig-CDRDD" class="quarto-xref">Abbildung&nbsp;<span>11.1</span></a>. Der kausale Effekt wird dabei als (lokaler) durchschnittlicher Behandlungseffekt der Diskontinuität auf die Outcome-Variable (<span class="math inline">\(Y\)</span>) anhand von Beobachtungen <em>nahe bei c</em> ermittelt.</p>
<p>Hinsichtlich der Beeinflussung der Behandlung unterscheiden wir zwischen <em>Sharp</em> und <em>Fuzzy</em> Regression Discontinuity Designs (SRDD/FRDD). Bei einem SRDD ist die Zuweisung der Behandlung <em>deterministisch</em>, d.h. der Schwellenwert in der Laufvariable ist eine harte Grenze für die Gruppenzugehörigkeit: Die <em>Wahrscheinlichkeit</em> der Behandlung <span class="math inline">\(p\)</span> springt bei <span class="math inline">\(X=c\)</span> von <span class="math inline">\(p=0\)</span> um <span class="math inline">\(\Delta p = 1\)</span> auf <span class="math inline">\(p=1\)</span>.</p>
<p>Bei einem FRDD ist die Zuordnung in Behandlungs- und Kontrollgruppe nicht perfekt durch den Schwellenwert <span class="math inline">\(c\)</span> bestimmt: Die Behandlungswahrscheinlichkeit <span class="math inline">\(p\)</span> springt bei <span class="math inline">\(X=c\)</span> um <span class="math inline">\(\Delta p&lt;1\)</span>. Im FRDD können grundsätzlich also sowohl behandelte Subjekte als auch Kontroll-Beobachtungen auf beiden Seiten der Diskontinuität vorliegen – die Trennung der Gruppen ist “unscharf”<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Dieser Umstand ist oft in empirischen Studien mit nicht-experimentellen Daten gegeben, wenn es neben der Überschreitung von <span class="math inline">\(c\)</span> weitere Determinanten der Behandlung gibt (für die wir nicht kontrollieren können). Die Wahl zwischen SRDD und FRDD hängt grundsätzlich vom datenerzeugenden Prozess und der Forschungsfrage ab.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;Engl. <em>fuzzy</em>.</p></div></div><section id="sharp-regression-discontinuity-design" class="level2 page-columns page-full" data-number="11.1"><h2 data-number="11.1" class="anchored" data-anchor-id="sharp-regression-discontinuity-design">
<span class="header-section-number">11.1</span> Sharp Regression Discontinuity Design</h2>
<p><strong>Modell und funktionale Form</strong></p>
<p>Die korrekte Spezifikation der funktionalen Form für ein RDD ist wichtig, um eine verzerrte Schätzung des Effekts zu vermeiden. Die einfachste Form eines SRDD kann anhand der linearen Regression <span class="math display">\[\begin{align}
Y_i = \beta_0 + \beta_1 B_i + \beta_2 X_i + u_i\label{eq-simpleSRDD}
\end{align}\]</span> geschätzt werden, wobei <span class="math inline">\(B_i\)</span> eine Dummy-Variable für das Überschreiten des Schwellenwertes <span class="math inline">\(c\)</span> ist, d.h. <span class="math display">\[\begin{align*}
  B_i=\begin{cases}
    0 &amp; X_i &lt; c\\
    1 &amp; X_i \geq c.
  \end{cases}
\end{align*}\]</span> Damit ist <span class="math inline">\(B_i\)</span> eine <em>deterministische</em> Funktion der Laufvariable <span class="math inline">\(X_i\)</span> und zeigt die Zugehörigkeit zur Behandlungs- oder Treatmentgruppe an. Der Koeffizient <span class="math inline">\(\beta_1\)</span> misst den Behandlungseffekt.</p>
<p>Das Modell <span class="math inline">\(\eqref{eq-simpleSRDD}\)</span> unterstellt, dass <span class="math inline">\(X\)</span> links- und rechtsseitig von <span class="math inline">\(c\)</span> denselben Effekt auf <span class="math inline">\(Y\)</span> hat. Diese Annahme ist restriktiv. Eine Alternative ist ein lineares Interaktionsmodell <span class="math display">\[\begin{align}
Y_i = \beta_0 + \beta_1 B_i + \beta_2 (X_i - c) + \beta_3(X_i - c)\times B_i + u_i.\label{eq:linearSRDD}
\end{align}\]</span> Das Modell <span class="math inline">\(\eqref{eq:linearSRDD}\)</span> kann unterschiedliche lineare Effekte von <span class="math inline">\(X\)</span> auf <span class="math inline">\(Y\)</span> unterhalb (<span class="math inline">\(\beta_2\)</span>) und oberhalb (<span class="math inline">\(\beta_2 + \beta_3\)</span>) von <span class="math inline">\(c\)</span> abbilden. Beachte, dass <span class="math inline">\((X_i - c)\)</span> die um den Schwellenwert zentrierte Laufvariable ist, sodass <span class="math inline">\(\beta_1\)</span> wie in <span class="math inline">\(\eqref{eq-simpleSRDD}\)</span> den Unterschied des Effekts von <span class="math inline">\(X\)</span> auf <span class="math inline">\(Y\)</span> für Beoabachtungen am Schwellenwert erfasst.</p>
<p>Um unterschiedliche nicht-lineare Zusammenhänge von <span class="math inline">\(X\)</span> und <span class="math inline">\(Y\)</span> unterhalb und oberhalb von <span class="math inline">\(c\)</span> abzubilden, können (interargierte) Polynom-Terme in <span class="math inline">\(X\)</span> verwendet werden. Häufig wird eine quadratische Regressionsfunktion genutzt, <span class="math display">\[\begin{align}
  Y_i =&amp;\, \beta_0 + \beta_1 B_i + \beta_2 (X_i - c) + \beta_3 (X_i - c)^2\\
       &amp;+\, \beta_4(X_i - c)\times B_i + \beta_5(X_i - c)\times B_i + u_i.\label{eq:quadSRDD}
\end{align}\]</span> <span class="citation" data-cites="GelmanImbens2019">Gelman und Imbens (<a href="Literatur.html#ref-GelmanImbens2019" role="doc-biblioref">2019</a>)</span> zeigen, dass Polynome höherer Ordnung zu verzerrten Schätzern und hoher Varianz führen können.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> Die Authoren empfehlen stattdessen die Schätzung mit lokaler Regression.</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;Ursachen sind Überanpassung an die Daten sowie instabiles Verhalten der Schätzung nahe des Schwellenwertes.</p></div></div><p><strong>Nicht-parametrische Schätzung und Bandweite</strong></p>
<p>Aktuelle Studien nutzen nicht-parametrische Schätzer, die den Behandlungseffekt als Differenz der geschätzten Regressionsfunktionen am Schwellenwert <span class="math inline">\(c\)</span> berechnen. Um auch nicht-lineare Regressionsfunktionen abzubilden zu können, wird häufig lokale Regression verwendet. Dieses Verfahren liefert eine “lokale” Schätzung der Regressionsfunktionen am Schwellenwert, bei der nur Beobachtungen nahe <span class="math inline">\(X = c\)</span> für die Schätzung berücksichtigt werden. Hinreichende Nähe wird hierbei durch eine sogenannte Bandweite <span class="math inline">\(h\)</span> festgelegt, wobei <span class="math display">\[\begin{align}
  \lvert(X_i-c)\rvert\leq h \label{eq:bwc}
\end{align}\]</span> das Kriterium für eine Berücksichtigung von Beobachtung <span class="math inline">\(i\)</span> bei der Schätzung ist.</p>
<p>Unter Verwendung einer Bandweite <span class="math inline">\(h\)</span> wird der Regressionsansatz <span class="math inline">\(\eqref{eq:linearSRDD}\)</span> als <em>lokale lineare Regression</em> mit Uniform-Kernelfunktion bezeichnet. Der Uniform-Kernel gibt allen Beobachtungen, innerhalb der Bandweite <span class="math inline">\(h\)</span> dasselbe Gewicht. Ist <span class="math inline">\(h\)</span> so groß, dass der gesamte Datensatz in die Schätzung einbezogen wird, entspricht der lokale lineare Regressions-Schätzer mit Uniform-Kernel dem (globalen) KQ-Schätzer in einem linearen Interaktionsmodell anhand aller Beobachtungen. Neben dem Uniform-Kernel ist der Triangular-Kernel eine in der Praxis häufig genutzte lineare Kernelfunktion. Der nachstehende Code plottet die Uniform- (grün) sowie die Triangular-Kernelfunktion (blau), siehe <a href="#fig-linearkern" class="quarto-xref">Abbildung&nbsp;<span>11.2</span></a>.</p>
<div class="cell page-columns page-full">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Kernelfunktionen zeichnen</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span></span>
<span>      fun <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span></span>
<span>        test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">1</span>,</span>
<span>        yes <span class="op">=</span>  <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, </span>
<span>        no <span class="op">=</span> <span class="fl">0</span></span>
<span>      <span class="op">)</span>, </span>
<span>      col <span class="op">=</span> <span class="st">"green"</span>, </span>
<span>      n <span class="op">=</span> <span class="fl">1000</span></span>
<span>      <span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span></span>
<span>      fun <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span></span>
<span>        test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">1</span>, </span>
<span>        yes <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, </span>
<span>        no <span class="op">=</span> <span class="fl">0</span></span>
<span>      <span class="op">)</span>, </span>
<span>      col <span class="op">=</span> <span class="st">"blue"</span>, </span>
<span>      n <span class="op">=</span> <span class="fl">100</span></span>
<span>      <span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="st">"x"</span>, </span>
<span>      limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span><span class="op">)</span>, </span>
<span>      breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="st">"K(x)"</span>, </span>
<span>      breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>      limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.25</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display page-columns page-full">
<div id="fig-linearkern" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-linearkern-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="RDD_files/figure-html/fig-linearkern-1.png" class="img-fluid figure-img" width="384">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-linearkern-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;11.2: Kernelfunktionen auf [-1, 1]
</figcaption></figure>
</div>
</div>
</div>
<p>In empirischen Studien wird als Basis-Spezifikation oft eine lokale lineare Regression anhand von <span class="math inline">\(\eqref{eq:linearSRDD}\)</span> mit einer linearen Kernelfunktionen und geringer bandweite <span class="math inline">\(h\)</span> genutzt. Anschließend wird die Robustheit der Ergebnisse anhand flexiblerer Spezifikationen, die Nicht-Linearitäten in der Regressionsfunktion besser abbilden können, geprüft.</p>
<p>Die nachstehende Visualisierung zeigt die Schätzung des kausalen Effektes der Behandlung <span class="math inline">\(B_i\)</span> anhand lokaler linearer Regression mit einem Uniform-Kernel für wiefolgt simulierte Daten: <span class="math display">\[\begin{align*}
  Y_i =&amp;\, \beta_1 X_i + \beta_2 B + \beta_3 X_i^2 \times B_i + u_i,\\
  \\
  u_i \sim&amp;\, N(0, 0.5), \quad X_i \sim U(0, 10), \quad B = \mathbb{I}(X_i \geq c = 5)\\
  \beta_1 =&amp;\, .5, \quad \beta_2 = 1.5, \quad \beta_3 = -0.15
\end{align*}\]</span></p>
<p>Diese Vorschrift ist schnell mit R umgesetzt:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="co"># Anz.Beobachtungen</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">750</span></span>
<span></span>
<span><span class="co"># Parameter definieren</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">beta_1</span> <span class="op">&lt;-</span> <span class="fl">.5</span></span>
<span><span class="va">beta_2</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">beta_3</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">.15</span></span>
<span></span>
<span><span class="co"># Regressionsfunktion definieren</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">beta_1</span> <span class="op">*</span> <span class="op">(</span><span class="va">X</span> <span class="op">-</span> <span class="va">c</span><span class="op">)</span> <span class="op">+</span> <span class="va">beta_2</span> <span class="op">*</span> <span class="va">B</span> <span class="op">+</span> <span class="va">beta_3</span> <span class="op">*</span> <span class="va">B</span> <span class="op">*</span> <span class="op">(</span><span class="va">X</span> <span class="op">-</span> <span class="va">c</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Daten erzeugen</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">11</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">X</span> <span class="op">-</span> <span class="va">c</span> <span class="op">&gt;=</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Beoabchtungen sammeln</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Y <span class="op">=</span> <span class="va">Y</span>, X <span class="op">=</span> <span class="va">X</span> <span class="op">-</span> <span class="va">c</span>, B <span class="op">=</span> <span class="va">B</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="311" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 310;"><span id="cb3-311"><a href="#cb3-311" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb3-312"><a href="#cb3-312" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;style&gt;</span></span>
<span id="cb3-313"><a href="#cb3-313" aria-hidden="true" tabindex="-1"></a><span class="vs">.regression {</span></span>
<span id="cb3-314"><a href="#cb3-314" aria-hidden="true" tabindex="-1"></a><span class="vs">  fill: none;</span></span>
<span id="cb3-315"><a href="#cb3-315" aria-hidden="true" tabindex="-1"></a><span class="vs">  stroke: #000;</span></span>
<span id="cb3-316"><a href="#cb3-316" aria-hidden="true" tabindex="-1"></a><span class="vs">  stroke-width: 1.5px;</span></span>
<span id="cb3-317"><a href="#cb3-317" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb3-318"><a href="#cb3-318" aria-hidden="true" tabindex="-1"></a><span class="vs">.axis line {</span></span>
<span id="cb3-319"><a href="#cb3-319" aria-hidden="true" tabindex="-1"></a><span class="vs">  stroke: #ddd;</span></span>
<span id="cb3-320"><a href="#cb3-320" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb3-321"><a href="#cb3-321" aria-hidden="true" tabindex="-1"></a><span class="vs">.axis .baseline line {</span></span>
<span id="cb3-322"><a href="#cb3-322" aria-hidden="true" tabindex="-1"></a><span class="vs">  stroke: #555;</span></span>
<span id="cb3-323"><a href="#cb3-323" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb3-324"><a href="#cb3-324" aria-hidden="true" tabindex="-1"></a><span class="vs">.axis .domain {</span></span>
<span id="cb3-325"><a href="#cb3-325" aria-hidden="true" tabindex="-1"></a><span class="vs">  display: none;</span></span>
<span id="cb3-326"><a href="#cb3-326" aria-hidden="true" tabindex="-1"></a><span class="vs">} </span></span>
<span id="cb3-327"><a href="#cb3-327" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;</span></span>
<span id="cb3-328"><a href="#cb3-328" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css"&gt;</span></span>
<span id="cb3-329"><a href="#cb3-329" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="330" data-source-offset="-300"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 329;"><span id="cb4-330"><a href="#cb4-330" aria-hidden="true" tabindex="-1"></a>d3 <span class="op">=</span> <span class="pp">require</span>(<span class="st">"d3-array@3"</span><span class="op">,</span> <span class="st">"d3-axis@3"</span><span class="op">,</span> <span class="st">"d3-regression@1"</span><span class="op">,</span> <span class="st">"d3-scale@4"</span><span class="op">,</span> <span class="st">"d3-shape@3"</span><span class="op">,</span> <span class="st">"d3-selection@3"</span><span class="op">,</span> <span class="st">"d3-format"</span>)</span>
<span id="cb4-331"><a href="#cb4-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-332"><a href="#cb4-332" aria-hidden="true" tabindex="-1"></a>margin <span class="op">=</span> ({<span class="dt">left</span><span class="op">:</span> <span class="dv">55</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span> <span class="dt">top</span><span class="op">:</span> <span class="dv">13</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">24</span>})<span class="op">;</span></span>
<span id="cb4-333"><a href="#cb4-333" aria-hidden="true" tabindex="-1"></a>base <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(width<span class="op">,</span> <span class="dv">500</span>)<span class="op">;</span></span>
<span id="cb4-334"><a href="#cb4-334" aria-hidden="true" tabindex="-1"></a>innerWidth <span class="op">=</span> base <span class="op">-</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span><span class="op">;</span></span>
<span id="cb4-335"><a href="#cb4-335" aria-hidden="true" tabindex="-1"></a>innerHeight <span class="op">=</span> base<span class="op">-</span><span class="dv">100</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">;</span></span>
<span id="cb4-336"><a href="#cb4-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-337"><a href="#cb4-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-338"><a href="#cb4-338" aria-hidden="true" tabindex="-1"></a>viewof bw_daten_LLRU <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">.</span><span class="dv">1</span><span class="op">,</span> <span class="dv">6</span>]<span class="op">,</span> {</span>
<span id="cb4-339"><a href="#cb4-339" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Bandweite (h)"</span><span class="op">,</span></span>
<span id="cb4-340"><a href="#cb4-340" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="op">.</span><span class="dv">1</span><span class="op">,</span></span>
<span id="cb4-341"><a href="#cb4-341" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="fl">1.3</span></span>
<span id="cb4-342"><a href="#cb4-342" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb4-343"><a href="#cb4-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-344"><a href="#cb4-344" aria-hidden="true" tabindex="-1"></a>xScaleLLRU <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb4-345"><a href="#cb4-345" aria-hidden="true" tabindex="-1"></a>   <span class="op">.</span><span class="fu">domain</span>([<span class="op">-</span><span class="dv">6</span><span class="op">,</span> <span class="dv">6</span>])</span>
<span id="cb4-346"><a href="#cb4-346" aria-hidden="true" tabindex="-1"></a>   <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> innerWidth])<span class="op">;</span></span>
<span id="cb4-347"><a href="#cb4-347" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb4-348"><a href="#cb4-348" aria-hidden="true" tabindex="-1"></a>yScaleLLRU <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb4-349"><a href="#cb4-349" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">domain</span>([<span class="op">-</span><span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>])</span>
<span id="cb4-350"><a href="#cb4-350" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">range</span>([innerHeight<span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb4-351"><a href="#cb4-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-352"><a href="#cb4-352" aria-hidden="true" tabindex="-1"></a>lineLLRU <span class="op">=</span> d3<span class="op">.</span><span class="fu">line</span>()</span>
<span id="cb4-353"><a href="#cb4-353" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">x</span>(d <span class="kw">=&gt;</span> <span class="fu">xScaleLLRU</span>(d[<span class="dv">0</span>]))</span>
<span id="cb4-354"><a href="#cb4-354" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">y</span>(d <span class="kw">=&gt;</span> <span class="fu">yScaleLLRU</span>(d[<span class="dv">1</span>]))<span class="op">;</span></span>
<span id="cb4-355"><a href="#cb4-355" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-356"><a href="#cb4-356" aria-hidden="true" tabindex="-1"></a>xAxisLLRU <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisBottom</span>(xScaleLLRU)</span>
<span id="cb4-357"><a href="#cb4-357" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">tickSize</span>(innerHeight <span class="op">+</span> <span class="dv">10</span>)</span>
<span id="cb4-358"><a href="#cb4-358" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">tickValues</span>([<span class="op">-</span><span class="dv">6</span><span class="op">,</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span> <span class="op">-</span><span class="dv">2</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>])</span>
<span id="cb4-359"><a href="#cb4-359" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">tickFormat</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb4-360"><a href="#cb4-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-361"><a href="#cb4-361" aria-hidden="true" tabindex="-1"></a>yAxisLLRU <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisLeft</span>(yScaleLLRU)</span>
<span id="cb4-362"><a href="#cb4-362" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">tickSize</span>(innerWidth <span class="op">+</span> <span class="dv">10</span>)</span>
<span id="cb4-363"><a href="#cb4-363" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">tickFormat</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb4-364"><a href="#cb4-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-365"><a href="#cb4-365" aria-hidden="true" tabindex="-1"></a>LLRURegression <span class="op">=</span> d3<span class="op">.</span><span class="fu">regressionLinear</span>()</span>
<span id="cb4-366"><a href="#cb4-366" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">x</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">X</span>)</span>
<span id="cb4-367"><a href="#cb4-367" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">y</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Y</span>)<span class="op">;</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-13" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="373" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 372;"><span id="cb5-373"><a href="#cb5-373" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb5-374"><a href="#cb5-374" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(DOM<span class="op">.</span><span class="fu">svg</span>(innerWidth <span class="op">+</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">right</span> <span class="op">+</span> <span class="dv">20</span><span class="op">,</span> innerHeight <span class="op">+</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">+</span> <span class="dv">20</span>))</span>
<span id="cb5-375"><a href="#cb5-375" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-376"><a href="#cb5-376" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> g <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb5-377"><a href="#cb5-377" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>margin<span class="op">.</span><span class="at">top</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb5-378"><a href="#cb5-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-379"><a href="#cb5-379" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb5-380"><a href="#cb5-380" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"axis"</span>)</span>
<span id="cb5-381"><a href="#cb5-381" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(xAxisLLRU)<span class="op">;</span></span>
<span id="cb5-382"><a href="#cb5-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-383"><a href="#cb5-383" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb5-384"><a href="#cb5-384" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"axis"</span>)</span>
<span id="cb5-385"><a href="#cb5-385" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>innerWidth<span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb5-386"><a href="#cb5-386" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(yAxisLLRU)<span class="op">;</span></span>
<span id="cb5-387"><a href="#cb5-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-388"><a href="#cb5-388" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add X axis label:</span></span>
<span id="cb5-389"><a href="#cb5-389" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb5-390"><a href="#cb5-390" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"end"</span>)</span>
<span id="cb5-391"><a href="#cb5-391" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">13</span>)</span>
<span id="cb5-392"><a href="#cb5-392" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> innerWidth)</span>
<span id="cb5-393"><a href="#cb5-393" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> innerHeight <span class="op">+</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> <span class="dv">25</span>)</span>
<span id="cb5-394"><a href="#cb5-394" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"X - c"</span>)<span class="op">;</span></span>
<span id="cb5-395"><a href="#cb5-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-396"><a href="#cb5-396" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Y axis label:</span></span>
<span id="cb5-397"><a href="#cb5-397" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb5-398"><a href="#cb5-398" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"end"</span>)</span>
<span id="cb5-399"><a href="#cb5-399" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"rotate(-90)"</span>)</span>
<span id="cb5-400"><a href="#cb5-400" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">13</span>)</span>
<span id="cb5-401"><a href="#cb5-401" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="op">-</span>margin<span class="op">.</span><span class="at">left</span><span class="op">+</span><span class="dv">10</span>)</span>
<span id="cb5-402"><a href="#cb5-402" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="op">-</span>margin<span class="op">.</span><span class="at">top</span><span class="op">+</span><span class="dv">10</span>)</span>
<span id="cb5-403"><a href="#cb5-403" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Y"</span>)<span class="op">;</span></span>
<span id="cb5-404"><a href="#cb5-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-405"><a href="#cb5-405" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"circle"</span>)</span>
<span id="cb5-406"><a href="#cb5-406" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(<span class="fu">transpose</span>(SRDD))</span>
<span id="cb5-407"><a href="#cb5-407" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()<span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb5-408"><a href="#cb5-408" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb5-409"><a href="#cb5-409" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">xScaleLLRU</span>(d<span class="op">.</span><span class="at">X</span>))</span>
<span id="cb5-410"><a href="#cb5-410" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">yScaleLLRU</span>(d<span class="op">.</span><span class="at">Y</span>))<span class="op">;</span></span>
<span id="cb5-411"><a href="#cb5-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-412"><a href="#cb5-412" aria-hidden="true" tabindex="-1"></a>g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"circle"</span>)</span>
<span id="cb5-413"><a href="#cb5-413" aria-hidden="true" tabindex="-1"></a> <span class="op">.</span><span class="fu">filter</span>( <span class="kw">function</span>(d){ <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(d<span class="op">.</span><span class="at">X</span>) <span class="op">&lt;=</span> bw_daten_LLRU } )</span>
<span id="cb5-414"><a href="#cb5-414" aria-hidden="true" tabindex="-1"></a> <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"orange"</span>)</span>
<span id="cb5-415"><a href="#cb5-415" aria-hidden="true" tabindex="-1"></a> <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb5-416"><a href="#cb5-416" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb5-417"><a href="#cb5-417" aria-hidden="true" tabindex="-1"></a>  <span class="op">&lt;!--</span> trf <span class="op">--&gt;</span></span>
<span id="cb5-418"><a href="#cb5-418" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span>  line <span class="op">=</span> d3<span class="op">.</span><span class="fu">line</span>()</span>
<span id="cb5-419"><a href="#cb5-419" aria-hidden="true" tabindex="-1"></a>           <span class="op">.</span><span class="fu">x</span>(<span class="kw">function</span>(d) { <span class="cf">return</span> <span class="fu">xScaleLLRU</span>(d<span class="op">.</span><span class="at">X</span>)<span class="op">;</span> }) </span>
<span id="cb5-420"><a href="#cb5-420" aria-hidden="true" tabindex="-1"></a>           <span class="op">.</span><span class="fu">y</span>(<span class="kw">function</span>(d) { <span class="cf">return</span> <span class="fu">yScaleLLRU</span>(d<span class="op">.</span><span class="at">Y_true</span>)<span class="op">;</span> }) </span>
<span id="cb5-421"><a href="#cb5-421" aria-hidden="true" tabindex="-1"></a>           <span class="op">.</span><span class="fu">curve</span>(d3<span class="op">.</span><span class="at">curveLinear</span>)<span class="op">;</span> </span>
<span id="cb5-422"><a href="#cb5-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-423"><a href="#cb5-423" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb5-424"><a href="#cb5-424" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">datum</span>(<span class="fu">transpose</span>(SRDD))</span>
<span id="cb5-425"><a href="#cb5-425" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> line)</span>
<span id="cb5-426"><a href="#cb5-426" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb5-427"><a href="#cb5-427" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"red"</span>)</span>
<span id="cb5-428"><a href="#cb5-428" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb5-429"><a href="#cb5-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-430"><a href="#cb5-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-431"><a href="#cb5-431" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">b</span>(d) { <span class="cf">return</span> <span class="fu">LLRURegression</span>(</span>
<span id="cb5-432"><a href="#cb5-432" aria-hidden="true" tabindex="-1"></a>        <span class="fu">transpose</span>(SRDD)<span class="op">.</span><span class="fu">filter</span>(<span class="kw">function</span>(d){ <span class="cf">return</span> d<span class="op">.</span><span class="at">X</span> <span class="op">&lt;=</span> <span class="dv">0</span> <span class="op">&amp;</span> d<span class="op">.</span><span class="at">X</span> <span class="op">&gt;=</span> <span class="op">-</span>bw_daten_LLRU })</span>
<span id="cb5-433"><a href="#cb5-433" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span> }</span>
<span id="cb5-434"><a href="#cb5-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-435"><a href="#cb5-435" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">a</span>(d) { <span class="cf">return</span> <span class="fu">LLRURegression</span>(</span>
<span id="cb5-436"><a href="#cb5-436" aria-hidden="true" tabindex="-1"></a>      <span class="fu">transpose</span>(SRDD)<span class="op">.</span><span class="fu">filter</span>(<span class="kw">function</span>(d){ <span class="cf">return</span> d<span class="op">.</span><span class="at">X</span> <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">&amp;</span> d<span class="op">.</span><span class="at">X</span> <span class="op">&lt;=</span> bw_daten_LLRU })</span>
<span id="cb5-437"><a href="#cb5-437" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span> }</span>
<span id="cb5-438"><a href="#cb5-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-439"><a href="#cb5-439" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb5-440"><a href="#cb5-440" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"regression"</span>)</span>
<span id="cb5-441"><a href="#cb5-441" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">datum</span>(b)</span>
<span id="cb5-442"><a href="#cb5-442" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> lineLLRU)</span>
<span id="cb5-443"><a href="#cb5-443" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb5-444"><a href="#cb5-444" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#39FF14"</span>)<span class="op">;</span></span>
<span id="cb5-445"><a href="#cb5-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-446"><a href="#cb5-446" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb5-447"><a href="#cb5-447" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"regression"</span>)</span>
<span id="cb5-448"><a href="#cb5-448" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">datum</span>(a)</span>
<span id="cb5-449"><a href="#cb5-449" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> lineLLRU)</span>
<span id="cb5-450"><a href="#cb5-450" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb5-451"><a href="#cb5-451" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#39FF14"</span>)<span class="op">;</span></span>
<span id="cb5-452"><a href="#cb5-452" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-453"><a href="#cb5-453" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb5-454"><a href="#cb5-454" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="fu">xScaleLLRU</span>(<span class="dv">0</span>))</span>
<span id="cb5-455"><a href="#cb5-455" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="fu">yScaleLLRU</span>((<span class="fu">b</span>()<span class="op">.</span><span class="fu">slice</span>(<span class="op">-</span><span class="dv">1</span>))[<span class="dv">0</span>][<span class="dv">1</span>]))</span>
<span id="cb5-456"><a href="#cb5-456" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="fu">xScaleLLRU</span>(<span class="dv">0</span>))</span>
<span id="cb5-457"><a href="#cb5-457" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="fu">yScaleLLRU</span>((<span class="fu">a</span>()<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span>))[<span class="dv">0</span>][<span class="dv">1</span>]))</span>
<span id="cb5-458"><a href="#cb5-458" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#39FF14"</span>)</span>
<span id="cb5-459"><a href="#cb5-459" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb5-460"><a href="#cb5-460" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-461"><a href="#cb5-461" aria-hidden="true" tabindex="-1"></a>   g<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb5-462"><a href="#cb5-462" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">xScaleLLRU</span>(<span class="op">-</span><span class="fl">2.75</span>))</span>
<span id="cb5-463"><a href="#cb5-463" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">yScaleLLRU</span>(<span class="fl">4.5</span>))</span>
<span id="cb5-464"><a href="#cb5-464" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">".35em"</span>)</span>
<span id="cb5-465"><a href="#cb5-465" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#39FF14"</span>)</span>
<span id="cb5-466"><a href="#cb5-466" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(</span>
<span id="cb5-467"><a href="#cb5-467" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">format</span>(<span class="st">",.2f"</span>)( (<span class="fu">a</span>()<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span>))[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">-</span> (<span class="fu">b</span>()<span class="op">.</span><span class="fu">slice</span>(<span class="op">-</span><span class="dv">1</span>))[<span class="dv">0</span>][<span class="dv">1</span>] ) </span>
<span id="cb5-468"><a href="#cb5-468" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb5-469"><a href="#cb5-469" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-470"><a href="#cb5-470" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* dashed line data bw upper */</span></span>
<span id="cb5-471"><a href="#cb5-471" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb5-472"><a href="#cb5-472" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="fu">xScaleLLRU</span>(bw_daten_LLRU))</span>
<span id="cb5-473"><a href="#cb5-473" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb5-474"><a href="#cb5-474" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="fu">xScaleLLRU</span>(bw_daten_LLRU))</span>
<span id="cb5-475"><a href="#cb5-475" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> innerHeight)</span>
<span id="cb5-476"><a href="#cb5-476" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"blue"</span>)</span>
<span id="cb5-477"><a href="#cb5-477" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"4"</span>)</span>
<span id="cb5-478"><a href="#cb5-478" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"1"</span>)<span class="op">;</span></span>
<span id="cb5-479"><a href="#cb5-479" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-480"><a href="#cb5-480" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* dashed line data bw lower */</span></span>
<span id="cb5-481"><a href="#cb5-481" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb5-482"><a href="#cb5-482" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="fu">xScaleLLRU</span>(<span class="op">-</span>bw_daten_LLRU))</span>
<span id="cb5-483"><a href="#cb5-483" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb5-484"><a href="#cb5-484" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="fu">xScaleLLRU</span>(<span class="op">-</span>bw_daten_LLRU))</span>
<span id="cb5-485"><a href="#cb5-485" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> innerHeight)</span>
<span id="cb5-486"><a href="#cb5-486" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"blue"</span>)</span>
<span id="cb5-487"><a href="#cb5-487" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"4"</span>)</span>
<span id="cb5-488"><a href="#cb5-488" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"1"</span>)<span class="op">;</span></span>
<span id="cb5-489"><a href="#cb5-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-490"><a href="#cb5-490" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb5-491"><a href="#cb5-491" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-srddviz" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-srddviz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-2" data-nodetype="expression">

</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-srddviz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;11.3: Nicht-parametrische Regression auf beiden Seiten des Cut-offs
</figcaption></figure>
</div>
</div>
<p>Der interssierende Effekt am Schwellenwert <span class="math inline">\(c=5\)</span> beträgt <span class="math inline">\(\beta_2 = 1.5\)</span>. Beachte, dass aufgrund des Terms <span class="math inline">\(\beta_3 X_i^2 \times B_i\)</span> ein quadratischer Zusammenhang von <span class="math inline">\(Y\)</span> und <span class="math inline">\(X\)</span> oberhalb von <span class="math inline">\(X_i = c\)</span> vorliegt. Es können folgende Eigenschaften der Schätzung in Abhängigkeit von der Bandweite <span class="math inline">\(h\)</span> beobachtet werden:</p>
<ul>
<li><p>Für die voreingestellte Bandweite <span class="math inline">\(h = 1.3\)</span> liefert die lokale lineare Regression eine gute Approximation des Regressionszusammenhangs auf beiden Seiten des Schwellenwertes und die Schätzung des Behandlungseffekts liegt nahe beim wahren Wert <span class="math inline">\(\beta_2 = 1.5\)</span>.</p></li>
<li><p>Für kleinere Bandweiten verringert sich die Datenbasis der Schätzung. Die Varianz der Schätzung nimmt zu und die Approximation der Regressionsfunktion verschlechtert sich. Wir beobachten eine mit <span class="math inline">\(h\to0\)</span> zunehmende Verzerrung bei der Schätzung des Behandlungseffekts.</p></li>
<li><p>Größere Bandweiten <span class="math inline">\(h\)</span> erhöhen die Datenbasis der Schätzung, führen aber zu einer Annäherung der lokalen Schätzung an die globale KQ-Schätzung. Linksseitig des Schwellenwertes erzielen wir damit eine Schätzung mit hoher Güte. Rechsseitig von <span class="math inline">\(X_i = c\)</span> verschlechtert sich die lokale Anpassung am Schwellenwert deutlich, weil die lineare Schätzung den tatsächlichen (nicht-linearen) Zusammenhang nicht adäquat abbilden kann. Die Schätzung des Behandlungseffekts ist hier deutlich verzerrt.</p></li>
</ul>
<p>Die Wahl der Bandweite ist also eine wichtige Komponenten der RDD-Schätzung: Kleine Bandweiten erlauben eine Schätzung der Regressionsfunktion nahe des Schwellenwertes mit wenig Verzerrung. Allerdings kann diese Schätzung unpräzise sein, wenn nur wenige Beobachtungen <span class="math inline">\(\eqref{eq:bwc}\)</span> erfüllen. In der Praxis wird <span class="math inline">\(h\)</span> daher mit einem analytischen Schätzer <span class="citation" data-cites="ImbensKalyanaraman2012">(vgl. <a href="Literatur.html#ref-ImbensKalyanaraman2012" role="doc-biblioref">G. Imbens und Kalyanaraman 2012</a>)</span> oder anhand von <em>Cross Validation</em> <span class="citation" data-cites="ImbensLemieux2008">(bspw. <a href="Literatur.html#ref-ImbensLemieux2008" role="doc-biblioref">G. W. Imbens und Lemieux 2008</a>)</span> bestimmt. Die später in diesem Kapitel betrachteten R-Pakete halten diese Methoden bereit.</p>
</section><section id="manipulation-am-schwellenwert" class="level2 page-columns page-full" data-number="11.2"><h2 data-number="11.2" class="anchored" data-anchor-id="manipulation-am-schwellenwert">
<span class="header-section-number">11.2</span> Manipulation am Schwellenwert</h2>
<p>Eine wichtige Annahmen für die Gültigkeit einer RDD-Schätzung ist, dass keine Manipulation der Gruppenzugehörigkeit am Schwellenwert vorliegt. Wenn sich Subjekte nahe des Schwellenwertes <span class="math inline">\(c\)</span> — d.h. in Abhängigkeit der Laufvariable <span class="math inline">\(X\)</span> — systematisch in den Confoundern <span class="math inline">\(Z\)</span> unterscheiden, können wir den Backdoor-Pfad <em>Oberhalb C → Behandlung B → Y</em> nicht isolieren. Wir erhalten dann eine verzerrte Schätzung des Behandlungseffekts.</p>
<p>In empirischen Studien mit Individuen kann Selbstselektion auftreten: Menschen mit <span class="math inline">\(X&lt;c\)</span> aber nahe <span class="math inline">\(c\)</span> (hier Kontrollgruppe) könnten aufgrund unbeobachtbarer Eigenschaften <span class="math inline">\(Z\)</span> die Ausprägung ihrer Laufvariable zu <span class="math inline">\(X&gt;c\)</span> (hier Behandlungsgruppe) manipulieren. Wenn <span class="math inline">\(Z\)</span> die Outcome-Variable beeinflusst, bleibt der Backdoor-Pfad <em>Oberhalb C → Behandlung B → Y</em> so bestehen.</p>
<p>Manipulation resultiert in Häufung von Beobachtungen am Schwellenwert. Dei Verteilung der Laufvariable kann auf diese Unregelmäßigkeit hin untersucht werden. <span class="citation" data-cites="McCrary2008">McCrary (<a href="Literatur.html#ref-McCrary2008" role="doc-biblioref">2008</a>)</span> schlägt hierfür einen Verfahren vor, das die Kontinuität der Dichtefunktion von <span class="math inline">\(X\)</span> am Schwellenwert testet.</p>
<p>Der Test von <span class="citation" data-cites="McCrary2008">McCrary (<a href="Literatur.html#ref-McCrary2008" role="doc-biblioref">2008</a>)</span> ist in <code><a href="https://rdrr.io/pkg/rdd/man/DCdensity.html">rdd::DCdensity()</a></code> implementiert. Wir zeigen die Anwendung des Tests anhand der oben simulierten Daten. Beachte, dass <span class="math inline">\(X_i\sim U(0, 10)\)</span>, d.h. die Laufvariable ist bei <span class="math inline">\(X_i = c\)</span> kontinuierlich verteilt. Die Nullhypothese (keine Manipulation) gilt für die simulierten Daten</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># McCrary-Test durchführen</span></span>
<span><span class="va">p_mccrary</span> <span class="op">&lt;-</span> <span class="fu">rdd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rdd/man/DCdensity.html">DCdensity</a></span><span class="op">(</span></span>
<span>  runvar <span class="op">=</span> <span class="va">X</span>, </span>
<span>  cutpoint <span class="op">=</span> <span class="va">c</span>, </span>
<span>  plot <span class="op">=</span> <span class="cn">F</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># p-Wert</span></span>
<span><span class="va">p_mccrary</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5013939</code></pre>
</div>
</div>
<p>Der p-Wert 0.5 ist größer als jedes übliche Signifikanzniveau. Damit liegt starke Evidenz für die Nullhypothese (keine Diskontinuität) und gegen Manipulation am Schwellenwert vor.</p>
<p><span class="citation" data-cites="CJM2020">Cattaneo, Jansson, und Ma (<a href="Literatur.html#ref-CJM2020" role="doc-biblioref">2020</a>)</span> (CMJ) schlagen eine Weiterentwicklung des McCrary-Tests vor, die höhere statistische Macht gegenüber Diskontinuitäten hat am Schwellenwert hat. Der CJM-Test ist im Paket <code>rddensity</code> implementiert.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rddensity</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CJM Schätzer berechnen</span></span>
<span><span class="va">CJM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rddensity/man/rddensity.html">rddensity</a></span><span class="op">(</span><span class="va">X</span>, c <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mit der Funktion <code><a href="https://rdrr.io/pkg/rddensity/man/rdplotdensity.html">rddensity::rdplotdensity()</a></code> erzeugen wir <a href="#fig-cjmtsim" class="quarto-xref">Abbildung&nbsp;<span>11.4</span></a>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot für Dichtefunktion erstellen</span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rddensity/man/rdplotdensity.html">rdplotdensity</a></span><span class="op">(</span></span>
<span>  rdd <span class="op">=</span> <span class="va">CJM</span>, </span>
<span>  X <span class="op">=</span> <span class="va">X</span>, </span>
<span>  <span class="co"># für Punkte- und Linienplots:</span></span>
<span>  type <span class="op">=</span> <span class="st">"both"</span> </span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-cjmtsim" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-cjmtsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="RDD_files/figure-html/fig-cjmtsim-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-cjmtsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;11.4: CJM-Test – geschätzte Dichtefunktionen der Laufvariable auf beiden Seiten des Schwellenwerts c = 5
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-cjmtsim" class="quarto-xref">Abbildung&nbsp;<span>11.4</span></a> zeigt die geschätzten Dichtefunktionen. Erwartungsgemäß finden wir eine große Überlappung der zugehörigen Konfidenzbänder (schattierte Flächen) am Schwellenwert <span class="math inline">\(c=5\)</span>.</p>
<p>Mit <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> erhalten wir eine detaillierte Zusammenfassung des Tests.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Statistische Zusammenfassung des CJM-Tests</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">CJM</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Manipulation testing using local polynomial density estimation.

Number of obs =       750
Model =               unrestricted
Kernel =              triangular
BW method =           estimated
VCE method =          jackknife

c = 5                 Left of c           Right of c          
Number of obs         329                 421                 
Eff. Number of obs    133                 154                 
Order est. (p)        2                   2                   
Order bias (q)        3                   3                   
BW est. (h)           1.918               2.124               

Method                T                   P &gt; |T|             
Robust                -0.3338             0.7385              


P-values of binomial tests (H0: p=0.5).

Window Length              &lt;c     &gt;=c    P&gt;|T|
0.346     + 0.346          20      21    1.0000
0.521     + 0.544          34      37    0.8126
0.696     + 0.742          44      57    0.2323
0.870     + 0.939          54      64    0.4075
1.045     + 1.137          62      77    0.2349
1.220     + 1.334          73      98    0.0661
1.394     + 1.532          86     106    0.1701
1.569     + 1.729          96     124    0.0685
1.743     + 1.927         119     140    0.2139
1.918     + 2.124         133     154    0.2377</code></pre>
</div>
</div>
<p>Gemäß des p-Werts (<code>P &gt; |T|</code>) von 0.74 spricht der CJM-Test noch deutlicher gegen eine Diskontinuität als der McCrary-Test.</p>
<section id="case-study-amtsinhaber-vorteil-lee2008" class="level3 page-columns page-full" data-number="11.2.1"><h3 data-number="11.2.1" class="anchored" data-anchor-id="case-study-amtsinhaber-vorteil-lee2008">
<span class="header-section-number">11.2.1</span> Case Study: Amtsinhaber-Vorteil <span class="citation" data-cites="Lee2008">(<a href="Literatur.html#ref-Lee2008" role="doc-biblioref">Lee 2008</a>)</span>
</h3>
<p><span class="citation" data-cites="Lee2008">Lee (<a href="Literatur.html#ref-Lee2008" role="doc-biblioref">2008</a>)</span> untersucht den Einfluss des Amtsinhaber-Vorteils auf die Wahl von Mitgliedern des US-Repräsentantenhaus. In den meisten Wahlkreisen entfallen große Anteile der Stimmen (oder gar ausschließlich) auf demokratische und republikanische Kanditat*innen, sodass sich die Studie auf diese Parteien beschränkt. Entfällt die Mehrheit der Stimmen auf eine*n Kandiat*in, gewinnt diese*r den Sitz für den Wahlkreis. Durch die Analyse der 6558 Wahlen im Zeitraum 1946-1998 mit einem SRDD kommt die Studie zu dem Ergebnis, dass Amtsinhabende im Durchschnitt einen Vorteil von etwa 8% bis 10% bei der Wahl haben. Dieses Ergebnis kann verschiedene Ursachen haben, bspw. dass die amtierende Partei höhere finanzielle Ressourcen besitzt und von einer besseren Organisation und durch Instrumenalisierung staatlicher Strukturen für die eigenen Zwecke profitiert.</p>
<p>Anhand der Datensätze <code>house</code> und <code>house_binned</code> illustrieren wir nachfolgend die Schätzung von SRDD-Modellen für den Wahlerfolg der demokratischen Partei, wenn diese Amtsinhaber ist. Wir lesen hierfür zunächst die Datensätze <code>house</code> und <code>house_binned</code> ein und verschaffen uns einen Überblick.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://modelsummary.com">modelsummary</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Daten einlesen</span></span>
<span><span class="va">house</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"datasets/house.csv"</span><span class="op">)</span></span>
<span><span class="co"># Gruppierter Datensatz</span></span>
<span><span class="va">house_binned</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"datasets/house_binned.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Überblick verschaffen</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">house</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 6,558
Columns: 2
$ StimmenTm1 &lt;dbl&gt; 0.1049, 0.1393, -0.0736, 0.0868, 0.3994, 0.1681, 0.2516, 0.…
$ StimmenT   &lt;dbl&gt; 0.5810, 0.4611, 0.5434, 0.5846, 0.5803, 0.6244, 0.4873, 0.5…</code></pre>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">house_binned</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 100
Columns: 2
$ StimmenT   &lt;dbl&gt; 0.5995600, 0.5657000, 0.4272554, 0.5637456, 0.6868627, 0.60…
$ StimmenTm1 &lt;dbl&gt; 0.104764444, 0.135005263, -0.075690769, 0.084570886, 0.3951…</code></pre>
</div>
</div>
<p>Der Datensatz <code>house</code> enthält die Stimmenanteile demokratischer Kandidat*innen bei der Wahl zum Zeitpunkt <span class="math inline">\(T\)</span> (<span class="math inline">\(StimmenT\)</span>) sowie die Differenz zwischen demokratischen und republikanischen Stimmenanteilen bei der vorherigen Wahl, d.h. zum Zeitpunkt <span class="math inline">\(T-1\)</span> (<span class="math inline">\(StimmenTm1\)</span>). Der Schwellenwert für einen Wahlsieg liegt bei Stimmengleichheit, d.h. <span class="math inline">\(StimmenTm1 = 0\)</span>.</p>
<p><code>house_binned</code> ist eine aggregierte Version von <code>house</code> mit Mittelwerten von jeweils 50 gleichgroßen Intervallen oberhalb und unterhalb der Schwelle von <span class="math inline">\(StimmenTm1 = 0\)</span>. Dieser Datensatz eignet sich, um einen ersten Eindruck des funktionalen Zusammenhangs auf beiden Seiten zu erhalten. Wir stellen zunächst diese klassierten Daten mit <code>ggplot2</code> graphisch dar.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Klassierte Daten plotten</span></span>
<span><span class="va">house_binned</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">StimmenTm1</span>, y <span class="op">=</span> <span class="va">StimmenT</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-LeeDataClass" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-LeeDataClass-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="RDD_files/figure-html/fig-LeeDataClass-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-LeeDataClass-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;11.5: Klassierte Daten aus Lee (2008)
</figcaption></figure>
</div>
</div>
</div>
<p>Die Grafik zeigt eindeutig einen Sprung von <span class="math inline">\(StimmenT\)</span> bei <span class="math inline">\(StimmenTm1 = 0\)</span>. Weiterhin erkennen wir, dass der Zusammenhang nahe <span class="math inline">\(0\)</span> vermutlich jeweils gut durch eine lineare Funktion approximiert werden kann. Eine Modell-Spezifikation mit gleicher Steigung auf beiden Seiten des Schwellenwertes scheint hingegen weniger gut geeignet. Wir vergleichen diese Spezifikationen nachfolgend.</p>
<p>Zunächst fügen wir dem Datensatz eine Dummyvariable <code>B</code> hinzu. Diese dient als Indikator für den Wahlgewinn in der letzten Wahl und zeigt die Amtsinhaberschaft (Behandlung) an.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Behandlungsindikator B hinzufügen</span></span>
<span><span class="va">house</span> <span class="op">&lt;-</span> <span class="va">house</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>B <span class="op">=</span> <span class="va">StimmenTm1</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">house</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 6,558
Columns: 3
$ StimmenTm1 &lt;dbl&gt; 0.1049, 0.1393, -0.0736, 0.0868, 0.3994, 0.1681, 0.2516, 0.…
$ StimmenT   &lt;dbl&gt; 0.5810, 0.4611, 0.5434, 0.5846, 0.5803, 0.6244, 0.4873, 0.5…
$ B          &lt;lgl&gt; TRUE, TRUE, FALSE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE…</code></pre>
</div>
</div>
<p>Wir überprüfen die Laufvariable mit dem CJM-Test auf Manipulation am Schwellenwert <span class="math inline">\(c=0\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># CJM-Test durchführen</span></span>
<span><span class="va">CJM_Lee</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rddensity/man/rddensity.html">rddensity</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">house</span><span class="op">$</span><span class="va">StimmenTm1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Zusammenfassung anzeigen</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">CJM_Lee</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Manipulation testing using local polynomial density estimation.

Number of obs =       6558
Model =               unrestricted
Kernel =              triangular
BW method =           estimated
VCE method =          jackknife

c = 0                 Left of c           Right of c          
Number of obs         2740                3818                
Eff. Number of obs    1297                1360                
Order est. (p)        2                   2                   
Order bias (q)        3                   3                   
BW est. (h)           0.236               0.243               

Method                T                   P &gt; |T|             
Robust                1.4346              0.1514              


P-values of binomial tests (H0: p=0.5).

Window Length / 2          &lt;c     &gt;=c    P&gt;|T|
0.004                      21      24    0.7660
0.007                      38      46    0.4452
0.011                      50      60    0.3909
0.014                      73      77    0.8066
0.018                      91     104    0.3902
0.022                     124     132    0.6618
0.025                     149     149    1.0000
0.029                     163     174    0.5860
0.032                     176     202    0.1984
0.036                     197     223    0.2225</code></pre>
</div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># CJM-Plot</span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rddensity/man/rdplotdensity.html">rdplotdensity</a></span><span class="op">(</span></span>
<span>  rdd <span class="op">=</span> <span class="va">CJM_Lee</span>,</span>
<span>  X <span class="op">=</span> <span class="va">house</span><span class="op">$</span><span class="va">StimmenTm1</span>, </span>
<span>  type <span class="op">=</span> <span class="st">"both"</span>, </span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-cjm-lee" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-cjm-lee-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="RDD_files/figure-html/fig-cjm-lee-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-cjm-lee-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;11.6: CJM-Test – geschätzte Dichtefunktionen der Laufvariable
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-cjm-lee" class="quarto-xref">Abbildung&nbsp;<span>11.6</span></a> und der p-Wert von <span class="math inline">\(0.15\)</span> sind Evidenz gegen eine Manipulation am Schwellenwert.</p>
<p>Um den Behandlungseffekt anhand eines SRDDs zu ermitteln, schätzen wir das Interaktionsmodell <span class="math display">\[\begin{align*}
  \text{StimmenT}_i =&amp;\, \beta_0 + \beta_1 B_i + \beta_2 (\text{StimmenTm1}_i - 50)\\
  +&amp;\, \beta_3(\text{StimmenTm1}_i - 50)\times B_i + u_i
\end{align*}\]</span> zunächst für eine Bandweite von <span class="math inline">\(h = 0.5\)</span>. Aufgrund der Skalierung der Daten (Wahlergebnisse in %) bedeutet dies die Verwendung des <em>gesamten</em> Datensatzes für die Schätzung.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Interaktionsmodell schätzen</span></span>
<span><span class="va">house_llr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">StimmenT</span> <span class="op">~</span> <span class="va">B</span> <span class="op">*</span> <span class="va">StimmenTm1</span>, </span>
<span>  data <span class="op">=</span> <span class="va">house</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Zusammenfassung anzeigen  </span></span>
<span><span class="fu"><a href="https://modelsummary.com/man/modelsummary.html">modelsummary</a></span><span class="op">(</span></span>
<span>  models <span class="op">=</span> <span class="va">house_llr1</span>, </span>
<span>  vcov <span class="op">=</span> <span class="st">"HC1"</span>, <span class="co"># robuste Standardfehler</span></span>
<span>  stars <span class="op">=</span> <span class="cn">T</span>, </span>
<span>  gof_map <span class="op">=</span> <span class="st">"nobs"</span>, </span>
<span>  output <span class="op">=</span> <span class="st">"gt"</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="va">tabopts</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="jxwlahbesu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jxwlahbesu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jxwlahbesu thead, #jxwlahbesu tbody, #jxwlahbesu tfoot, #jxwlahbesu tr, #jxwlahbesu td, #jxwlahbesu th {
  border-style: none;
}

#jxwlahbesu p {
  margin: 0;
  padding: 0;
}

#jxwlahbesu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #000000;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jxwlahbesu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jxwlahbesu .gt_title {
  color: #000000;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jxwlahbesu .gt_subtitle {
  color: #000000;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jxwlahbesu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jxwlahbesu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jxwlahbesu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jxwlahbesu .gt_col_heading {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jxwlahbesu .gt_column_spanner_outer {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jxwlahbesu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jxwlahbesu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jxwlahbesu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jxwlahbesu .gt_spanner_row {
  border-bottom-style: hidden;
}

#jxwlahbesu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jxwlahbesu .gt_empty_group_heading {
  padding: 0.5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jxwlahbesu .gt_from_md > :first-child {
  margin-top: 0;
}

#jxwlahbesu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jxwlahbesu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jxwlahbesu .gt_stub {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jxwlahbesu .gt_stub_row_group {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jxwlahbesu .gt_row_group_first td {
  border-top-width: 2px;
}

#jxwlahbesu .gt_row_group_first th {
  border-top-width: 2px;
}

#jxwlahbesu .gt_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxwlahbesu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jxwlahbesu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jxwlahbesu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jxwlahbesu .gt_grand_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxwlahbesu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jxwlahbesu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jxwlahbesu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jxwlahbesu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#jxwlahbesu .gt_footnotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jxwlahbesu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxwlahbesu .gt_sourcenotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jxwlahbesu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxwlahbesu .gt_left {
  text-align: left;
}

#jxwlahbesu .gt_center {
  text-align: center;
}

#jxwlahbesu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jxwlahbesu .gt_font_normal {
  font-weight: normal;
}

#jxwlahbesu .gt_font_bold {
  font-weight: bold;
}

#jxwlahbesu .gt_font_italic {
  font-style: italic;
}

#jxwlahbesu .gt_super {
  font-size: 65%;
}

#jxwlahbesu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jxwlahbesu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jxwlahbesu .gt_indent_1 {
  text-indent: 5px;
}

#jxwlahbesu .gt_indent_2 {
  text-indent: 10px;
}

#jxwlahbesu .gt_indent_3 {
  text-indent: 15px;
}

#jxwlahbesu .gt_indent_4 {
  text-indent: 20px;
}

#jxwlahbesu .gt_indent_5 {
  text-indent: 25px;
}

#jxwlahbesu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jxwlahbesu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id=" " class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="(1)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">(1)</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=" ">(Intercept)</td>
<td class="gt_row gt_center" headers="(1)">0.433***</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="(1)">(0.004)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">BTRUE</td>
<td class="gt_row gt_center" headers="(1)">0.118***</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="(1)">(0.006)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">StimmenTm1</td>
<td class="gt_row gt_center" headers="(1)">0.297***</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="(1)">(0.016)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">BTRUE × StimmenTm1</td>
<td class="gt_row gt_center" headers="(1)">0.046*</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" " style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000"></td>
<td class="gt_row gt_center" headers="(1)" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000">(0.018)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">Num.Obs.</td>
<td class="gt_row gt_center" headers="(1)">6558</td>
</tr>
</tbody>
<tfoot class="gt_sourcenotes"><tr class="even">
<td colspan="2" class="gt_sourcenote">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
<p>Der geschätzte Koeffizient von <span class="math inline">\(B\)</span> (<code>BTRUE</code>) beträgt etwa <span class="math inline">\(0.12\)</span> und ist hochsignifikant. Übereinstimmend mit <a href="#fig-LeeDataClass" class="quarto-xref">Abbildung&nbsp;<span>11.5</span></a> erhalten wir also eine positive Schätzung des Behandlungseffekts. Die Interpretation ist, dass die amtierenden Demokraten bei der Wahl von einem Amtsinhabervorteil profitieren. Dieser Effekt schlägt sich als Stimmenbonus von geschätzten 12% nieder. Diese Schätzung des Behandlungseffekts könnte jedoch verzerrt sein:</p>
<ul>
<li><p>Die (implizite) Wahl von <span class="math inline">\(h=0.5\)</span> in unserer Schätzung macht die Isolation des relevanten Frontdoor-Paths (<span class="math inline">\(c=0\)</span> → Treatment → StimmenT) wenig plausibel. <span class="math inline">\(h\)</span> sollte mit einer datengetriebenen Methode gewählt werden.</p></li>
<li><p>Weiterhin könnte die lineare funktionale Form der Regression inadäquat sein: Die lineare Approximation der wahren Regressionsfunktion nahe des Schwellenwerts <span class="math inline">\(0\)</span> könnte unzureichend sein und in einer verzerrten Schätzung des Effekts resultieren. Zur Überprüfung der Robustheit der Ergebnisse sollte mit Schätzungen anhand nicht-linearer Spezifikationen verglichen werden.</p></li>
</ul>
<p>Um diesen Gefahren für die Validität der Studie zu begegnen, schätzen wir nun weitere Spezifikationen. Im Folgenden verwenden wir eine Bandweitenschätzung gemäß <span class="citation" data-cites="ImbensKalyanaraman2012">G. Imbens und Kalyanaraman (<a href="Literatur.html#ref-ImbensKalyanaraman2012" role="doc-biblioref">2012</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Bandweite mit Schätzer von IK (2012) berechnen</span></span>
<span><span class="op">(</span></span>
<span><span class="va">IK_BW</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">rdd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rdd/man/IKbandwidth.html">IKbandwidth</a></span><span class="op">(</span></span>
<span>    X <span class="op">=</span> <span class="va">house</span><span class="op">$</span><span class="va">StimmenTm1</span>, </span>
<span>    Y <span class="op">=</span> <span class="va">house</span><span class="op">$</span><span class="va">StimmenT</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2685123</code></pre>
</div>
</div>
<p>Wir schätzen zunächst erneut das lineare Interaktionsmodell, diesmal jedoch mit der Bandweite <code>IK_BW</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Lineares Interaktionsmodelle mit IK-Bandweite</span></span>
<span><span class="va">house_llin_IK</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">StimmenT</span> <span class="op">~</span> <span class="va">B</span> <span class="op">*</span> <span class="va">StimmenTm1</span>, </span>
<span>  data <span class="op">=</span> <span class="va">house</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">StimmenTm1</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="va">IK_BW</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Für den Vergleich mit einer nicht-linearen Spezifikation schätzen wir auch ein quadratisches Interaktionsmodell.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Quadratisches Interaktionsmodell mit IK-Bandweite</span></span>
<span><span class="va">house_poly_IK</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">house_llin_IK</span>,</span>
<span>  formula <span class="op">=</span> <span class="va">StimmenT</span> <span class="op">~</span> <span class="va">B</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">StimmenTm1</span>, degree <span class="op">=</span> <span class="fl">2</span>, raw <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Für eine Gegenüberstellung der Ergebnisse verwenden wir <code><a href="https://modelsummary.com/man/modelsummary.html">modelsummary()</a></code>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Tabellarischer Modellvergleich</span></span>
<span><span class="fu"><a href="https://modelsummary.com/man/modelsummary.html">modelsummary</a></span><span class="op">(</span></span>
<span>  models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Linear int."</span> <span class="op">=</span> <span class="va">house_llin_IK</span>, </span>
<span>    <span class="st">"Quadratisch int."</span> <span class="op">=</span> <span class="va">house_poly_IK</span></span>
<span>  <span class="op">)</span>,  </span>
<span>  vcov <span class="op">=</span> <span class="st">"HC1"</span>, </span>
<span>  stars <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  gof_map <span class="op">=</span> <span class="st">"nobs"</span>, </span>
<span>  output <span class="op">=</span> <span class="st">"gt"</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="va">tabopts</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-intmodsLee" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><div aria-describedby="tbl-intmodsLee-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="xxwsigecfm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xxwsigecfm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xxwsigecfm thead, #xxwsigecfm tbody, #xxwsigecfm tfoot, #xxwsigecfm tr, #xxwsigecfm td, #xxwsigecfm th {
  border-style: none;
}

#xxwsigecfm p {
  margin: 0;
  padding: 0;
}

#xxwsigecfm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #000000;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xxwsigecfm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xxwsigecfm .gt_title {
  color: #000000;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xxwsigecfm .gt_subtitle {
  color: #000000;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xxwsigecfm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xxwsigecfm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xxwsigecfm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xxwsigecfm .gt_col_heading {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xxwsigecfm .gt_column_spanner_outer {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xxwsigecfm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xxwsigecfm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xxwsigecfm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xxwsigecfm .gt_spanner_row {
  border-bottom-style: hidden;
}

#xxwsigecfm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xxwsigecfm .gt_empty_group_heading {
  padding: 0.5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xxwsigecfm .gt_from_md > :first-child {
  margin-top: 0;
}

#xxwsigecfm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xxwsigecfm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xxwsigecfm .gt_stub {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xxwsigecfm .gt_stub_row_group {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xxwsigecfm .gt_row_group_first td {
  border-top-width: 2px;
}

#xxwsigecfm .gt_row_group_first th {
  border-top-width: 2px;
}

#xxwsigecfm .gt_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xxwsigecfm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xxwsigecfm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xxwsigecfm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xxwsigecfm .gt_grand_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xxwsigecfm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xxwsigecfm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xxwsigecfm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xxwsigecfm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#xxwsigecfm .gt_footnotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xxwsigecfm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xxwsigecfm .gt_sourcenotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xxwsigecfm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xxwsigecfm .gt_left {
  text-align: left;
}

#xxwsigecfm .gt_center {
  text-align: center;
}

#xxwsigecfm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xxwsigecfm .gt_font_normal {
  font-weight: normal;
}

#xxwsigecfm .gt_font_bold {
  font-weight: bold;
}

#xxwsigecfm .gt_font_italic {
  font-style: italic;
}

#xxwsigecfm .gt_super {
  font-size: 65%;
}

#xxwsigecfm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xxwsigecfm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xxwsigecfm .gt_indent_1 {
  text-indent: 5px;
}

#xxwsigecfm .gt_indent_2 {
  text-indent: 10px;
}

#xxwsigecfm .gt_indent_3 {
  text-indent: 15px;
}

#xxwsigecfm .gt_indent_4 {
  text-indent: 20px;
}

#xxwsigecfm .gt_indent_5 {
  text-indent: 25px;
}

#xxwsigecfm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xxwsigecfm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id=" " class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="Linear int." class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Linear int.</th>
<th id="Quadratisch int." class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Quadratisch int.</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=" ">(Intercept)</td>
<td class="gt_row gt_center" headers="Linear int.">0.450***</td>
<td class="gt_row gt_center" headers="Quadratisch int.">0.460***</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="Linear int.">(0.005)</td>
<td class="gt_row gt_center" headers="Quadratisch int.">(0.008)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">BTRUE</td>
<td class="gt_row gt_center" headers="Linear int.">0.085***</td>
<td class="gt_row gt_center" headers="Quadratisch int.">0.068***</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="Linear int.">(0.008)</td>
<td class="gt_row gt_center" headers="Quadratisch int.">(0.012)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">StimmenTm1</td>
<td class="gt_row gt_center" headers="Linear int.">0.360***</td>
<td class="gt_row gt_center" headers="Quadratisch int."></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="Linear int.">(0.036)</td>
<td class="gt_row gt_center" headers="Quadratisch int."></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">BTRUE × StimmenTm1</td>
<td class="gt_row gt_center" headers="Linear int.">0.055</td>
<td class="gt_row gt_center" headers="Quadratisch int."></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="Linear int.">(0.059)</td>
<td class="gt_row gt_center" headers="Quadratisch int."></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">poly(StimmenTm1, degree = 2, raw = T)1</td>
<td class="gt_row gt_center" headers="Linear int."></td>
<td class="gt_row gt_center" headers="Quadratisch int.">0.573***</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="Linear int."></td>
<td class="gt_row gt_center" headers="Quadratisch int.">(0.138)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">poly(StimmenTm1, degree = 2, raw = T)2</td>
<td class="gt_row gt_center" headers="Linear int."></td>
<td class="gt_row gt_center" headers="Quadratisch int.">0.798</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="Linear int."></td>
<td class="gt_row gt_center" headers="Quadratisch int.">(0.493)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">BTRUE × poly(StimmenTm1, degree = 2, raw = T)1</td>
<td class="gt_row gt_center" headers="Linear int."></td>
<td class="gt_row gt_center" headers="Quadratisch int.">0.036</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="Linear int."></td>
<td class="gt_row gt_center" headers="Quadratisch int.">(0.219)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">BTRUE × poly(StimmenTm1, degree = 2, raw = T)2</td>
<td class="gt_row gt_center" headers="Linear int."></td>
<td class="gt_row gt_center" headers="Quadratisch int.">-1.529+</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" " style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000"></td>
<td class="gt_row gt_center" headers="Linear int." style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000"></td>
<td class="gt_row gt_center" headers="Quadratisch int." style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000">(0.834)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">Num.Obs.</td>
<td class="gt_row gt_center" headers="Linear int.">2956</td>
<td class="gt_row gt_center" headers="Quadratisch int.">2956</td>
</tr>
</tbody>
<tfoot class="gt_sourcenotes"><tr class="even">
<td colspan="3" class="gt_sourcenote">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-intmodsLee-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;11.1: Vergleich von SRDD-Interaktionsmodellen für Lee (2008)
</figcaption></figure>
</div>
</div>
<p>Die Spalte (1) in <a href="#tbl-intmodsLee" class="quarto-xref">Tabelle&nbsp;<span>11.1</span></a> zeigt die lokale Schätzung mit einem linearen Interaktionsmodell. Wir erhalten damit einen Behandlungseffekt von etwa <span class="math inline">\(8.5\%\)</span>. Der Schätzwert fällt also etwas geringer aus als für die globale KQ-Schätzung des linearen Interaktionsmodells. Für das Modell (2) mit quadratischer Spezifikation liegt der Schätzwert mit <span class="math inline">\(6.8\%\)</span> in der selben Größenordnung. Beide Schätzungen ergeben einen signifikant von <span class="math inline">\(0\)</span> verschieden Effekt. Weiterhin fällt auf, dass in beiden Modellen keine Evidenz für unterschiedliche Formen der Regressionsfunktionen auf beiden Seiten des Schwellenwerts vorliegen: sämtliche Koeffizientenschätzwerte der Interaktionsterme haben hohe Standardfehler und sind nicht signifikant. Im quadratischen Modell hat auch der Term <span class="math inline">\(StimmenTm1^2\)</span> keinen signifikanten Effekt. Diese Ergebnisse deuten darauf hin, dass eine lineare Spezifikation ausreichend ist.</p>
<p><strong>SRDD-Schätzung mit LOESS</strong></p>
<p>Wir illustrieren nachfolgend die Schätzung des Behandlungseffekts mit einer flexiblen und in der Praxis häufig verwendeten Methode für lokale Regression. Die nachfolgende interaktive Grafik zeigt die klassierten Daten aus <span class="citation" data-cites="Lee2008">Lee (<a href="Literatur.html#ref-Lee2008" role="doc-biblioref">2008</a>)</span> auf dem Intervall <span class="math inline">\([-0.5,0.5]\)</span> gemeinsam mit einer nicht-parametrischen Schätzung des Zusammenhangs von <code>StimmenT</code> und <code>StimmenTm1</code> mittels LOESS.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> Diese Implementierung von lokaler Regression nutzt einen <a href="https://en.wikipedia.org/wiki/Kernel_(statistics)">tricube kernel</a>. Über den Input kann eine Bandweite <span class="math inline">\(l\in(0,1]\)</span> für den LOESS-Schätzer auf beiden Seiten des Schwellenwerts <span class="math inline">\(0\)</span> gewählt werden. Die Bandweite ist hier der <em>Anteil der Beobachtungen an der gesamten Anzahl an Beobachtungen</em>, die in die Schätzung einbezogen werden sollen.</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;<a href="https://en.wikipedia.org/wiki/Local_regression">LOESS</a> ist eine Variante von lokaler Polynom-Regression.</p></div></div><p>Für die Schätzung am Schwellenwert berücksichtigte Daten sind in orange kenntlich gemacht. Die rote linie zeigt die geschätzte Regressionsfunktion über gleichmäßig verteilte Werte von <code>StimmenTm1</code> auf <span class="math inline">\([-0.5,0.5]\)</span>. Die Grafik verdeutlicht, dass die LOESS-Methode flexibel genug ist, um lineare und nicht-lineare Zusammenhänge abbilden zu können. Wie zuvor ist eine adäquate Wahl der Bandweite wichtig:</p>
<ul>
<li><p>Der mit LOESS geschätzte Zusammenhang auf beiden Seiten des Schwellenwerts ist etwa linear für den voreingestellten Parameter (<span class="math inline">\(l = 0.28\)</span>).</p></li>
<li><p>Für größere Werte von <span class="math inline">\(l\)</span> nähert sich die Schätzung weiter einem linearen Verlauf an. Die Schätzung des Effekts bleibt vergleichbar mit den Ergebnissen des linearen Interaktionsmodell (s. oben).</p></li>
<li><p>Für kleinere <span class="math inline">\(l\)</span> erhalten wir eine stärkere Anpassung der Schätzung an die Daten. Zu kleine Werte führen zu einer Überanpassung (<em>overfitting</em>). Insbesondere tendiert die geschätzte Funktion zu extremer Steigung nahe des Schwellenwerts → stark verzerrte Schätzung des Effekts!</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb28" data-startfrom="749" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 748;"><span id="cb28-749"><a href="#cb28-749" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb28-750"><a href="#cb28-750" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;style&gt;</span></span>
<span id="cb28-751"><a href="#cb28-751" aria-hidden="true" tabindex="-1"></a><span class="vs">.regression {</span></span>
<span id="cb28-752"><a href="#cb28-752" aria-hidden="true" tabindex="-1"></a><span class="vs">  fill: none;</span></span>
<span id="cb28-753"><a href="#cb28-753" aria-hidden="true" tabindex="-1"></a><span class="vs">  stroke: #000;</span></span>
<span id="cb28-754"><a href="#cb28-754" aria-hidden="true" tabindex="-1"></a><span class="vs">  stroke-width: 1.5px;</span></span>
<span id="cb28-755"><a href="#cb28-755" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-756"><a href="#cb28-756" aria-hidden="true" tabindex="-1"></a><span class="vs">.axis line {</span></span>
<span id="cb28-757"><a href="#cb28-757" aria-hidden="true" tabindex="-1"></a><span class="vs">  stroke: #ddd;</span></span>
<span id="cb28-758"><a href="#cb28-758" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-759"><a href="#cb28-759" aria-hidden="true" tabindex="-1"></a><span class="vs">.axis .baseline line {</span></span>
<span id="cb28-760"><a href="#cb28-760" aria-hidden="true" tabindex="-1"></a><span class="vs">  stroke: #555;</span></span>
<span id="cb28-761"><a href="#cb28-761" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-762"><a href="#cb28-762" aria-hidden="true" tabindex="-1"></a><span class="vs">.axis .domain {</span></span>
<span id="cb28-763"><a href="#cb28-763" aria-hidden="true" tabindex="-1"></a><span class="vs">  display: none;</span></span>
<span id="cb28-764"><a href="#cb28-764" aria-hidden="true" tabindex="-1"></a><span class="vs">} </span></span>
<span id="cb28-765"><a href="#cb28-765" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;</span></span>
<span id="cb28-766"><a href="#cb28-766" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css"&gt;</span></span>
<span id="cb28-767"><a href="#cb28-767" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb29" data-startfrom="768" data-source-offset="-299"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 767;"><span id="cb29-768"><a href="#cb29-768" aria-hidden="true" tabindex="-1"></a>viewof bandwidth <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">.</span><span class="bn">01</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {</span>
<span id="cb29-769"><a href="#cb29-769" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Bandweite LOESS (l)"</span><span class="op">,</span></span>
<span id="cb29-770"><a href="#cb29-770" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="op">.</span><span class="bn">01</span><span class="op">,</span></span>
<span id="cb29-771"><a href="#cb29-771" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="op">.</span><span class="dv">28</span></span>
<span id="cb29-772"><a href="#cb29-772" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb29-773"><a href="#cb29-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-774"><a href="#cb29-774" aria-hidden="true" tabindex="-1"></a>xScaleLoess <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb29-775"><a href="#cb29-775" aria-hidden="true" tabindex="-1"></a>   <span class="op">.</span><span class="fu">domain</span>([<span class="op">-.</span><span class="dv">55</span><span class="op">,</span> <span class="op">.</span><span class="dv">55</span>])</span>
<span id="cb29-776"><a href="#cb29-776" aria-hidden="true" tabindex="-1"></a>   <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> innerWidth])<span class="op">;</span></span>
<span id="cb29-777"><a href="#cb29-777" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb29-778"><a href="#cb29-778" aria-hidden="true" tabindex="-1"></a>yScaleLoess <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb29-779"><a href="#cb29-779" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">domain</span>([<span class="op">.</span><span class="dv">2</span><span class="op">,</span> <span class="op">.</span><span class="dv">8</span>])</span>
<span id="cb29-780"><a href="#cb29-780" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">range</span>([innerHeight<span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb29-781"><a href="#cb29-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-782"><a href="#cb29-782" aria-hidden="true" tabindex="-1"></a>lineLoess <span class="op">=</span> d3<span class="op">.</span><span class="fu">line</span>()</span>
<span id="cb29-783"><a href="#cb29-783" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">x</span>(d <span class="kw">=&gt;</span> <span class="fu">xScaleLoess</span>(d[<span class="dv">0</span>]))</span>
<span id="cb29-784"><a href="#cb29-784" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">y</span>(d <span class="kw">=&gt;</span> <span class="fu">yScaleLoess</span>(d[<span class="dv">1</span>]))<span class="op">;</span></span>
<span id="cb29-785"><a href="#cb29-785" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-786"><a href="#cb29-786" aria-hidden="true" tabindex="-1"></a>xAxisLoess <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisBottom</span>(xScaleLoess)</span>
<span id="cb29-787"><a href="#cb29-787" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">tickSize</span>(innerHeight <span class="op">+</span> <span class="dv">10</span>)</span>
<span id="cb29-788"><a href="#cb29-788" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">tickValues</span>([<span class="op">-.</span><span class="dv">5</span><span class="op">,</span> <span class="op">-.</span><span class="dv">25</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="op">.</span><span class="dv">25</span><span class="op">,</span> <span class="op">.</span><span class="dv">5</span>])</span>
<span id="cb29-789"><a href="#cb29-789" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">tickFormat</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb29-790"><a href="#cb29-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-791"><a href="#cb29-791" aria-hidden="true" tabindex="-1"></a>yAxisLoess <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisLeft</span>(yScaleLoess)</span>
<span id="cb29-792"><a href="#cb29-792" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">tickSize</span>(innerWidth <span class="op">+</span> <span class="dv">10</span>)</span>
<span id="cb29-793"><a href="#cb29-793" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">tickValues</span>([<span class="op">.</span><span class="dv">2</span><span class="op">,</span> <span class="op">.</span><span class="dv">35</span><span class="op">,</span> <span class="op">.</span><span class="dv">5</span><span class="op">,</span> <span class="op">.</span><span class="dv">65</span><span class="op">,</span> <span class="op">.</span><span class="dv">8</span>])</span>
<span id="cb29-794"><a href="#cb29-794" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">tickFormat</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb29-795"><a href="#cb29-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-796"><a href="#cb29-796" aria-hidden="true" tabindex="-1"></a>loessRegression <span class="op">=</span> d3<span class="op">.</span><span class="fu">regressionLoess</span>()</span>
<span id="cb29-797"><a href="#cb29-797" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">x</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">StimmenTm1</span>)</span>
<span id="cb29-798"><a href="#cb29-798" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">y</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">StimmenT</span>)</span>
<span id="cb29-799"><a href="#cb29-799" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">bandwidth</span>(bandwidth)<span class="op">;</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-8" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code hidden" id="cb30" data-startfrom="804" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 803;"><span id="cb30-804"><a href="#cb30-804" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb30-805"><a href="#cb30-805" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(DOM<span class="op">.</span><span class="fu">svg</span>(innerWidth <span class="op">+</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">right</span> <span class="op">+</span> <span class="dv">20</span><span class="op">,</span> innerHeight <span class="op">+</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">+</span> <span class="dv">20</span>))</span>
<span id="cb30-806"><a href="#cb30-806" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-807"><a href="#cb30-807" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> g <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb30-808"><a href="#cb30-808" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>margin<span class="op">.</span><span class="at">top</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb30-809"><a href="#cb30-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-810"><a href="#cb30-810" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb30-811"><a href="#cb30-811" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"axis"</span>)</span>
<span id="cb30-812"><a href="#cb30-812" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(xAxisLoess)<span class="op">;</span></span>
<span id="cb30-813"><a href="#cb30-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-814"><a href="#cb30-814" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb30-815"><a href="#cb30-815" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"axis"</span>)</span>
<span id="cb30-816"><a href="#cb30-816" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>innerWidth<span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb30-817"><a href="#cb30-817" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(yAxisLoess)<span class="op">;</span></span>
<span id="cb30-818"><a href="#cb30-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-819"><a href="#cb30-819" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add X axis label:</span></span>
<span id="cb30-820"><a href="#cb30-820" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb30-821"><a href="#cb30-821" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"end"</span>)</span>
<span id="cb30-822"><a href="#cb30-822" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">13</span>)</span>
<span id="cb30-823"><a href="#cb30-823" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> innerWidth)</span>
<span id="cb30-824"><a href="#cb30-824" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> innerHeight <span class="op">+</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> <span class="dv">25</span>)</span>
<span id="cb30-825"><a href="#cb30-825" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Differenz Stimmenanteil Demokraten letzte Wahl zur 50%-Schwelle"</span>)<span class="op">;</span></span>
<span id="cb30-826"><a href="#cb30-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-827"><a href="#cb30-827" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Y axis label:</span></span>
<span id="cb30-828"><a href="#cb30-828" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb30-829"><a href="#cb30-829" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"end"</span>)</span>
<span id="cb30-830"><a href="#cb30-830" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"rotate(-90)"</span>)</span>
<span id="cb30-831"><a href="#cb30-831" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">13</span>)</span>
<span id="cb30-832"><a href="#cb30-832" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="op">-</span>margin<span class="op">.</span><span class="at">left</span><span class="op">+</span><span class="dv">10</span>)</span>
<span id="cb30-833"><a href="#cb30-833" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="op">-</span>margin<span class="op">.</span><span class="at">top</span><span class="op">+</span><span class="dv">10</span>)</span>
<span id="cb30-834"><a href="#cb30-834" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Stimmenanteil Demokraten"</span>)<span class="op">;</span></span>
<span id="cb30-835"><a href="#cb30-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-836"><a href="#cb30-836" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"circle"</span>)</span>
<span id="cb30-837"><a href="#cb30-837" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(<span class="fu">transpose</span>(house_binned))</span>
<span id="cb30-838"><a href="#cb30-838" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()<span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb30-839"><a href="#cb30-839" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb30-840"><a href="#cb30-840" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">xScaleLoess</span>(d<span class="op">.</span><span class="at">StimmenTm1</span>))</span>
<span id="cb30-841"><a href="#cb30-841" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">yScaleLoess</span>(d<span class="op">.</span><span class="at">StimmenT</span>))<span class="op">;</span></span>
<span id="cb30-842"><a href="#cb30-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-843"><a href="#cb30-843" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"circle"</span>)</span>
<span id="cb30-844"><a href="#cb30-844" aria-hidden="true" tabindex="-1"></a>   <span class="op">.</span><span class="fu">filter</span>( <span class="kw">function</span>(d){ <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(d<span class="op">.</span><span class="at">StimmenTm1</span>) <span class="op">&lt;=</span> bandwidth<span class="op">/</span><span class="dv">2</span> } )</span>
<span id="cb30-845"><a href="#cb30-845" aria-hidden="true" tabindex="-1"></a>   <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"orange"</span>)</span>
<span id="cb30-846"><a href="#cb30-846" aria-hidden="true" tabindex="-1"></a>   <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb30-847"><a href="#cb30-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-848"><a href="#cb30-848" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">b</span>(d) { <span class="cf">return</span> <span class="fu">loessRegression</span>(</span>
<span id="cb30-849"><a href="#cb30-849" aria-hidden="true" tabindex="-1"></a>        <span class="fu">transpose</span>(house)<span class="op">.</span><span class="fu">filter</span>(<span class="kw">function</span>(d){ <span class="cf">return</span> d<span class="op">.</span><span class="at">StimmenTm1</span> <span class="op">&lt;=</span> <span class="dv">0</span> <span class="op">&amp;</span> d<span class="op">.</span><span class="at">StimmenTm1</span> <span class="op">&gt;=</span> <span class="op">-.</span><span class="dv">5</span> })</span>
<span id="cb30-850"><a href="#cb30-850" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span> }</span>
<span id="cb30-851"><a href="#cb30-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-852"><a href="#cb30-852" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">a</span>(d) { <span class="cf">return</span> <span class="fu">loessRegression</span>(</span>
<span id="cb30-853"><a href="#cb30-853" aria-hidden="true" tabindex="-1"></a>      <span class="fu">transpose</span>(house)<span class="op">.</span><span class="fu">filter</span>(<span class="kw">function</span>(d){ <span class="cf">return</span> d<span class="op">.</span><span class="at">StimmenTm1</span> <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">&amp;</span> d<span class="op">.</span><span class="at">StimmenTm1</span> <span class="op">&lt;=</span> <span class="op">.</span><span class="dv">5</span>  })</span>
<span id="cb30-854"><a href="#cb30-854" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span> }</span>
<span id="cb30-855"><a href="#cb30-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-856"><a href="#cb30-856" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb30-857"><a href="#cb30-857" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"regression"</span>)</span>
<span id="cb30-858"><a href="#cb30-858" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">datum</span>(b)</span>
<span id="cb30-859"><a href="#cb30-859" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> lineLoess)</span>
<span id="cb30-860"><a href="#cb30-860" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb30-861"><a href="#cb30-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-862"><a href="#cb30-862" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb30-863"><a href="#cb30-863" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"regression"</span>)</span>
<span id="cb30-864"><a href="#cb30-864" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">datum</span>(a)</span>
<span id="cb30-865"><a href="#cb30-865" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> lineLoess)</span>
<span id="cb30-866"><a href="#cb30-866" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb30-867"><a href="#cb30-867" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-868"><a href="#cb30-868" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb30-869"><a href="#cb30-869" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">xScaleLoess</span>(<span class="op">-.</span><span class="dv">24</span>))</span>
<span id="cb30-870"><a href="#cb30-870" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">yScaleLoess</span>(<span class="op">.</span><span class="dv">55</span>))</span>
<span id="cb30-871"><a href="#cb30-871" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">".35em"</span>)</span>
<span id="cb30-872"><a href="#cb30-872" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#39FF14"</span>)</span>
<span id="cb30-873"><a href="#cb30-873" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d3<span class="op">.</span><span class="fu">format</span>(<span class="st">",.2f"</span>)((<span class="fu">a</span>()<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span>))[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">-</span> (<span class="fu">b</span>()<span class="op">.</span><span class="fu">slice</span>(<span class="op">-</span><span class="dv">1</span>))[<span class="dv">0</span>][<span class="dv">1</span>]))<span class="op">;</span></span>
<span id="cb30-874"><a href="#cb30-874" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-875"><a href="#cb30-875" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb30-876"><a href="#cb30-876" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="fu">xScaleLoess</span>(<span class="dv">0</span>))</span>
<span id="cb30-877"><a href="#cb30-877" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="fu">yScaleLoess</span>((<span class="fu">b</span>()<span class="op">.</span><span class="fu">slice</span>(<span class="op">-</span><span class="dv">1</span>))[<span class="dv">0</span>][<span class="dv">1</span>]))</span>
<span id="cb30-878"><a href="#cb30-878" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="fu">xScaleLoess</span>(<span class="dv">0</span>))</span>
<span id="cb30-879"><a href="#cb30-879" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="fu">yScaleLoess</span>((<span class="fu">a</span>()<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span>))[<span class="dv">0</span>][<span class="dv">1</span>]))</span>
<span id="cb30-880"><a href="#cb30-880" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#39FF14"</span>)</span>
<span id="cb30-881"><a href="#cb30-881" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb30-882"><a href="#cb30-882" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-883"><a href="#cb30-883" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* dashed line at cutoff */</span></span>
<span id="cb30-884"><a href="#cb30-884" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb30-885"><a href="#cb30-885" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="fu">xScaleLoess</span>(<span class="dv">0</span>))</span>
<span id="cb30-886"><a href="#cb30-886" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb30-887"><a href="#cb30-887" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="fu">xScaleLoess</span>(<span class="dv">0</span>))</span>
<span id="cb30-888"><a href="#cb30-888" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> innerHeight)</span>
<span id="cb30-889"><a href="#cb30-889" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb30-890"><a href="#cb30-890" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"1"</span>)</span>
<span id="cb30-891"><a href="#cb30-891" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"1"</span>)<span class="op">;</span></span>
<span id="cb30-892"><a href="#cb30-892" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-893"><a href="#cb30-893" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* dashed line data bw upper */</span></span>
<span id="cb30-894"><a href="#cb30-894" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb30-895"><a href="#cb30-895" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="fu">xScaleLoess</span>(bandwidth<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb30-896"><a href="#cb30-896" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb30-897"><a href="#cb30-897" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="fu">xScaleLoess</span>(bandwidth<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb30-898"><a href="#cb30-898" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> innerHeight)</span>
<span id="cb30-899"><a href="#cb30-899" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"blue"</span>)</span>
<span id="cb30-900"><a href="#cb30-900" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"4"</span>)</span>
<span id="cb30-901"><a href="#cb30-901" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"1"</span>)<span class="op">;</span></span>
<span id="cb30-902"><a href="#cb30-902" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-903"><a href="#cb30-903" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* dashed line data bw lower */</span></span>
<span id="cb30-904"><a href="#cb30-904" aria-hidden="true" tabindex="-1"></a>  g<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb30-905"><a href="#cb30-905" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="fu">xScaleLoess</span>(<span class="op">-</span>bandwidth<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb30-906"><a href="#cb30-906" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb30-907"><a href="#cb30-907" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="fu">xScaleLoess</span>(<span class="op">-</span>bandwidth<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb30-908"><a href="#cb30-908" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> innerHeight)</span>
<span id="cb30-909"><a href="#cb30-909" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"blue"</span>)</span>
<span id="cb30-910"><a href="#cb30-910" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"4"</span>)</span>
<span id="cb30-911"><a href="#cb30-911" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"1"</span>)<span class="op">;</span></span>
<span id="cb30-912"><a href="#cb30-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-913"><a href="#cb30-913" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb30-914"><a href="#cb30-914" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-ojs-cell-4" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-ojs-cell-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-4" data-nodetype="expression">

</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-ojs-cell-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;11.7: Nicht-parametrische Regression auf beiden Seiten des Cut-offs.
</figcaption></figure>
</div>
</div>
</section></section><section id="fuzzy-regression-discontinuity-design" class="level2 page-columns page-full" data-number="11.3"><h2 data-number="11.3" class="anchored" data-anchor-id="fuzzy-regression-discontinuity-design">
<span class="header-section-number">11.3</span> Fuzzy Regression Discontinuity Design</h2>
<div class="cell page-columns page-full" data-fig-width="5" data-fig-height="3" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-CDFRDD" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-CDFRDD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<svg width="480" height="288" viewbox="0.00 0.00 360.35 188.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 184)"><polygon fill="white" stroke="transparent" points="-4,4 -4,-184 356.35,-184 356.35,4 -4,4"></polygon><!-- X --><g id="node1" class="node"><title>X</title>
<text text-anchor="middle" x="37.35" y="-157.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">X</text></g><!-- Y --><g id="node2" class="node"><title>Y</title>
<text text-anchor="middle" x="325.35" y="-13.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Y</text></g><!-- X&#45;&gt;Y --><g id="edge2" class="edge"><title>X-&gt;Y</title>
<path fill="none" stroke="black" d="M64.44,-148.45C116.44,-122.45 230.25,-65.55 288.86,-36.24"></path><polygon fill="black" stroke="black" points="290.74,-39.22 298.11,-31.62 287.6,-32.96 290.74,-39.22"></polygon></g><!-- oberhalb c --><g id="node3" class="node"><title>oberhalb c</title>
<text text-anchor="middle" x="37.35" y="-13.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">oberhalb c</text></g><!-- X&#45;&gt;oberhalb c --><g id="edge6" class="edge"><title>X-&gt;oberhalb c</title>
<path fill="none" stroke="black" d="M37.35,-143.76C37.35,-119.2 37.35,-75.25 37.35,-46.35"></path><polygon fill="black" stroke="black" points="40.85,-46.09 37.35,-36.09 33.85,-46.09 40.85,-46.09"></polygon></g><!-- Behandlung --><g id="node5" class="node"><title>Behandlung</title>
<text text-anchor="middle" x="181.35" y="-13.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Behandlung</text></g><!-- X&#45;&gt;Behandlung --><g id="edge3" class="edge"><title>X-&gt;Behandlung</title>
<path fill="none" stroke="black" d="M55.58,-143.76C81.01,-118.34 127.22,-72.13 155.99,-43.36"></path><polygon fill="black" stroke="black" points="158.66,-45.64 163.26,-36.09 153.71,-40.69 158.66,-45.64"></polygon></g><!-- oberhalb c&#45;&gt;Behandlung --><g id="edge7" class="edge"><title>oberhalb c-&gt;Behandlung</title>
<path fill="none" stroke="black" d="M74.81,-18C91.46,-18 111.35,-18 129.41,-18"></path><polygon fill="black" stroke="black" points="129.51,-21.5 139.51,-18 129.51,-14.5 129.51,-21.5"></polygon></g><!-- Z --><g id="node4" class="node"><title>Z</title>
<text text-anchor="middle" x="325.35" y="-157.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Z</text></g><!-- Z&#45;&gt;X --><g id="edge4" class="edge"><title>Z-&gt;X</title>
<path fill="none" stroke="black" d="M298.25,-162C246.58,-162 133.85,-162 74.93,-162"></path><polygon fill="black" stroke="black" points="74.58,-158.5 64.58,-162 74.58,-165.5 74.58,-158.5"></polygon></g><!-- Z&#45;&gt;Y --><g id="edge5" class="edge"><title>Z-&gt;Y</title>
<path fill="none" stroke="black" d="M325.35,-143.76C325.35,-119.2 325.35,-75.25 325.35,-46.35"></path><polygon fill="black" stroke="black" points="328.85,-46.09 325.35,-36.09 321.85,-46.09 328.85,-46.09"></polygon></g><!-- Z&#45;&gt;Behandlung --><g id="edge1" class="edge"><title>Z-&gt;Behandlung</title>
<path fill="none" stroke="black" d="M307.11,-143.76C281.68,-118.34 235.47,-72.13 206.7,-43.36"></path><polygon fill="black" stroke="black" points="208.98,-40.69 199.44,-36.09 204.03,-45.64 208.98,-40.69"></polygon></g><!-- Behandlung&#45;&gt;Y --><g id="edge8" class="edge"><title>Behandlung-&gt;Y</title>
<path fill="none" stroke="black" d="M223.38,-18C243.79,-18 268.11,-18 287.87,-18"></path><polygon fill="black" stroke="black" points="288.04,-21.5 298.04,-18 288.04,-14.5 288.04,-21.5"></polygon></g></g></svg>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-CDFRDD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;11.8: Kausales Diagram für FRDD
</figcaption></figure>
</div>
</div>
</div>
<p>Ein FRDD liegt vor, wenn die Zuweisung der Behandlung <span class="math inline">\(B\)</span> durch die Laufvariable <span class="math inline">\(X\)</span> (und möglicherweise weitere Variablen <span class="math inline">\(Z\)</span>) beeinflusst wird. Im Vergleich zum SRDD ist die Behandlung dann also <em>nicht</em> ausschließlich durch Überschreiten des Schwellenwerts <span class="math inline">\(X = c\)</span> bestimmt.</p>
<p><a href="#fig-CDFRDD" class="quarto-xref">Abbildung&nbsp;<span>11.8</span></a> zeigt den grundsätzlichen Zusammenhang. Hier genügt es weiterhin für <span class="math inline">\(X\)</span> (und ggf. <span class="math inline">\(Z\)</span>) zu kontrollieren, um den Pfad <em>oberhalb <span class="math inline">\(C\)</span> → Behandlung <span class="math inline">\(B\)</span> → <span class="math inline">\(Y\)</span></em> zu isolieren. Der so für <em>Behandlung <span class="math inline">\(B\)</span></em> ermittelte Effekt auf <span class="math inline">\(Y\)</span> entspricht jedoch <em>nicht</em> dem “vollständigen” Behandlungseffekt, da bei <span class="math inline">\(c\)</span> die Zuweisung der Behandlung nicht von <span class="math inline">\(0\)</span> auf <span class="math inline">\(100\%\)</span> springt. Die Schätzung des FRDD berücksichtigt dies und skaliert den geschätzten Effekt entsprechend.</p>
<p>Wir betrachten zunächst den Zusammenhang <span class="math display">\[\begin{align}
  Y_i = \beta_0 + \beta_1 B_i + \beta_2 (X_i - c) + u_i.\label{eq-simpleFRDD}
\end{align}\]</span> In einem FRDD springt die Behandlungswahrscheinlichkeit am Schwellenwert <span class="math inline">\(c\)</span> um <span class="math inline">\(\Delta p&lt;1\)</span>. Wir können <span class="math inline">\(B\)</span> also nicht als deterministische Funktion von <span class="math inline">\(X\)</span>, welche die Zuweisung zu Behandlungs- bzw. Kontrollgruppe am Schwellenwert <span class="math inline">\(c\)</span> anzeigt (wie im SRDD), definieren. Stattdessen betrachten wir <span class="math display">\[\begin{align}
  P(B_i=1\vert X_i) =
  \begin{cases}
    g_{X_i&lt;c}(X_i), &amp; X_i &lt; c \\
    g_{X_i\geq c}(X_i) &amp; X_i \geq c
  \end{cases}\,. \label{eq-BFRDD}
\end{align}\]</span> Die Funktionen <span class="math inline">\(g_{X_i&lt;c}\)</span> und <span class="math inline">\(g_{X_i\geq c}\)</span> können verschieden sein. Es muss jedoch <span class="math display">\[g_{X_i&lt;c}(X_i = c) \neq g_{X_i\geq c}(X_i = c)\]</span> gelten. Die Behandlungsvariable <span class="math inline">\(B_i\)</span> ist im FRDD also eine (binäre) Zufallsvariable, deren bedingte Wahrscheinlichkeitsfunktion <span class="math inline">\(P(B_i=1\vert X_i)\)</span> am Schwellenwert <span class="math inline">\(c\)</span> eine Diskontinuität aufweist. <a href="#fig-FRDDprobD" class="quarto-xref">Abbildung&nbsp;<span>11.9</span></a> zeigt heispielhafte Verläufe nicht-linearer bedingter Wahrscheinlichkeitsfunktion für die Behandlung mit einer Diskontinuität bei <span class="math inline">\(X_i = c\)</span>.</p>
<div class="cell page-columns page-full">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bedingte Behandlungswahrscheinlichkeit im FRDD illustrieren</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span></span>
<span>      <span class="va">.</span> <span class="op">&lt;</span> <span class="fl">0</span>, </span>
<span>      <span class="op">-</span><span class="fl">.1</span> <span class="op">*</span> <span class="va">.</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">.25</span>, </span>
<span>      <span class="op">-</span><span class="fl">.1</span> <span class="op">*</span> <span class="op">(</span><span class="va">.</span><span class="op">-</span><span class="fl">1.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>, </span>
<span>    n <span class="op">=</span> <span class="fl">1000</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span></span>
<span>      <span class="va">.</span> <span class="op">&lt;</span> <span class="fl">0</span>, </span>
<span>     <span class="fl">.35</span>, </span>
<span>     <span class="fl">.65</span></span>
<span>    <span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>    lty <span class="op">=</span> <span class="fl">2</span>, </span>
<span>    col <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Laufvariable X"</span>, </span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    breaks <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"P(D=1|X)"</span>, </span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display page-columns page-full">
<div id="fig-FRDDprobD" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-FRDDprobD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="RDD_files/figure-html/fig-FRDDprobD-1.png" class="img-fluid figure-img" width="288">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-FRDDprobD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;11.9: Bedingte Behandlungswahrscheinlichkeiten im FRDD
</figcaption></figure>
</div>
</div>
</div>
<p>Definition <span class="math inline">\(\eqref{eq-BFRDD}\)</span> bedeutet, dass eine KQ-Schätzung von <span class="math inline">\(\beta_1\)</span> anhand <span class="math inline">\(\eqref{eq-simpleFRDD}\)</span> eine <em>verzerrte</em> Schätzung des Behandlungseffekts ist: Der in <span class="math inline">\(\widehat{\beta}_1\)</span> erfasste Effekt auf <span class="math inline">\(Y\)</span> ist auf einen Sprung der Behandlungswahrscheinlichkeit bei <span class="math inline">\(X_i = c\)</span> um <em>weniger</em> als <span class="math inline">\(100\%\)</span> zurückzuführen. Der wahre Behandlungseffekt wird also <em>unterschätzt</em>. Daher muss <span class="math inline">\(\widehat{\beta}_1\)</span> skaliert werden, sodass die Schätzung als Effekt einer Änderung der Behandlungswahrscheinlichkei um <span class="math inline">\(100\%\)</span> interpretiert werden kann — der erwartete Effekt, wenn ausschließlich Subjekte mit <span class="math inline">\(X_i\geq c\)</span> behandelt würden. Diese skalierte Schätzung erhalten wir mit IV-Regression (vgl. Kapitel XYZ). Hierfür nutzen wir für <span class="math inline">\(B_i\)</span> die Instrumentvariable <span class="math display">\[\begin{align*}
  D_i = \begin{cases}
    0, &amp; X_i &lt; c \\
    1, &amp; X_i \geq c.
  \end{cases}
\end{align*}\]</span></p>
<p>Angenommen <span class="math inline">\(g_{X_i\geq c}(X_i) = \alpha_0\)</span> und <span class="math inline">\(g_{X_i&lt;c}(X_i) = \alpha_0 + \alpha_1\)</span> mit <span class="math inline">\(\alpha_0 + \alpha_1 &lt; 1\)</span> (vgl. rote Funktion in <a href="#fig-CDFRDD" class="quarto-xref">Abbildung&nbsp;<span>11.8</span></a>). Der FRDD-Schätzer des Behandlungseffekts ist dann <span class="math inline">\(\widehat{\gamma}_\textup{FRDD}\)</span> im 2SLS-Verfahren mit den Regressionen <span class="math display">\[\begin{align}
  \begin{split}
  (\mathrm{I})\qquad B_i =&amp;\, \alpha_0 + \alpha_1 D_i + \alpha_2 (X_i - c) + e_i,\\
  (\mathrm{II})\qquad Y_i =&amp;\, \gamma_0 + \gamma_1 \widehat{B}_i + \gamma_2 (X_i - c) + \epsilon_i,
  \end{split}\label{eq:FRDD_simpleIV}
\end{align}\]</span> wobei <span class="math inline">\(\widehat{B}_i\)</span> die angepassten Werte aus Stufe <span class="math inline">\((\mathrm I)\)</span> und <span class="math inline">\(e_i\)</span> sowie <span class="math inline">\(\epsilon_i\)</span> Fehlterterme sind.</p>
<p>Analog zum SRDD müssen in empirischen Anwendungen geeignete Spezifikationen für die Regressionsfunktionen <span class="math inline">\(\eqref{eq-simpleFRDD}\)</span> und <span class="math inline">\(\eqref{eq-BFRDD}\)</span> gewählt und der 2SLS-Schätzer <span class="math inline">\(\eqref{eq:FRDD_simpleIV}\)</span> entsprechend angepasst werden. Ein einfaches Interaktionsmodell wäre <span class="math display">\[\begin{align}
  \begin{split}
  (\mathrm{I})\qquad B_i =&amp;\, \alpha_0 + \alpha_1 D_i + \alpha_2 (X_i - c)\\
  +&amp;\, \alpha_3 (X_i - c) \times D_i + e_i,\\
  \\
  (\mathrm{II})\qquad Y_i =&amp;\, \gamma_0 + \gamma_1 \widehat{B}_i\\
  +&amp;\, \gamma_2 (X_i - c) + \gamma_3 (X_i-c)\times\widehat{B}_i, \epsilon_i
  \end{split},\label{eq:FRDD_lintIV}
\end{align}\]</span> d.h. wir instrumentieren <span class="math inline">\(B_i\)</span> mit <span class="math inline">\(D_i\)</span> und dem Interaktionsterm <span class="math inline">\((X_i-c)\times D_i\)</span>.</p>
<p>Wie im SRDD werden die IV-Ansätze für das FRDD <span class="math inline">\(\eqref{eq:FRDD_simpleIV}\)</span> und <span class="math inline">\(\eqref{eq:FRDD_lintIV}\)</span> in empirischen Studien unter Berücksichtigung einer Bandweite (i.d.R. dieselbe Bandweite für beide Stufen) angewendet.</p>
</section><section id="case-study-protestantische-arbeitsethik" class="level2 page-columns page-full" data-number="11.4"><h2 data-number="11.4" class="anchored" data-anchor-id="case-study-protestantische-arbeitsethik">
<span class="header-section-number">11.4</span> Case Study: Protestantische Arbeitsethik</h2>
<p>Die Studie <em>Beyond Work Ethic: Religion, Individual, and Political Preferences</em> <span class="citation" data-cites="BastenBetz2013">(<a href="Literatur.html#ref-BastenBetz2013" role="doc-biblioref">Basten und Betz 2013</a>)</span> untersucht den Zusammenhang zwischen Religion, individuellen Merkmalen und politischen Präferenzen. Das Hauptaugenmerk ist die Rolle von Religiosität als Einflussfaktor auf politische Einstellungen. Die Hypothese der Autoren ist, dass Religiosität eines Individuums über den traditionellen Rahmen von Moralvorstellungen und sozialen Normen hinaus auch die politischen Präferenzen beeinflusst. Eine entsprechende Theorie wurde zu Beginn des 20. Jahrhunderts entwickelt und prominent von Max Weber <span class="citation" data-cites="Weber2004">(vgl. <a href="Literatur.html#ref-Weber2004" role="doc-biblioref">Weber 2004</a>)</span> vertreten. Weber argumentiert, dass die protestantische Arbeitsethik einen entscheidenden Einfluss auf die Entwicklung des Kapitalismus hatte. Laut Weber führte der protestantische Glaube an harte Arbeit, ein sparsames Leben und ethisches Verhalten zur einer in den damaligen Gesellschaften weit verbreiteten Geisteshaltung, die wirtschaftliches Wachstum förderte und den Aufstieg des Kapitalismus begünstigte.</p>
<p><span class="citation" data-cites="BastenBetz2013">Basten und Betz (<a href="Literatur.html#ref-BastenBetz2013" role="doc-biblioref">2013</a>)</span> nutzen Wahlergebnisse sowie geo- und soziodemographische Datensätze für schweizer Gemeinden, um den Zusammenhang zwischen Religiosität und politischen Präferenzen wie links-rechts-Ausrichtung, Einstellungen zur Umverteilung und Einwanderung zu untersuchen. Hierfür verwenden die Autoren ein FRDD, dass eine historisch bedingte Diskontinuität der geographischen Verteilung von evanglischer bzw. katholischer Religionszugehörigkeit zwischen den Kantonen Freiburg (überwiegend dunkelrote Region, frz. <em>Fribourg</em>) und Waadt (kleinere hellrote Region, frz. <em>Vaud</em>) ausnutzt. Die historische Verteilung der Konfessionen in der betrachteten Region im 16. Jahrhundert durch Abspaltung des Kantons Freiburg ist in <a href="#fig-vaudfb" class="quarto-xref">Abbildung&nbsp;<span>11.10</span></a> dargestellt.</p>
<p>Aufgrund von Bevölkerungsbewegungen ist die Verteilung der Konfessionen zwar nicht mehr eindeutig durch die Kantonsgrenze bestimmt, jedoch sind die Gemeinden der betrachteten Kantone auch heute noch mehrheitlich protestantisch bzw. katholisch. Es ist plausibel, dass eine Prägung gemäß Webers Theorie vorliegt, sich die Gemeinden nahe der Grenz aber hinsichtlich anderer Charakteristika (insb. der Bevölkerungsstruktur) nicht systematisch unterscheiden. Somit liegt ein quai</p>
<div class="cell page-columns page-full" data-layout-align="center" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-vaudfb" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-vaudfb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/WaadtFribourg.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-vaudfb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;11.10: Historische Verteilung von Religionszugehörigkeit in Schweizer Gemeinden im 16. Jahrhundert. Quelle: Basten und Betz (2013).
</figcaption></figure>
</div>
</div>
</div>
<p>Die Ergebnisse der Studie zeigen einen signifikanten Einfluss von Protestantismus auf politische Präferenzen, die über traditionelle Moralvorstellungen hinausgehen: Die Autoren finden Hinweise, dass Einwohner evangelisch geprägter Gemeinden eher konservative soziale und politische Ansichten vertreten. Eine mögliche Erklärung für diesen Effekt ist, dass religiöse Institutionen auch eine soziale und politische Agenda verfolgen, die von den Gläubigen internalisiert wird.</p>
<section id="aufbereitung-der-daten" class="level3 page-columns page-full" data-number="11.4.1"><h3 data-number="11.4.1" class="anchored" data-anchor-id="aufbereitung-der-daten">
<span class="header-section-number">11.4.1</span> Aufbereitung der Daten</h3>
<p>In diesem Kapitel zeigen wir, wie die Kernergebnisse der Studie mit R reproduziert werden können. Hierfür werden folgende Pakete benötigt.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://haven.tidyverse.org">haven</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://nickch-k.github.io/vtable/">vtable</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rdrobust</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Das Papier sowie der Datensatz <code>BastenBetz.dta</code> sind auf der <a href="https://www.aeaweb.org/articles?id=10.1257/pol.5.3.67">Übersichtsseite der AEA</a> verfügbar und liegt im STATA-Format <code>.dta</code> vor.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;Siehe alternativ das <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2133848">working paper</a>, falls kein Abbonement für AEA-Journals vorliegt.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Datensatz einlesen</span></span>
<span><span class="va">BastenBetz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://haven.tidyverse.org/reference/read_dta.html">read_dta</a></span><span class="op">(</span><span class="st">'BastenBetz.dta'</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Der Datensatz <code>BastenBetz</code> enthält Beobachtungen zu 509 schweizer Gemeinden. Eine Vielzahl an Variablen ist lediglich für Robustheits-Checks relevant. Für die Reproduktion der Kernergebnisse erstellen wir zunächst einen reduzierten Datensatz und transformieren einige Variablen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Reduzierten Datensatz erstellen</span></span>
<span><span class="va">BastenBetz</span> <span class="op">&lt;-</span> <span class="va">BastenBetz</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/transmute.html">transmute</a></span><span class="op">(</span></span>
<span>    gini <span class="op">=</span> <span class="va">Ecoplan_gini</span>,</span>
<span>    prot <span class="op">=</span> <span class="va">prot1980s</span>,</span>
<span>    bord <span class="op">=</span> <span class="va">borderdis</span>, </span>
<span>    <span class="va">vaud</span>,</span>
<span>    <span class="va">pfl</span>, </span>
<span>    <span class="va">pfr</span>, </span>
<span>    <span class="va">pfi</span></span>
<span>  <span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Die Definitionen der Variablen sind in <a href="#tbl-BastenBetzRed" class="quarto-xref">Tabelle&nbsp;<span>11.2</span></a> gegeben. Die Präferenzen <code>pfl</code>, <code>pfr</code> und <code>pfi</code> basieren auf Wahlergebnissen auf Gemeindeebene zu Volksentscheiden.</p>
<div id="tbl-BastenBetzRed" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><div aria-describedby="tbl-BastenBetzRed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 18%">
<col style="width: 81%">
</colgroup>
<thead><tr class="header">
<th>Variable</th>
<th>Definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>prot</code></td>
<td>Anteil Prothestanten im Jahr 1980 (%)</td>
</tr>
<tr class="even">
<td><code>gini</code></td>
<td>Gini-Koeffizient</td>
</tr>
<tr class="odd">
<td><code>bord</code></td>
<td>Laufdistanz zur Kantonsgrenze (Km)</td>
</tr>
<tr class="even">
<td><code>vaud</code></td>
<td>Dummyvariable: Gemeine im Kanton Waadt</td>
</tr>
<tr class="odd">
<td><code>pfl</code></td>
<td>Präferenz für Freizeit (%)</td>
</tr>
<tr class="even">
<td><code>pfr</code></td>
<td>Präferenz für Umverteilung (%)</td>
</tr>
<tr class="odd">
<td><code>pfi</code></td>
<td>Präferenz für wirtschaftliche Intervention des Staats (%)</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-BastenBetzRed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;11.2: <code>BastenBetz</code> – Variablen und Definitionen
</figcaption></figure>
</div>
<p>Für die Berechnung der optimalen Bandweite des FRDD verwenden wir einen MSE-optimalen Schätzer, der in der Funktion <code><a href="https://rdrr.io/pkg/rdrobust/man/rdbwselect.html">rdrobust::rdbwselect()</a></code> implementiert ist.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;<span class="citation" data-cites="BastenBetz2013">Basten und Betz (<a href="Literatur.html#ref-BastenBetz2013" role="doc-biblioref">2013</a>)</span> setzen BW = 5.01, den Durchschnitt von IK-Schätzungen über Modelle sämtlicher betrachteter Outcome-Variablen. Diese Bandweite liegt nahe des Ergebnisses von <code>rdbwselect</code>. Wir verwenden nachfolgend die Schätzung <code>OB</code>.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Bandweite schätzen (Bsp. für Freizeitpräferenz)</span></span>
<span><span class="va">bw_selection</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rdrobust/man/rdbwselect.html">rdbwselect</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="va">BastenBetz</span><span class="op">$</span><span class="va">pfl</span>,</span>
<span>  x <span class="op">=</span> <span class="va">BastenBetz</span><span class="op">$</span><span class="va">bord</span>,</span>
<span>  fuzzy <span class="op">=</span> <span class="va">BastenBetz</span><span class="op">$</span><span class="va">prot</span>, </span>
<span>  bwselect <span class="op">=</span> <span class="st">"mserd"</span>, </span>
<span>  kernel <span class="op">=</span> <span class="st">"uniform"</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Bandweite auslesen und zuweisen</span></span>
<span><span class="op">(</span><span class="va">OB</span> <span class="op">&lt;-</span> <span class="va">bw_selection</span><span class="op">$</span><span class="va">bws</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.078001</code></pre>
</div>
</div>
</section><section id="deskriptive-statistiken" class="level3 page-columns page-full" data-number="11.4.2"><h3 data-number="11.4.2" class="anchored" data-anchor-id="deskriptive-statistiken">
<span class="header-section-number">11.4.2</span> Deskriptive Statistiken</h3>
<p>Zur Reproduktion von Tabelle 1 aus <span class="citation" data-cites="BastenBetz2013">Basten und Betz (<a href="Literatur.html#ref-BastenBetz2013" role="doc-biblioref">2013</a>)</span> erzeugen wir eine nach Kantonen gruppierte Zusammenfassung der Daten und berechnen deskriptive Statistiken. Wie im Paper berücksichtigen wir hierbei nur Gemeinden innerhalb der geschätzten optimalen Bandweite <code>OB</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Datensatz für Reproduktion von Table 1 formatieren</span></span>
<span><span class="va">T1</span> <span class="op">&lt;-</span> <span class="va">BastenBetz</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">bord</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">OB</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    vaud <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span></span>
<span>      test <span class="op">=</span> <span class="va">vaud</span> <span class="op">==</span> <span class="fl">1</span>, </span>
<span>      yes <span class="op">=</span> <span class="st">"Waadt"</span>, </span>
<span>      no <span class="op">=</span> <span class="st">"Freiburg"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    prot <span class="op">=</span> <span class="va">prot</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">vaud</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        Mean <span class="op">=</span> <span class="va">mean</span>, </span>
<span>        SD <span class="op">=</span> <span class="va">sd</span>, </span>
<span>        N <span class="op">=</span> <span class="va">length</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="op">-</span><span class="va">vaud</span>,</span>
<span>    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"variable"</span>, <span class="st">"statistic"</span><span class="op">)</span>, </span>
<span>    names_sep <span class="op">=</span> <span class="st">"_"</span></span>
<span>  <span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Für die tabellarische Darstellung transformieren wir in ein weites Format, sodass die Tabelle die deskriptive Statistiken spaltenweise für die Kantone zeigt.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Daten in weites Format überführen</span></span>
<span><span class="va">T1_wider</span> <span class="op">&lt;-</span> <span class="va">T1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"vaud"</span>, <span class="st">"statistic"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Die Tabelle erzeugen wir mit <code><a href="https://gt.rstudio.com/reference/gt.html">gt::gt()</a></code>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Tabelle mit gt() erzeugen</span></span>
<span><span class="va">T1_wider</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">gt</span><span class="op">(</span>rowname_col <span class="op">=</span> <span class="st">"Variable"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tab_spanner_delim</span><span class="op">(</span></span>
<span>    delim <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span> <span class="va">tabopts</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-sumstat" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><div aria-describedby="tbl-sumstat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="vwnpzbkelk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vwnpzbkelk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vwnpzbkelk thead, #vwnpzbkelk tbody, #vwnpzbkelk tfoot, #vwnpzbkelk tr, #vwnpzbkelk td, #vwnpzbkelk th {
  border-style: none;
}

#vwnpzbkelk p {
  margin: 0;
  padding: 0;
}

#vwnpzbkelk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #000000;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vwnpzbkelk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vwnpzbkelk .gt_title {
  color: #000000;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vwnpzbkelk .gt_subtitle {
  color: #000000;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vwnpzbkelk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vwnpzbkelk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vwnpzbkelk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vwnpzbkelk .gt_col_heading {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vwnpzbkelk .gt_column_spanner_outer {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vwnpzbkelk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vwnpzbkelk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vwnpzbkelk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vwnpzbkelk .gt_spanner_row {
  border-bottom-style: hidden;
}

#vwnpzbkelk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vwnpzbkelk .gt_empty_group_heading {
  padding: 0.5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vwnpzbkelk .gt_from_md > :first-child {
  margin-top: 0;
}

#vwnpzbkelk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vwnpzbkelk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vwnpzbkelk .gt_stub {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vwnpzbkelk .gt_stub_row_group {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vwnpzbkelk .gt_row_group_first td {
  border-top-width: 2px;
}

#vwnpzbkelk .gt_row_group_first th {
  border-top-width: 2px;
}

#vwnpzbkelk .gt_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vwnpzbkelk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vwnpzbkelk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vwnpzbkelk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vwnpzbkelk .gt_grand_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vwnpzbkelk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vwnpzbkelk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vwnpzbkelk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vwnpzbkelk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#vwnpzbkelk .gt_footnotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vwnpzbkelk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vwnpzbkelk .gt_sourcenotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vwnpzbkelk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vwnpzbkelk .gt_left {
  text-align: left;
}

#vwnpzbkelk .gt_center {
  text-align: center;
}

#vwnpzbkelk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vwnpzbkelk .gt_font_normal {
  font-weight: normal;
}

#vwnpzbkelk .gt_font_bold {
  font-weight: bold;
}

#vwnpzbkelk .gt_font_italic {
  font-style: italic;
}

#vwnpzbkelk .gt_super {
  font-size: 65%;
}

#vwnpzbkelk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vwnpzbkelk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vwnpzbkelk .gt_indent_1 {
  text-indent: 5px;
}

#vwnpzbkelk .gt_indent_2 {
  text-indent: 10px;
}

#vwnpzbkelk .gt_indent_3 {
  text-indent: 15px;
}

#vwnpzbkelk .gt_indent_4 {
  text-indent: 20px;
}

#vwnpzbkelk .gt_indent_5 {
  text-indent: 25px;
}

#vwnpzbkelk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vwnpzbkelk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" id="variable" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">variable</th>
<th colspan="3" id="Freiburg" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">Freiburg</span></th>
<th colspan="3" id="Waadt" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">Waadt</span></th>
</tr>
<tr class="odd gt_col_headings">
<th id="Mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mean</th>
<th id="SD" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">SD</th>
<th id="N" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">N</th>
<th id="Mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mean</th>
<th id="SD" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">SD</th>
<th id="N" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">N</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="variable">gini</td>
<td class="gt_row gt_right" headers="Freiburg_Mean">0.302</td>
<td class="gt_row gt_right" headers="Freiburg_SD">0.029</td>
<td class="gt_row gt_right" headers="Freiburg_N">49</td>
<td class="gt_row gt_right" headers="Waadt_Mean">0.367</td>
<td class="gt_row gt_right" headers="Waadt_SD">0.052</td>
<td class="gt_row gt_right" headers="Waadt_N">84</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">prot</td>
<td class="gt_row gt_right" headers="Freiburg_Mean">9.428</td>
<td class="gt_row gt_right" headers="Freiburg_SD">5.695</td>
<td class="gt_row gt_right" headers="Freiburg_N">49</td>
<td class="gt_row gt_right" headers="Waadt_Mean">83.245</td>
<td class="gt_row gt_right" headers="Waadt_SD">11.411</td>
<td class="gt_row gt_right" headers="Waadt_N">84</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">bord</td>
<td class="gt_row gt_right" headers="Freiburg_Mean">−2.327</td>
<td class="gt_row gt_right" headers="Freiburg_SD">1.274</td>
<td class="gt_row gt_right" headers="Freiburg_N">49</td>
<td class="gt_row gt_right" headers="Waadt_Mean">2.493</td>
<td class="gt_row gt_right" headers="Waadt_SD">1.201</td>
<td class="gt_row gt_right" headers="Waadt_N">84</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">pfl</td>
<td class="gt_row gt_right" headers="Freiburg_Mean">48.239</td>
<td class="gt_row gt_right" headers="Freiburg_SD">4.774</td>
<td class="gt_row gt_right" headers="Freiburg_N">49</td>
<td class="gt_row gt_right" headers="Waadt_Mean">39.508</td>
<td class="gt_row gt_right" headers="Waadt_SD">5.723</td>
<td class="gt_row gt_right" headers="Waadt_N">84</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">pfr</td>
<td class="gt_row gt_right" headers="Freiburg_Mean">43.049</td>
<td class="gt_row gt_right" headers="Freiburg_SD">2.634</td>
<td class="gt_row gt_right" headers="Freiburg_N">49</td>
<td class="gt_row gt_right" headers="Waadt_Mean">39.19</td>
<td class="gt_row gt_right" headers="Waadt_SD">5.025</td>
<td class="gt_row gt_right" headers="Waadt_N">84</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">pfi</td>
<td class="gt_row gt_right" headers="Freiburg_Mean">52.642</td>
<td class="gt_row gt_right" headers="Freiburg_SD">2.94</td>
<td class="gt_row gt_right" headers="Freiburg_N">49</td>
<td class="gt_row gt_right" headers="Waadt_Mean">47.086</td>
<td class="gt_row gt_right" headers="Waadt_SD">3.368</td>
<td class="gt_row gt_right" headers="Waadt_N">84</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-sumstat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;11.3: Datensatz <code>BastenBetz</code> – Zusammenfassende Statistiken
</figcaption></figure>
</div>
</div>
<p>Die Statistiken in <a href="#tbl-sumstat" class="quarto-xref">Tabelle&nbsp;<span>11.3</span></a> scheinen konsistent mit der (historischen) Verteilung der Religionszugehörigkeit und politischen Einstellung gemäß der Hypothese: Im überwiegend katholischen Freiburg finden wir eine größere Einkommensungleichkeit und höhere aus Wahlergebnissen abgeleitete Präferenzen für Freizeit, Umverteilung sowie staatliche Interventionen.</p>
</section><section id="modellspezifikation-und-first-stage-ergebnisse" class="level3 page-columns page-full" data-number="11.4.3"><h3 data-number="11.4.3" class="anchored" data-anchor-id="modellspezifikation-und-first-stage-ergebnisse">
<span class="header-section-number">11.4.3</span> Modellspezifikation und First-Stage-Ergebnisse</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">CJM_BB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rddensity/man/rddensity.html">rddensity</a></span><span class="op">(</span><span class="va">BastenBetz</span><span class="op">$</span><span class="va">bord</span>, c <span class="op">=</span> <span class="fl">0</span>, kernel <span class="op">=</span> <span class="st">"epanechnikov"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">CJM_BB</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Manipulation testing using local polynomial density estimation.

Number of obs =       509
Model =               unrestricted
Kernel =              epanechnikov
BW method =           estimated
VCE method =          jackknife

c = 0                 Left of c           Right of c          
Number of obs         127                 382                 
Eff. Number of obs    69                  124                 
Order est. (p)        2                   2                   
Order bias (q)        3                   3                   
BW est. (h)           8.531               9.57                

Method                T                   P &gt; |T|             
Robust                0.7552              0.4501              


P-values of binomial tests (H0: p=0.5).

Window Length              &lt;c     &gt;=c    P&gt;|T|
1.400     + 1.400          20      20    1.0000
2.192     + 2.308          27      47    0.0265
2.985     + 3.215          34      60    0.0095
3.777     + 4.123          40      72    0.0032
4.570     + 5.031          44      84    0.0005
5.362     + 5.939          51      95    0.0003
6.154     + 6.846          56     100    0.0005
6.947     + 7.754          60     106    0.0004
7.739     + 8.662          67     114    0.0006
8.531     + 9.570          69     124    0.0001</code></pre>
</div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># CJM-Plot</span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rddensity/man/rdplotdensity.html">rdplotdensity</a></span><span class="op">(</span></span>
<span>  rdd <span class="op">=</span> <span class="va">CJM_BB</span>,</span>
<span>  X <span class="op">=</span> <span class="va">BastenBetz</span><span class="op">$</span><span class="va">bord</span>, </span>
<span>  type <span class="op">=</span> <span class="st">"both"</span>, plotN <span class="op">=</span> <span class="fl">20</span>, </span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="RDD_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Die Kantone Waadt und Freiburg haben bis heute mehrheitlich protestantische bzw. katholische Gemeinden. Die Verteilung von Protestantismus ist also, u.a. aufgrund von Bevölkerungsbewegungen, nicht mehr deterministisch. An der Kantonsgrenze besteht jedoch eine deutliche Diskontinuität im Anteil protestantischer Einwohner, die auf die historische Verteilung der Religionszugehörigkeit zurückzuführen ist. Damit kann ein FRDD implementiert werden, bei dem die Distanz zur Grenze (<code>bord</code>) die zentrierte Laufvariable ist und die Zugehörigkeit zum Kanton Waadt (<code>vaud</code>) ein Instrument für die Behandlungsvariable (<code>prot</code>) ist.</p>
<p>Wir nutzen die Funktion <code><a href="https://rdrr.io/pkg/rdrobust/man/rdplot.html">rdrobust::rdplot</a></code> um diesen Zusammenhang für verschiedene Bandweiten anhand des linearen Interaktionsmodells <span class="math display">\[\begin{align}
  \begin{split}
  prot_i =&amp;\, \alpha_0 + \alpha_1 vaud_i + \alpha_2 bord_i \\
  +&amp;\, \alpha_3 bord_i \times vaud_i + u_i
  \end{split}\label{eq:BBFSR}
\end{align}\]</span> grafisch darzustellen. Dies ist die First-Stage-Regression für die 2SLS-Schätzung der Behandlungseffekte.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Reproduktion von Abbildung 3 in Basten und Betz (2013)</span></span>
<span><span class="va">plots_BB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="co"># gesch. optimale Bandweite</span></span>
<span>  p_OB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/rdrobust/man/rdplot.html">rdplot</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">BastenBetz</span><span class="op">$</span><span class="va">prot</span>, </span>
<span>    x <span class="op">=</span> <span class="va">BastenBetz</span><span class="op">$</span><span class="va">bord</span>, </span>
<span>    h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">OB</span>, <span class="va">OB</span><span class="op">)</span>, </span>
<span>    x.label <span class="op">=</span> <span class="st">"Distanz zur Grenze (bord)"</span>,</span>
<span>    y.label <span class="op">=</span> <span class="st">"Anteil Protestanten (prot)"</span>, </span>
<span>    title <span class="op">=</span> <span class="st">"Gesch. Bandweite"</span>,</span>
<span>    p <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    nbins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">14</span><span class="op">)</span>, </span>
<span>    masspoints <span class="op">=</span> <span class="st">"off"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co"># Bandweite 10</span></span>
<span>  p_BW10 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/rdrobust/man/rdplot.html">rdplot</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">BastenBetz</span><span class="op">$</span><span class="va">prot</span>, </span>
<span>    x <span class="op">=</span> <span class="va">BastenBetz</span><span class="op">$</span><span class="va">bord</span>, </span>
<span>    h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, </span>
<span>    x.label <span class="op">=</span> <span class="st">"Distanz zur Grenze (bord)"</span>,</span>
<span>    y.label <span class="op">=</span> <span class="st">"Anteil Protestanten  (prot)"</span>, </span>
<span>    title <span class="op">=</span> <span class="st">"Bandweite = 10"</span>,</span>
<span>    p <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    nbins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>    masspoints <span class="op">=</span> <span class="st">"off"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co"># Bandweite 20</span></span>
<span>  p_BW20 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/rdrobust/man/rdplot.html">rdplot</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">BastenBetz</span><span class="op">$</span><span class="va">prot</span>, </span>
<span>    x <span class="op">=</span> <span class="va">BastenBetz</span><span class="op">$</span><span class="va">bord</span>, </span>
<span>    h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span>, </span>
<span>    x.label <span class="op">=</span> <span class="st">"Distanz zur Grenze (bord)"</span>,</span>
<span>    y.label <span class="op">=</span> <span class="st">"Anteil Protestanten  (prot)"</span>, </span>
<span>    title <span class="op">=</span> <span class="st">"Bandweite = 20"</span>,</span>
<span>    p <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    nbins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>    masspoints <span class="op">=</span> <span class="st">"off"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co"># Gesamter Datensatz</span></span>
<span>  p_G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/rdrobust/man/rdplot.html">rdplot</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">BastenBetz</span><span class="op">$</span><span class="va">prot</span>, </span>
<span>    x <span class="op">=</span> <span class="va">BastenBetz</span><span class="op">$</span><span class="va">bord</span>,</span>
<span>    x.label <span class="op">=</span> <span class="st">"Distanz zur Grenze (bord)"</span>,</span>
<span>    y.label <span class="op">=</span> <span class="st">"Anteil Protestanten"</span>, </span>
<span>    title <span class="op">=</span> <span class="st">"Ges. Datensatz"</span>,</span>
<span>    p <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    nbins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>    masspoints <span class="op">=</span> <span class="st">"off"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir sammeln die Ergebnisse in einem Plot-Gitter mit <code><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">cowplot::plot_grid()</a></code>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode" id="cb44" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Reproduktion von Abbildung 3 in Basten und Betz (2013)</span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span></span>
<span>  plotlist <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">plots_BB</span>, <span class="op">~</span> <span class="va">.</span><span class="op">$</span><span class="va">rdplot</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-BastenBetzFS" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-BastenBetzFS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="RDD_files/figure-html/fig-BastenBetzFS-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-BastenBetzFS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;11.11: First-Stage-Regressionen
</figcaption></figure>
</div>
</div>
</div>
<p>Die Grafiken in <a href="#fig-BastenBetzFS" class="quarto-xref">Abbildung&nbsp;<span>11.11</span></a> zeigen deutliche Hinweise auf die Diskontinuität in <code>prot</code> nahe der Kantonsgrenze. Die Größe des geschätzten Sprungs scheint nur wenig sensitiv gegenüber der gewählten Bandweite zu sein. Die Signifikanz des Effekts können wir anhand der jeweiligen KQ-Regressionen beurteilen.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>&nbsp;Wir nutzen <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> um die Regression mit weniger Code für verschiedene Bandweiten zu schätzen.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Reproduktion der First-Stage-Regressionen</span></span>
<span><span class="co"># s. Tabelle 2 in Basten und Betz (2013)</span></span>
<span></span>
<span><span class="co"># (1) BW = OB</span></span>
<span><span class="va">FS1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">prot</span> <span class="op">~</span> <span class="va">vaud</span> <span class="op">+</span> <span class="va">bord</span> <span class="op">+</span> <span class="va">vaud</span> <span class="op">*</span> <span class="va">bord</span>, </span>
<span>  data <span class="op">=</span> <span class="va">BastenBetz</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">bord</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="va">OB</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (2) BW = 10</span></span>
<span><span class="va">FS2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span></span>
<span>  <span class="va">FS1</span>,</span>
<span>  data <span class="op">=</span> <span class="va">BastenBetz</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">bord</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">10</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (3) BW = 20</span></span>
<span><span class="va">FS3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span></span>
<span>  <span class="va">FS1</span>,</span>
<span>  data <span class="op">=</span> <span class="va">BastenBetz</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">bord</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">20</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (4) Ges. Datensatz</span></span>
<span><span class="va">FS4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">FS1</span>,</span>
<span>  data <span class="op">=</span> <span class="va">BastenBetz</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Tabellarische Darstellung</span></span>
<span><span class="fu"><a href="https://modelsummary.com/man/modelsummary.html">modelsummary</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"BW = OB"</span><span class="op">=</span> <span class="va">FS1</span>, </span>
<span>    <span class="st">"BW = 10"</span> <span class="op">=</span> <span class="va">FS2</span>, </span>
<span>    <span class="st">"BW=20"</span> <span class="op">=</span> <span class="va">FS3</span>, </span>
<span>    <span class="st">"Ges. Datensatz"</span> <span class="op">=</span> <span class="va">FS4</span></span>
<span>  <span class="op">)</span>, </span>
<span>  vcov <span class="op">=</span> <span class="st">"HC1"</span>, </span>
<span>  stars <span class="op">=</span> <span class="cn">T</span>, </span>
<span>  gof_map <span class="op">=</span> <span class="st">"nobs"</span>, </span>
<span>  output <span class="op">=</span> <span class="st">"gt"</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tabopts</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-BastenBetzFS" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><div aria-describedby="tbl-BastenBetzFS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="aoarlwszxn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#aoarlwszxn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#aoarlwszxn thead, #aoarlwszxn tbody, #aoarlwszxn tfoot, #aoarlwszxn tr, #aoarlwszxn td, #aoarlwszxn th {
  border-style: none;
}

#aoarlwszxn p {
  margin: 0;
  padding: 0;
}

#aoarlwszxn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #000000;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#aoarlwszxn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#aoarlwszxn .gt_title {
  color: #000000;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#aoarlwszxn .gt_subtitle {
  color: #000000;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#aoarlwszxn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aoarlwszxn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aoarlwszxn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aoarlwszxn .gt_col_heading {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#aoarlwszxn .gt_column_spanner_outer {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#aoarlwszxn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#aoarlwszxn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#aoarlwszxn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#aoarlwszxn .gt_spanner_row {
  border-bottom-style: hidden;
}

#aoarlwszxn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#aoarlwszxn .gt_empty_group_heading {
  padding: 0.5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#aoarlwszxn .gt_from_md > :first-child {
  margin-top: 0;
}

#aoarlwszxn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#aoarlwszxn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#aoarlwszxn .gt_stub {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#aoarlwszxn .gt_stub_row_group {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#aoarlwszxn .gt_row_group_first td {
  border-top-width: 2px;
}

#aoarlwszxn .gt_row_group_first th {
  border-top-width: 2px;
}

#aoarlwszxn .gt_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aoarlwszxn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#aoarlwszxn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#aoarlwszxn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aoarlwszxn .gt_grand_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aoarlwszxn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#aoarlwszxn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#aoarlwszxn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#aoarlwszxn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#aoarlwszxn .gt_footnotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aoarlwszxn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aoarlwszxn .gt_sourcenotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aoarlwszxn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aoarlwszxn .gt_left {
  text-align: left;
}

#aoarlwszxn .gt_center {
  text-align: center;
}

#aoarlwszxn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#aoarlwszxn .gt_font_normal {
  font-weight: normal;
}

#aoarlwszxn .gt_font_bold {
  font-weight: bold;
}

#aoarlwszxn .gt_font_italic {
  font-style: italic;
}

#aoarlwszxn .gt_super {
  font-size: 65%;
}

#aoarlwszxn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#aoarlwszxn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#aoarlwszxn .gt_indent_1 {
  text-indent: 5px;
}

#aoarlwszxn .gt_indent_2 {
  text-indent: 10px;
}

#aoarlwszxn .gt_indent_3 {
  text-indent: 15px;
}

#aoarlwszxn .gt_indent_4 {
  text-indent: 20px;
}

#aoarlwszxn .gt_indent_5 {
  text-indent: 25px;
}

#aoarlwszxn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#aoarlwszxn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id=" " class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="BW = OB" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">BW = OB</th>
<th id="BW = 10" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">BW = 10</th>
<th id="BW=20" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">BW=20</th>
<th id="Ges. Datensatz" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Ges. Datensatz</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=" ">(Intercept)</td>
<td class="gt_row gt_center" headers="BW = OB">0.134***</td>
<td class="gt_row gt_center" headers="BW = 10">0.100***</td>
<td class="gt_row gt_center" headers="BW=20">0.103***</td>
<td class="gt_row gt_center" headers="Ges. Datensatz">0.109***</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="BW = OB">(0.017)</td>
<td class="gt_row gt_center" headers="BW = 10">(0.013)</td>
<td class="gt_row gt_center" headers="BW=20">(0.010)</td>
<td class="gt_row gt_center" headers="Ges. Datensatz">(0.009)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">vaud</td>
<td class="gt_row gt_center" headers="BW = OB">0.671***</td>
<td class="gt_row gt_center" headers="BW = 10">0.726***</td>
<td class="gt_row gt_center" headers="BW=20">0.756***</td>
<td class="gt_row gt_center" headers="Ges. Datensatz">0.710***</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="BW = OB">(0.034)</td>
<td class="gt_row gt_center" headers="BW = 10">(0.022)</td>
<td class="gt_row gt_center" headers="BW=20">(0.018)</td>
<td class="gt_row gt_center" headers="Ges. Datensatz">(0.014)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">bord</td>
<td class="gt_row gt_center" headers="BW = OB">0.017**</td>
<td class="gt_row gt_center" headers="BW = 10">0.001</td>
<td class="gt_row gt_center" headers="BW=20">0.001</td>
<td class="gt_row gt_center" headers="Ges. Datensatz">0.002*</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="BW = OB">(0.006)</td>
<td class="gt_row gt_center" headers="BW = 10">(0.003)</td>
<td class="gt_row gt_center" headers="BW=20">(0.001)</td>
<td class="gt_row gt_center" headers="Ges. Datensatz">(0.001)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">vaud × bord</td>
<td class="gt_row gt_center" headers="BW = OB">-0.006</td>
<td class="gt_row gt_center" headers="BW = 10">-0.001</td>
<td class="gt_row gt_center" headers="BW=20">-0.009***</td>
<td class="gt_row gt_center" headers="Ges. Datensatz">-0.004***</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" " style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000"></td>
<td class="gt_row gt_center" headers="BW = OB" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000">(0.012)</td>
<td class="gt_row gt_center" headers="BW = 10" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000">(0.005)</td>
<td class="gt_row gt_center" headers="BW=20" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000">(0.003)</td>
<td class="gt_row gt_center" headers="Ges. Datensatz" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000">(0.001)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">Num.Obs.</td>
<td class="gt_row gt_center" headers="BW = OB">133</td>
<td class="gt_row gt_center" headers="BW = 10">207</td>
<td class="gt_row gt_center" headers="BW=20">312</td>
<td class="gt_row gt_center" headers="Ges. Datensatz">509</td>
</tr>
</tbody>
<tfoot class="gt_sourcenotes"><tr class="even">
<td colspan="5" class="gt_sourcenote">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-BastenBetzFS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;11.4: First-Stage-Regressionen
</figcaption></figure>
</div>
</div>
<p>Für die geschätze Bandweite schätzen wir einen hochsignifikanten Sprung in <code>prot</code> von etwa 67% an der Kantonsgrenze. Auch für größere Bandweiten von 10km und 20km sowie für den gesamten Datensatz finden wir vergleichbare signifikante Effekte, was eine bei zunehmender Distanz zur Grenze persistente Diskrepanz der Religionszugehörigkeit bestätigt.</p>
</section><section id="second-stage-ergebnisse" class="level3 page-columns page-full" data-number="11.4.4"><h3 data-number="11.4.4" class="anchored" data-anchor-id="second-stage-ergebnisse">
<span class="header-section-number">11.4.4</span> Second-Stage-Ergebnisse</h3>
<p>Wir schätzen nun den LATE von Protestantismus für die Outcome-Variablen <code>gini</code>, <code>pfl</code>, <code>pfi</code> und <code>pfr</code>, vgl. <a href="#tbl-BastenBetzRed" class="quarto-xref">Tabelle&nbsp;<span>11.2</span></a>. Die Spezifikation für die Second-Stage-Regression der FRDD-Schätzung ist <span class="math display">\[\begin{align}
  \begin{split}
    Y_i = \gamma_0 + \gamma_1 \widehat{prot}_i +  \gamma_2 bord_i + \gamma_3 bord_i  \times vaud_i + e_i
  \end{split},
\end{align}\]</span> wobei <span class="math inline">\(\widehat{prot}_i\)</span> angepasste Werte aus der KQ-Schätzung von <span class="math inline">\(\eqref{eq:BBFSR}\)</span> mit Bandweite <code>OB</code> sind. Dazu erzeugen wir zunächst eine angepasste Version des Objekts <code>BastenBetz</code>, welche nur Gemeinden innerhalb der Bandweite enthält.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Gemeinden innerhalb der Bandweite filtern</span></span>
<span><span class="va">BastenBetz_OB</span> <span class="op">&lt;-</span> <span class="va">BastenBetz</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">bord</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="va">OB</span></span>
<span>  <span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Zur Illustration schätzen wir nun die Second-Stage-Regression für <span class="math inline">\(Y = pfl\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Second-Stage-Regression für `pfl`</span></span>
<span><span class="va">BastenBetz_OB</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    prot_fitted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">FS1</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">pfl</span> <span class="op">~</span> <span class="va">prot_fitted</span> <span class="op">+</span> <span class="va">bord</span> <span class="op">+</span> <span class="va">vaud</span><span class="op">:</span><span class="va">bord</span>, </span>
<span>  data <span class="op">=</span> <span class="va">.</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = pfl ~ prot_fitted + bord + vaud:bord, data = .)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.8870  -3.8621  -0.0423   3.4993  12.1636 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  50.5275     1.9721  25.621  &lt; 2e-16 ***
prot_fitted -13.4600     3.1749  -4.240 4.24e-05 ***
bord          0.4380     0.6528   0.671    0.503    
bord:vaud    -0.3636     0.7939  -0.458    0.648    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.433 on 129 degrees of freedom
Multiple R-squared:  0.383, Adjusted R-squared:  0.3686 
F-statistic: 26.69 on 3 and 129 DF,  p-value: 1.704e-13</code></pre>
</div>
</div>
<p>Der Koeffizient <code>prot_fitted</code> ist der gesuchte Behandlungseffekt. Beachte, dass die von <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> berechneten Standardfehler ungültig sind, weil diese die zusätzliche Unsicherheit durch die Berechnung von <span class="math inline">\(\widehat{prot}\)</span> über die First-Stage-Regression nicht berücksichtigen. Nachfolgend nutzen wir <code><a href="https://rdrr.io/pkg/AER/man/ivreg.html">AER::ivreg()</a></code>, um komfortabel gültige (heteroskedastie-robuste) Inferenz betreiben zu können.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>&nbsp;Die Autoren geben an, robuste SEs zu nutzen. Das scheint nicht der Fall zu sein, denn <code>vcov = "HC0"</code> liefert die Ergebinsse im Paper. Die von Stata berechneten HC1-SEs weichen ab. Dies ändert allerdings nichts an der Signifikanz der Koeffizienten. Wir nutzen <code>vcov = "HC1"</code>.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Schätzung mit 2SlS</span></span>
<span><span class="co"># s. Tabelle 4 in Basten und Betz (2013)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># Wir instrumentieren Treatment (`prot1980s`) mit dem Schwellenindikator (`vaud`)</span></span>
<span><span class="co"># ivreg: exogene Variablen instrumentieren sich selbst, daher</span></span>
<span><span class="co"># ' | vaud * borderdis '</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">AER</span><span class="op">)</span></span>
<span><span class="co"># (1) Präferenz für Freizeit</span></span>
<span><span class="va">SS_pfl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AER/man/ivreg.html">ivreg</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">pfl</span> <span class="op">~</span> <span class="va">prot</span> <span class="op">+</span> <span class="va">bord</span><span class="op">:</span><span class="va">vaud</span> <span class="op">+</span> <span class="va">bord</span> <span class="op">|</span> <span class="va">vaud</span> <span class="op">*</span> <span class="va">bord</span>,</span>
<span>  data <span class="op">=</span> <span class="va">BastenBetz_OB</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (2) Präferenz für Umverteilung</span></span>
<span><span class="va">SS_pfr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">SS_pfl</span>,</span>
<span>  formula <span class="op">=</span> <span class="va">pfr</span> <span class="op">~</span> <span class="va">prot</span> <span class="op">+</span> <span class="va">bord</span><span class="op">:</span><span class="va">vaud</span> <span class="op">+</span> <span class="va">bord</span> <span class="op">|</span> <span class="va">vaud</span> <span class="op">*</span> <span class="va">bord</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (3) Präferenz für Intervention</span></span>
<span><span class="va">SS_pfi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">SS_pfl</span>,</span>
<span>  formula <span class="op">=</span> <span class="va">pfi</span> <span class="op">~</span> <span class="va">prot</span> <span class="op">+</span> <span class="va">bord</span><span class="op">:</span><span class="va">vaud</span> <span class="op">+</span> <span class="va">bord</span> <span class="op">|</span> <span class="va">vaud</span> <span class="op">*</span> <span class="va">bord</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (4) Einkommensungleichheit</span></span>
<span><span class="va">SS_gini</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">SS_pfl</span>,</span>
<span>  formula <span class="op">=</span> <span class="va">pfi</span> <span class="op">~</span> <span class="va">prot</span> <span class="op">+</span> <span class="va">bord</span><span class="op">:</span><span class="va">vaud</span> <span class="op">+</span> <span class="va">bord</span> <span class="op">|</span> <span class="va">vaud</span> <span class="op">*</span> <span class="va">bord</span>,</span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Tabellarische Darstellung</span></span>
<span><span class="fu"><a href="https://modelsummary.com/man/modelsummary.html">modelsummary</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"(1) Freizeit"</span><span class="op">=</span> <span class="va">SS_pfl</span>, </span>
<span>    <span class="st">"(2) Umverteilung"</span> <span class="op">=</span> <span class="va">SS_pfr</span>, </span>
<span>    <span class="st">"(3) Intervention"</span> <span class="op">=</span> <span class="va">SS_pfi</span>, </span>
<span>    <span class="st">"(4) Ungleichheit"</span> <span class="op">=</span> <span class="va">SS_gini</span></span>
<span>  <span class="op">)</span>, </span>
<span>  vcov <span class="op">=</span> <span class="st">"HC1"</span>, </span>
<span>  stars <span class="op">=</span> <span class="cn">T</span>, </span>
<span>  gof_map <span class="op">=</span> <span class="st">"nobs"</span>, </span>
<span>  output <span class="op">=</span> <span class="st">"gt"</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tabopts</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-BastenBetzSS" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><div aria-describedby="tbl-BastenBetzSS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="gyvgkegfnu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gyvgkegfnu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gyvgkegfnu thead, #gyvgkegfnu tbody, #gyvgkegfnu tfoot, #gyvgkegfnu tr, #gyvgkegfnu td, #gyvgkegfnu th {
  border-style: none;
}

#gyvgkegfnu p {
  margin: 0;
  padding: 0;
}

#gyvgkegfnu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #000000;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gyvgkegfnu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gyvgkegfnu .gt_title {
  color: #000000;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gyvgkegfnu .gt_subtitle {
  color: #000000;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gyvgkegfnu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gyvgkegfnu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gyvgkegfnu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gyvgkegfnu .gt_col_heading {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gyvgkegfnu .gt_column_spanner_outer {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gyvgkegfnu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gyvgkegfnu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gyvgkegfnu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gyvgkegfnu .gt_spanner_row {
  border-bottom-style: hidden;
}

#gyvgkegfnu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gyvgkegfnu .gt_empty_group_heading {
  padding: 0.5px;
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gyvgkegfnu .gt_from_md > :first-child {
  margin-top: 0;
}

#gyvgkegfnu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gyvgkegfnu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gyvgkegfnu .gt_stub {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gyvgkegfnu .gt_stub_row_group {
  color: #000000;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gyvgkegfnu .gt_row_group_first td {
  border-top-width: 2px;
}

#gyvgkegfnu .gt_row_group_first th {
  border-top-width: 2px;
}

#gyvgkegfnu .gt_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gyvgkegfnu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gyvgkegfnu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gyvgkegfnu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gyvgkegfnu .gt_grand_summary_row {
  color: #000000;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gyvgkegfnu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gyvgkegfnu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gyvgkegfnu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gyvgkegfnu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#gyvgkegfnu .gt_footnotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gyvgkegfnu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gyvgkegfnu .gt_sourcenotes {
  color: #000000;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gyvgkegfnu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gyvgkegfnu .gt_left {
  text-align: left;
}

#gyvgkegfnu .gt_center {
  text-align: center;
}

#gyvgkegfnu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gyvgkegfnu .gt_font_normal {
  font-weight: normal;
}

#gyvgkegfnu .gt_font_bold {
  font-weight: bold;
}

#gyvgkegfnu .gt_font_italic {
  font-style: italic;
}

#gyvgkegfnu .gt_super {
  font-size: 65%;
}

#gyvgkegfnu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gyvgkegfnu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gyvgkegfnu .gt_indent_1 {
  text-indent: 5px;
}

#gyvgkegfnu .gt_indent_2 {
  text-indent: 10px;
}

#gyvgkegfnu .gt_indent_3 {
  text-indent: 15px;
}

#gyvgkegfnu .gt_indent_4 {
  text-indent: 20px;
}

#gyvgkegfnu .gt_indent_5 {
  text-indent: 25px;
}

#gyvgkegfnu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gyvgkegfnu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id=" " class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="(1) Freizeit" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">(1) Freizeit</th>
<th id="(2) Umverteilung" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">(2) Umverteilung</th>
<th id="(3) Intervention" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">(3) Intervention</th>
<th id="(4) Ungleichheit" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">(4) Ungleichheit</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=" ">(Intercept)</td>
<td class="gt_row gt_center" headers="(1) Freizeit">50.528***</td>
<td class="gt_row gt_center" headers="(2) Umverteilung">44.560***</td>
<td class="gt_row gt_center" headers="(3) Intervention">52.871***</td>
<td class="gt_row gt_center" headers="(4) Ungleichheit">52.871***</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="(1) Freizeit">(1.918)</td>
<td class="gt_row gt_center" headers="(2) Umverteilung">(0.950)</td>
<td class="gt_row gt_center" headers="(3) Intervention">(1.063)</td>
<td class="gt_row gt_center" headers="(4) Ungleichheit">(1.063)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">prot</td>
<td class="gt_row gt_center" headers="(1) Freizeit">-13.460***</td>
<td class="gt_row gt_center" headers="(2) Umverteilung">-5.061*</td>
<td class="gt_row gt_center" headers="(3) Intervention">-6.487***</td>
<td class="gt_row gt_center" headers="(4) Ungleichheit">-6.487***</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="(1) Freizeit">(3.161)</td>
<td class="gt_row gt_center" headers="(2) Umverteilung">(2.161)</td>
<td class="gt_row gt_center" headers="(3) Intervention">(1.738)</td>
<td class="gt_row gt_center" headers="(4) Ungleichheit">(1.738)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">bord</td>
<td class="gt_row gt_center" headers="(1) Freizeit">0.438</td>
<td class="gt_row gt_center" headers="(2) Umverteilung">0.444</td>
<td class="gt_row gt_center" headers="(3) Intervention">-0.165</td>
<td class="gt_row gt_center" headers="(4) Ungleichheit">-0.165</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" "></td>
<td class="gt_row gt_center" headers="(1) Freizeit">(0.639)</td>
<td class="gt_row gt_center" headers="(2) Umverteilung">(0.357)</td>
<td class="gt_row gt_center" headers="(3) Intervention">(0.332)</td>
<td class="gt_row gt_center" headers="(4) Ungleichheit">(0.332)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">bord × vaud</td>
<td class="gt_row gt_center" headers="(1) Freizeit">-0.364</td>
<td class="gt_row gt_center" headers="(2) Umverteilung">-0.909</td>
<td class="gt_row gt_center" headers="(3) Intervention">0.011</td>
<td class="gt_row gt_center" headers="(4) Ungleichheit">0.011</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=" " style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000"></td>
<td class="gt_row gt_center" headers="(1) Freizeit" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000">(0.811)</td>
<td class="gt_row gt_center" headers="(2) Umverteilung" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000">(0.561)</td>
<td class="gt_row gt_center" headers="(3) Intervention" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000">(0.432)</td>
<td class="gt_row gt_center" headers="(4) Ungleichheit" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000">(0.432)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=" ">Num.Obs.</td>
<td class="gt_row gt_center" headers="(1) Freizeit">133</td>
<td class="gt_row gt_center" headers="(2) Umverteilung">133</td>
<td class="gt_row gt_center" headers="(3) Intervention">133</td>
<td class="gt_row gt_center" headers="(4) Ungleichheit">133</td>
</tr>
</tbody>
<tfoot class="gt_sourcenotes"><tr class="even">
<td colspan="5" class="gt_sourcenote">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-BastenBetzSS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;11.5: Ergebnisse der Second-Stage-Regressionen
</figcaption></figure>
</div>
</div>
<p>Die Koeffizienten von <code>prot</code> in <a href="#tbl-BastenBetzSS" class="quarto-xref">Tabelle&nbsp;<span>11.5</span></a> sind die mit 2SLS ermittelten erwarteten Behandlungseffekte einer 100%-Reformation (d.h. von 100% katholisch zu 100% protestantisch) für eine durchschnittliche Gemeine nahe der Kantonsgrnze. Es handelt sich jeweils um einen lokalen durchschnittlichen Behandlungseffekt (LATE). Gem. der Definition der abhängigen Variablen, interpretieren wir die Koeffizienten von <code>prot</code> in de Regressionen (1), (2) und (3) als erwartete Prozentänderung durch Reformation. Der Koeffizient in Regression (4) gibt die erwartete Änderung des Gini-Index an. Sämtliche geschätzte Effekte sind signifikant und haben ein mit der Hypothese der Autoren konsistentes negatives Vorzeichen.</p>
<p>Die Ergebnisse sind Evidenz, dass Protestantismus zu verringerter Präferenz für Freizeit, Umverteilung sowie wirtschaftspolitische Intervention seitens des Staats führt. Auch die ökonomische Ungleichheit ist signifikant geringer, als in einer durchschnittlichen vollständig katholischen Gemeinde.</p>
</section><section id="addendum-frdd-schätzung-mit-rdrobust" class="level3" data-number="11.4.5"><h3 data-number="11.4.5" class="anchored" data-anchor-id="addendum-frdd-schätzung-mit-rdrobust">
<span class="header-section-number">11.4.5</span> Addendum: FRDD-Schätzung mit <code>rdrobust()</code>
</h3>
<p>Die Funktion <code><a href="https://rdrr.io/pkg/rdrobust/man/rdrobust.html">rdrobust::rdrobust()</a></code> erlaubt die Schätzung von SRDD und FRDD mit einer Vielzahl von Optionen, s. <code><a href="https://rdrr.io/pkg/rdrobust/man/rdrobust.html">?rdrobust</a></code>. Dies erleichtert die Schätzung mehrerer Modellspezifikationenen und Bandweiten. Mit dem nachstehenden Befehl schätzen wir den LATE von Reformation auf die Präferenz für Umverteilung anhand lokaler quadratischer Regression. Der Output gibt einen Überblick der Bandweitenschätzung sowie der 2 Stufen des 2SLS-Schätzers, inkl. robuster Inferenzstatistiken.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pfr_rdr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rdrobust/man/rdrobust.html">rdrobust</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="va">BastenBetz</span><span class="op">$</span><span class="va">pfr</span>,</span>
<span>  x <span class="op">=</span> <span class="va">BastenBetz</span><span class="op">$</span><span class="va">bord</span>,</span>
<span>  fuzzy <span class="op">=</span> <span class="va">BastenBetz</span><span class="op">$</span><span class="va">prot</span>, </span>
<span>  p <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  kernel <span class="op">=</span> <span class="st">"uniform"</span>,</span>
<span>  vce <span class="op">=</span> <span class="st">"HC1"</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="va">pfr_rdr</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fuzzy RD estimates using local polynomial regression.

Number of Obs.                  509
BW type                       mserd
Kernel                      Uniform
VCE method                      HC1

Number of Obs.                  127          382
Eff. Number of Obs.              85          131
Order est. (p)                    2            2
Order bias  (q)                   3            3
BW est. (h)                  10.796       10.796
BW bias (b)                  22.271       22.271
rho (h/b)                     0.485        0.485
Unique Obs.                      97          261

First-stage estimates.

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional     0.701     0.039    17.782     0.000     [0.624 , 0.778]     
        Robust         -         -    15.837     0.000     [0.599 , 0.768]     
=============================================================================

Treatment effect estimates.

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional    -5.047     2.254    -2.239     0.025    [-9.464 , -0.629]    
        Robust         -         -    -2.210     0.027   [-10.114 , -0.607]    
=============================================================================</code></pre>
</div>
</div>
<p>Auch für die quadratische Spezifikation erhalten wir mit -5.047 ein vergleichbares signifikantes Ergebnis für den LATE von Protestantismus auf Umverteilung, vgl. Spalte (2) in <a href="#tbl-BastenBetzSS" class="quarto-xref">Tabelle&nbsp;<span>11.5</span></a>.</p>
<p>Mit der Option <code>bwselect = "msetwo"</code> kann die Bandweite jeweils für die lokale Regression links- und rechtssetig des Schwellenwerts geschätzt werden.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pfr_rdr</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span>bwselect <span class="op">=</span> <span class="st">"msetwo"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fuzzy RD estimates using local polynomial regression.

Number of Obs.                  509
BW type                      msetwo
Kernel                      Uniform
VCE method                      HC1

Number of Obs.                  127          382
Eff. Number of Obs.              51          134
Order est. (p)                    2            2
Order bias  (q)                   3            3
BW est. (h)                   5.340       11.387
BW bias (b)                  13.917       22.330
rho (h/b)                     0.384        0.510
Unique Obs.                      97          261

First-stage estimates.

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional     0.649     0.046    14.216     0.000     [0.560 , 0.739]     
        Robust         -         -    11.970     0.000     [0.534 , 0.743]     
=============================================================================

Treatment effect estimates.

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional    -7.487     3.378    -2.216     0.027   [-14.109 , -0.866]    
        Robust         -         -    -2.156     0.031   [-14.750 , -0.704]    
=============================================================================</code></pre>
</div>
</div>
<p>Trotz Diskrepanz der geschätzten Bandweiten erhalten wir eine größere aber vergleichbare Schätzung für einen negativen Effekt.</p>


<!-- -->

<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script><div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
W10=
</script><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-BastenBetz2013" class="csl-entry" role="listitem">
Basten, Christoph, und Frank Betz. 2013. <span>„Beyond work ethic: Religion, individual, and political preferences“</span>. <em>American Economic Journal: Economic Policy</em> 5 (3): 67–91.
</div>
<div id="ref-CJM2020" class="csl-entry" role="listitem">
Cattaneo, Matias D, Michael Jansson, und Xinwei Ma. 2020. <span>„Simple local polynomial density estimators“</span>. <em>Journal of the American Statistical Association</em> 115 (531): 1449–55.
</div>
<div id="ref-GelmanImbens2019" class="csl-entry" role="listitem">
Gelman, Andrew, und Guido Imbens. 2019. <span>„Why high-order polynomials should not be used in regression discontinuity designs“</span>. <em>Journal of Business &amp; Economic Statistics</em> 37 (3): 447–56.
</div>
<div id="ref-ImbensLemieux2008" class="csl-entry" role="listitem">
Imbens, G. W., und Thomas Lemieux. 2008. <span>„Regression discontinuity designs: A guide to practice“</span>. <em>Journal of econometrics</em> 142 (2): 615–35.
</div>
<div id="ref-ImbensKalyanaraman2012" class="csl-entry" role="listitem">
Imbens, Guido, und Karthik Kalyanaraman. 2012. <span>„Optimal bandwidth choice for the regression discontinuity estimator“</span>. <em>The Review of economic studies</em> 79 (3): 933–59.
</div>
<div id="ref-Lee2008" class="csl-entry" role="listitem">
Lee, David S. 2008. <span>„Randomized experiments from non-random selection in US House elections“</span>. <em>Journal of Econometrics</em> 142 (2): 675–97.
</div>
<div id="ref-McCrary2008" class="csl-entry" role="listitem">
McCrary, Justin. 2008. <span>„Manipulation of the running variable in the regression discontinuity design: A density test“</span>. <em>Journal of Econometrics</em> 142 (2): 698–714.
</div>
<div id="ref-Weber2004" class="csl-entry" role="listitem">
Weber, Max. 2004. <em>Die protestantische Ethik und der Geist des Kapitalismus</em>. Bd. 1614. CH Beck.
</div>
</div>
</section></section></main><!-- /main --><script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuaHRtbGBcbjxzdHlsZT5cbi5yZWdyZXNzaW9uIHtcbiAgZmlsbDogbm9uZTtcbiAgc3Ryb2tlOiAjMDAwO1xuICBzdHJva2Utd2lkdGg6IDEuNXB4O1xufVxuLmF4aXMgbGluZSB7XG4gIHN0cm9rZTogI2RkZDtcbn1cbi5heGlzIC5iYXNlbGluZSBsaW5lIHtcbiAgc3Ryb2tlOiAjNTU1O1xufVxuLmF4aXMgLmRvbWFpbiB7XG4gIGRpc3BsYXk6IG5vbmU7XG59IFxuPC9zdHlsZT5cbjxsaW5rIHJlbD1cInN0eWxlc2hlZXRcIiBocmVmPVwiaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvS2FUZVgvMC4xMS4xL2thdGV4Lm1pbi5jc3NcIj5cbmBcbmQzID0gcmVxdWlyZShcImQzLWFycmF5QDNcIiwgXCJkMy1heGlzQDNcIiwgXCJkMy1yZWdyZXNzaW9uQDFcIiwgXCJkMy1zY2FsZUA0XCIsIFwiZDMtc2hhcGVAM1wiLCBcImQzLXNlbGVjdGlvbkAzXCIsIFwiZDMtZm9ybWF0XCIpXG5cbm1hcmdpbiA9ICh7bGVmdDogNTUsIHJpZ2h0OiA4LCB0b3A6IDEzLCBib3R0b206IDI0fSk7XG5iYXNlID0gTWF0aC5taW4od2lkdGgsIDUwMCk7XG5pbm5lcldpZHRoID0gYmFzZSAtIG1hcmdpbi5sZWZ0IC0gbWFyZ2luLnJpZ2h0O1xuaW5uZXJIZWlnaHQgPSBiYXNlLTEwMCAtIG1hcmdpbi50b3AgLSBtYXJnaW4uYm90dG9tO1xuXG5cbnZpZXdvZiBid19kYXRlbl9MTFJVID0gSW5wdXRzLnJhbmdlKFsuMSwgNl0sIHtcbiAgbGFiZWw6IFwiQmFuZHdlaXRlIChoKVwiLFxuICBzdGVwOiAuMSxcbiAgdmFsdWU6IDEuM1xufSk7XG5cbnhTY2FsZUxMUlUgPSBkMy5zY2FsZUxpbmVhcigpXG4gICAuZG9tYWluKFstNiwgNl0pXG4gICAucmFuZ2UoWzAsIGlubmVyV2lkdGhdKTtcbiAgIFxueVNjYWxlTExSVSA9IGQzLnNjYWxlTGluZWFyKClcbiAgLmRvbWFpbihbLTQsIDZdKVxuICAucmFuZ2UoW2lubmVySGVpZ2h0LCAwXSk7XG5cbmxpbmVMTFJVID0gZDMubGluZSgpXG4gIC54KGQgPT4geFNjYWxlTExSVShkWzBdKSlcbiAgLnkoZCA9PiB5U2NhbGVMTFJVKGRbMV0pKTtcbiAgXG54QXhpc0xMUlUgPSBkMy5heGlzQm90dG9tKHhTY2FsZUxMUlUpXG4gIC50aWNrU2l6ZShpbm5lckhlaWdodCArIDEwKVxuICAudGlja1ZhbHVlcyhbLTYsIC00LCAtMiwgMCwgMiwgNCwgNl0pXG4gIC50aWNrRm9ybWF0KGQgPT4gZCk7XG5cbnlBeGlzTExSVSA9IGQzLmF4aXNMZWZ0KHlTY2FsZUxMUlUpXG4gIC50aWNrU2l6ZShpbm5lcldpZHRoICsgMTApXG4gIC50aWNrRm9ybWF0KGQgPT4gZCk7XG5cbkxMUlVSZWdyZXNzaW9uID0gZDMucmVncmVzc2lvbkxpbmVhcigpXG4gIC54KGQgPT4gZC5YKVxuICAueShkID0+IGQuWSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcbntcbiAgY29uc3Qgc3ZnID0gZDMuc2VsZWN0KERPTS5zdmcoaW5uZXJXaWR0aCArIG1hcmdpbi5sZWZ0ICsgbWFyZ2luLnJpZ2h0ICsgMjAsIGlubmVySGVpZ2h0ICsgbWFyZ2luLnRvcCArIG1hcmdpbi5ib3R0b20gKyAyMCkpXG4gIFxuICBjb25zdCBnID0gc3ZnLmFwcGVuZChcImdcIilcbiAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHttYXJnaW4ubGVmdH0sICR7bWFyZ2luLnRvcH0pYCk7XG5cbiAgZy5hcHBlbmQoXCJnXCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIFwiYXhpc1wiKVxuICAgICAgLmNhbGwoeEF4aXNMTFJVKTtcblxuICBnLmFwcGVuZChcImdcIilcbiAgICAuYXR0cihcImNsYXNzXCIsIFwiYXhpc1wiKVxuICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHtpbm5lcldpZHRofSlgKVxuICAgIC5jYWxsKHlBeGlzTExSVSk7XG5cbiAgLy8gQWRkIFggYXhpcyBsYWJlbDpcbiAgZy5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcImVuZFwiKVxuICAgIC5hdHRyKFwiZm9udC1zaXplXCIsIDEzKVxuICAgIC5hdHRyKFwieFwiLCBpbm5lcldpZHRoKVxuICAgIC5hdHRyKFwieVwiLCBpbm5lckhlaWdodCArIG1hcmdpbi50b3AgKyAyNSlcbiAgICAudGV4dChcIlggLSBjXCIpO1xuXG4gIC8vIFkgYXhpcyBsYWJlbDpcbiAgZy5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcImVuZFwiKVxuICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwicm90YXRlKC05MClcIilcbiAgICAuYXR0cihcImZvbnQtc2l6ZVwiLCAxMylcbiAgICAuYXR0cihcInlcIiwgLW1hcmdpbi5sZWZ0KzEwKVxuICAgIC5hdHRyKFwieFwiLCAtbWFyZ2luLnRvcCsxMClcbiAgICAudGV4dChcIllcIik7XG5cbiAgZy5zZWxlY3RBbGwoXCJjaXJjbGVcIilcbiAgICAuZGF0YSh0cmFuc3Bvc2UoU1JERCkpXG4gICAgLmVudGVyKCkuYXBwZW5kKFwiY2lyY2xlXCIpXG4gICAgLmF0dHIoXCJyXCIsIDIpXG4gICAgLmF0dHIoXCJjeFwiLCBkID0+IHhTY2FsZUxMUlUoZC5YKSlcbiAgICAuYXR0cihcImN5XCIsIGQgPT4geVNjYWxlTExSVShkLlkpKTtcblxuZy5zZWxlY3RBbGwoXCJjaXJjbGVcIilcbiAuZmlsdGVyKCBmdW5jdGlvbihkKXsgcmV0dXJuIE1hdGguYWJzKGQuWCkgPD0gYndfZGF0ZW5fTExSVSB9IClcbiAuYXR0cihcImZpbGxcIiwgXCJvcmFuZ2VcIilcbiAuYXR0cihcInN0cm9rZVwiLCBcIm5vbmVcIik7XG4gXG4gIDwhLS0gdHJmIC0tPlxudmFyICBsaW5lID0gZDMubGluZSgpXG4gICAgICAgICAgIC54KGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHhTY2FsZUxMUlUoZC5YKTsgfSkgXG4gICAgICAgICAgIC55KGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHlTY2FsZUxMUlUoZC5ZX3RydWUpOyB9KSBcbiAgICAgICAgICAgLmN1cnZlKGQzLmN1cnZlTGluZWFyKTsgXG5cbiAgZy5hcHBlbmQoXCJwYXRoXCIpXG4gICAgLmRhdHVtKHRyYW5zcG9zZShTUkREKSlcbiAgICAuYXR0cihcImRcIiwgbGluZSlcbiAgICAuYXR0cihcImZpbGxcIiwgXCJub25lXCIpXG4gICAgLmF0dHIoXCJzdHJva2VcIiwgXCJyZWRcIilcbiAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCAyKTtcblxuXG5mdW5jdGlvbiBiKGQpIHsgcmV0dXJuIExMUlVSZWdyZXNzaW9uKFxuICAgICAgICB0cmFuc3Bvc2UoU1JERCkuZmlsdGVyKGZ1bmN0aW9uKGQpeyByZXR1cm4gZC5YIDw9IDAgJiBkLlggPj0gLWJ3X2RhdGVuX0xMUlUgfSlcbiAgICApOyB9XG5cbmZ1bmN0aW9uIGEoZCkgeyByZXR1cm4gTExSVVJlZ3Jlc3Npb24oXG4gICAgICB0cmFuc3Bvc2UoU1JERCkuZmlsdGVyKGZ1bmN0aW9uKGQpeyByZXR1cm4gZC5YID4gMCAmIGQuWCA8PSBid19kYXRlbl9MTFJVIH0pXG4gICAgKTsgfVxuXG4gIGcuYXBwZW5kKFwicGF0aFwiKVxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcInJlZ3Jlc3Npb25cIilcbiAgICAgIC5kYXR1bShiKVxuICAgICAgLmF0dHIoXCJkXCIsIGxpbmVMTFJVKVxuICAgICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgMilcbiAgICAgIC5zdHlsZShcInN0cm9rZVwiLCBcIiMzOUZGMTRcIik7XG5cbiAgZy5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIFwicmVncmVzc2lvblwiKVxuICAgICAgLmRhdHVtKGEpXG4gICAgICAuYXR0cihcImRcIiwgbGluZUxMUlUpXG4gICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCAyKVxuICAgICAgLnN0eWxlKFwic3Ryb2tlXCIsIFwiIzM5RkYxNFwiKTtcbiAgXG4gIGcuYXBwZW5kKFwibGluZVwiKVxuICAuYXR0cihcIngxXCIsIHhTY2FsZUxMUlUoMCkpXG4gIC5hdHRyKFwieTFcIiwgeVNjYWxlTExSVSgoYigpLnNsaWNlKC0xKSlbMF1bMV0pKVxuICAuYXR0cihcIngyXCIsIHhTY2FsZUxMUlUoMCkpXG4gIC5hdHRyKFwieTJcIiwgeVNjYWxlTExSVSgoYSgpLnNsaWNlKDApKVswXVsxXSkpXG4gIC5hdHRyKFwic3Ryb2tlXCIsIFwiIzM5RkYxNFwiKVxuICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCAyKTtcbiAgXG4gICBnLmFwcGVuZChcInRleHRcIilcbiAgICAuYXR0cihcInhcIiwgZCA9PiB4U2NhbGVMTFJVKC0yLjc1KSlcbiAgICAuYXR0cihcInlcIiwgZCA9PiB5U2NhbGVMTFJVKDQuNSkpXG4gICAgLmF0dHIoXCJkeVwiLCBcIi4zNWVtXCIpXG4gICAgLmF0dHIoXCJmaWxsXCIsIFwiIzM5RkYxNFwiKVxuICAgIC50ZXh0KFxuICAgIGQzLmZvcm1hdChcIiwuMmZcIikoIChhKCkuc2xpY2UoMCkpWzBdWzFdIC0gKGIoKS5zbGljZSgtMSkpWzBdWzFdICkgXG4gICAgKTtcbiAgXG4gIC8qIGRhc2hlZCBsaW5lIGRhdGEgYncgdXBwZXIgKi9cbiAgZy5hcHBlbmQoXCJsaW5lXCIpXG4gIC5hdHRyKFwieDFcIiwgeFNjYWxlTExSVShid19kYXRlbl9MTFJVKSlcbiAgLmF0dHIoXCJ5MVwiLCAwKVxuICAuYXR0cihcIngyXCIsIHhTY2FsZUxMUlUoYndfZGF0ZW5fTExSVSkpXG4gIC5hdHRyKFwieTJcIiwgaW5uZXJIZWlnaHQpXG4gIC5zdHlsZShcInN0cm9rZVwiLCBcImJsdWVcIilcbiAgLnN0eWxlKFwic3Ryb2tlLWRhc2hhcnJheVwiLCBcIjRcIilcbiAgLnN0eWxlKFwic3Ryb2tlLXdpZHRoXCIsIFwiMVwiKTtcbiAgXG4gIC8qIGRhc2hlZCBsaW5lIGRhdGEgYncgbG93ZXIgKi9cbiAgZy5hcHBlbmQoXCJsaW5lXCIpXG4gIC5hdHRyKFwieDFcIiwgeFNjYWxlTExSVSgtYndfZGF0ZW5fTExSVSkpXG4gIC5hdHRyKFwieTFcIiwgMClcbiAgLmF0dHIoXCJ4MlwiLCB4U2NhbGVMTFJVKC1id19kYXRlbl9MTFJVKSlcbiAgLmF0dHIoXCJ5MlwiLCBpbm5lckhlaWdodClcbiAgLnN0eWxlKFwic3Ryb2tlXCIsIFwiYmx1ZVwiKVxuICAuc3R5bGUoXCJzdHJva2UtZGFzaGFycmF5XCIsIFwiNFwiKVxuICAuc3R5bGUoXCJzdHJva2Utd2lkdGhcIiwgXCIxXCIpO1xuXG4gIHJldHVybiBzdmcubm9kZSgpO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGBcbjxzdHlsZT5cbi5yZWdyZXNzaW9uIHtcbiAgZmlsbDogbm9uZTtcbiAgc3Ryb2tlOiAjMDAwO1xuICBzdHJva2Utd2lkdGg6IDEuNXB4O1xufVxuLmF4aXMgbGluZSB7XG4gIHN0cm9rZTogI2RkZDtcbn1cbi5heGlzIC5iYXNlbGluZSBsaW5lIHtcbiAgc3Ryb2tlOiAjNTU1O1xufVxuLmF4aXMgLmRvbWFpbiB7XG4gIGRpc3BsYXk6IG5vbmU7XG59IFxuPC9zdHlsZT5cbjxsaW5rIHJlbD1cInN0eWxlc2hlZXRcIiBocmVmPVwiaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvS2FUZVgvMC4xMS4xL2thdGV4Lm1pbi5jc3NcIj5cbmBcbnZpZXdvZiBiYW5kd2lkdGggPSBJbnB1dHMucmFuZ2UoWy4wMSwgMV0sIHtcbiAgbGFiZWw6IFwiQmFuZHdlaXRlIExPRVNTIChsKVwiLFxuICBzdGVwOiAuMDEsXG4gIHZhbHVlOiAuMjhcbn0pO1xuXG54U2NhbGVMb2VzcyA9IGQzLnNjYWxlTGluZWFyKClcbiAgIC5kb21haW4oWy0uNTUsIC41NV0pXG4gICAucmFuZ2UoWzAsIGlubmVyV2lkdGhdKTtcbiAgIFxueVNjYWxlTG9lc3MgPSBkMy5zY2FsZUxpbmVhcigpXG4gIC5kb21haW4oWy4yLCAuOF0pXG4gIC5yYW5nZShbaW5uZXJIZWlnaHQsIDBdKTtcblxubGluZUxvZXNzID0gZDMubGluZSgpXG4gIC54KGQgPT4geFNjYWxlTG9lc3MoZFswXSkpXG4gIC55KGQgPT4geVNjYWxlTG9lc3MoZFsxXSkpO1xuICBcbnhBeGlzTG9lc3MgPSBkMy5heGlzQm90dG9tKHhTY2FsZUxvZXNzKVxuICAudGlja1NpemUoaW5uZXJIZWlnaHQgKyAxMClcbiAgLnRpY2tWYWx1ZXMoWy0uNSwgLS4yNSwgMCwgLjI1LCAuNV0pXG4gIC50aWNrRm9ybWF0KGQgPT4gZCk7XG5cbnlBeGlzTG9lc3MgPSBkMy5heGlzTGVmdCh5U2NhbGVMb2VzcylcbiAgLnRpY2tTaXplKGlubmVyV2lkdGggKyAxMClcbiAgLnRpY2tWYWx1ZXMoWy4yLCAuMzUsIC41LCAuNjUsIC44XSlcbiAgLnRpY2tGb3JtYXQoZCA9PiBkKTtcblxubG9lc3NSZWdyZXNzaW9uID0gZDMucmVncmVzc2lvbkxvZXNzKClcbiAgLngoZCA9PiBkLlN0aW1tZW5UbTEpXG4gIC55KGQgPT4gZC5TdGltbWVuVClcbiAgLmJhbmR3aWR0aChiYW5kd2lkdGgpO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG57XG4gIGNvbnN0IHN2ZyA9IGQzLnNlbGVjdChET00uc3ZnKGlubmVyV2lkdGggKyBtYXJnaW4ubGVmdCArIG1hcmdpbi5yaWdodCArIDIwLCBpbm5lckhlaWdodCArIG1hcmdpbi50b3AgKyBtYXJnaW4uYm90dG9tICsgMjApKVxuICBcbiAgY29uc3QgZyA9IHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7bWFyZ2luLmxlZnR9LCAke21hcmdpbi50b3B9KWApO1xuXG4gIGcuYXBwZW5kKFwiZ1wiKVxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImF4aXNcIilcbiAgICAgIC5jYWxsKHhBeGlzTG9lc3MpO1xuXG4gIGcuYXBwZW5kKFwiZ1wiKVxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJheGlzXCIpXG4gICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke2lubmVyV2lkdGh9KWApXG4gICAgLmNhbGwoeUF4aXNMb2Vzcyk7XG5cbiAgLy8gQWRkIFggYXhpcyBsYWJlbDpcbiAgZy5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcImVuZFwiKVxuICAgIC5hdHRyKFwiZm9udC1zaXplXCIsIDEzKVxuICAgIC5hdHRyKFwieFwiLCBpbm5lcldpZHRoKVxuICAgIC5hdHRyKFwieVwiLCBpbm5lckhlaWdodCArIG1hcmdpbi50b3AgKyAyNSlcbiAgICAudGV4dChcIkRpZmZlcmVueiBTdGltbWVuYW50ZWlsIERlbW9rcmF0ZW4gbGV0enRlIFdhaGwgenVyIDUwJS1TY2h3ZWxsZVwiKTtcblxuICAvLyBZIGF4aXMgbGFiZWw6XG4gIGcuYXBwZW5kKFwidGV4dFwiKVxuICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJlbmRcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInJvdGF0ZSgtOTApXCIpXG4gICAgLmF0dHIoXCJmb250LXNpemVcIiwgMTMpXG4gICAgLmF0dHIoXCJ5XCIsIC1tYXJnaW4ubGVmdCsxMClcbiAgICAuYXR0cihcInhcIiwgLW1hcmdpbi50b3ArMTApXG4gICAgLnRleHQoXCJTdGltbWVuYW50ZWlsIERlbW9rcmF0ZW5cIik7XG5cbiAgZy5zZWxlY3RBbGwoXCJjaXJjbGVcIilcbiAgICAuZGF0YSh0cmFuc3Bvc2UoaG91c2VfYmlubmVkKSlcbiAgICAuZW50ZXIoKS5hcHBlbmQoXCJjaXJjbGVcIilcbiAgICAuYXR0cihcInJcIiwgMilcbiAgICAuYXR0cihcImN4XCIsIGQgPT4geFNjYWxlTG9lc3MoZC5TdGltbWVuVG0xKSlcbiAgICAuYXR0cihcImN5XCIsIGQgPT4geVNjYWxlTG9lc3MoZC5TdGltbWVuVCkpO1xuXG4gIGcuc2VsZWN0QWxsKFwiY2lyY2xlXCIpXG4gICAuZmlsdGVyKCBmdW5jdGlvbihkKXsgcmV0dXJuIE1hdGguYWJzKGQuU3RpbW1lblRtMSkgPD0gYmFuZHdpZHRoLzIgfSApXG4gICAuYXR0cihcImZpbGxcIiwgXCJvcmFuZ2VcIilcbiAgIC5hdHRyKFwic3Ryb2tlXCIsIFwibm9uZVwiKTtcblxuZnVuY3Rpb24gYihkKSB7IHJldHVybiBsb2Vzc1JlZ3Jlc3Npb24oXG4gICAgICAgIHRyYW5zcG9zZShob3VzZSkuZmlsdGVyKGZ1bmN0aW9uKGQpeyByZXR1cm4gZC5TdGltbWVuVG0xIDw9IDAgJiBkLlN0aW1tZW5UbTEgPj0gLS41IH0pXG4gICAgKTsgfVxuXG5mdW5jdGlvbiBhKGQpIHsgcmV0dXJuIGxvZXNzUmVncmVzc2lvbihcbiAgICAgIHRyYW5zcG9zZShob3VzZSkuZmlsdGVyKGZ1bmN0aW9uKGQpeyByZXR1cm4gZC5TdGltbWVuVG0xID4gMCAmIGQuU3RpbW1lblRtMSA8PSAuNSAgfSlcbiAgICApOyB9XG5cbiAgZy5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIFwicmVncmVzc2lvblwiKVxuICAgICAgLmRhdHVtKGIpXG4gICAgICAuYXR0cihcImRcIiwgbGluZUxvZXNzKVxuICAgICAgLnN0eWxlKFwic3Ryb2tlXCIsIFwicmVkXCIpO1xuXG4gIGcuYXBwZW5kKFwicGF0aFwiKVxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcInJlZ3Jlc3Npb25cIilcbiAgICAgIC5kYXR1bShhKVxuICAgICAgLmF0dHIoXCJkXCIsIGxpbmVMb2VzcylcbiAgICAgIC5zdHlsZShcInN0cm9rZVwiLCBcInJlZFwiKTtcbiAgXG4gIGcuYXBwZW5kKFwidGV4dFwiKVxuICAgIC5hdHRyKFwieFwiLCBkID0+IHhTY2FsZUxvZXNzKC0uMjQpKVxuICAgIC5hdHRyKFwieVwiLCBkID0+IHlTY2FsZUxvZXNzKC41NSkpXG4gICAgLmF0dHIoXCJkeVwiLCBcIi4zNWVtXCIpXG4gICAgLmF0dHIoXCJmaWxsXCIsIFwiIzM5RkYxNFwiKVxuICAgIC50ZXh0KGQzLmZvcm1hdChcIiwuMmZcIikoKGEoKS5zbGljZSgwKSlbMF1bMV0gLSAoYigpLnNsaWNlKC0xKSlbMF1bMV0pKTtcbiAgXG4gIGcuYXBwZW5kKFwibGluZVwiKVxuICAuYXR0cihcIngxXCIsIHhTY2FsZUxvZXNzKDApKVxuICAuYXR0cihcInkxXCIsIHlTY2FsZUxvZXNzKChiKCkuc2xpY2UoLTEpKVswXVsxXSkpXG4gIC5hdHRyKFwieDJcIiwgeFNjYWxlTG9lc3MoMCkpXG4gIC5hdHRyKFwieTJcIiwgeVNjYWxlTG9lc3MoKGEoKS5zbGljZSgwKSlbMF1bMV0pKVxuICAuYXR0cihcInN0cm9rZVwiLCBcIiMzOUZGMTRcIilcbiAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgMik7XG4gIFxuICAvKiBkYXNoZWQgbGluZSBhdCBjdXRvZmYgKi9cbiAgZy5hcHBlbmQoXCJsaW5lXCIpXG4gIC5hdHRyKFwieDFcIiwgeFNjYWxlTG9lc3MoMCkpXG4gIC5hdHRyKFwieTFcIiwgMClcbiAgLmF0dHIoXCJ4MlwiLCB4U2NhbGVMb2VzcygwKSlcbiAgLmF0dHIoXCJ5MlwiLCBpbm5lckhlaWdodClcbiAgLnN0eWxlKFwic3Ryb2tlXCIsIFwiYmxhY2tcIilcbiAgLnN0eWxlKFwic3Ryb2tlLWRhc2hhcnJheVwiLCBcIjFcIilcbiAgLnN0eWxlKFwic3Ryb2tlLXdpZHRoXCIsIFwiMVwiKTtcbiAgXG4gIC8qIGRhc2hlZCBsaW5lIGRhdGEgYncgdXBwZXIgKi9cbiAgZy5hcHBlbmQoXCJsaW5lXCIpXG4gIC5hdHRyKFwieDFcIiwgeFNjYWxlTG9lc3MoYmFuZHdpZHRoLzIpKVxuICAuYXR0cihcInkxXCIsIDApXG4gIC5hdHRyKFwieDJcIiwgeFNjYWxlTG9lc3MoYmFuZHdpZHRoLzIpKVxuICAuYXR0cihcInkyXCIsIGlubmVySGVpZ2h0KVxuICAuc3R5bGUoXCJzdHJva2VcIiwgXCJibHVlXCIpXG4gIC5zdHlsZShcInN0cm9rZS1kYXNoYXJyYXlcIiwgXCI0XCIpXG4gIC5zdHlsZShcInN0cm9rZS13aWR0aFwiLCBcIjFcIik7XG4gIFxuICAvKiBkYXNoZWQgbGluZSBkYXRhIGJ3IGxvd2VyICovXG4gIGcuYXBwZW5kKFwibGluZVwiKVxuICAuYXR0cihcIngxXCIsIHhTY2FsZUxvZXNzKC1iYW5kd2lkdGgvMikpXG4gIC5hdHRyKFwieTFcIiwgMClcbiAgLmF0dHIoXCJ4MlwiLCB4U2NhbGVMb2VzcygtYmFuZHdpZHRoLzIpKVxuICAuYXR0cihcInkyXCIsIGlubmVySGVpZ2h0KVxuICAuc3R5bGUoXCJzdHJva2VcIiwgXCJibHVlXCIpXG4gIC5zdHlsZShcInN0cm9rZS1kYXNoYXJyYXlcIiwgXCI0XCIpXG4gIC5zdHlsZShcInN0cm9rZS13aWR0aFwiLCBcIjFcIik7XG5cbiAgcmV0dXJuIHN2Zy5ub2RlKCk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2J3X2RhdGVuX0xMUlUnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnYmFuZHdpZHRoJykifV19
</script><script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./EventStudies.html" class="pagination-link" aria-label="Event Studies">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Event Studies</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./SyntheticControl.html" class="pagination-link" aria-label="Synthetic Control">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Synthetic Control</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb56" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Regression Discontiniuty Designs</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = F}</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="in">house_binned &lt;- read.csv("datasets/house_binned.csv")</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="in">house &lt;- read.csv("datasets/house.csv")</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="in">SRDD &lt;- read.csv("datasets/SRDD.csv")</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="in">ojs_define(</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="in"> house_binned = house_binned,</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="in"> house = house,</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="in"> SRDD = SRDD</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="in">```{CSS, echo = F}</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="in">svg {</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-left: auto;</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-right: auto;</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: asis</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>webr_counter <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"importScripts('https://webr.r-wasm.org/v0.1.1/webr-worker.js');"</span>, <span class="at">file =</span> <span class="st">"docs/webr-worker.js"</span>)</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"importScripts('https://webr.r-wasm.org/v0.1.1/webr-serviceworker.js');"</span>, <span class="at">file =</span> <span class="st">"docs/webr-serviceworker.js"</span>)</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>webr_editor <span class="ot">=</span> <span class="cf">function</span>(<span class="at">code =</span> <span class="fu">I</span>(<span class="fu">encodeString</span>(code, <span class="at">quote =</span> <span class="st">'`'</span>)), width, height) { </span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>webr_counter <span class="ot">&lt;&lt;-</span> webr_counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>output <span class="ot">=</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'</span></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;button class="btn btn-outline-primary btn-sm btn-webr run" disabled type="button" id="webr-run-button-{{ webr_counter }}" style="width:100%; border-radius:15px 15px 0 0;"&gt;R lädt. Etwas Geduld bitte...&lt;i class="fas fa-cog fa-spin"&gt;&lt;/i&gt;&lt;/button&gt;</span></span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;div id="webr-editor-{{ webr_counter }}"&gt;&lt;/div&gt;</span></span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;div id="webr-code-output-{{ webr_counter }}"&gt;&lt;pre style="visibility: hidden"&gt;&lt;/pre&gt;&lt;/div&gt;</span></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;script type="module"&gt;</span></span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a><span class="st">  const runButton = document.getElementById("webr-run-button-{{ webr_counter }}");</span></span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a><span class="st">  const outputDiv = document.getElementById("webr-code-output-{{ webr_counter }}");</span></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a><span class="st">  const editorDiv = document.getElementById("webr-editor-{{ webr_counter }}");</span></span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a><span class="st">  const editor = CodeMirror((elt) =&gt; {</span></span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a><span class="st">    elt.style.border = "2px solid #eee";</span></span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a><span class="st">    elt.style.borderRadius = "0 0 15px 15px";</span></span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a><span class="st">    elt.style.height = "auto";</span></span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a><span class="st">    elt.style.fontSize = "15px";</span></span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a><span class="st">    editorDiv.append(elt);</span></span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a><span class="st">  },{</span></span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a><span class="st">    value: {{code}},</span></span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a><span class="st">    lineNumbers: true,</span></span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a><span class="st">    mode: "r",</span></span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a><span class="st">    theme: "light default",</span></span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a><span class="st">    viewportMargin: Infinity,</span></span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a><span class="st">  });</span></span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a><span class="st">  runButton.onclick = async () =&gt; {</span></span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a><span class="st">    runButton.disabled = true;</span></span>
<span id="cb56-60"><a href="#cb56-60" aria-hidden="true" tabindex="-1"></a><span class="st">    let canvas = undefined;</span></span>
<span id="cb56-61"><a href="#cb56-61" aria-hidden="true" tabindex="-1"></a><span class="st">    await globalThis.webR.init();</span></span>
<span id="cb56-62"><a href="#cb56-62" aria-hidden="true" tabindex="-1"></a><span class="st">    await webR.evalRVoid("canvas(width={{width}}, height={{height}})");</span></span>
<span id="cb56-63"><a href="#cb56-63" aria-hidden="true" tabindex="-1"></a><span class="st">    const result = await webRCodeShelter.captureR(editor.getValue(), {</span></span>
<span id="cb56-64"><a href="#cb56-64" aria-hidden="true" tabindex="-1"></a><span class="st">      withAutoprint: true,</span></span>
<span id="cb56-65"><a href="#cb56-65" aria-hidden="true" tabindex="-1"></a><span class="st">      captureStreams: true,</span></span>
<span id="cb56-66"><a href="#cb56-66" aria-hidden="true" tabindex="-1"></a><span class="st">      captureConditions: false,</span></span>
<span id="cb56-67"><a href="#cb56-67" aria-hidden="true" tabindex="-1"></a><span class="st">      env: webR.objs.emptyEnv,</span></span>
<span id="cb56-68"><a href="#cb56-68" aria-hidden="true" tabindex="-1"></a><span class="st">    });</span></span>
<span id="cb56-69"><a href="#cb56-69" aria-hidden="true" tabindex="-1"></a><span class="st">    try {</span></span>
<span id="cb56-70"><a href="#cb56-70" aria-hidden="true" tabindex="-1"></a><span class="st">      await webR.evalRVoid("dev.off()");</span></span>
<span id="cb56-71"><a href="#cb56-71" aria-hidden="true" tabindex="-1"></a><span class="st">      const out = result.output.filter(</span></span>
<span id="cb56-72"><a href="#cb56-72" aria-hidden="true" tabindex="-1"></a><span class="st">        evt =&gt; evt.type == "stdout" || evt.type == "stderr"</span></span>
<span id="cb56-73"><a href="#cb56-73" aria-hidden="true" tabindex="-1"></a><span class="st">      ).map((evt) =&gt; evt.data).join("</span><span class="sc">\\</span><span class="st">n");</span></span>
<span id="cb56-74"><a href="#cb56-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-75"><a href="#cb56-75" aria-hidden="true" tabindex="-1"></a><span class="st">      const msgs = await webR.flush();</span></span>
<span id="cb56-76"><a href="#cb56-76" aria-hidden="true" tabindex="-1"></a><span class="st">      msgs.forEach(msg =&gt; {</span></span>
<span id="cb56-77"><a href="#cb56-77" aria-hidden="true" tabindex="-1"></a><span class="st">        if (msg.type === "canvasExec"){</span></span>
<span id="cb56-78"><a href="#cb56-78" aria-hidden="true" tabindex="-1"></a><span class="st">          if (!canvas) {</span></span>
<span id="cb56-79"><a href="#cb56-79" aria-hidden="true" tabindex="-1"></a><span class="st">            canvas = document.createElement("canvas");</span></span>
<span id="cb56-80"><a href="#cb56-80" aria-hidden="true" tabindex="-1"></a><span class="st">            canvas.setAttribute("width", 2 * {{width}});</span></span>
<span id="cb56-81"><a href="#cb56-81" aria-hidden="true" tabindex="-1"></a><span class="st">            canvas.setAttribute("height", 2 * {{height}});</span></span>
<span id="cb56-82"><a href="#cb56-82" aria-hidden="true" tabindex="-1"></a><span class="st">            canvas.style.width="700px";</span></span>
<span id="cb56-83"><a href="#cb56-83" aria-hidden="true" tabindex="-1"></a><span class="st">            canvas.style.display="block";</span></span>
<span id="cb56-84"><a href="#cb56-84" aria-hidden="true" tabindex="-1"></a><span class="st">            canvas.style.margin="auto";</span></span>
<span id="cb56-85"><a href="#cb56-85" aria-hidden="true" tabindex="-1"></a><span class="st">          }</span></span>
<span id="cb56-86"><a href="#cb56-86" aria-hidden="true" tabindex="-1"></a><span class="st">          Function(`this.getContext("2d").${msg.data}`).bind(canvas)();</span></span>
<span id="cb56-87"><a href="#cb56-87" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb56-88"><a href="#cb56-88" aria-hidden="true" tabindex="-1"></a><span class="st">      });</span></span>
<span id="cb56-89"><a href="#cb56-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-90"><a href="#cb56-90" aria-hidden="true" tabindex="-1"></a><span class="st">      outputDiv.innerHTML = "";</span></span>
<span id="cb56-91"><a href="#cb56-91" aria-hidden="true" tabindex="-1"></a><span class="st">      const pre = document.createElement("pre");</span></span>
<span id="cb56-92"><a href="#cb56-92" aria-hidden="true" tabindex="-1"></a><span class="st">      if (/</span><span class="sc">\\</span><span class="st">S/.test(out)) {</span></span>
<span id="cb56-93"><a href="#cb56-93" aria-hidden="true" tabindex="-1"></a><span class="st">        const code = document.createElement("code");</span></span>
<span id="cb56-94"><a href="#cb56-94" aria-hidden="true" tabindex="-1"></a><span class="st">        code.innerText = out;</span></span>
<span id="cb56-95"><a href="#cb56-95" aria-hidden="true" tabindex="-1"></a><span class="st">        pre.appendChild(code);</span></span>
<span id="cb56-96"><a href="#cb56-96" aria-hidden="true" tabindex="-1"></a><span class="st">      } else {</span></span>
<span id="cb56-97"><a href="#cb56-97" aria-hidden="true" tabindex="-1"></a><span class="st">        pre.style.visibility = "hidden";</span></span>
<span id="cb56-98"><a href="#cb56-98" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb56-99"><a href="#cb56-99" aria-hidden="true" tabindex="-1"></a><span class="st">      outputDiv.appendChild(pre);</span></span>
<span id="cb56-100"><a href="#cb56-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-101"><a href="#cb56-101" aria-hidden="true" tabindex="-1"></a><span class="st">      if (canvas) {</span></span>
<span id="cb56-102"><a href="#cb56-102" aria-hidden="true" tabindex="-1"></a><span class="st">        const p = document.createElement("p");</span></span>
<span id="cb56-103"><a href="#cb56-103" aria-hidden="true" tabindex="-1"></a><span class="st">        p.appendChild(canvas);</span></span>
<span id="cb56-104"><a href="#cb56-104" aria-hidden="true" tabindex="-1"></a><span class="st">        outputDiv.appendChild(p);</span></span>
<span id="cb56-105"><a href="#cb56-105" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb56-106"><a href="#cb56-106" aria-hidden="true" tabindex="-1"></a><span class="st">    } finally {</span></span>
<span id="cb56-107"><a href="#cb56-107" aria-hidden="true" tabindex="-1"></a><span class="st">      webRCodeShelter.purge();</span></span>
<span id="cb56-108"><a href="#cb56-108" aria-hidden="true" tabindex="-1"></a><span class="st">      runButton.disabled = false;</span></span>
<span id="cb56-109"><a href="#cb56-109" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb56-110"><a href="#cb56-110" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb56-111"><a href="#cb56-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-112"><a href="#cb56-112" aria-hidden="true" tabindex="-1"></a><span class="st">  await globalThis.webR.init();</span></span>
<span id="cb56-113"><a href="#cb56-113" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/script&gt;</span></span>
<span id="cb56-114"><a href="#cb56-114" aria-hidden="true" tabindex="-1"></a><span class="st">'</span>, <span class="at">.open =</span> <span class="st">"{{"</span>, <span class="at">.close =</span> <span class="st">"}}"</span>)</span>
<span id="cb56-115"><a href="#cb56-115" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-116"><a href="#cb56-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-117"><a href="#cb56-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-120"><a href="#cb56-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-121"><a href="#cb56-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb56-122"><a href="#cb56-122" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>knit_engines<span class="sc">$</span><span class="fu">set</span>(<span class="at">webr =</span> <span class="cf">function</span>(options) {</span>
<span id="cb56-123"><a href="#cb56-123" aria-hidden="true" tabindex="-1"></a>  code <span class="ot">=</span> <span class="fu">paste</span>(options<span class="sc">$</span>code, <span class="at">collapse =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb56-124"><a href="#cb56-124" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">=</span> knitr<span class="sc">::</span>opts_current<span class="sc">$</span><span class="fu">get</span>(<span class="st">'fig.width'</span>) <span class="sc">*</span> <span class="dv">72</span></span>
<span id="cb56-125"><a href="#cb56-125" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">=</span> knitr<span class="sc">::</span>opts_current<span class="sc">$</span><span class="fu">get</span>(<span class="st">'fig.height'</span>) <span class="sc">*</span> <span class="dv">72</span></span>
<span id="cb56-126"><a href="#cb56-126" aria-hidden="true" tabindex="-1"></a>  options<span class="sc">$</span>results <span class="ot">=</span> <span class="st">'asis'</span></span>
<span id="cb56-127"><a href="#cb56-127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-128"><a href="#cb56-128" aria-hidden="true" tabindex="-1"></a>  form <span class="ot">=</span> <span class="fu">webr_editor</span>(<span class="at">code =</span> <span class="fu">I</span>(<span class="fu">encodeString</span>(code, <span class="at">quote =</span> <span class="st">'`'</span>)), <span class="at">width =</span> w, <span class="at">height =</span> h)</span>
<span id="cb56-129"><a href="#cb56-129" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-130"><a href="#cb56-130" aria-hidden="true" tabindex="-1"></a>  form</span>
<span id="cb56-131"><a href="#cb56-131" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-132"><a href="#cb56-132" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-133"><a href="#cb56-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-134"><a href="#cb56-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-135"><a href="#cb56-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=F, message=FALSE}</span></span>
<span id="cb56-136"><a href="#cb56-136" aria-hidden="true" tabindex="-1"></a><span class="in">library(gt)</span></span>
<span id="cb56-137"><a href="#cb56-137" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb56-138"><a href="#cb56-138" aria-hidden="true" tabindex="-1"></a><span class="in"># Formatierung von gt-Tabellen</span></span>
<span id="cb56-139"><a href="#cb56-139" aria-hidden="true" tabindex="-1"></a><span class="in">tabopts &lt;- function(x) {</span></span>
<span id="cb56-140"><a href="#cb56-140" aria-hidden="true" tabindex="-1"></a><span class="in">    fmt_number(x, decimals = 3, drop_trailing_zeros = T) %&gt;%</span></span>
<span id="cb56-141"><a href="#cb56-141" aria-hidden="true" tabindex="-1"></a><span class="in">  tab_options(table_body.hlines.color = "white", </span></span>
<span id="cb56-142"><a href="#cb56-142" aria-hidden="true" tabindex="-1"></a><span class="in">              column_labels.border.bottom.color = "black", </span></span>
<span id="cb56-143"><a href="#cb56-143" aria-hidden="true" tabindex="-1"></a><span class="in">             column_labels.border.top.color = "black",</span></span>
<span id="cb56-144"><a href="#cb56-144" aria-hidden="true" tabindex="-1"></a><span class="in">             table_body.border.bottom.color = "black", </span></span>
<span id="cb56-145"><a href="#cb56-145" aria-hidden="true" tabindex="-1"></a><span class="in">             table.border.bottom.color = "black",</span></span>
<span id="cb56-146"><a href="#cb56-146" aria-hidden="true" tabindex="-1"></a><span class="in">             column_labels.font.weight = "bold", </span></span>
<span id="cb56-147"><a href="#cb56-147" aria-hidden="true" tabindex="-1"></a><span class="in">             table.font.color = "black", </span></span>
<span id="cb56-148"><a href="#cb56-148" aria-hidden="true" tabindex="-1"></a><span class="in">             table.font.size = 16)</span></span>
<span id="cb56-149"><a href="#cb56-149" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb56-150"><a href="#cb56-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-151"><a href="#cb56-151" aria-hidden="true" tabindex="-1"></a><span class="in">house &lt;- read_csv("datasets/house.csv")</span></span>
<span id="cb56-152"><a href="#cb56-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-153"><a href="#cb56-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-154"><a href="#cb56-154" aria-hidden="true" tabindex="-1"></a>Regression Discontinuity Design (RDD) ist ein Ansatz für die Schätzung von Behandlungseffekten mit Regression, wenn durch einen experimentell oder natürlich gegebenen Umstand die Behandlung an einem Schwellenwert ($c$) einer *Laufvariable* ($X$) sprunghaft beeinflusst wird. Ein RDD-Schätzer wird so implementiert, dass lediglich Beobachtungen mit Ausprägungen von $X$, die knapp ober- oder knapp unterhalb von $c$ liegen, berücksichtigt werden. Die zentrale Idee hierbei ist, dass Individuen nahe bei $c$ im Durchschnitt ähnliche Merkmale aufweisen. Beobachtungen nahe $c$ sind dann insbesondere hinsichtlich potentieller Backdoor-Variablen vergleichbar, sodass deren problematische Pfade geschlossen sind. Das kausale Diagram in @fig-CDRDD zeigt den grundsätzlichen Zusammenhang.</span>
<span id="cb56-155"><a href="#cb56-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-158"><a href="#cb56-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{dot}</span></span>
<span id="cb56-159"><a href="#cb56-159" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-width: 5</span></span>
<span id="cb56-160"><a href="#cb56-160" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-height: 3</span></span>
<span id="cb56-161"><a href="#cb56-161" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-align: 'center'</span></span>
<span id="cb56-162"><a href="#cb56-162" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-cap: "Kausales Diagramm für Sharp RDD"</span></span>
<span id="cb56-163"><a href="#cb56-163" aria-hidden="true" tabindex="-1"></a><span class="in">//| label: "fig-CDRDD" </span></span>
<span id="cb56-164"><a href="#cb56-164" aria-hidden="true" tabindex="-1"></a><span class="in">digraph "Causal Diagramm RDD" {</span></span>
<span id="cb56-165"><a href="#cb56-165" aria-hidden="true" tabindex="-1"></a><span class="in">  layout=neato</span></span>
<span id="cb56-166"><a href="#cb56-166" aria-hidden="true" tabindex="-1"></a><span class="in">  fontname="Helvetica,Arial,sans-serif"</span></span>
<span id="cb56-167"><a href="#cb56-167" aria-hidden="true" tabindex="-1"></a><span class="in">  node [fontname="Helvetica,Arial,sans-serif"]</span></span>
<span id="cb56-168"><a href="#cb56-168" aria-hidden="true" tabindex="-1"></a><span class="in">  edge [fontname="Helvetica,Arial,sans-serif"]</span></span>
<span id="cb56-169"><a href="#cb56-169" aria-hidden="true" tabindex="-1"></a><span class="in">  node [shape=none];</span></span>
<span id="cb56-170"><a href="#cb56-170" aria-hidden="true" tabindex="-1"></a><span class="in">  "X" [pos="0,1!"]</span></span>
<span id="cb56-171"><a href="#cb56-171" aria-hidden="true" tabindex="-1"></a><span class="in">  "Y" [pos="4,-1!"]</span></span>
<span id="cb56-172"><a href="#cb56-172" aria-hidden="true" tabindex="-1"></a><span class="in">  "Oberhalb c" [pos="0,-1!"]</span></span>
<span id="cb56-173"><a href="#cb56-173" aria-hidden="true" tabindex="-1"></a><span class="in">  "Z" [pos="4,1!"]</span></span>
<span id="cb56-174"><a href="#cb56-174" aria-hidden="true" tabindex="-1"></a><span class="in">  "Behandlung B" [pos="2,-1!"]</span></span>
<span id="cb56-175"><a href="#cb56-175" aria-hidden="true" tabindex="-1"></a><span class="in">  "X" -&gt; "Y"</span></span>
<span id="cb56-176"><a href="#cb56-176" aria-hidden="true" tabindex="-1"></a><span class="in">  "Z" -&gt; "X"</span></span>
<span id="cb56-177"><a href="#cb56-177" aria-hidden="true" tabindex="-1"></a><span class="in">  "Z" -&gt; "Y"</span></span>
<span id="cb56-178"><a href="#cb56-178" aria-hidden="true" tabindex="-1"></a><span class="in">  "X" -&gt; "Oberhalb c"</span></span>
<span id="cb56-179"><a href="#cb56-179" aria-hidden="true" tabindex="-1"></a><span class="in">  "Oberhalb c" -&gt; "Behandlung B"</span></span>
<span id="cb56-180"><a href="#cb56-180" aria-hidden="true" tabindex="-1"></a><span class="in">  "Behandlung B" -&gt; "Y"</span></span>
<span id="cb56-181"><a href="#cb56-181" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb56-182"><a href="#cb56-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-183"><a href="#cb56-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-184"><a href="#cb56-184" aria-hidden="true" tabindex="-1"></a>RDD isoliert Variation auf dem Pfad *Oberhalb C &amp;rarr; Behandlung B &amp;rarr; Y*. Somit können Backdoor-Pfade über $X$ oder weitere (möglichweise unbeobachtbare) Confounder ($Z$) vermieden werden, siehe @fig-CDRDD. Der kausale Effekt wird dabei als (lokaler) durchschnittlicher Behandlungseffekt der Diskontinuität auf die Outcome-Variable ($Y$) anhand von Beobachtungen *nahe bei c* ermittelt. </span>
<span id="cb56-185"><a href="#cb56-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-186"><a href="#cb56-186" aria-hidden="true" tabindex="-1"></a>Hinsichtlich der Beeinflussung der Behandlung unterscheiden wir zwischen *Sharp* und *Fuzzy* Regression Discontinuity Designs (SRDD/FRDD). Bei einem SRDD ist die Zuweisung der Behandlung *deterministisch*, d.h. der Schwellenwert in der Laufvariable ist eine harte Grenze für die Gruppenzugehörigkeit: Die *Wahrscheinlichkeit* der Behandlung $p$ springt bei $X=c$ von $p=0$ um $\Delta p = 1$ auf $p=1$.</span>
<span id="cb56-187"><a href="#cb56-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-188"><a href="#cb56-188" aria-hidden="true" tabindex="-1"></a>Bei einem FRDD ist die Zuordnung in Behandlungs- und Kontrollgruppe nicht perfekt durch den Schwellenwert $c$ bestimmt: Die Behandlungswahrscheinlichkeit $p$ springt bei $X=c$ um $\Delta p&lt;1$. Im FRDD können grundsätzlich also sowohl behandelte Subjekte als auch Kontroll-Beobachtungen auf beiden Seiten der Diskontinuität vorliegen -- die Trennung der Gruppen ist "unscharf"^<span class="co">[</span><span class="ot">Engl. *fuzzy*.</span><span class="co">]</span>. Dieser Umstand ist oft in empirischen Studien mit nicht-experimentellen Daten gegeben, wenn es neben der Überschreitung von $c$ weitere Determinanten der Behandlung gibt (für die wir nicht kontrollieren können). Die Wahl zwischen SRDD und FRDD hängt grundsätzlich vom datenerzeugenden Prozess und der Forschungsfrage ab.</span>
<span id="cb56-189"><a href="#cb56-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-190"><a href="#cb56-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-191"><a href="#cb56-191" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sharp Regression Discontinuity Design</span></span>
<span id="cb56-192"><a href="#cb56-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-193"><a href="#cb56-193" aria-hidden="true" tabindex="-1"></a>**Modell und funktionale Form**</span>
<span id="cb56-194"><a href="#cb56-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-195"><a href="#cb56-195" aria-hidden="true" tabindex="-1"></a>Die korrekte Spezifikation der funktionalen Form für ein RDD ist wichtig, um eine verzerrte Schätzung des Effekts zu vermeiden. Die einfachste Form eines SRDD kann anhand der linearen Regression </span>
<span id="cb56-196"><a href="#cb56-196" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb56-197"><a href="#cb56-197" aria-hidden="true" tabindex="-1"></a>Y_i = \beta_0 + \beta_1 B_i + \beta_2 X_i + u_i\label{eq-simpleSRDD}</span>
<span id="cb56-198"><a href="#cb56-198" aria-hidden="true" tabindex="-1"></a>\end{align} geschätzt werden, wobei $B_i$ eine Dummy-Variable für das Überschreiten des Schwellenwertes $c$ ist, d.h.</span>
<span id="cb56-199"><a href="#cb56-199" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb56-200"><a href="#cb56-200" aria-hidden="true" tabindex="-1"></a>  B_i=\begin{cases}</span>
<span id="cb56-201"><a href="#cb56-201" aria-hidden="true" tabindex="-1"></a>    0 &amp; X_i &lt; c<span class="sc">\\</span></span>
<span id="cb56-202"><a href="#cb56-202" aria-hidden="true" tabindex="-1"></a>    1 &amp; X_i \geq c.</span>
<span id="cb56-203"><a href="#cb56-203" aria-hidden="true" tabindex="-1"></a>  \end{cases}</span>
<span id="cb56-204"><a href="#cb56-204" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb56-205"><a href="#cb56-205" aria-hidden="true" tabindex="-1"></a>Damit ist $B_i$ eine *deterministische* Funktion der Laufvariable $X_i$ und zeigt die Zugehörigkeit zur Behandlungs- oder Treatmentgruppe an. Der Koeffizient $\beta_1$ misst den Behandlungseffekt.</span>
<span id="cb56-206"><a href="#cb56-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-207"><a href="#cb56-207" aria-hidden="true" tabindex="-1"></a>Das Modell \eqref{eq-simpleSRDD} unterstellt, dass $X$ links- und rechtsseitig von $c$ denselben Effekt auf $Y$ hat. Diese Annahme ist restriktiv. Eine Alternative ist ein lineares Interaktionsmodell</span>
<span id="cb56-208"><a href="#cb56-208" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb56-209"><a href="#cb56-209" aria-hidden="true" tabindex="-1"></a>Y_i = \beta_0 + \beta_1 B_i + \beta_2 (X_i - c) + \beta_3(X_i - c)\times B_i + u_i.\label{eq:linearSRDD}</span>
<span id="cb56-210"><a href="#cb56-210" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb56-211"><a href="#cb56-211" aria-hidden="true" tabindex="-1"></a>Das Modell \eqref{eq:linearSRDD} kann unterschiedliche lineare Effekte von $X$ auf $Y$ unterhalb ($\beta_2$) und oberhalb ($\beta_2 + \beta_3$) von $c$ abbilden. Beachte, dass $(X_i - c)$ die um den Schwellenwert zentrierte Laufvariable ist, sodass $\beta_1$ wie in \eqref{eq-simpleSRDD} den Unterschied des Effekts von $X$ auf $Y$ für Beoabachtungen am Schwellenwert erfasst. </span>
<span id="cb56-212"><a href="#cb56-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-213"><a href="#cb56-213" aria-hidden="true" tabindex="-1"></a>Um unterschiedliche nicht-lineare Zusammenhänge von $X$ und $Y$ unterhalb und oberhalb von $c$ abzubilden, können (interargierte) Polynom-Terme in $X$ verwendet werden. Häufig wird eine quadratische Regressionsfunktion genutzt,</span>
<span id="cb56-214"><a href="#cb56-214" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb56-215"><a href="#cb56-215" aria-hidden="true" tabindex="-1"></a>  Y_i =&amp;\, \beta_0 + \beta_1 B_i + \beta_2 (X_i - c) + \beta_3 (X_i - c)^2<span class="sc">\\</span> </span>
<span id="cb56-216"><a href="#cb56-216" aria-hidden="true" tabindex="-1"></a>       &amp;+\, \beta_4(X_i - c)\times B_i + \beta_5(X_i - c)\times B_i + u_i.\label{eq:quadSRDD}</span>
<span id="cb56-217"><a href="#cb56-217" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb56-218"><a href="#cb56-218" aria-hidden="true" tabindex="-1"></a>@GelmanImbens2019 zeigen, dass Polynome höherer Ordnung zu verzerrten Schätzern und hoher Varianz führen können.^<span class="co">[</span><span class="ot">Ursachen sind Überanpassung an die Daten sowie instabiles Verhalten der Schätzung nahe des Schwellenwertes.</span><span class="co">]</span> Die Authoren empfehlen stattdessen die Schätzung mit lokaler Regression.</span>
<span id="cb56-219"><a href="#cb56-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-220"><a href="#cb56-220" aria-hidden="true" tabindex="-1"></a>**Nicht-parametrische Schätzung und Bandweite**</span>
<span id="cb56-221"><a href="#cb56-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-222"><a href="#cb56-222" aria-hidden="true" tabindex="-1"></a>Aktuelle Studien nutzen nicht-parametrische Schätzer, die den Behandlungseffekt als Differenz der geschätzten Regressionsfunktionen am Schwellenwert $c$ berechnen. Um auch nicht-lineare Regressionsfunktionen abzubilden zu können, wird häufig lokale Regression verwendet. Dieses Verfahren liefert eine "lokale" Schätzung der Regressionsfunktionen am Schwellenwert, bei der nur Beobachtungen nahe $X = c$ für die Schätzung berücksichtigt werden. Hinreichende Nähe wird hierbei durch eine sogenannte Bandweite $h$ festgelegt, wobei </span>
<span id="cb56-223"><a href="#cb56-223" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb56-224"><a href="#cb56-224" aria-hidden="true" tabindex="-1"></a>  \lvert(X_i-c)\rvert\leq h \label{eq:bwc}</span>
<span id="cb56-225"><a href="#cb56-225" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb56-226"><a href="#cb56-226" aria-hidden="true" tabindex="-1"></a>das Kriterium für eine Berücksichtigung von Beobachtung $i$ bei der Schätzung ist. </span>
<span id="cb56-227"><a href="#cb56-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-228"><a href="#cb56-228" aria-hidden="true" tabindex="-1"></a>Unter Verwendung einer Bandweite $h$ wird der Regressionsansatz \eqref{eq:linearSRDD} als *lokale lineare Regression* mit Uniform-Kernelfunktion bezeichnet. Der Uniform-Kernel gibt allen Beobachtungen, innerhalb der Bandweite $h$ dasselbe Gewicht. Ist $h$ so groß, dass der gesamte Datensatz in die Schätzung einbezogen wird, entspricht der lokale lineare Regressions-Schätzer mit Uniform-Kernel dem (globalen) KQ-Schätzer in einem linearen Interaktionsmodell anhand aller Beobachtungen. Neben dem Uniform-Kernel ist der Triangular-Kernel eine in der Praxis häufig genutzte lineare Kernelfunktion. Der nachstehende Code plottet die Uniform- (grün) sowie die Triangular-Kernelfunktion (blau), siehe @fig-linearkern.</span>
<span id="cb56-231"><a href="#cb56-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-232"><a href="#cb56-232" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Kernelfunktionen auf [-1, 1]"</span></span>
<span id="cb56-233"><a href="#cb56-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-linearkern</span></span>
<span id="cb56-234"><a href="#cb56-234" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb56-235"><a href="#cb56-235" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2.5</span></span>
<span id="cb56-236"><a href="#cb56-236" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb56-237"><a href="#cb56-237" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb56-238"><a href="#cb56-238" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb56-239"><a href="#cb56-239" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb56-240"><a href="#cb56-240" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb56-241"><a href="#cb56-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-242"><a href="#cb56-242" aria-hidden="true" tabindex="-1"></a><span class="co"># Kernelfunktionen zeichnen</span></span>
<span id="cb56-243"><a href="#cb56-243" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb56-244"><a href="#cb56-244" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(</span>
<span id="cb56-245"><a href="#cb56-245" aria-hidden="true" tabindex="-1"></a>      <span class="at">fun =</span> <span class="sc">~</span> <span class="fu">ifelse</span>(</span>
<span id="cb56-246"><a href="#cb56-246" aria-hidden="true" tabindex="-1"></a>        <span class="at">test =</span> <span class="fu">abs</span>(.) <span class="sc">&lt;=</span> <span class="dv">1</span>,</span>
<span id="cb56-247"><a href="#cb56-247" aria-hidden="true" tabindex="-1"></a>        <span class="at">yes =</span>  <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, </span>
<span id="cb56-248"><a href="#cb56-248" aria-hidden="true" tabindex="-1"></a>        <span class="at">no =</span> <span class="dv">0</span></span>
<span id="cb56-249"><a href="#cb56-249" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb56-250"><a href="#cb56-250" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"green"</span>, </span>
<span id="cb56-251"><a href="#cb56-251" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="dv">1000</span></span>
<span id="cb56-252"><a href="#cb56-252" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span> </span>
<span id="cb56-253"><a href="#cb56-253" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(</span>
<span id="cb56-254"><a href="#cb56-254" aria-hidden="true" tabindex="-1"></a>      <span class="at">fun =</span> <span class="sc">~</span> <span class="fu">ifelse</span>(</span>
<span id="cb56-255"><a href="#cb56-255" aria-hidden="true" tabindex="-1"></a>        <span class="at">test =</span> <span class="fu">abs</span>(.) <span class="sc">&lt;=</span> <span class="dv">1</span>, </span>
<span id="cb56-256"><a href="#cb56-256" aria-hidden="true" tabindex="-1"></a>        <span class="at">yes =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">abs</span>(.), </span>
<span id="cb56-257"><a href="#cb56-257" aria-hidden="true" tabindex="-1"></a>        <span class="at">no =</span> <span class="dv">0</span></span>
<span id="cb56-258"><a href="#cb56-258" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb56-259"><a href="#cb56-259" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"blue"</span>, </span>
<span id="cb56-260"><a href="#cb56-260" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="dv">100</span></span>
<span id="cb56-261"><a href="#cb56-261" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span> </span>
<span id="cb56-262"><a href="#cb56-262" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb56-263"><a href="#cb56-263" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"x"</span>, </span>
<span id="cb56-264"><a href="#cb56-264" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>), </span>
<span id="cb56-265"><a href="#cb56-265" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb56-266"><a href="#cb56-266" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb56-267"><a href="#cb56-267" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb56-268"><a href="#cb56-268" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"K(x)"</span>, </span>
<span id="cb56-269"><a href="#cb56-269" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb56-270"><a href="#cb56-270" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.25</span>)</span>
<span id="cb56-271"><a href="#cb56-271" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb56-272"><a href="#cb56-272" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>()</span>
<span id="cb56-273"><a href="#cb56-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-274"><a href="#cb56-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-275"><a href="#cb56-275" aria-hidden="true" tabindex="-1"></a>In empirischen Studien wird als Basis-Spezifikation oft eine lokale lineare Regression anhand von \eqref{eq:linearSRDD} mit einer linearen Kernelfunktionen und geringer bandweite $h$ genutzt. Anschließend wird die Robustheit der Ergebnisse anhand flexiblerer Spezifikationen, die Nicht-Linearitäten in der Regressionsfunktion besser abbilden können, geprüft.</span>
<span id="cb56-276"><a href="#cb56-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-277"><a href="#cb56-277" aria-hidden="true" tabindex="-1"></a>Die nachstehende Visualisierung zeigt die Schätzung des kausalen Effektes der Behandlung $B_i$ anhand lokaler linearer Regression mit einem Uniform-Kernel für wiefolgt simulierte Daten:</span>
<span id="cb56-278"><a href="#cb56-278" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb56-279"><a href="#cb56-279" aria-hidden="true" tabindex="-1"></a>  Y_i =&amp;\, \beta_1 X_i + \beta_2 B + \beta_3 X_i^2 \times B_i + u_i,<span class="sc">\\</span></span>
<span id="cb56-280"><a href="#cb56-280" aria-hidden="true" tabindex="-1"></a>  <span class="sc">\\</span></span>
<span id="cb56-281"><a href="#cb56-281" aria-hidden="true" tabindex="-1"></a>  u_i \sim&amp;\, N(0, 0.5), \quad X_i \sim U(0, 10), \quad B = \mathbb{I}(X_i \geq c = 5)<span class="sc">\\</span></span>
<span id="cb56-282"><a href="#cb56-282" aria-hidden="true" tabindex="-1"></a>  \beta_1 =&amp;\, .5, \quad \beta_2 = 1.5, \quad \beta_3 = -0.15</span>
<span id="cb56-283"><a href="#cb56-283" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb56-284"><a href="#cb56-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-285"><a href="#cb56-285" aria-hidden="true" tabindex="-1"></a>Diese Vorschrift ist schnell mit R umgesetzt:</span>
<span id="cb56-286"><a href="#cb56-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-289"><a href="#cb56-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-290"><a href="#cb56-290" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb56-291"><a href="#cb56-291" aria-hidden="true" tabindex="-1"></a><span class="co"># Anz.Beobachtungen</span></span>
<span id="cb56-292"><a href="#cb56-292" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">750</span></span>
<span id="cb56-293"><a href="#cb56-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-294"><a href="#cb56-294" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter definieren</span></span>
<span id="cb56-295"><a href="#cb56-295" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb56-296"><a href="#cb56-296" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb56-297"><a href="#cb56-297" aria-hidden="true" tabindex="-1"></a>beta_2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb56-298"><a href="#cb56-298" aria-hidden="true" tabindex="-1"></a>beta_3 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">15</span></span>
<span id="cb56-299"><a href="#cb56-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-300"><a href="#cb56-300" aria-hidden="true" tabindex="-1"></a><span class="co"># Regressionsfunktion definieren</span></span>
<span id="cb56-301"><a href="#cb56-301" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(X) {</span>
<span id="cb56-302"><a href="#cb56-302" aria-hidden="true" tabindex="-1"></a>  beta_1 <span class="sc">*</span> (X <span class="sc">-</span> c) <span class="sc">+</span> beta_2 <span class="sc">*</span> B <span class="sc">+</span> beta_3 <span class="sc">*</span> B <span class="sc">*</span> (X <span class="sc">-</span> c)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb56-303"><a href="#cb56-303" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-304"><a href="#cb56-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-305"><a href="#cb56-305" aria-hidden="true" tabindex="-1"></a><span class="co"># Daten erzeugen</span></span>
<span id="cb56-306"><a href="#cb56-306" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">11</span>)</span>
<span id="cb56-307"><a href="#cb56-307" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(X <span class="sc">-</span> c <span class="sc">&gt;=</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb56-308"><a href="#cb56-308" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">f</span>(X) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> .<span class="dv">5</span>)</span>
<span id="cb56-309"><a href="#cb56-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-310"><a href="#cb56-310" aria-hidden="true" tabindex="-1"></a><span class="co"># Beoabchtungen sammeln</span></span>
<span id="cb56-311"><a href="#cb56-311" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb56-312"><a href="#cb56-312" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> Y, <span class="at">X =</span> X <span class="sc">-</span> c, <span class="at">B =</span> B</span>
<span id="cb56-313"><a href="#cb56-313" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-314"><a href="#cb56-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-315"><a href="#cb56-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-316"><a href="#cb56-316" aria-hidden="true" tabindex="-1"></a>::: {.content-hidden unless-format="html"}</span>
<span id="cb56-317"><a href="#cb56-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-320"><a href="#cb56-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb56-321"><a href="#cb56-321" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb56-322"><a href="#cb56-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-323"><a href="#cb56-323" aria-hidden="true" tabindex="-1"></a><span class="in">html`</span></span>
<span id="cb56-324"><a href="#cb56-324" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb56-325"><a href="#cb56-325" aria-hidden="true" tabindex="-1"></a><span class="in">.regression {</span></span>
<span id="cb56-326"><a href="#cb56-326" aria-hidden="true" tabindex="-1"></a><span class="in">  fill: none;</span></span>
<span id="cb56-327"><a href="#cb56-327" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke: #000;</span></span>
<span id="cb56-328"><a href="#cb56-328" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 1.5px;</span></span>
<span id="cb56-329"><a href="#cb56-329" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb56-330"><a href="#cb56-330" aria-hidden="true" tabindex="-1"></a><span class="in">.axis line {</span></span>
<span id="cb56-331"><a href="#cb56-331" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke: #ddd;</span></span>
<span id="cb56-332"><a href="#cb56-332" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb56-333"><a href="#cb56-333" aria-hidden="true" tabindex="-1"></a><span class="in">.axis .baseline line {</span></span>
<span id="cb56-334"><a href="#cb56-334" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke: #555;</span></span>
<span id="cb56-335"><a href="#cb56-335" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb56-336"><a href="#cb56-336" aria-hidden="true" tabindex="-1"></a><span class="in">.axis .domain {</span></span>
<span id="cb56-337"><a href="#cb56-337" aria-hidden="true" tabindex="-1"></a><span class="in">  display: none;</span></span>
<span id="cb56-338"><a href="#cb56-338" aria-hidden="true" tabindex="-1"></a><span class="in">} </span></span>
<span id="cb56-339"><a href="#cb56-339" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb56-340"><a href="#cb56-340" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css"&gt;</span></span>
<span id="cb56-341"><a href="#cb56-341" aria-hidden="true" tabindex="-1"></a><span class="in">`</span></span>
<span id="cb56-342"><a href="#cb56-342" aria-hidden="true" tabindex="-1"></a><span class="in">d3 = require("d3-array@3", "d3-axis@3", "d3-regression@1", "d3-scale@4", "d3-shape@3", "d3-selection@3", "d3-format")</span></span>
<span id="cb56-343"><a href="#cb56-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-344"><a href="#cb56-344" aria-hidden="true" tabindex="-1"></a><span class="in">margin = ({left: 55, right: 8, top: 13, bottom: 24});</span></span>
<span id="cb56-345"><a href="#cb56-345" aria-hidden="true" tabindex="-1"></a><span class="in">base = Math.min(width, 500);</span></span>
<span id="cb56-346"><a href="#cb56-346" aria-hidden="true" tabindex="-1"></a><span class="in">innerWidth = base - margin.left - margin.right;</span></span>
<span id="cb56-347"><a href="#cb56-347" aria-hidden="true" tabindex="-1"></a><span class="in">innerHeight = base-100 - margin.top - margin.bottom;</span></span>
<span id="cb56-348"><a href="#cb56-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-349"><a href="#cb56-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-350"><a href="#cb56-350" aria-hidden="true" tabindex="-1"></a><span class="in">viewof bw_daten_LLRU = Inputs.range([.1, 6], {</span></span>
<span id="cb56-351"><a href="#cb56-351" aria-hidden="true" tabindex="-1"></a><span class="in">  label: "Bandweite (h)",</span></span>
<span id="cb56-352"><a href="#cb56-352" aria-hidden="true" tabindex="-1"></a><span class="in">  step: .1,</span></span>
<span id="cb56-353"><a href="#cb56-353" aria-hidden="true" tabindex="-1"></a><span class="in">  value: 1.3</span></span>
<span id="cb56-354"><a href="#cb56-354" aria-hidden="true" tabindex="-1"></a><span class="in">});</span></span>
<span id="cb56-355"><a href="#cb56-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-356"><a href="#cb56-356" aria-hidden="true" tabindex="-1"></a><span class="in">xScaleLLRU = d3.scaleLinear()</span></span>
<span id="cb56-357"><a href="#cb56-357" aria-hidden="true" tabindex="-1"></a><span class="in">   .domain([-6, 6])</span></span>
<span id="cb56-358"><a href="#cb56-358" aria-hidden="true" tabindex="-1"></a><span class="in">   .range([0, innerWidth]);</span></span>
<span id="cb56-359"><a href="#cb56-359" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb56-360"><a href="#cb56-360" aria-hidden="true" tabindex="-1"></a><span class="in">yScaleLLRU = d3.scaleLinear()</span></span>
<span id="cb56-361"><a href="#cb56-361" aria-hidden="true" tabindex="-1"></a><span class="in">  .domain([-4, 6])</span></span>
<span id="cb56-362"><a href="#cb56-362" aria-hidden="true" tabindex="-1"></a><span class="in">  .range([innerHeight, 0]);</span></span>
<span id="cb56-363"><a href="#cb56-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-364"><a href="#cb56-364" aria-hidden="true" tabindex="-1"></a><span class="in">lineLLRU = d3.line()</span></span>
<span id="cb56-365"><a href="#cb56-365" aria-hidden="true" tabindex="-1"></a><span class="in">  .x(d =&gt; xScaleLLRU(d[0]))</span></span>
<span id="cb56-366"><a href="#cb56-366" aria-hidden="true" tabindex="-1"></a><span class="in">  .y(d =&gt; yScaleLLRU(d[1]));</span></span>
<span id="cb56-367"><a href="#cb56-367" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb56-368"><a href="#cb56-368" aria-hidden="true" tabindex="-1"></a><span class="in">xAxisLLRU = d3.axisBottom(xScaleLLRU)</span></span>
<span id="cb56-369"><a href="#cb56-369" aria-hidden="true" tabindex="-1"></a><span class="in">  .tickSize(innerHeight + 10)</span></span>
<span id="cb56-370"><a href="#cb56-370" aria-hidden="true" tabindex="-1"></a><span class="in">  .tickValues([-6, -4, -2, 0, 2, 4, 6])</span></span>
<span id="cb56-371"><a href="#cb56-371" aria-hidden="true" tabindex="-1"></a><span class="in">  .tickFormat(d =&gt; d);</span></span>
<span id="cb56-372"><a href="#cb56-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-373"><a href="#cb56-373" aria-hidden="true" tabindex="-1"></a><span class="in">yAxisLLRU = d3.axisLeft(yScaleLLRU)</span></span>
<span id="cb56-374"><a href="#cb56-374" aria-hidden="true" tabindex="-1"></a><span class="in">  .tickSize(innerWidth + 10)</span></span>
<span id="cb56-375"><a href="#cb56-375" aria-hidden="true" tabindex="-1"></a><span class="in">  .tickFormat(d =&gt; d);</span></span>
<span id="cb56-376"><a href="#cb56-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-377"><a href="#cb56-377" aria-hidden="true" tabindex="-1"></a><span class="in">LLRURegression = d3.regressionLinear()</span></span>
<span id="cb56-378"><a href="#cb56-378" aria-hidden="true" tabindex="-1"></a><span class="in">  .x(d =&gt; d.X)</span></span>
<span id="cb56-379"><a href="#cb56-379" aria-hidden="true" tabindex="-1"></a><span class="in">  .y(d =&gt; d.Y);</span></span>
<span id="cb56-380"><a href="#cb56-380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-381"><a href="#cb56-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-384"><a href="#cb56-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb56-385"><a href="#cb56-385" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb56-386"><a href="#cb56-386" aria-hidden="true" tabindex="-1"></a><span class="in">//| label: fig-srddviz</span></span>
<span id="cb56-387"><a href="#cb56-387" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-cap: "Nicht-parametrische Regression auf beiden Seiten des Cut-offs"</span></span>
<span id="cb56-388"><a href="#cb56-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-389"><a href="#cb56-389" aria-hidden="true" tabindex="-1"></a><span class="in">{</span></span>
<span id="cb56-390"><a href="#cb56-390" aria-hidden="true" tabindex="-1"></a><span class="in">  const svg = d3.select(DOM.svg(innerWidth + margin.left + margin.right + 20, innerHeight + margin.top + margin.bottom + 20))</span></span>
<span id="cb56-391"><a href="#cb56-391" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb56-392"><a href="#cb56-392" aria-hidden="true" tabindex="-1"></a><span class="in">  const g = svg.append("g")</span></span>
<span id="cb56-393"><a href="#cb56-393" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("transform", `translate(${margin.left}, ${margin.top})`);</span></span>
<span id="cb56-394"><a href="#cb56-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-395"><a href="#cb56-395" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("g")</span></span>
<span id="cb56-396"><a href="#cb56-396" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("class", "axis")</span></span>
<span id="cb56-397"><a href="#cb56-397" aria-hidden="true" tabindex="-1"></a><span class="in">      .call(xAxisLLRU);</span></span>
<span id="cb56-398"><a href="#cb56-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-399"><a href="#cb56-399" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("g")</span></span>
<span id="cb56-400"><a href="#cb56-400" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("class", "axis")</span></span>
<span id="cb56-401"><a href="#cb56-401" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("transform", `translate(${innerWidth})`)</span></span>
<span id="cb56-402"><a href="#cb56-402" aria-hidden="true" tabindex="-1"></a><span class="in">    .call(yAxisLLRU);</span></span>
<span id="cb56-403"><a href="#cb56-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-404"><a href="#cb56-404" aria-hidden="true" tabindex="-1"></a><span class="in">  // Add X axis label:</span></span>
<span id="cb56-405"><a href="#cb56-405" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("text")</span></span>
<span id="cb56-406"><a href="#cb56-406" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("text-anchor", "end")</span></span>
<span id="cb56-407"><a href="#cb56-407" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("font-size", 13)</span></span>
<span id="cb56-408"><a href="#cb56-408" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("x", innerWidth)</span></span>
<span id="cb56-409"><a href="#cb56-409" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("y", innerHeight + margin.top + 25)</span></span>
<span id="cb56-410"><a href="#cb56-410" aria-hidden="true" tabindex="-1"></a><span class="in">    .text("X - c");</span></span>
<span id="cb56-411"><a href="#cb56-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-412"><a href="#cb56-412" aria-hidden="true" tabindex="-1"></a><span class="in">  // Y axis label:</span></span>
<span id="cb56-413"><a href="#cb56-413" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("text")</span></span>
<span id="cb56-414"><a href="#cb56-414" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("text-anchor", "end")</span></span>
<span id="cb56-415"><a href="#cb56-415" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("transform", "rotate(-90)")</span></span>
<span id="cb56-416"><a href="#cb56-416" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("font-size", 13)</span></span>
<span id="cb56-417"><a href="#cb56-417" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("y", -margin.left+10)</span></span>
<span id="cb56-418"><a href="#cb56-418" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("x", -margin.top+10)</span></span>
<span id="cb56-419"><a href="#cb56-419" aria-hidden="true" tabindex="-1"></a><span class="in">    .text("Y");</span></span>
<span id="cb56-420"><a href="#cb56-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-421"><a href="#cb56-421" aria-hidden="true" tabindex="-1"></a><span class="in">  g.selectAll("circle")</span></span>
<span id="cb56-422"><a href="#cb56-422" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(transpose(SRDD))</span></span>
<span id="cb56-423"><a href="#cb56-423" aria-hidden="true" tabindex="-1"></a><span class="in">    .enter().append("circle")</span></span>
<span id="cb56-424"><a href="#cb56-424" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("r", 2)</span></span>
<span id="cb56-425"><a href="#cb56-425" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("cx", d =&gt; xScaleLLRU(d.X))</span></span>
<span id="cb56-426"><a href="#cb56-426" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("cy", d =&gt; yScaleLLRU(d.Y));</span></span>
<span id="cb56-427"><a href="#cb56-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-428"><a href="#cb56-428" aria-hidden="true" tabindex="-1"></a><span class="in">g.selectAll("circle")</span></span>
<span id="cb56-429"><a href="#cb56-429" aria-hidden="true" tabindex="-1"></a><span class="in"> .filter( function(d){ return Math.abs(d.X) &lt;= bw_daten_LLRU } )</span></span>
<span id="cb56-430"><a href="#cb56-430" aria-hidden="true" tabindex="-1"></a><span class="in"> .attr("fill", "orange")</span></span>
<span id="cb56-431"><a href="#cb56-431" aria-hidden="true" tabindex="-1"></a><span class="in"> .attr("stroke", "none");</span></span>
<span id="cb56-432"><a href="#cb56-432" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb56-433"><a href="#cb56-433" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- trf --&gt;</span></span>
<span id="cb56-434"><a href="#cb56-434" aria-hidden="true" tabindex="-1"></a><span class="in">var  line = d3.line()</span></span>
<span id="cb56-435"><a href="#cb56-435" aria-hidden="true" tabindex="-1"></a><span class="in">           .x(function(d) { return xScaleLLRU(d.X); }) </span></span>
<span id="cb56-436"><a href="#cb56-436" aria-hidden="true" tabindex="-1"></a><span class="in">           .y(function(d) { return yScaleLLRU(d.Y_true); }) </span></span>
<span id="cb56-437"><a href="#cb56-437" aria-hidden="true" tabindex="-1"></a><span class="in">           .curve(d3.curveLinear); </span></span>
<span id="cb56-438"><a href="#cb56-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-439"><a href="#cb56-439" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("path")</span></span>
<span id="cb56-440"><a href="#cb56-440" aria-hidden="true" tabindex="-1"></a><span class="in">    .datum(transpose(SRDD))</span></span>
<span id="cb56-441"><a href="#cb56-441" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("d", line)</span></span>
<span id="cb56-442"><a href="#cb56-442" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("fill", "none")</span></span>
<span id="cb56-443"><a href="#cb56-443" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("stroke", "red")</span></span>
<span id="cb56-444"><a href="#cb56-444" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("stroke-width", 2);</span></span>
<span id="cb56-445"><a href="#cb56-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-446"><a href="#cb56-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-447"><a href="#cb56-447" aria-hidden="true" tabindex="-1"></a><span class="in">function b(d) { return LLRURegression(</span></span>
<span id="cb56-448"><a href="#cb56-448" aria-hidden="true" tabindex="-1"></a><span class="in">        transpose(SRDD).filter(function(d){ return d.X &lt;= 0 &amp; d.X &gt;= -bw_daten_LLRU })</span></span>
<span id="cb56-449"><a href="#cb56-449" aria-hidden="true" tabindex="-1"></a><span class="in">    ); }</span></span>
<span id="cb56-450"><a href="#cb56-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-451"><a href="#cb56-451" aria-hidden="true" tabindex="-1"></a><span class="in">function a(d) { return LLRURegression(</span></span>
<span id="cb56-452"><a href="#cb56-452" aria-hidden="true" tabindex="-1"></a><span class="in">      transpose(SRDD).filter(function(d){ return d.X &gt; 0 &amp; d.X &lt;= bw_daten_LLRU })</span></span>
<span id="cb56-453"><a href="#cb56-453" aria-hidden="true" tabindex="-1"></a><span class="in">    ); }</span></span>
<span id="cb56-454"><a href="#cb56-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-455"><a href="#cb56-455" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("path")</span></span>
<span id="cb56-456"><a href="#cb56-456" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("class", "regression")</span></span>
<span id="cb56-457"><a href="#cb56-457" aria-hidden="true" tabindex="-1"></a><span class="in">      .datum(b)</span></span>
<span id="cb56-458"><a href="#cb56-458" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("d", lineLLRU)</span></span>
<span id="cb56-459"><a href="#cb56-459" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("stroke-width", 2)</span></span>
<span id="cb56-460"><a href="#cb56-460" aria-hidden="true" tabindex="-1"></a><span class="in">      .style("stroke", "#39FF14");</span></span>
<span id="cb56-461"><a href="#cb56-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-462"><a href="#cb56-462" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("path")</span></span>
<span id="cb56-463"><a href="#cb56-463" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("class", "regression")</span></span>
<span id="cb56-464"><a href="#cb56-464" aria-hidden="true" tabindex="-1"></a><span class="in">      .datum(a)</span></span>
<span id="cb56-465"><a href="#cb56-465" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("d", lineLLRU)</span></span>
<span id="cb56-466"><a href="#cb56-466" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("stroke-width", 2)</span></span>
<span id="cb56-467"><a href="#cb56-467" aria-hidden="true" tabindex="-1"></a><span class="in">      .style("stroke", "#39FF14");</span></span>
<span id="cb56-468"><a href="#cb56-468" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb56-469"><a href="#cb56-469" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("line")</span></span>
<span id="cb56-470"><a href="#cb56-470" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("x1", xScaleLLRU(0))</span></span>
<span id="cb56-471"><a href="#cb56-471" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("y1", yScaleLLRU((b().slice(-1))[0][1]))</span></span>
<span id="cb56-472"><a href="#cb56-472" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("x2", xScaleLLRU(0))</span></span>
<span id="cb56-473"><a href="#cb56-473" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("y2", yScaleLLRU((a().slice(0))[0][1]))</span></span>
<span id="cb56-474"><a href="#cb56-474" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("stroke", "#39FF14")</span></span>
<span id="cb56-475"><a href="#cb56-475" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("stroke-width", 2);</span></span>
<span id="cb56-476"><a href="#cb56-476" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb56-477"><a href="#cb56-477" aria-hidden="true" tabindex="-1"></a><span class="in">   g.append("text")</span></span>
<span id="cb56-478"><a href="#cb56-478" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("x", d =&gt; xScaleLLRU(-2.75))</span></span>
<span id="cb56-479"><a href="#cb56-479" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("y", d =&gt; yScaleLLRU(4.5))</span></span>
<span id="cb56-480"><a href="#cb56-480" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("dy", ".35em")</span></span>
<span id="cb56-481"><a href="#cb56-481" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("fill", "#39FF14")</span></span>
<span id="cb56-482"><a href="#cb56-482" aria-hidden="true" tabindex="-1"></a><span class="in">    .text(</span></span>
<span id="cb56-483"><a href="#cb56-483" aria-hidden="true" tabindex="-1"></a><span class="in">    d3.format(",.2f")( (a().slice(0))[0][1] - (b().slice(-1))[0][1] ) </span></span>
<span id="cb56-484"><a href="#cb56-484" aria-hidden="true" tabindex="-1"></a><span class="in">    );</span></span>
<span id="cb56-485"><a href="#cb56-485" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb56-486"><a href="#cb56-486" aria-hidden="true" tabindex="-1"></a><span class="in">  /* dashed line data bw upper */</span></span>
<span id="cb56-487"><a href="#cb56-487" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("line")</span></span>
<span id="cb56-488"><a href="#cb56-488" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("x1", xScaleLLRU(bw_daten_LLRU))</span></span>
<span id="cb56-489"><a href="#cb56-489" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("y1", 0)</span></span>
<span id="cb56-490"><a href="#cb56-490" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("x2", xScaleLLRU(bw_daten_LLRU))</span></span>
<span id="cb56-491"><a href="#cb56-491" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("y2", innerHeight)</span></span>
<span id="cb56-492"><a href="#cb56-492" aria-hidden="true" tabindex="-1"></a><span class="in">  .style("stroke", "blue")</span></span>
<span id="cb56-493"><a href="#cb56-493" aria-hidden="true" tabindex="-1"></a><span class="in">  .style("stroke-dasharray", "4")</span></span>
<span id="cb56-494"><a href="#cb56-494" aria-hidden="true" tabindex="-1"></a><span class="in">  .style("stroke-width", "1");</span></span>
<span id="cb56-495"><a href="#cb56-495" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb56-496"><a href="#cb56-496" aria-hidden="true" tabindex="-1"></a><span class="in">  /* dashed line data bw lower */</span></span>
<span id="cb56-497"><a href="#cb56-497" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("line")</span></span>
<span id="cb56-498"><a href="#cb56-498" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("x1", xScaleLLRU(-bw_daten_LLRU))</span></span>
<span id="cb56-499"><a href="#cb56-499" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("y1", 0)</span></span>
<span id="cb56-500"><a href="#cb56-500" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("x2", xScaleLLRU(-bw_daten_LLRU))</span></span>
<span id="cb56-501"><a href="#cb56-501" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("y2", innerHeight)</span></span>
<span id="cb56-502"><a href="#cb56-502" aria-hidden="true" tabindex="-1"></a><span class="in">  .style("stroke", "blue")</span></span>
<span id="cb56-503"><a href="#cb56-503" aria-hidden="true" tabindex="-1"></a><span class="in">  .style("stroke-dasharray", "4")</span></span>
<span id="cb56-504"><a href="#cb56-504" aria-hidden="true" tabindex="-1"></a><span class="in">  .style("stroke-width", "1");</span></span>
<span id="cb56-505"><a href="#cb56-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-506"><a href="#cb56-506" aria-hidden="true" tabindex="-1"></a><span class="in">  return svg.node();</span></span>
<span id="cb56-507"><a href="#cb56-507" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb56-508"><a href="#cb56-508" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-509"><a href="#cb56-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-510"><a href="#cb56-510" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-511"><a href="#cb56-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-512"><a href="#cb56-512" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb56-513"><a href="#cb56-513" aria-hidden="true" tabindex="-1"></a>----</span>
<span id="cb56-514"><a href="#cb56-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-515"><a href="#cb56-515" aria-hidden="true" tabindex="-1"></a>***Diese interaktive Komponente des Buchs ist nur in der Online-Version verfügbar.***</span>
<span id="cb56-516"><a href="#cb56-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-517"><a href="#cb56-517" aria-hidden="true" tabindex="-1"></a>----</span>
<span id="cb56-518"><a href="#cb56-518" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-519"><a href="#cb56-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-520"><a href="#cb56-520" aria-hidden="true" tabindex="-1"></a>Der interssierende Effekt am Schwellenwert $c=5$ beträgt $\beta_2 = 1.5$. Beachte, dass aufgrund des Terms $\beta_3 X_i^2 \times B_i$ ein quadratischer Zusammenhang von $Y$ und $X$ oberhalb von $X_i = c$ vorliegt. Es können folgende Eigenschaften der Schätzung in Abhängigkeit von der Bandweite $h$ beobachtet werden:</span>
<span id="cb56-521"><a href="#cb56-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-522"><a href="#cb56-522" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Für die voreingestellte Bandweite $h = 1.3$ liefert die lokale lineare Regression eine gute Approximation des Regressionszusammenhangs auf beiden Seiten des Schwellenwertes und die Schätzung des Behandlungseffekts liegt nahe beim wahren Wert $\beta_2 = 1.5$.</span>
<span id="cb56-523"><a href="#cb56-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-524"><a href="#cb56-524" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Für kleinere Bandweiten verringert sich die Datenbasis der Schätzung. Die Varianz der Schätzung nimmt zu und die Approximation der Regressionsfunktion verschlechtert sich. Wir beobachten eine mit $h\to0$ zunehmende Verzerrung bei der Schätzung des Behandlungseffekts.</span>
<span id="cb56-525"><a href="#cb56-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-526"><a href="#cb56-526" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Größere Bandweiten $h$ erhöhen die Datenbasis der Schätzung, führen aber zu einer Annäherung der lokalen Schätzung an die globale KQ-Schätzung. Linksseitig des Schwellenwertes erzielen wir damit eine Schätzung mit hoher Güte. Rechsseitig von $X_i = c$ verschlechtert sich die lokale Anpassung am Schwellenwert deutlich, weil die lineare Schätzung den tatsächlichen (nicht-linearen) Zusammenhang nicht adäquat abbilden kann. Die Schätzung des Behandlungseffekts ist hier deutlich verzerrt.</span>
<span id="cb56-527"><a href="#cb56-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-528"><a href="#cb56-528" aria-hidden="true" tabindex="-1"></a>Die Wahl der Bandweite ist also eine wichtige Komponenten der RDD-Schätzung: Kleine Bandweiten erlauben eine Schätzung der Regressionsfunktion nahe des Schwellenwertes mit wenig Verzerrung. Allerdings kann diese Schätzung unpräzise sein, wenn nur wenige Beobachtungen \eqref{eq:bwc} erfüllen. In der Praxis wird $h$ daher mit einem analytischen Schätzer <span class="co">[</span><span class="ot">vgl. @ImbensKalyanaraman2012</span><span class="co">]</span> oder anhand von *Cross Validation* <span class="co">[</span><span class="ot">bspw. @ImbensLemieux2008</span><span class="co">]</span> bestimmt. Die später in diesem Kapitel betrachteten R-Pakete halten diese Methoden bereit.</span>
<span id="cb56-529"><a href="#cb56-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-530"><a href="#cb56-530" aria-hidden="true" tabindex="-1"></a><span class="fu">## Manipulation am Schwellenwert</span></span>
<span id="cb56-531"><a href="#cb56-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-532"><a href="#cb56-532" aria-hidden="true" tabindex="-1"></a>Eine wichtige Annahmen für die Gültigkeit einer RDD-Schätzung ist, dass keine Manipulation der Gruppenzugehörigkeit am Schwellenwert vorliegt. Wenn sich Subjekte nahe des Schwellenwertes $c$ --- d.h. in Abhängigkeit der Laufvariable $X$ --- systematisch in den Confoundern $Z$ unterscheiden, können wir den Backdoor-Pfad *Oberhalb C &amp;rarr; Behandlung B &amp;rarr; Y* nicht isolieren. Wir erhalten dann eine verzerrte Schätzung des Behandlungseffekts.</span>
<span id="cb56-533"><a href="#cb56-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-534"><a href="#cb56-534" aria-hidden="true" tabindex="-1"></a>In empirischen Studien mit Individuen kann Selbstselektion auftreten: Menschen mit $X&lt;c$ aber nahe $c$ (hier Kontrollgruppe) könnten aufgrund unbeobachtbarer Eigenschaften $Z$ die Ausprägung ihrer Laufvariable zu $X&gt;c$ (hier Behandlungsgruppe) manipulieren. Wenn $Z$ die Outcome-Variable beeinflusst, bleibt der Backdoor-Pfad *Oberhalb C &amp;rarr; Behandlung B &amp;rarr; Y* so bestehen.  </span>
<span id="cb56-535"><a href="#cb56-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-536"><a href="#cb56-536" aria-hidden="true" tabindex="-1"></a>Manipulation resultiert in Häufung von Beobachtungen am Schwellenwert. Dei Verteilung der Laufvariable kann auf diese Unregelmäßigkeit hin untersucht werden. @McCrary2008 schlägt hierfür einen Verfahren vor, das die Kontinuität der Dichtefunktion von $X$ am Schwellenwert testet.</span>
<span id="cb56-537"><a href="#cb56-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-538"><a href="#cb56-538" aria-hidden="true" tabindex="-1"></a>Der Test von @McCrary2008 ist in <span class="in">`rdd::DCdensity()`</span> implementiert. Wir zeigen die Anwendung des Tests anhand der oben simulierten Daten. Beachte, dass $X_i\sim U(0, 10)$, d.h. die Laufvariable ist bei $X_i = c$ kontinuierlich verteilt. Die Nullhypothese (keine Manipulation) gilt für die simulierten Daten</span>
<span id="cb56-539"><a href="#cb56-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-542"><a href="#cb56-542" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-543"><a href="#cb56-543" aria-hidden="true" tabindex="-1"></a><span class="co"># McCrary-Test durchführen</span></span>
<span id="cb56-544"><a href="#cb56-544" aria-hidden="true" tabindex="-1"></a>p_mccrary <span class="ot">&lt;-</span> rdd<span class="sc">::</span><span class="fu">DCdensity</span>(</span>
<span id="cb56-545"><a href="#cb56-545" aria-hidden="true" tabindex="-1"></a>  <span class="at">runvar =</span> X, </span>
<span id="cb56-546"><a href="#cb56-546" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutpoint =</span> c, </span>
<span id="cb56-547"><a href="#cb56-547" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> F</span>
<span id="cb56-548"><a href="#cb56-548" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-549"><a href="#cb56-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-550"><a href="#cb56-550" aria-hidden="true" tabindex="-1"></a><span class="co"># p-Wert</span></span>
<span id="cb56-551"><a href="#cb56-551" aria-hidden="true" tabindex="-1"></a>p_mccrary</span>
<span id="cb56-552"><a href="#cb56-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-553"><a href="#cb56-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-554"><a href="#cb56-554" aria-hidden="true" tabindex="-1"></a>Der p-Wert <span class="in">`r round(p_mccrary, 2)`</span> ist größer als jedes übliche Signifikanzniveau. Damit liegt starke Evidenz für die Nullhypothese (keine Diskontinuität) und gegen Manipulation am Schwellenwert vor.</span>
<span id="cb56-555"><a href="#cb56-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-556"><a href="#cb56-556" aria-hidden="true" tabindex="-1"></a>@CJM2020 (CMJ) schlagen eine Weiterentwicklung des McCrary-Tests vor, die höhere statistische Macht gegenüber Diskontinuitäten hat am Schwellenwert hat. Der CJM-Test ist im Paket <span class="in">`rddensity`</span> implementiert.</span>
<span id="cb56-557"><a href="#cb56-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-560"><a href="#cb56-560" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-561"><a href="#cb56-561" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rddensity)</span>
<span id="cb56-562"><a href="#cb56-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-563"><a href="#cb56-563" aria-hidden="true" tabindex="-1"></a><span class="co"># CJM Schätzer berechnen</span></span>
<span id="cb56-564"><a href="#cb56-564" aria-hidden="true" tabindex="-1"></a>CJM <span class="ot">&lt;-</span> <span class="fu">rddensity</span>(X, <span class="at">c =</span> <span class="dv">5</span>)</span>
<span id="cb56-565"><a href="#cb56-565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-566"><a href="#cb56-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-567"><a href="#cb56-567" aria-hidden="true" tabindex="-1"></a>Mit der Funktion <span class="in">`rddensity::rdplotdensity()`</span> erzeugen wir @fig-cjmtsim.</span>
<span id="cb56-568"><a href="#cb56-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-571"><a href="#cb56-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-572"><a href="#cb56-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "CJM-Test -- geschätzte Dichtefunktionen der Laufvariable auf beiden Seiten des Schwellenwerts c = 5"</span></span>
<span id="cb56-573"><a href="#cb56-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-cjmtsim</span></span>
<span id="cb56-574"><a href="#cb56-574" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot für Dichtefunktion erstellen</span></span>
<span id="cb56-575"><a href="#cb56-575" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">rdplotdensity</span>(</span>
<span id="cb56-576"><a href="#cb56-576" aria-hidden="true" tabindex="-1"></a>  <span class="at">rdd =</span> CJM, </span>
<span id="cb56-577"><a href="#cb56-577" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> X, </span>
<span id="cb56-578"><a href="#cb56-578" aria-hidden="true" tabindex="-1"></a>  <span class="co"># für Punkte- und Linienplots:</span></span>
<span id="cb56-579"><a href="#cb56-579" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"both"</span> </span>
<span id="cb56-580"><a href="#cb56-580" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-581"><a href="#cb56-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-582"><a href="#cb56-582" aria-hidden="true" tabindex="-1"></a>@fig-cjmtsim zeigt die geschätzten Dichtefunktionen. Erwartungsgemäß finden wir eine große Überlappung der zugehörigen Konfidenzbänder (schattierte Flächen) am Schwellenwert $c=5$.</span>
<span id="cb56-583"><a href="#cb56-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-584"><a href="#cb56-584" aria-hidden="true" tabindex="-1"></a>Mit <span class="in">`summary()`</span> erhalten wir eine detaillierte Zusammenfassung des Tests. </span>
<span id="cb56-585"><a href="#cb56-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-588"><a href="#cb56-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-589"><a href="#cb56-589" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistische Zusammenfassung des CJM-Tests</span></span>
<span id="cb56-590"><a href="#cb56-590" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(CJM)</span>
<span id="cb56-591"><a href="#cb56-591" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-592"><a href="#cb56-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-593"><a href="#cb56-593" aria-hidden="true" tabindex="-1"></a>Gemäß des p-Werts (<span class="in">`P &gt; |T|`</span>) von 0.74 spricht der CJM-Test noch deutlicher gegen eine Diskontinuität als der McCrary-Test.</span>
<span id="cb56-594"><a href="#cb56-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-595"><a href="#cb56-595" aria-hidden="true" tabindex="-1"></a><span class="fu">### Case Study: Amtsinhaber-Vorteil [@Lee2008]</span></span>
<span id="cb56-596"><a href="#cb56-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-597"><a href="#cb56-597" aria-hidden="true" tabindex="-1"></a>@Lee2008 untersucht den Einfluss des Amtsinhaber-Vorteils auf die Wahl von Mitgliedern des US-Repräsentantenhaus. In den meisten Wahlkreisen entfallen große Anteile der Stimmen (oder gar ausschließlich) auf demokratische und republikanische Kanditat<span class="sc">\*</span>innen, sodass sich die Studie auf diese Parteien beschränkt. Entfällt die Mehrheit der Stimmen auf eine<span class="sc">\*</span>n Kandiat<span class="sc">\*</span>in, gewinnt diese<span class="sc">\*</span>r den Sitz für den Wahlkreis. Durch die Analyse der 6558 Wahlen im Zeitraum 1946-1998 mit einem SRDD kommt die Studie zu dem Ergebnis, dass Amtsinhabende im Durchschnitt einen Vorteil von etwa 8% bis 10% bei der Wahl haben. Dieses Ergebnis kann verschiedene Ursachen haben, bspw. dass die amtierende Partei höhere finanzielle Ressourcen besitzt und von einer besseren Organisation und durch Instrumenalisierung staatlicher Strukturen für die eigenen Zwecke profitiert.</span>
<span id="cb56-598"><a href="#cb56-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-599"><a href="#cb56-599" aria-hidden="true" tabindex="-1"></a>Anhand der Datensätze <span class="in">`house`</span> und <span class="in">`house_binned`</span> illustrieren wir nachfolgend die Schätzung von SRDD-Modellen für den Wahlerfolg der demokratischen Partei, wenn diese Amtsinhaber ist. Wir lesen hierfür zunächst die Datensätze <span class="in">`house`</span> und <span class="in">`house_binned`</span> ein und verschaffen uns einen Überblick.</span>
<span id="cb56-600"><a href="#cb56-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-603"><a href="#cb56-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-604"><a href="#cb56-604" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb56-605"><a href="#cb56-605" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb56-606"><a href="#cb56-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-607"><a href="#cb56-607" aria-hidden="true" tabindex="-1"></a><span class="co"># Daten einlesen</span></span>
<span id="cb56-608"><a href="#cb56-608" aria-hidden="true" tabindex="-1"></a>house <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datasets/house.csv"</span>)</span>
<span id="cb56-609"><a href="#cb56-609" aria-hidden="true" tabindex="-1"></a><span class="co"># Gruppierter Datensatz</span></span>
<span id="cb56-610"><a href="#cb56-610" aria-hidden="true" tabindex="-1"></a>house_binned <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datasets/house_binned.csv"</span>)</span>
<span id="cb56-611"><a href="#cb56-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-612"><a href="#cb56-612" aria-hidden="true" tabindex="-1"></a><span class="co"># Überblick verschaffen</span></span>
<span id="cb56-613"><a href="#cb56-613" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(house)</span>
<span id="cb56-614"><a href="#cb56-614" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(house_binned)</span>
<span id="cb56-615"><a href="#cb56-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-616"><a href="#cb56-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-617"><a href="#cb56-617" aria-hidden="true" tabindex="-1"></a>Der Datensatz <span class="in">`house`</span> enthält die Stimmenanteile demokratischer Kandidat<span class="sc">\*</span>innen bei der Wahl zum Zeitpunkt $T$ ($StimmenT$) sowie die Differenz zwischen demokratischen und republikanischen Stimmenanteilen bei der vorherigen Wahl, d.h. zum Zeitpunkt $T-1$ ($StimmenTm1$). Der Schwellenwert für einen Wahlsieg liegt bei Stimmengleichheit, d.h. $StimmenTm1 = 0$.</span>
<span id="cb56-618"><a href="#cb56-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-619"><a href="#cb56-619" aria-hidden="true" tabindex="-1"></a><span class="in">`house_binned`</span> ist eine aggregierte Version von <span class="in">`house`</span> mit Mittelwerten von jeweils 50 gleichgroßen Intervallen oberhalb und unterhalb der Schwelle von $StimmenTm1 = 0$. Dieser Datensatz eignet sich, um einen ersten Eindruck des funktionalen Zusammenhangs auf beiden Seiten zu erhalten. Wir stellen zunächst diese klassierten Daten mit <span class="in">`ggplot2`</span> graphisch dar.</span>
<span id="cb56-620"><a href="#cb56-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-623"><a href="#cb56-623" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-624"><a href="#cb56-624" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Klassierte Daten aus Lee (2008)</span></span>
<span id="cb56-625"><a href="#cb56-625" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-LeeDataClass</span></span>
<span id="cb56-626"><a href="#cb56-626" aria-hidden="true" tabindex="-1"></a><span class="co"># Klassierte Daten plotten</span></span>
<span id="cb56-627"><a href="#cb56-627" aria-hidden="true" tabindex="-1"></a>house_binned <span class="sc">%&gt;%</span></span>
<span id="cb56-628"><a href="#cb56-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb56-629"><a href="#cb56-629" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> StimmenTm1, <span class="at">y =</span> StimmenT)</span>
<span id="cb56-630"><a href="#cb56-630" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb56-631"><a href="#cb56-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb56-632"><a href="#cb56-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb56-633"><a href="#cb56-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-634"><a href="#cb56-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-635"><a href="#cb56-635" aria-hidden="true" tabindex="-1"></a>Die Grafik zeigt eindeutig einen Sprung von $StimmenT$ bei $StimmenTm1 = 0$. Weiterhin erkennen wir, dass der Zusammenhang nahe $0$ vermutlich jeweils gut durch eine lineare Funktion approximiert werden kann. Eine Modell-Spezifikation mit gleicher Steigung auf beiden Seiten des Schwellenwertes scheint hingegen weniger gut geeignet. Wir vergleichen diese Spezifikationen nachfolgend. </span>
<span id="cb56-636"><a href="#cb56-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-637"><a href="#cb56-637" aria-hidden="true" tabindex="-1"></a>Zunächst fügen wir dem Datensatz eine Dummyvariable <span class="in">`B`</span> hinzu. Diese dient als Indikator für den Wahlgewinn in der letzten Wahl und zeigt die Amtsinhaberschaft (Behandlung) an.</span>
<span id="cb56-638"><a href="#cb56-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-641"><a href="#cb56-641" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-642"><a href="#cb56-642" aria-hidden="true" tabindex="-1"></a><span class="co"># Behandlungsindikator B hinzufügen</span></span>
<span id="cb56-643"><a href="#cb56-643" aria-hidden="true" tabindex="-1"></a>house <span class="ot">&lt;-</span> house <span class="sc">%&gt;%</span> </span>
<span id="cb56-644"><a href="#cb56-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">B =</span> StimmenTm1 <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb56-645"><a href="#cb56-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-646"><a href="#cb56-646" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(house)</span>
<span id="cb56-647"><a href="#cb56-647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-648"><a href="#cb56-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-649"><a href="#cb56-649" aria-hidden="true" tabindex="-1"></a>Wir überprüfen die Laufvariable mit dem CJM-Test auf Manipulation am Schwellenwert $c=0$.</span>
<span id="cb56-650"><a href="#cb56-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-651"><a href="#cb56-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=F}</span></span>
<span id="cb56-652"><a href="#cb56-652" aria-hidden="true" tabindex="-1"></a><span class="in"># CJM-Test durchführen</span></span>
<span id="cb56-653"><a href="#cb56-653" aria-hidden="true" tabindex="-1"></a><span class="in">CJM_Lee &lt;- rddensity(X = house$StimmenTm1)</span></span>
<span id="cb56-654"><a href="#cb56-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-655"><a href="#cb56-655" aria-hidden="true" tabindex="-1"></a><span class="in"># Zusammenfassung anzeigen</span></span>
<span id="cb56-656"><a href="#cb56-656" aria-hidden="true" tabindex="-1"></a><span class="in">summary(CJM_Lee)</span></span>
<span id="cb56-657"><a href="#cb56-657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-658"><a href="#cb56-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-661"><a href="#cb56-661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-662"><a href="#cb56-662" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "CJM-Test -- geschätzte Dichtefunktionen der Laufvariable"</span></span>
<span id="cb56-663"><a href="#cb56-663" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-cjm-lee</span></span>
<span id="cb56-664"><a href="#cb56-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-665"><a href="#cb56-665" aria-hidden="true" tabindex="-1"></a><span class="co"># CJM-Plot</span></span>
<span id="cb56-666"><a href="#cb56-666" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">rdplotdensity</span>(</span>
<span id="cb56-667"><a href="#cb56-667" aria-hidden="true" tabindex="-1"></a>  <span class="at">rdd =</span> CJM_Lee,</span>
<span id="cb56-668"><a href="#cb56-668" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> house<span class="sc">$</span>StimmenTm1, </span>
<span id="cb56-669"><a href="#cb56-669" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"both"</span>, </span>
<span id="cb56-670"><a href="#cb56-670" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-671"><a href="#cb56-671" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-672"><a href="#cb56-672" aria-hidden="true" tabindex="-1"></a>@fig-cjm-lee und der p-Wert von $0.15$ sind Evidenz gegen eine Manipulation am Schwellenwert. </span>
<span id="cb56-673"><a href="#cb56-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-674"><a href="#cb56-674" aria-hidden="true" tabindex="-1"></a>Um den Behandlungseffekt anhand eines SRDDs zu ermitteln, schätzen wir das Interaktionsmodell </span>
<span id="cb56-675"><a href="#cb56-675" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb56-676"><a href="#cb56-676" aria-hidden="true" tabindex="-1"></a>  \text{StimmenT}_i =&amp;\, \beta_0 + \beta_1 B_i + \beta_2 (\text{StimmenTm1}_i - 50)<span class="sc">\\</span> </span>
<span id="cb56-677"><a href="#cb56-677" aria-hidden="true" tabindex="-1"></a>  +&amp;\, \beta_3(\text{StimmenTm1}_i - 50)\times B_i + u_i</span>
<span id="cb56-678"><a href="#cb56-678" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb56-679"><a href="#cb56-679" aria-hidden="true" tabindex="-1"></a>zunächst für eine Bandweite von $h = 0.5$. Aufgrund der Skalierung der Daten (Wahlergebnisse in \%) bedeutet dies die Verwendung des *gesamten* Datensatzes für die Schätzung.</span>
<span id="cb56-680"><a href="#cb56-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-683"><a href="#cb56-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-684"><a href="#cb56-684" aria-hidden="true" tabindex="-1"></a><span class="co"># Interaktionsmodell schätzen</span></span>
<span id="cb56-685"><a href="#cb56-685" aria-hidden="true" tabindex="-1"></a>house_llr1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb56-686"><a href="#cb56-686" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> StimmenT <span class="sc">~</span> B <span class="sc">*</span> StimmenTm1, </span>
<span id="cb56-687"><a href="#cb56-687" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> house</span>
<span id="cb56-688"><a href="#cb56-688" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-689"><a href="#cb56-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-690"><a href="#cb56-690" aria-hidden="true" tabindex="-1"></a><span class="co"># Zusammenfassung anzeigen  </span></span>
<span id="cb56-691"><a href="#cb56-691" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb56-692"><a href="#cb56-692" aria-hidden="true" tabindex="-1"></a>  <span class="at">models =</span> house_llr1, </span>
<span id="cb56-693"><a href="#cb56-693" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov =</span> <span class="st">"HC1"</span>, <span class="co"># robuste Standardfehler</span></span>
<span id="cb56-694"><a href="#cb56-694" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> T, </span>
<span id="cb56-695"><a href="#cb56-695" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_map =</span> <span class="st">"nobs"</span>, </span>
<span id="cb56-696"><a href="#cb56-696" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"gt"</span></span>
<span id="cb56-697"><a href="#cb56-697" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-698"><a href="#cb56-698" aria-hidden="true" tabindex="-1"></a>  tabopts</span>
<span id="cb56-699"><a href="#cb56-699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-700"><a href="#cb56-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-701"><a href="#cb56-701" aria-hidden="true" tabindex="-1"></a>Der geschätzte Koeffizient von $B$ (<span class="in">`BTRUE`</span>) beträgt etwa $0.12$ und ist hochsignifikant. Übereinstimmend mit @fig-LeeDataClass erhalten wir also eine positive Schätzung des Behandlungseffekts. Die Interpretation ist, dass die amtierenden Demokraten bei der Wahl von einem Amtsinhabervorteil profitieren. Dieser Effekt schlägt sich als Stimmenbonus von geschätzten 12\% nieder. Diese Schätzung des Behandlungseffekts könnte jedoch verzerrt sein: </span>
<span id="cb56-702"><a href="#cb56-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-703"><a href="#cb56-703" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Die (implizite) Wahl von $h=0.5$ in unserer Schätzung macht die Isolation des relevanten Frontdoor-Paths ($c=0$ <span class="dv">&amp;rarr;</span> Treatment <span class="dv">&amp;rarr;</span> StimmenT) wenig plausibel. $h$ sollte mit einer datengetriebenen Methode gewählt werden.</span>
<span id="cb56-704"><a href="#cb56-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-705"><a href="#cb56-705" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Weiterhin könnte die lineare funktionale Form der Regression inadäquat sein: Die lineare Approximation der wahren Regressionsfunktion nahe des Schwellenwerts $0$ könnte unzureichend sein und in einer verzerrten Schätzung des Effekts resultieren. Zur Überprüfung der Robustheit der Ergebnisse sollte mit Schätzungen anhand nicht-linearer Spezifikationen verglichen werden.</span>
<span id="cb56-706"><a href="#cb56-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-707"><a href="#cb56-707" aria-hidden="true" tabindex="-1"></a>Um diesen Gefahren für die Validität der Studie zu begegnen, schätzen wir nun weitere Spezifikationen. Im Folgenden verwenden wir eine Bandweitenschätzung gemäß @ImbensKalyanaraman2012.</span>
<span id="cb56-708"><a href="#cb56-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-711"><a href="#cb56-711" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-712"><a href="#cb56-712" aria-hidden="true" tabindex="-1"></a><span class="co"># Bandweite mit Schätzer von IK (2012) berechnen</span></span>
<span id="cb56-713"><a href="#cb56-713" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb56-714"><a href="#cb56-714" aria-hidden="true" tabindex="-1"></a>IK_BW <span class="ot">&lt;-</span> </span>
<span id="cb56-715"><a href="#cb56-715" aria-hidden="true" tabindex="-1"></a>  rdd<span class="sc">::</span><span class="fu">IKbandwidth</span>(</span>
<span id="cb56-716"><a href="#cb56-716" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> house<span class="sc">$</span>StimmenTm1, </span>
<span id="cb56-717"><a href="#cb56-717" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> house<span class="sc">$</span>StimmenT</span>
<span id="cb56-718"><a href="#cb56-718" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-719"><a href="#cb56-719" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-720"><a href="#cb56-720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-721"><a href="#cb56-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-722"><a href="#cb56-722" aria-hidden="true" tabindex="-1"></a>Wir schätzen zunächst erneut das lineare Interaktionsmodell, diesmal jedoch mit der Bandweite <span class="in">`IK_BW`</span>.</span>
<span id="cb56-723"><a href="#cb56-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-726"><a href="#cb56-726" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-727"><a href="#cb56-727" aria-hidden="true" tabindex="-1"></a><span class="co"># Lineares Interaktionsmodelle mit IK-Bandweite</span></span>
<span id="cb56-728"><a href="#cb56-728" aria-hidden="true" tabindex="-1"></a>house_llin_IK <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb56-729"><a href="#cb56-729" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> StimmenT <span class="sc">~</span> B <span class="sc">*</span> StimmenTm1, </span>
<span id="cb56-730"><a href="#cb56-730" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> house <span class="sc">%&gt;%</span> </span>
<span id="cb56-731"><a href="#cb56-731" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb56-732"><a href="#cb56-732" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>(StimmenTm1) <span class="sc">&lt;=</span> IK_BW</span>
<span id="cb56-733"><a href="#cb56-733" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-734"><a href="#cb56-734" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-735"><a href="#cb56-735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-736"><a href="#cb56-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-737"><a href="#cb56-737" aria-hidden="true" tabindex="-1"></a>Für den Vergleich mit einer nicht-linearen Spezifikation schätzen wir auch ein quadratisches Interaktionsmodell.</span>
<span id="cb56-738"><a href="#cb56-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-741"><a href="#cb56-741" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-742"><a href="#cb56-742" aria-hidden="true" tabindex="-1"></a><span class="co"># Quadratisches Interaktionsmodell mit IK-Bandweite</span></span>
<span id="cb56-743"><a href="#cb56-743" aria-hidden="true" tabindex="-1"></a>house_poly_IK <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb56-744"><a href="#cb56-744" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> house_llin_IK,</span>
<span id="cb56-745"><a href="#cb56-745" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> StimmenT <span class="sc">~</span> B <span class="sc">*</span> <span class="fu">poly</span>(StimmenTm1, <span class="at">degree =</span> <span class="dv">2</span>, <span class="at">raw =</span> T)</span>
<span id="cb56-746"><a href="#cb56-746" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-747"><a href="#cb56-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-748"><a href="#cb56-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-749"><a href="#cb56-749" aria-hidden="true" tabindex="-1"></a>Für eine Gegenüberstellung der Ergebnisse verwenden wir <span class="in">`modelsummary()`</span>.</span>
<span id="cb56-750"><a href="#cb56-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-753"><a href="#cb56-753" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-754"><a href="#cb56-754" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Vergleich von SRDD-Interaktionsmodellen für Lee (2008)</span></span>
<span id="cb56-755"><a href="#cb56-755" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-intmodsLee</span></span>
<span id="cb56-756"><a href="#cb56-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-757"><a href="#cb56-757" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabellarischer Modellvergleich</span></span>
<span id="cb56-758"><a href="#cb56-758" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb56-759"><a href="#cb56-759" aria-hidden="true" tabindex="-1"></a>  <span class="at">models =</span> <span class="fu">list</span>(</span>
<span id="cb56-760"><a href="#cb56-760" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Linear int."</span> <span class="ot">=</span> house_llin_IK, </span>
<span id="cb56-761"><a href="#cb56-761" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Quadratisch int."</span> <span class="ot">=</span> house_poly_IK</span>
<span id="cb56-762"><a href="#cb56-762" aria-hidden="true" tabindex="-1"></a>  ),  </span>
<span id="cb56-763"><a href="#cb56-763" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov =</span> <span class="st">"HC1"</span>, </span>
<span id="cb56-764"><a href="#cb56-764" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> T,</span>
<span id="cb56-765"><a href="#cb56-765" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_map =</span> <span class="st">"nobs"</span>, </span>
<span id="cb56-766"><a href="#cb56-766" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"gt"</span></span>
<span id="cb56-767"><a href="#cb56-767" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-768"><a href="#cb56-768" aria-hidden="true" tabindex="-1"></a>  tabopts</span>
<span id="cb56-769"><a href="#cb56-769" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-770"><a href="#cb56-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-771"><a href="#cb56-771" aria-hidden="true" tabindex="-1"></a>Die Spalte (1) in @tbl-intmodsLee zeigt die lokale Schätzung mit einem linearen Interaktionsmodell. Wir erhalten damit einen Behandlungseffekt von etwa $8.5\%$. Der Schätzwert fällt also etwas geringer aus als für die globale KQ-Schätzung des linearen Interaktionsmodells. Für das Modell (2) mit quadratischer Spezifikation liegt der Schätzwert mit $6.8\%$ in der selben Größenordnung. Beide Schätzungen ergeben einen signifikant von $0$ verschieden Effekt. Weiterhin fällt auf, dass in beiden Modellen keine Evidenz für unterschiedliche Formen der Regressionsfunktionen auf beiden Seiten des Schwellenwerts vorliegen: sämtliche Koeffizientenschätzwerte der Interaktionsterme haben hohe Standardfehler und sind nicht signifikant. Im quadratischen Modell hat auch der Term $StimmenTm1^2$ keinen signifikanten Effekt. Diese Ergebnisse deuten darauf hin, dass eine lineare Spezifikation ausreichend ist.</span>
<span id="cb56-772"><a href="#cb56-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-773"><a href="#cb56-773" aria-hidden="true" tabindex="-1"></a>**SRDD-Schätzung mit LOESS**</span>
<span id="cb56-774"><a href="#cb56-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-775"><a href="#cb56-775" aria-hidden="true" tabindex="-1"></a>Wir illustrieren nachfolgend die Schätzung des Behandlungseffekts mit einer flexiblen und in der Praxis häufig verwendeten Methode für lokale Regression. Die nachfolgende interaktive Grafik zeigt die klassierten Daten aus @Lee2008 auf dem Intervall $<span class="co">[</span><span class="ot">-0.5,0.5</span><span class="co">]</span>$ gemeinsam mit einer nicht-parametrischen Schätzung des Zusammenhangs von <span class="in">`StimmenT`</span> und <span class="in">`StimmenTm1`</span> mittels LOESS.^[<span class="co">[</span><span class="ot">LOESS</span><span class="co">](https://en.wikipedia.org/wiki/Local_regression)</span> ist eine Variante von lokaler Polynom-Regression.] Diese Implementierung von lokaler Regression nutzt einen <span class="co">[</span><span class="ot">tricube kernel</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Kernel_(statistics)). Über den Input kann eine Bandweite $l\in(0,1]$ für den LOESS-Schätzer auf beiden Seiten des Schwellenwerts $0$ gewählt werden. Die Bandweite ist hier der *Anteil der Beobachtungen an der gesamten Anzahl an Beobachtungen*, die in die Schätzung einbezogen werden sollen. </span>
<span id="cb56-776"><a href="#cb56-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-777"><a href="#cb56-777" aria-hidden="true" tabindex="-1"></a>Für die Schätzung am Schwellenwert berücksichtigte Daten sind in orange kenntlich gemacht. Die rote linie zeigt die geschätzte Regressionsfunktion über gleichmäßig verteilte Werte von <span class="in">`StimmenTm1`</span> auf $<span class="co">[</span><span class="ot">-0.5,0.5</span><span class="co">]</span>$. Die Grafik verdeutlicht, dass die LOESS-Methode flexibel genug ist, um lineare und nicht-lineare Zusammenhänge abbilden zu können. Wie zuvor ist eine adäquate Wahl der Bandweite wichtig: </span>
<span id="cb56-778"><a href="#cb56-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-779"><a href="#cb56-779" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Der mit LOESS geschätzte Zusammenhang auf beiden Seiten des Schwellenwerts ist etwa linear für den voreingestellten Parameter ($l = 0.28$).</span>
<span id="cb56-780"><a href="#cb56-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-781"><a href="#cb56-781" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Für größere Werte von $l$ nähert sich die Schätzung weiter einem linearen Verlauf an. Die Schätzung des Effekts bleibt vergleichbar mit den Ergebnissen des linearen Interaktionsmodell (s. oben).</span>
<span id="cb56-782"><a href="#cb56-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-783"><a href="#cb56-783" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Für kleinere $l$ erhalten wir eine stärkere Anpassung der Schätzung an die Daten. Zu kleine Werte führen zu einer Überanpassung (*overfitting*). Insbesondere tendiert die geschätzte Funktion zu extremer Steigung nahe des Schwellenwerts <span class="dv">&amp;rarr;</span> stark verzerrte Schätzung des Effekts!</span>
<span id="cb56-784"><a href="#cb56-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-785"><a href="#cb56-785" aria-hidden="true" tabindex="-1"></a>::: {.content-hidden unless-format="html"}</span>
<span id="cb56-786"><a href="#cb56-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-789"><a href="#cb56-789" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb56-790"><a href="#cb56-790" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb56-791"><a href="#cb56-791" aria-hidden="true" tabindex="-1"></a><span class="in">html`</span></span>
<span id="cb56-792"><a href="#cb56-792" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb56-793"><a href="#cb56-793" aria-hidden="true" tabindex="-1"></a><span class="in">.regression {</span></span>
<span id="cb56-794"><a href="#cb56-794" aria-hidden="true" tabindex="-1"></a><span class="in">  fill: none;</span></span>
<span id="cb56-795"><a href="#cb56-795" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke: #000;</span></span>
<span id="cb56-796"><a href="#cb56-796" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 1.5px;</span></span>
<span id="cb56-797"><a href="#cb56-797" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb56-798"><a href="#cb56-798" aria-hidden="true" tabindex="-1"></a><span class="in">.axis line {</span></span>
<span id="cb56-799"><a href="#cb56-799" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke: #ddd;</span></span>
<span id="cb56-800"><a href="#cb56-800" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb56-801"><a href="#cb56-801" aria-hidden="true" tabindex="-1"></a><span class="in">.axis .baseline line {</span></span>
<span id="cb56-802"><a href="#cb56-802" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke: #555;</span></span>
<span id="cb56-803"><a href="#cb56-803" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb56-804"><a href="#cb56-804" aria-hidden="true" tabindex="-1"></a><span class="in">.axis .domain {</span></span>
<span id="cb56-805"><a href="#cb56-805" aria-hidden="true" tabindex="-1"></a><span class="in">  display: none;</span></span>
<span id="cb56-806"><a href="#cb56-806" aria-hidden="true" tabindex="-1"></a><span class="in">} </span></span>
<span id="cb56-807"><a href="#cb56-807" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb56-808"><a href="#cb56-808" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css"&gt;</span></span>
<span id="cb56-809"><a href="#cb56-809" aria-hidden="true" tabindex="-1"></a><span class="in">`</span></span>
<span id="cb56-810"><a href="#cb56-810" aria-hidden="true" tabindex="-1"></a><span class="in">viewof bandwidth = Inputs.range([.01, 1], {</span></span>
<span id="cb56-811"><a href="#cb56-811" aria-hidden="true" tabindex="-1"></a><span class="in">  label: "Bandweite LOESS (l)",</span></span>
<span id="cb56-812"><a href="#cb56-812" aria-hidden="true" tabindex="-1"></a><span class="in">  step: .01,</span></span>
<span id="cb56-813"><a href="#cb56-813" aria-hidden="true" tabindex="-1"></a><span class="in">  value: .28</span></span>
<span id="cb56-814"><a href="#cb56-814" aria-hidden="true" tabindex="-1"></a><span class="in">});</span></span>
<span id="cb56-815"><a href="#cb56-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-816"><a href="#cb56-816" aria-hidden="true" tabindex="-1"></a><span class="in">xScaleLoess = d3.scaleLinear()</span></span>
<span id="cb56-817"><a href="#cb56-817" aria-hidden="true" tabindex="-1"></a><span class="in">   .domain([-.55, .55])</span></span>
<span id="cb56-818"><a href="#cb56-818" aria-hidden="true" tabindex="-1"></a><span class="in">   .range([0, innerWidth]);</span></span>
<span id="cb56-819"><a href="#cb56-819" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb56-820"><a href="#cb56-820" aria-hidden="true" tabindex="-1"></a><span class="in">yScaleLoess = d3.scaleLinear()</span></span>
<span id="cb56-821"><a href="#cb56-821" aria-hidden="true" tabindex="-1"></a><span class="in">  .domain([.2, .8])</span></span>
<span id="cb56-822"><a href="#cb56-822" aria-hidden="true" tabindex="-1"></a><span class="in">  .range([innerHeight, 0]);</span></span>
<span id="cb56-823"><a href="#cb56-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-824"><a href="#cb56-824" aria-hidden="true" tabindex="-1"></a><span class="in">lineLoess = d3.line()</span></span>
<span id="cb56-825"><a href="#cb56-825" aria-hidden="true" tabindex="-1"></a><span class="in">  .x(d =&gt; xScaleLoess(d[0]))</span></span>
<span id="cb56-826"><a href="#cb56-826" aria-hidden="true" tabindex="-1"></a><span class="in">  .y(d =&gt; yScaleLoess(d[1]));</span></span>
<span id="cb56-827"><a href="#cb56-827" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb56-828"><a href="#cb56-828" aria-hidden="true" tabindex="-1"></a><span class="in">xAxisLoess = d3.axisBottom(xScaleLoess)</span></span>
<span id="cb56-829"><a href="#cb56-829" aria-hidden="true" tabindex="-1"></a><span class="in">  .tickSize(innerHeight + 10)</span></span>
<span id="cb56-830"><a href="#cb56-830" aria-hidden="true" tabindex="-1"></a><span class="in">  .tickValues([-.5, -.25, 0, .25, .5])</span></span>
<span id="cb56-831"><a href="#cb56-831" aria-hidden="true" tabindex="-1"></a><span class="in">  .tickFormat(d =&gt; d);</span></span>
<span id="cb56-832"><a href="#cb56-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-833"><a href="#cb56-833" aria-hidden="true" tabindex="-1"></a><span class="in">yAxisLoess = d3.axisLeft(yScaleLoess)</span></span>
<span id="cb56-834"><a href="#cb56-834" aria-hidden="true" tabindex="-1"></a><span class="in">  .tickSize(innerWidth + 10)</span></span>
<span id="cb56-835"><a href="#cb56-835" aria-hidden="true" tabindex="-1"></a><span class="in">  .tickValues([.2, .35, .5, .65, .8])</span></span>
<span id="cb56-836"><a href="#cb56-836" aria-hidden="true" tabindex="-1"></a><span class="in">  .tickFormat(d =&gt; d);</span></span>
<span id="cb56-837"><a href="#cb56-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-838"><a href="#cb56-838" aria-hidden="true" tabindex="-1"></a><span class="in">loessRegression = d3.regressionLoess()</span></span>
<span id="cb56-839"><a href="#cb56-839" aria-hidden="true" tabindex="-1"></a><span class="in">  .x(d =&gt; d.StimmenTm1)</span></span>
<span id="cb56-840"><a href="#cb56-840" aria-hidden="true" tabindex="-1"></a><span class="in">  .y(d =&gt; d.StimmenT)</span></span>
<span id="cb56-841"><a href="#cb56-841" aria-hidden="true" tabindex="-1"></a><span class="in">  .bandwidth(bandwidth);</span></span>
<span id="cb56-842"><a href="#cb56-842" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-843"><a href="#cb56-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-846"><a href="#cb56-846" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb56-847"><a href="#cb56-847" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb56-848"><a href="#cb56-848" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-cap: "Nicht-parametrische Regression auf beiden Seiten des Cut-offs."</span></span>
<span id="cb56-849"><a href="#cb56-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-850"><a href="#cb56-850" aria-hidden="true" tabindex="-1"></a><span class="in">{</span></span>
<span id="cb56-851"><a href="#cb56-851" aria-hidden="true" tabindex="-1"></a><span class="in">  const svg = d3.select(DOM.svg(innerWidth + margin.left + margin.right + 20, innerHeight + margin.top + margin.bottom + 20))</span></span>
<span id="cb56-852"><a href="#cb56-852" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb56-853"><a href="#cb56-853" aria-hidden="true" tabindex="-1"></a><span class="in">  const g = svg.append("g")</span></span>
<span id="cb56-854"><a href="#cb56-854" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("transform", `translate(${margin.left}, ${margin.top})`);</span></span>
<span id="cb56-855"><a href="#cb56-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-856"><a href="#cb56-856" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("g")</span></span>
<span id="cb56-857"><a href="#cb56-857" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("class", "axis")</span></span>
<span id="cb56-858"><a href="#cb56-858" aria-hidden="true" tabindex="-1"></a><span class="in">      .call(xAxisLoess);</span></span>
<span id="cb56-859"><a href="#cb56-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-860"><a href="#cb56-860" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("g")</span></span>
<span id="cb56-861"><a href="#cb56-861" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("class", "axis")</span></span>
<span id="cb56-862"><a href="#cb56-862" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("transform", `translate(${innerWidth})`)</span></span>
<span id="cb56-863"><a href="#cb56-863" aria-hidden="true" tabindex="-1"></a><span class="in">    .call(yAxisLoess);</span></span>
<span id="cb56-864"><a href="#cb56-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-865"><a href="#cb56-865" aria-hidden="true" tabindex="-1"></a><span class="in">  // Add X axis label:</span></span>
<span id="cb56-866"><a href="#cb56-866" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("text")</span></span>
<span id="cb56-867"><a href="#cb56-867" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("text-anchor", "end")</span></span>
<span id="cb56-868"><a href="#cb56-868" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("font-size", 13)</span></span>
<span id="cb56-869"><a href="#cb56-869" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("x", innerWidth)</span></span>
<span id="cb56-870"><a href="#cb56-870" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("y", innerHeight + margin.top + 25)</span></span>
<span id="cb56-871"><a href="#cb56-871" aria-hidden="true" tabindex="-1"></a><span class="in">    .text("Differenz Stimmenanteil Demokraten letzte Wahl zur 50%-Schwelle");</span></span>
<span id="cb56-872"><a href="#cb56-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-873"><a href="#cb56-873" aria-hidden="true" tabindex="-1"></a><span class="in">  // Y axis label:</span></span>
<span id="cb56-874"><a href="#cb56-874" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("text")</span></span>
<span id="cb56-875"><a href="#cb56-875" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("text-anchor", "end")</span></span>
<span id="cb56-876"><a href="#cb56-876" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("transform", "rotate(-90)")</span></span>
<span id="cb56-877"><a href="#cb56-877" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("font-size", 13)</span></span>
<span id="cb56-878"><a href="#cb56-878" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("y", -margin.left+10)</span></span>
<span id="cb56-879"><a href="#cb56-879" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("x", -margin.top+10)</span></span>
<span id="cb56-880"><a href="#cb56-880" aria-hidden="true" tabindex="-1"></a><span class="in">    .text("Stimmenanteil Demokraten");</span></span>
<span id="cb56-881"><a href="#cb56-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-882"><a href="#cb56-882" aria-hidden="true" tabindex="-1"></a><span class="in">  g.selectAll("circle")</span></span>
<span id="cb56-883"><a href="#cb56-883" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(transpose(house_binned))</span></span>
<span id="cb56-884"><a href="#cb56-884" aria-hidden="true" tabindex="-1"></a><span class="in">    .enter().append("circle")</span></span>
<span id="cb56-885"><a href="#cb56-885" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("r", 2)</span></span>
<span id="cb56-886"><a href="#cb56-886" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("cx", d =&gt; xScaleLoess(d.StimmenTm1))</span></span>
<span id="cb56-887"><a href="#cb56-887" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("cy", d =&gt; yScaleLoess(d.StimmenT));</span></span>
<span id="cb56-888"><a href="#cb56-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-889"><a href="#cb56-889" aria-hidden="true" tabindex="-1"></a><span class="in">  g.selectAll("circle")</span></span>
<span id="cb56-890"><a href="#cb56-890" aria-hidden="true" tabindex="-1"></a><span class="in">   .filter( function(d){ return Math.abs(d.StimmenTm1) &lt;= bandwidth/2 } )</span></span>
<span id="cb56-891"><a href="#cb56-891" aria-hidden="true" tabindex="-1"></a><span class="in">   .attr("fill", "orange")</span></span>
<span id="cb56-892"><a href="#cb56-892" aria-hidden="true" tabindex="-1"></a><span class="in">   .attr("stroke", "none");</span></span>
<span id="cb56-893"><a href="#cb56-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-894"><a href="#cb56-894" aria-hidden="true" tabindex="-1"></a><span class="in">function b(d) { return loessRegression(</span></span>
<span id="cb56-895"><a href="#cb56-895" aria-hidden="true" tabindex="-1"></a><span class="in">        transpose(house).filter(function(d){ return d.StimmenTm1 &lt;= 0 &amp; d.StimmenTm1 &gt;= -.5 })</span></span>
<span id="cb56-896"><a href="#cb56-896" aria-hidden="true" tabindex="-1"></a><span class="in">    ); }</span></span>
<span id="cb56-897"><a href="#cb56-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-898"><a href="#cb56-898" aria-hidden="true" tabindex="-1"></a><span class="in">function a(d) { return loessRegression(</span></span>
<span id="cb56-899"><a href="#cb56-899" aria-hidden="true" tabindex="-1"></a><span class="in">      transpose(house).filter(function(d){ return d.StimmenTm1 &gt; 0 &amp; d.StimmenTm1 &lt;= .5  })</span></span>
<span id="cb56-900"><a href="#cb56-900" aria-hidden="true" tabindex="-1"></a><span class="in">    ); }</span></span>
<span id="cb56-901"><a href="#cb56-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-902"><a href="#cb56-902" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("path")</span></span>
<span id="cb56-903"><a href="#cb56-903" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("class", "regression")</span></span>
<span id="cb56-904"><a href="#cb56-904" aria-hidden="true" tabindex="-1"></a><span class="in">      .datum(b)</span></span>
<span id="cb56-905"><a href="#cb56-905" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("d", lineLoess)</span></span>
<span id="cb56-906"><a href="#cb56-906" aria-hidden="true" tabindex="-1"></a><span class="in">      .style("stroke", "red");</span></span>
<span id="cb56-907"><a href="#cb56-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-908"><a href="#cb56-908" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("path")</span></span>
<span id="cb56-909"><a href="#cb56-909" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("class", "regression")</span></span>
<span id="cb56-910"><a href="#cb56-910" aria-hidden="true" tabindex="-1"></a><span class="in">      .datum(a)</span></span>
<span id="cb56-911"><a href="#cb56-911" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("d", lineLoess)</span></span>
<span id="cb56-912"><a href="#cb56-912" aria-hidden="true" tabindex="-1"></a><span class="in">      .style("stroke", "red");</span></span>
<span id="cb56-913"><a href="#cb56-913" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb56-914"><a href="#cb56-914" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("text")</span></span>
<span id="cb56-915"><a href="#cb56-915" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("x", d =&gt; xScaleLoess(-.24))</span></span>
<span id="cb56-916"><a href="#cb56-916" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("y", d =&gt; yScaleLoess(.55))</span></span>
<span id="cb56-917"><a href="#cb56-917" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("dy", ".35em")</span></span>
<span id="cb56-918"><a href="#cb56-918" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("fill", "#39FF14")</span></span>
<span id="cb56-919"><a href="#cb56-919" aria-hidden="true" tabindex="-1"></a><span class="in">    .text(d3.format(",.2f")((a().slice(0))[0][1] - (b().slice(-1))[0][1]));</span></span>
<span id="cb56-920"><a href="#cb56-920" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb56-921"><a href="#cb56-921" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("line")</span></span>
<span id="cb56-922"><a href="#cb56-922" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("x1", xScaleLoess(0))</span></span>
<span id="cb56-923"><a href="#cb56-923" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("y1", yScaleLoess((b().slice(-1))[0][1]))</span></span>
<span id="cb56-924"><a href="#cb56-924" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("x2", xScaleLoess(0))</span></span>
<span id="cb56-925"><a href="#cb56-925" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("y2", yScaleLoess((a().slice(0))[0][1]))</span></span>
<span id="cb56-926"><a href="#cb56-926" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("stroke", "#39FF14")</span></span>
<span id="cb56-927"><a href="#cb56-927" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("stroke-width", 2);</span></span>
<span id="cb56-928"><a href="#cb56-928" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb56-929"><a href="#cb56-929" aria-hidden="true" tabindex="-1"></a><span class="in">  /* dashed line at cutoff */</span></span>
<span id="cb56-930"><a href="#cb56-930" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("line")</span></span>
<span id="cb56-931"><a href="#cb56-931" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("x1", xScaleLoess(0))</span></span>
<span id="cb56-932"><a href="#cb56-932" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("y1", 0)</span></span>
<span id="cb56-933"><a href="#cb56-933" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("x2", xScaleLoess(0))</span></span>
<span id="cb56-934"><a href="#cb56-934" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("y2", innerHeight)</span></span>
<span id="cb56-935"><a href="#cb56-935" aria-hidden="true" tabindex="-1"></a><span class="in">  .style("stroke", "black")</span></span>
<span id="cb56-936"><a href="#cb56-936" aria-hidden="true" tabindex="-1"></a><span class="in">  .style("stroke-dasharray", "1")</span></span>
<span id="cb56-937"><a href="#cb56-937" aria-hidden="true" tabindex="-1"></a><span class="in">  .style("stroke-width", "1");</span></span>
<span id="cb56-938"><a href="#cb56-938" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb56-939"><a href="#cb56-939" aria-hidden="true" tabindex="-1"></a><span class="in">  /* dashed line data bw upper */</span></span>
<span id="cb56-940"><a href="#cb56-940" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("line")</span></span>
<span id="cb56-941"><a href="#cb56-941" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("x1", xScaleLoess(bandwidth/2))</span></span>
<span id="cb56-942"><a href="#cb56-942" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("y1", 0)</span></span>
<span id="cb56-943"><a href="#cb56-943" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("x2", xScaleLoess(bandwidth/2))</span></span>
<span id="cb56-944"><a href="#cb56-944" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("y2", innerHeight)</span></span>
<span id="cb56-945"><a href="#cb56-945" aria-hidden="true" tabindex="-1"></a><span class="in">  .style("stroke", "blue")</span></span>
<span id="cb56-946"><a href="#cb56-946" aria-hidden="true" tabindex="-1"></a><span class="in">  .style("stroke-dasharray", "4")</span></span>
<span id="cb56-947"><a href="#cb56-947" aria-hidden="true" tabindex="-1"></a><span class="in">  .style("stroke-width", "1");</span></span>
<span id="cb56-948"><a href="#cb56-948" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb56-949"><a href="#cb56-949" aria-hidden="true" tabindex="-1"></a><span class="in">  /* dashed line data bw lower */</span></span>
<span id="cb56-950"><a href="#cb56-950" aria-hidden="true" tabindex="-1"></a><span class="in">  g.append("line")</span></span>
<span id="cb56-951"><a href="#cb56-951" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("x1", xScaleLoess(-bandwidth/2))</span></span>
<span id="cb56-952"><a href="#cb56-952" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("y1", 0)</span></span>
<span id="cb56-953"><a href="#cb56-953" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("x2", xScaleLoess(-bandwidth/2))</span></span>
<span id="cb56-954"><a href="#cb56-954" aria-hidden="true" tabindex="-1"></a><span class="in">  .attr("y2", innerHeight)</span></span>
<span id="cb56-955"><a href="#cb56-955" aria-hidden="true" tabindex="-1"></a><span class="in">  .style("stroke", "blue")</span></span>
<span id="cb56-956"><a href="#cb56-956" aria-hidden="true" tabindex="-1"></a><span class="in">  .style("stroke-dasharray", "4")</span></span>
<span id="cb56-957"><a href="#cb56-957" aria-hidden="true" tabindex="-1"></a><span class="in">  .style("stroke-width", "1");</span></span>
<span id="cb56-958"><a href="#cb56-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-959"><a href="#cb56-959" aria-hidden="true" tabindex="-1"></a><span class="in">  return svg.node();</span></span>
<span id="cb56-960"><a href="#cb56-960" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb56-961"><a href="#cb56-961" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-962"><a href="#cb56-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-963"><a href="#cb56-963" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-964"><a href="#cb56-964" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb56-965"><a href="#cb56-965" aria-hidden="true" tabindex="-1"></a>----</span>
<span id="cb56-966"><a href="#cb56-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-967"><a href="#cb56-967" aria-hidden="true" tabindex="-1"></a>***Diese interaktive Komponente des Buchs ist nur in der Online-Version verfügbar.***</span>
<span id="cb56-968"><a href="#cb56-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-969"><a href="#cb56-969" aria-hidden="true" tabindex="-1"></a>----</span>
<span id="cb56-970"><a href="#cb56-970" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb56-971"><a href="#cb56-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-972"><a href="#cb56-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-973"><a href="#cb56-973" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fuzzy Regression Discontinuity Design</span></span>
<span id="cb56-974"><a href="#cb56-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-977"><a href="#cb56-977" aria-hidden="true" tabindex="-1"></a><span class="in">```{dot}</span></span>
<span id="cb56-978"><a href="#cb56-978" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-width: 5</span></span>
<span id="cb56-979"><a href="#cb56-979" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-height: 3</span></span>
<span id="cb56-980"><a href="#cb56-980" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-align: 'center'</span></span>
<span id="cb56-981"><a href="#cb56-981" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-cap: "Kausales Diagram für FRDD"</span></span>
<span id="cb56-982"><a href="#cb56-982" aria-hidden="true" tabindex="-1"></a><span class="in">//| label: "fig-CDFRDD" </span></span>
<span id="cb56-983"><a href="#cb56-983" aria-hidden="true" tabindex="-1"></a><span class="in">digraph {</span></span>
<span id="cb56-984"><a href="#cb56-984" aria-hidden="true" tabindex="-1"></a><span class="in">  layout=neato</span></span>
<span id="cb56-985"><a href="#cb56-985" aria-hidden="true" tabindex="-1"></a><span class="in">  fontname="Helvetica,Arial,sans-serif"</span></span>
<span id="cb56-986"><a href="#cb56-986" aria-hidden="true" tabindex="-1"></a><span class="in">  node [fontname="Helvetica,Arial,sans-serif"]</span></span>
<span id="cb56-987"><a href="#cb56-987" aria-hidden="true" tabindex="-1"></a><span class="in">  edge [fontname="Helvetica,Arial,sans-serif"]</span></span>
<span id="cb56-988"><a href="#cb56-988" aria-hidden="true" tabindex="-1"></a><span class="in">  node [shape=none];</span></span>
<span id="cb56-989"><a href="#cb56-989" aria-hidden="true" tabindex="-1"></a><span class="in">  "X" [pos="0,1!"]</span></span>
<span id="cb56-990"><a href="#cb56-990" aria-hidden="true" tabindex="-1"></a><span class="in">  "Y" [pos="4,-1!"]</span></span>
<span id="cb56-991"><a href="#cb56-991" aria-hidden="true" tabindex="-1"></a><span class="in">  "oberhalb c" [pos="0,-1!"]</span></span>
<span id="cb56-992"><a href="#cb56-992" aria-hidden="true" tabindex="-1"></a><span class="in">  "Z" [pos="4,1!"]</span></span>
<span id="cb56-993"><a href="#cb56-993" aria-hidden="true" tabindex="-1"></a><span class="in">  "Behandlung" [pos="2,-1!"]</span></span>
<span id="cb56-994"><a href="#cb56-994" aria-hidden="true" tabindex="-1"></a><span class="in">  "Z" -&gt; "Behandlung"</span></span>
<span id="cb56-995"><a href="#cb56-995" aria-hidden="true" tabindex="-1"></a><span class="in">  "X" -&gt; "Y"</span></span>
<span id="cb56-996"><a href="#cb56-996" aria-hidden="true" tabindex="-1"></a><span class="in">  "X" -&gt; "Behandlung"</span></span>
<span id="cb56-997"><a href="#cb56-997" aria-hidden="true" tabindex="-1"></a><span class="in">  "Z" -&gt; "X"</span></span>
<span id="cb56-998"><a href="#cb56-998" aria-hidden="true" tabindex="-1"></a><span class="in">  "Z" -&gt; "Y"</span></span>
<span id="cb56-999"><a href="#cb56-999" aria-hidden="true" tabindex="-1"></a><span class="in">  "X" -&gt; "oberhalb c"</span></span>
<span id="cb56-1000"><a href="#cb56-1000" aria-hidden="true" tabindex="-1"></a><span class="in">  "oberhalb c" -&gt; "Behandlung"</span></span>
<span id="cb56-1001"><a href="#cb56-1001" aria-hidden="true" tabindex="-1"></a><span class="in">  "Behandlung" -&gt; "Y"</span></span>
<span id="cb56-1002"><a href="#cb56-1002" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb56-1003"><a href="#cb56-1003" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1004"><a href="#cb56-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1005"><a href="#cb56-1005" aria-hidden="true" tabindex="-1"></a>Ein FRDD liegt vor, wenn die Zuweisung der Behandlung $B$ durch die Laufvariable $X$ (und möglicherweise weitere Variablen $Z$) beeinflusst wird. Im Vergleich zum SRDD ist die Behandlung dann also *nicht* ausschließlich durch Überschreiten des Schwellenwerts $X = c$ bestimmt. </span>
<span id="cb56-1006"><a href="#cb56-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1007"><a href="#cb56-1007" aria-hidden="true" tabindex="-1"></a>@fig-CDFRDD zeigt den grundsätzlichen Zusammenhang. Hier genügt es weiterhin für $X$ (und ggf. $Z$) zu kontrollieren, um den Pfad *oberhalb $C$ &amp;rarr; Behandlung $B$ &amp;rarr; $Y$* zu isolieren. Der so für *Behandlung $B$* ermittelte Effekt auf $Y$ entspricht jedoch *nicht* dem "vollständigen" Behandlungseffekt, da bei $c$ die Zuweisung der Behandlung nicht von $0$ auf $100\%$ springt. Die Schätzung des FRDD berücksichtigt dies und skaliert den geschätzten Effekt entsprechend.</span>
<span id="cb56-1008"><a href="#cb56-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1009"><a href="#cb56-1009" aria-hidden="true" tabindex="-1"></a>Wir betrachten zunächst den Zusammenhang</span>
<span id="cb56-1010"><a href="#cb56-1010" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb56-1011"><a href="#cb56-1011" aria-hidden="true" tabindex="-1"></a>  Y_i = \beta_0 + \beta_1 B_i + \beta_2 (X_i - c) + u_i.\label{eq-simpleFRDD}</span>
<span id="cb56-1012"><a href="#cb56-1012" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb56-1013"><a href="#cb56-1013" aria-hidden="true" tabindex="-1"></a>In einem FRDD springt die Behandlungswahrscheinlichkeit am Schwellenwert $c$ um $\Delta p&lt;1$. Wir können $B$ also nicht als deterministische Funktion von $X$, welche die Zuweisung zu Behandlungs- bzw. Kontrollgruppe am Schwellenwert $c$ anzeigt (wie im SRDD), definieren. Stattdessen betrachten wir</span>
<span id="cb56-1014"><a href="#cb56-1014" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb56-1015"><a href="#cb56-1015" aria-hidden="true" tabindex="-1"></a>  P(B_i=1\vert X_i) = </span>
<span id="cb56-1016"><a href="#cb56-1016" aria-hidden="true" tabindex="-1"></a>  \begin{cases}</span>
<span id="cb56-1017"><a href="#cb56-1017" aria-hidden="true" tabindex="-1"></a>    g_{X_i&lt;c}(X_i), &amp; X_i &lt; c <span class="sc">\\</span> </span>
<span id="cb56-1018"><a href="#cb56-1018" aria-hidden="true" tabindex="-1"></a>    g_{X_i\geq c}(X_i) &amp; X_i \geq c</span>
<span id="cb56-1019"><a href="#cb56-1019" aria-hidden="true" tabindex="-1"></a>  \end{cases}\,. \label{eq-BFRDD}</span>
<span id="cb56-1020"><a href="#cb56-1020" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb56-1021"><a href="#cb56-1021" aria-hidden="true" tabindex="-1"></a>Die Funktionen $g_{X_i&lt;c}$ und $g_{X_i\geq c}$ können verschieden sein. Es muss jedoch $$g_{X_i&lt;c}(X_i = c) \neq g_{X_i\geq c}(X_i = c)$$ gelten. Die Behandlungsvariable $B_i$ ist im FRDD also eine (binäre) Zufallsvariable, deren bedingte Wahrscheinlichkeitsfunktion $P(B_i=1\vert X_i)$ am Schwellenwert $c$ eine Diskontinuität aufweist. @fig-FRDDprobD zeigt heispielhafte Verläufe nicht-linearer bedingter Wahrscheinlichkeitsfunktion für die Behandlung mit einer Diskontinuität bei $X_i = c$.</span>
<span id="cb56-1022"><a href="#cb56-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1025"><a href="#cb56-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1026"><a href="#cb56-1026" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Bedingte Behandlungswahrscheinlichkeiten im FRDD"</span></span>
<span id="cb56-1027"><a href="#cb56-1027" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-FRDDprobD</span></span>
<span id="cb56-1028"><a href="#cb56-1028" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3</span></span>
<span id="cb56-1029"><a href="#cb56-1029" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2.5</span></span>
<span id="cb56-1030"><a href="#cb56-1030" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb56-1031"><a href="#cb56-1031" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb56-1032"><a href="#cb56-1032" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb56-1033"><a href="#cb56-1033" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb56-1034"><a href="#cb56-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1035"><a href="#cb56-1035" aria-hidden="true" tabindex="-1"></a><span class="co"># Bedingte Behandlungswahrscheinlichkeit im FRDD illustrieren</span></span>
<span id="cb56-1036"><a href="#cb56-1036" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb56-1037"><a href="#cb56-1037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb56-1038"><a href="#cb56-1038" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="sc">~</span> <span class="fu">ifelse</span>(</span>
<span id="cb56-1039"><a href="#cb56-1039" aria-hidden="true" tabindex="-1"></a>      . <span class="sc">&lt;</span> <span class="dv">0</span>, </span>
<span id="cb56-1040"><a href="#cb56-1040" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span>.<span class="dv">1</span> <span class="sc">*</span> .<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> .<span class="dv">25</span>, </span>
<span id="cb56-1041"><a href="#cb56-1041" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span>.<span class="dv">1</span> <span class="sc">*</span> (.<span class="sc">-</span><span class="fl">1.5</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb56-1042"><a href="#cb56-1042" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb56-1043"><a href="#cb56-1043" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">1000</span></span>
<span id="cb56-1044"><a href="#cb56-1044" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb56-1045"><a href="#cb56-1045" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(</span>
<span id="cb56-1046"><a href="#cb56-1046" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="sc">~</span> <span class="fu">ifelse</span>(</span>
<span id="cb56-1047"><a href="#cb56-1047" aria-hidden="true" tabindex="-1"></a>      . <span class="sc">&lt;</span> <span class="dv">0</span>, </span>
<span id="cb56-1048"><a href="#cb56-1048" aria-hidden="true" tabindex="-1"></a>     .<span class="dv">35</span>, </span>
<span id="cb56-1049"><a href="#cb56-1049" aria-hidden="true" tabindex="-1"></a>     .<span class="dv">65</span></span>
<span id="cb56-1050"><a href="#cb56-1050" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-1051"><a href="#cb56-1051" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">1000</span>, </span>
<span id="cb56-1052"><a href="#cb56-1052" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">2</span>, </span>
<span id="cb56-1053"><a href="#cb56-1053" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"red"</span></span>
<span id="cb56-1054"><a href="#cb56-1054" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb56-1055"><a href="#cb56-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb56-1056"><a href="#cb56-1056" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Laufvariable X"</span>, </span>
<span id="cb56-1057"><a href="#cb56-1057" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>),</span>
<span id="cb56-1058"><a href="#cb56-1058" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cn">NULL</span>,</span>
<span id="cb56-1059"><a href="#cb56-1059" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="cn">NULL</span></span>
<span id="cb56-1060"><a href="#cb56-1060" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-1061"><a href="#cb56-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb56-1062"><a href="#cb56-1062" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"P(D=1|X)"</span>, </span>
<span id="cb56-1063"><a href="#cb56-1063" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb56-1064"><a href="#cb56-1064" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb56-1065"><a href="#cb56-1065" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-1066"><a href="#cb56-1066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb56-1067"><a href="#cb56-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1068"><a href="#cb56-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1069"><a href="#cb56-1069" aria-hidden="true" tabindex="-1"></a>Definition \eqref{eq-BFRDD} bedeutet, dass eine KQ-Schätzung von $\beta_1$ anhand \eqref{eq-simpleFRDD} eine *verzerrte* Schätzung des Behandlungseffekts ist: Der in $\widehat{\beta}_1$ erfasste Effekt auf $Y$ ist auf einen Sprung der Behandlungswahrscheinlichkeit bei $X_i = c$ um *weniger* als $100\%$ zurückzuführen. Der wahre Behandlungseffekt wird also *unterschätzt*. Daher muss $\widehat{\beta}_1$ skaliert werden, sodass die Schätzung als Effekt einer Änderung der Behandlungswahrscheinlichkei um $100\%$ interpretiert werden kann --- der erwartete Effekt, wenn ausschließlich Subjekte mit $X_i\geq c$ behandelt würden. Diese skalierte Schätzung erhalten wir mit IV-Regression (vgl. Kapitel XYZ). Hierfür nutzen wir für $B_i$ die Instrumentvariable </span>
<span id="cb56-1070"><a href="#cb56-1070" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb56-1071"><a href="#cb56-1071" aria-hidden="true" tabindex="-1"></a>  D_i = \begin{cases}</span>
<span id="cb56-1072"><a href="#cb56-1072" aria-hidden="true" tabindex="-1"></a>    0, &amp; X_i &lt; c <span class="sc">\\</span> </span>
<span id="cb56-1073"><a href="#cb56-1073" aria-hidden="true" tabindex="-1"></a>    1, &amp; X_i \geq c.</span>
<span id="cb56-1074"><a href="#cb56-1074" aria-hidden="true" tabindex="-1"></a>  \end{cases}</span>
<span id="cb56-1075"><a href="#cb56-1075" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb56-1076"><a href="#cb56-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1077"><a href="#cb56-1077" aria-hidden="true" tabindex="-1"></a>Angenommen $g_{X_i\geq c}(X_i) = \alpha_0$ und $g_{X_i&lt;c}(X_i) = \alpha_0 + \alpha_1$ mit $\alpha_0 + \alpha_1 &lt; 1$ (vgl. rote Funktion in @fig-CDFRDD). Der FRDD-Schätzer des Behandlungseffekts ist dann $\widehat{\gamma}_\textup{FRDD}$ im 2SLS-Verfahren mit den Regressionen</span>
<span id="cb56-1078"><a href="#cb56-1078" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb56-1079"><a href="#cb56-1079" aria-hidden="true" tabindex="-1"></a>  \begin{split}</span>
<span id="cb56-1080"><a href="#cb56-1080" aria-hidden="true" tabindex="-1"></a>  (\mathrm{I})\qquad B_i =&amp;\, \alpha_0 + \alpha_1 D_i + \alpha_2 (X_i - c) + e_i,<span class="sc">\\</span></span>
<span id="cb56-1081"><a href="#cb56-1081" aria-hidden="true" tabindex="-1"></a>  (\mathrm{II})\qquad Y_i =&amp;\, \gamma_0 + \gamma_1 \widehat{B}_i + \gamma_2 (X_i - c) + \epsilon_i,</span>
<span id="cb56-1082"><a href="#cb56-1082" aria-hidden="true" tabindex="-1"></a>  \end{split}\label{eq:FRDD_simpleIV}</span>
<span id="cb56-1083"><a href="#cb56-1083" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb56-1084"><a href="#cb56-1084" aria-hidden="true" tabindex="-1"></a>wobei $\widehat{B}_i$ die angepassten Werte aus Stufe $(\mathrm I)$ und $e_i$ sowie $\epsilon_i$ Fehlterterme sind.</span>
<span id="cb56-1085"><a href="#cb56-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1086"><a href="#cb56-1086" aria-hidden="true" tabindex="-1"></a>Analog zum SRDD müssen in empirischen Anwendungen geeignete Spezifikationen für die Regressionsfunktionen \eqref{eq-simpleFRDD} und \eqref{eq-BFRDD} gewählt und der 2SLS-Schätzer \eqref{eq:FRDD_simpleIV} entsprechend angepasst werden. Ein einfaches Interaktionsmodell wäre</span>
<span id="cb56-1087"><a href="#cb56-1087" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb56-1088"><a href="#cb56-1088" aria-hidden="true" tabindex="-1"></a>  \begin{split}</span>
<span id="cb56-1089"><a href="#cb56-1089" aria-hidden="true" tabindex="-1"></a>  (\mathrm{I})\qquad B_i =&amp;\, \alpha_0 + \alpha_1 D_i + \alpha_2 (X_i - c)<span class="sc">\\</span> </span>
<span id="cb56-1090"><a href="#cb56-1090" aria-hidden="true" tabindex="-1"></a>  +&amp;\, \alpha_3 (X_i - c) \times D_i + e_i,<span class="sc">\\</span></span>
<span id="cb56-1091"><a href="#cb56-1091" aria-hidden="true" tabindex="-1"></a>  <span class="sc">\\</span></span>
<span id="cb56-1092"><a href="#cb56-1092" aria-hidden="true" tabindex="-1"></a>  (\mathrm{II})\qquad Y_i =&amp;\, \gamma_0 + \gamma_1 \widehat{B}_i<span class="sc">\\</span></span>
<span id="cb56-1093"><a href="#cb56-1093" aria-hidden="true" tabindex="-1"></a>  +&amp;\, \gamma_2 (X_i - c) + \gamma_3 (X_i-c)\times\widehat{B}_i, \epsilon_i</span>
<span id="cb56-1094"><a href="#cb56-1094" aria-hidden="true" tabindex="-1"></a>  \end{split},\label{eq:FRDD_lintIV}</span>
<span id="cb56-1095"><a href="#cb56-1095" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb56-1096"><a href="#cb56-1096" aria-hidden="true" tabindex="-1"></a>d.h. wir instrumentieren $B_i$ mit $D_i$ und dem Interaktionsterm $(X_i-c)\times D_i$.</span>
<span id="cb56-1097"><a href="#cb56-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1098"><a href="#cb56-1098" aria-hidden="true" tabindex="-1"></a>Wie im SRDD werden die IV-Ansätze für das FRDD \eqref{eq:FRDD_simpleIV} und \eqref{eq:FRDD_lintIV} in empirischen Studien unter Berücksichtigung einer Bandweite (i.d.R. dieselbe Bandweite für beide Stufen) angewendet.</span>
<span id="cb56-1099"><a href="#cb56-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1100"><a href="#cb56-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1101"><a href="#cb56-1101" aria-hidden="true" tabindex="-1"></a><span class="fu">## Case Study: Protestantische Arbeitsethik</span></span>
<span id="cb56-1102"><a href="#cb56-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1103"><a href="#cb56-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=F}</span></span>
<span id="cb56-1104"><a href="#cb56-1104" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(fig.align = 'center', warning = F, message = F)</span></span>
<span id="cb56-1105"><a href="#cb56-1105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1106"><a href="#cb56-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1107"><a href="#cb56-1107" aria-hidden="true" tabindex="-1"></a>Die Studie *Beyond Work Ethic: Religion, Individual, and Political Preferences* <span class="co">[</span><span class="ot">@BastenBetz2013</span><span class="co">]</span> untersucht den Zusammenhang zwischen Religion, individuellen Merkmalen und politischen Präferenzen. Das Hauptaugenmerk ist die Rolle von Religiosität als Einflussfaktor auf politische Einstellungen. Die Hypothese der Autoren ist, dass Religiosität eines Individuums über den traditionellen Rahmen von Moralvorstellungen und sozialen Normen hinaus auch die politischen Präferenzen beeinflusst. Eine entsprechende Theorie wurde zu Beginn des 20. Jahrhunderts entwickelt und prominent von Max Weber <span class="co">[</span><span class="ot">vgl. @Weber2004</span><span class="co">]</span> vertreten. Weber argumentiert, dass die protestantische Arbeitsethik einen entscheidenden Einfluss auf die Entwicklung des Kapitalismus hatte. Laut Weber führte der protestantische Glaube an harte Arbeit, ein sparsames Leben und ethisches Verhalten zur einer in den damaligen Gesellschaften weit verbreiteten Geisteshaltung, die wirtschaftliches Wachstum förderte und den Aufstieg des Kapitalismus begünstigte.</span>
<span id="cb56-1108"><a href="#cb56-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1109"><a href="#cb56-1109" aria-hidden="true" tabindex="-1"></a>@BastenBetz2013 nutzen Wahlergebnisse sowie geo- und soziodemographische Datensätze für schweizer Gemeinden, um den Zusammenhang zwischen Religiosität und politischen Präferenzen wie links-rechts-Ausrichtung, Einstellungen zur Umverteilung und Einwanderung zu untersuchen. Hierfür verwenden die Autoren ein FRDD, dass eine historisch bedingte Diskontinuität der geographischen Verteilung von evanglischer bzw. katholischer Religionszugehörigkeit zwischen den Kantonen Freiburg (überwiegend dunkelrote Region, frz. *Fribourg*) und Waadt (kleinere hellrote Region, frz. *Vaud*) ausnutzt. Die historische Verteilung der Konfessionen in der betrachteten Region im 16. Jahrhundert durch Abspaltung des Kantons Freiburg ist in @fig-vaudfb dargestellt.</span>
<span id="cb56-1110"><a href="#cb56-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1111"><a href="#cb56-1111" aria-hidden="true" tabindex="-1"></a>Aufgrund von Bevölkerungsbewegungen ist die Verteilung der Konfessionen zwar nicht mehr eindeutig durch die Kantonsgrenze bestimmt, jedoch sind die Gemeinden der betrachteten Kantone auch heute noch mehrheitlich protestantisch bzw. katholisch. Es ist plausibel, dass eine Prägung gemäß Webers Theorie vorliegt, sich die Gemeinden nahe der Grenz aber hinsichtlich anderer Charakteristika (insb. der Bevölkerungsstruktur) nicht systematisch unterscheiden. Somit liegt ein quai</span>
<span id="cb56-1112"><a href="#cb56-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1113"><a href="#cb56-1113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "400px"}</span></span>
<span id="cb56-1114"><a href="#cb56-1114" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb56-1115"><a href="#cb56-1115" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Historische Verteilung von Religionszugehörigkeit in Schweizer Gemeinden im 16. Jahrhundert. Quelle: Basten und Betz (2013)."</span></span>
<span id="cb56-1116"><a href="#cb56-1116" aria-hidden="true" tabindex="-1"></a><span class="in">#| cap-location: margin</span></span>
<span id="cb56-1117"><a href="#cb56-1117" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-vaudfb</span></span>
<span id="cb56-1118"><a href="#cb56-1118" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics(path = "img/WaadtFribourg.png")</span></span>
<span id="cb56-1119"><a href="#cb56-1119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1120"><a href="#cb56-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1121"><a href="#cb56-1121" aria-hidden="true" tabindex="-1"></a>Die Ergebnisse der Studie zeigen einen signifikanten Einfluss von Protestantismus auf politische Präferenzen, die über traditionelle Moralvorstellungen hinausgehen: Die Autoren finden Hinweise, dass Einwohner evangelisch geprägter Gemeinden eher konservative soziale und politische Ansichten vertreten. Eine mögliche Erklärung für diesen Effekt ist, dass religiöse Institutionen auch eine soziale und politische Agenda verfolgen, die von den Gläubigen internalisiert wird.</span>
<span id="cb56-1122"><a href="#cb56-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1123"><a href="#cb56-1123" aria-hidden="true" tabindex="-1"></a><span class="fu">### Aufbereitung der Daten</span></span>
<span id="cb56-1124"><a href="#cb56-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1125"><a href="#cb56-1125" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel zeigen wir, wie die Kernergebnisse der Studie mit R reproduziert werden können. Hierfür werden folgende Pakete benötigt.</span>
<span id="cb56-1126"><a href="#cb56-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1127"><a href="#cb56-1127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=TRUE, warning=FALSE}</span></span>
<span id="cb56-1128"><a href="#cb56-1128" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb56-1129"><a href="#cb56-1129" aria-hidden="true" tabindex="-1"></a><span class="in">library(haven)</span></span>
<span id="cb56-1130"><a href="#cb56-1130" aria-hidden="true" tabindex="-1"></a><span class="in">library(vtable)</span></span>
<span id="cb56-1131"><a href="#cb56-1131" aria-hidden="true" tabindex="-1"></a><span class="in">library(rdrobust)</span></span>
<span id="cb56-1132"><a href="#cb56-1132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1133"><a href="#cb56-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1134"><a href="#cb56-1134" aria-hidden="true" tabindex="-1"></a>Das Papier sowie der Datensatz <span class="in">`BastenBetz.dta`</span> sind auf der <span class="co">[</span><span class="ot">Übersichtsseite der AEA</span><span class="co">](https://www.aeaweb.org/articles?id=10.1257/pol.5.3.67)</span> verfügbar und liegt im STATA-Format <span class="in">`.dta`</span> vor.^<span class="co">[</span><span class="ot">Siehe alternativ das [working paper](https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2133848), falls kein Abbonement für AEA-Journals vorliegt.</span><span class="co">]</span></span>
<span id="cb56-1135"><a href="#cb56-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1138"><a href="#cb56-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1139"><a href="#cb56-1139" aria-hidden="true" tabindex="-1"></a><span class="co"># Datensatz einlesen</span></span>
<span id="cb56-1140"><a href="#cb56-1140" aria-hidden="true" tabindex="-1"></a>BastenBetz <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">'BastenBetz.dta'</span>)</span>
<span id="cb56-1141"><a href="#cb56-1141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1142"><a href="#cb56-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1143"><a href="#cb56-1143" aria-hidden="true" tabindex="-1"></a>Der Datensatz <span class="in">`BastenBetz`</span> enthält Beobachtungen zu 509 schweizer Gemeinden. Eine Vielzahl an Variablen ist lediglich für Robustheits-Checks relevant. Für die Reproduktion der Kernergebnisse erstellen wir zunächst einen reduzierten Datensatz und transformieren einige Variablen. </span>
<span id="cb56-1144"><a href="#cb56-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1147"><a href="#cb56-1147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1148"><a href="#cb56-1148" aria-hidden="true" tabindex="-1"></a><span class="co"># Reduzierten Datensatz erstellen</span></span>
<span id="cb56-1149"><a href="#cb56-1149" aria-hidden="true" tabindex="-1"></a>BastenBetz <span class="ot">&lt;-</span> BastenBetz <span class="sc">%&gt;%</span></span>
<span id="cb56-1150"><a href="#cb56-1150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb56-1151"><a href="#cb56-1151" aria-hidden="true" tabindex="-1"></a>    <span class="at">gini =</span> Ecoplan_gini,</span>
<span id="cb56-1152"><a href="#cb56-1152" aria-hidden="true" tabindex="-1"></a>    <span class="at">prot =</span> prot1980s,</span>
<span id="cb56-1153"><a href="#cb56-1153" aria-hidden="true" tabindex="-1"></a>    <span class="at">bord =</span> borderdis, </span>
<span id="cb56-1154"><a href="#cb56-1154" aria-hidden="true" tabindex="-1"></a>    vaud,</span>
<span id="cb56-1155"><a href="#cb56-1155" aria-hidden="true" tabindex="-1"></a>    pfl, </span>
<span id="cb56-1156"><a href="#cb56-1156" aria-hidden="true" tabindex="-1"></a>    pfr, </span>
<span id="cb56-1157"><a href="#cb56-1157" aria-hidden="true" tabindex="-1"></a>    pfi</span>
<span id="cb56-1158"><a href="#cb56-1158" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-1159"><a href="#cb56-1159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1160"><a href="#cb56-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1161"><a href="#cb56-1161" aria-hidden="true" tabindex="-1"></a>Die Definitionen der Variablen sind in @tbl-BastenBetzRed gegeben. Die Präferenzen <span class="in">`pfl`</span>, <span class="in">`pfr`</span> und <span class="in">`pfi`</span> basieren auf Wahlergebnissen auf Gemeindeebene zu Volksentscheiden.</span>
<span id="cb56-1162"><a href="#cb56-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1163"><a href="#cb56-1163" aria-hidden="true" tabindex="-1"></a>| Variable    | Definition                                                |</span>
<span id="cb56-1164"><a href="#cb56-1164" aria-hidden="true" tabindex="-1"></a>|-------------|-----------------------------------------------------------|</span>
<span id="cb56-1165"><a href="#cb56-1165" aria-hidden="true" tabindex="-1"></a>| <span class="in">`prot`</span>      | Anteil Prothestanten im Jahr 1980 (%)                     |</span>
<span id="cb56-1166"><a href="#cb56-1166" aria-hidden="true" tabindex="-1"></a>| <span class="in">`gini`</span>      | Gini-Koeffizient                                          |</span>
<span id="cb56-1167"><a href="#cb56-1167" aria-hidden="true" tabindex="-1"></a>| <span class="in">`bord`</span>      | Laufdistanz zur Kantonsgrenze (Km)                     |</span>
<span id="cb56-1168"><a href="#cb56-1168" aria-hidden="true" tabindex="-1"></a>| <span class="in">`vaud`</span>      | Dummyvariable: Gemeine im Kanton Waadt                    |</span>
<span id="cb56-1169"><a href="#cb56-1169" aria-hidden="true" tabindex="-1"></a>| <span class="in">`pfl`</span>       | Präferenz für Freizeit (%)                                |</span>
<span id="cb56-1170"><a href="#cb56-1170" aria-hidden="true" tabindex="-1"></a>| <span class="in">`pfr`</span>       | Präferenz für Umverteilung (%)                            |</span>
<span id="cb56-1171"><a href="#cb56-1171" aria-hidden="true" tabindex="-1"></a>| <span class="in">`pfi`</span>       | Präferenz für wirtschaftliche Intervention des Staats (%) |</span>
<span id="cb56-1172"><a href="#cb56-1172" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-1173"><a href="#cb56-1173" aria-hidden="true" tabindex="-1"></a>: <span class="in">`BastenBetz`</span> -- Variablen und Definitionen {#tbl-BastenBetzRed}</span>
<span id="cb56-1174"><a href="#cb56-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1175"><a href="#cb56-1175" aria-hidden="true" tabindex="-1"></a>Für die Berechnung der optimalen Bandweite des FRDD verwenden wir einen MSE-optimalen Schätzer, der in der Funktion <span class="in">`rdrobust::rdbwselect()`</span> implementiert ist.^<span class="co">[</span><span class="ot">@BastenBetz2013 setzen BW = 5.01, den Durchschnitt von IK-Schätzungen über Modelle sämtlicher betrachteter Outcome-Variablen. Diese Bandweite liegt nahe des Ergebnisses von `rdbwselect`. Wir verwenden nachfolgend die Schätzung `OB`.</span><span class="co">]</span></span>
<span id="cb56-1176"><a href="#cb56-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1177"><a href="#cb56-1177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=F}</span></span>
<span id="cb56-1178"><a href="#cb56-1178" aria-hidden="true" tabindex="-1"></a><span class="in"># Bandweite schätzen (Bsp. für Freizeitpräferenz)</span></span>
<span id="cb56-1179"><a href="#cb56-1179" aria-hidden="true" tabindex="-1"></a><span class="in">bw_selection &lt;- rdbwselect(</span></span>
<span id="cb56-1180"><a href="#cb56-1180" aria-hidden="true" tabindex="-1"></a><span class="in">  y = BastenBetz$pfl,</span></span>
<span id="cb56-1181"><a href="#cb56-1181" aria-hidden="true" tabindex="-1"></a><span class="in">  x = BastenBetz$bord,</span></span>
<span id="cb56-1182"><a href="#cb56-1182" aria-hidden="true" tabindex="-1"></a><span class="in">  fuzzy = BastenBetz$prot, </span></span>
<span id="cb56-1183"><a href="#cb56-1183" aria-hidden="true" tabindex="-1"></a><span class="in">  bwselect = "mserd", </span></span>
<span id="cb56-1184"><a href="#cb56-1184" aria-hidden="true" tabindex="-1"></a><span class="in">  kernel = "uniform"</span></span>
<span id="cb56-1185"><a href="#cb56-1185" aria-hidden="true" tabindex="-1"></a><span class="in">) </span></span>
<span id="cb56-1186"><a href="#cb56-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1187"><a href="#cb56-1187" aria-hidden="true" tabindex="-1"></a><span class="in"># Bandweite auslesen und zuweisen</span></span>
<span id="cb56-1188"><a href="#cb56-1188" aria-hidden="true" tabindex="-1"></a><span class="in">(OB &lt;- bw_selection$bws[1])</span></span>
<span id="cb56-1189"><a href="#cb56-1189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1190"><a href="#cb56-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1191"><a href="#cb56-1191" aria-hidden="true" tabindex="-1"></a><span class="fu">### Deskriptive Statistiken</span></span>
<span id="cb56-1192"><a href="#cb56-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1193"><a href="#cb56-1193" aria-hidden="true" tabindex="-1"></a>Zur Reproduktion von Tabelle 1 aus @BastenBetz2013 erzeugen wir eine nach Kantonen gruppierte Zusammenfassung der Daten und berechnen deskriptive Statistiken. Wie im Paper berücksichtigen wir hierbei nur Gemeinden innerhalb der geschätzten optimalen Bandweite <span class="in">`OB`</span>.</span>
<span id="cb56-1194"><a href="#cb56-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1197"><a href="#cb56-1197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1198"><a href="#cb56-1198" aria-hidden="true" tabindex="-1"></a><span class="co"># Datensatz für Reproduktion von Table 1 formatieren</span></span>
<span id="cb56-1199"><a href="#cb56-1199" aria-hidden="true" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> BastenBetz <span class="sc">%&gt;%</span></span>
<span id="cb56-1200"><a href="#cb56-1200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">abs</span>(bord) <span class="sc">&lt;</span> OB) <span class="sc">%&gt;%</span></span>
<span id="cb56-1201"><a href="#cb56-1201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb56-1202"><a href="#cb56-1202" aria-hidden="true" tabindex="-1"></a>    <span class="at">vaud =</span> <span class="fu">ifelse</span>(</span>
<span id="cb56-1203"><a href="#cb56-1203" aria-hidden="true" tabindex="-1"></a>      <span class="at">test =</span> vaud <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb56-1204"><a href="#cb56-1204" aria-hidden="true" tabindex="-1"></a>      <span class="at">yes =</span> <span class="st">"Waadt"</span>, </span>
<span id="cb56-1205"><a href="#cb56-1205" aria-hidden="true" tabindex="-1"></a>      <span class="at">no =</span> <span class="st">"Freiburg"</span></span>
<span id="cb56-1206"><a href="#cb56-1206" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-1207"><a href="#cb56-1207" aria-hidden="true" tabindex="-1"></a>    <span class="at">prot =</span> prot <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb56-1208"><a href="#cb56-1208" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb56-1209"><a href="#cb56-1209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vaud) <span class="sc">%&gt;%</span></span>
<span id="cb56-1210"><a href="#cb56-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb56-1211"><a href="#cb56-1211" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb56-1212"><a href="#cb56-1212" aria-hidden="true" tabindex="-1"></a>      <span class="fu">everything</span>(), </span>
<span id="cb56-1213"><a href="#cb56-1213" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb56-1214"><a href="#cb56-1214" aria-hidden="true" tabindex="-1"></a>        <span class="at">Mean =</span> mean, </span>
<span id="cb56-1215"><a href="#cb56-1215" aria-hidden="true" tabindex="-1"></a>        <span class="at">SD =</span> sd, </span>
<span id="cb56-1216"><a href="#cb56-1216" aria-hidden="true" tabindex="-1"></a>        <span class="at">N =</span> length</span>
<span id="cb56-1217"><a href="#cb56-1217" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb56-1218"><a href="#cb56-1218" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-1219"><a href="#cb56-1219" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb56-1220"><a href="#cb56-1220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb56-1221"><a href="#cb56-1221" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span>vaud,</span>
<span id="cb56-1222"><a href="#cb56-1222" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"variable"</span>, <span class="st">"statistic"</span>), </span>
<span id="cb56-1223"><a href="#cb56-1223" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span></span>
<span id="cb56-1224"><a href="#cb56-1224" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-1225"><a href="#cb56-1225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1226"><a href="#cb56-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1227"><a href="#cb56-1227" aria-hidden="true" tabindex="-1"></a>Für die tabellarische Darstellung transformieren wir in ein weites Format, sodass die Tabelle die deskriptive Statistiken spaltenweise für die Kantone zeigt.</span>
<span id="cb56-1228"><a href="#cb56-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1231"><a href="#cb56-1231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1232"><a href="#cb56-1232" aria-hidden="true" tabindex="-1"></a><span class="co"># Daten in weites Format überführen</span></span>
<span id="cb56-1233"><a href="#cb56-1233" aria-hidden="true" tabindex="-1"></a>T1_wider <span class="ot">&lt;-</span> T1 <span class="sc">%&gt;%</span> </span>
<span id="cb56-1234"><a href="#cb56-1234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb56-1235"><a href="#cb56-1235" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="fu">c</span>(<span class="st">"vaud"</span>, <span class="st">"statistic"</span>)</span>
<span id="cb56-1236"><a href="#cb56-1236" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-1237"><a href="#cb56-1237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1238"><a href="#cb56-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1239"><a href="#cb56-1239" aria-hidden="true" tabindex="-1"></a>Die Tabelle erzeugen wir mit <span class="in">`gt::gt()`</span>.</span>
<span id="cb56-1240"><a href="#cb56-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1243"><a href="#cb56-1243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1244"><a href="#cb56-1244" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-sumstat</span></span>
<span id="cb56-1245"><a href="#cb56-1245" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Datensatz `BastenBetz` -- Zusammenfassende Statistiken"</span></span>
<span id="cb56-1246"><a href="#cb56-1246" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabelle mit gt() erzeugen</span></span>
<span id="cb56-1247"><a href="#cb56-1247" aria-hidden="true" tabindex="-1"></a>T1_wider <span class="sc">%&gt;%</span></span>
<span id="cb56-1248"><a href="#cb56-1248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">rowname_col =</span> <span class="st">"Variable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-1249"><a href="#cb56-1249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner_delim</span>(</span>
<span id="cb56-1250"><a href="#cb56-1250" aria-hidden="true" tabindex="-1"></a>    <span class="at">delim =</span> <span class="st">"_"</span>,</span>
<span id="cb56-1251"><a href="#cb56-1251" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb56-1252"><a href="#cb56-1252" aria-hidden="true" tabindex="-1"></a> tabopts</span>
<span id="cb56-1253"><a href="#cb56-1253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1254"><a href="#cb56-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1255"><a href="#cb56-1255" aria-hidden="true" tabindex="-1"></a>Die Statistiken in @tbl-sumstat scheinen konsistent mit der (historischen) Verteilung der Religionszugehörigkeit und politischen Einstellung gemäß der Hypothese: Im überwiegend katholischen Freiburg finden wir eine größere Einkommensungleichkeit und höhere aus Wahlergebnissen abgeleitete Präferenzen für Freizeit, Umverteilung sowie staatliche Interventionen.</span>
<span id="cb56-1256"><a href="#cb56-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1257"><a href="#cb56-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1258"><a href="#cb56-1258" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modellspezifikation und First-Stage-Ergebnisse</span></span>
<span id="cb56-1259"><a href="#cb56-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1262"><a href="#cb56-1262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1263"><a href="#cb56-1263" aria-hidden="true" tabindex="-1"></a>CJM_BB <span class="ot">&lt;-</span> <span class="fu">rddensity</span>(BastenBetz<span class="sc">$</span>bord, <span class="at">c =</span> <span class="dv">0</span>, <span class="at">kernel =</span> <span class="st">"epanechnikov"</span>)</span>
<span id="cb56-1264"><a href="#cb56-1264" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(CJM_BB)</span>
<span id="cb56-1265"><a href="#cb56-1265" aria-hidden="true" tabindex="-1"></a><span class="co"># CJM-Plot</span></span>
<span id="cb56-1266"><a href="#cb56-1266" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">rdplotdensity</span>(</span>
<span id="cb56-1267"><a href="#cb56-1267" aria-hidden="true" tabindex="-1"></a>  <span class="at">rdd =</span> CJM_BB,</span>
<span id="cb56-1268"><a href="#cb56-1268" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> BastenBetz<span class="sc">$</span>bord, </span>
<span id="cb56-1269"><a href="#cb56-1269" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"both"</span>, <span class="at">plotN =</span> <span class="dv">20</span>, </span>
<span id="cb56-1270"><a href="#cb56-1270" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1271"><a href="#cb56-1271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1272"><a href="#cb56-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1273"><a href="#cb56-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1274"><a href="#cb56-1274" aria-hidden="true" tabindex="-1"></a>Die Kantone Waadt und Freiburg haben bis heute mehrheitlich protestantische bzw. katholische Gemeinden. Die Verteilung von Protestantismus ist also, u.a. aufgrund von Bevölkerungsbewegungen, nicht mehr deterministisch. An der Kantonsgrenze besteht jedoch eine deutliche Diskontinuität im Anteil protestantischer Einwohner, die auf die historische Verteilung der Religionszugehörigkeit zurückzuführen ist. Damit kann ein  FRDD implementiert werden, bei dem die Distanz zur Grenze (<span class="in">`bord`</span>) die zentrierte Laufvariable ist und die Zugehörigkeit zum Kanton Waadt (<span class="in">`vaud`</span>) ein Instrument für die Behandlungsvariable (<span class="in">`prot`</span>) ist. </span>
<span id="cb56-1275"><a href="#cb56-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1276"><a href="#cb56-1276" aria-hidden="true" tabindex="-1"></a>Wir nutzen die Funktion <span class="in">`rdrobust::rdplot`</span> um diesen Zusammenhang für verschiedene Bandweiten anhand des linearen Interaktionsmodells</span>
<span id="cb56-1277"><a href="#cb56-1277" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb56-1278"><a href="#cb56-1278" aria-hidden="true" tabindex="-1"></a>  \begin{split}</span>
<span id="cb56-1279"><a href="#cb56-1279" aria-hidden="true" tabindex="-1"></a>  prot_i =&amp;\, \alpha_0 + \alpha_1 vaud_i + \alpha_2 bord_i <span class="sc">\\</span></span>
<span id="cb56-1280"><a href="#cb56-1280" aria-hidden="true" tabindex="-1"></a>  +&amp;\, \alpha_3 bord_i \times vaud_i + u_i</span>
<span id="cb56-1281"><a href="#cb56-1281" aria-hidden="true" tabindex="-1"></a>  \end{split}\label{eq:BBFSR}</span>
<span id="cb56-1282"><a href="#cb56-1282" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb56-1283"><a href="#cb56-1283" aria-hidden="true" tabindex="-1"></a>grafisch darzustellen. Dies ist die First-Stage-Regression für die 2SLS-Schätzung der Behandlungseffekte.</span>
<span id="cb56-1284"><a href="#cb56-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1287"><a href="#cb56-1287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1288"><a href="#cb56-1288" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb56-1289"><a href="#cb56-1289" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-keep: none</span></span>
<span id="cb56-1290"><a href="#cb56-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1291"><a href="#cb56-1291" aria-hidden="true" tabindex="-1"></a><span class="co"># Reproduktion von Abbildung 3 in Basten und Betz (2013)</span></span>
<span id="cb56-1292"><a href="#cb56-1292" aria-hidden="true" tabindex="-1"></a>plots_BB <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb56-1293"><a href="#cb56-1293" aria-hidden="true" tabindex="-1"></a>  <span class="co"># gesch. optimale Bandweite</span></span>
<span id="cb56-1294"><a href="#cb56-1294" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_OB =</span> <span class="fu">rdplot</span>(</span>
<span id="cb56-1295"><a href="#cb56-1295" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> BastenBetz<span class="sc">$</span>prot, </span>
<span id="cb56-1296"><a href="#cb56-1296" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> BastenBetz<span class="sc">$</span>bord, </span>
<span id="cb56-1297"><a href="#cb56-1297" aria-hidden="true" tabindex="-1"></a>    <span class="at">h =</span> <span class="fu">c</span>(OB, OB), </span>
<span id="cb56-1298"><a href="#cb56-1298" aria-hidden="true" tabindex="-1"></a>    <span class="at">x.label =</span> <span class="st">"Distanz zur Grenze (bord)"</span>,</span>
<span id="cb56-1299"><a href="#cb56-1299" aria-hidden="true" tabindex="-1"></a>    <span class="at">y.label =</span> <span class="st">"Anteil Protestanten (prot)"</span>, </span>
<span id="cb56-1300"><a href="#cb56-1300" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gesch. Bandweite"</span>,</span>
<span id="cb56-1301"><a href="#cb56-1301" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="dv">1</span>, </span>
<span id="cb56-1302"><a href="#cb56-1302" aria-hidden="true" tabindex="-1"></a>    <span class="at">nbins =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">14</span>), </span>
<span id="cb56-1303"><a href="#cb56-1303" aria-hidden="true" tabindex="-1"></a>    <span class="at">masspoints =</span> <span class="st">"off"</span></span>
<span id="cb56-1304"><a href="#cb56-1304" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb56-1305"><a href="#cb56-1305" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-1306"><a href="#cb56-1306" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bandweite 10</span></span>
<span id="cb56-1307"><a href="#cb56-1307" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_BW10 =</span> <span class="fu">rdplot</span>(</span>
<span id="cb56-1308"><a href="#cb56-1308" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> BastenBetz<span class="sc">$</span>prot, </span>
<span id="cb56-1309"><a href="#cb56-1309" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> BastenBetz<span class="sc">$</span>bord, </span>
<span id="cb56-1310"><a href="#cb56-1310" aria-hidden="true" tabindex="-1"></a>    <span class="at">h =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>), </span>
<span id="cb56-1311"><a href="#cb56-1311" aria-hidden="true" tabindex="-1"></a>    <span class="at">x.label =</span> <span class="st">"Distanz zur Grenze (bord)"</span>,</span>
<span id="cb56-1312"><a href="#cb56-1312" aria-hidden="true" tabindex="-1"></a>    <span class="at">y.label =</span> <span class="st">"Anteil Protestanten  (prot)"</span>, </span>
<span id="cb56-1313"><a href="#cb56-1313" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Bandweite = 10"</span>,</span>
<span id="cb56-1314"><a href="#cb56-1314" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="dv">1</span>, </span>
<span id="cb56-1315"><a href="#cb56-1315" aria-hidden="true" tabindex="-1"></a>    <span class="at">nbins =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">14</span>),</span>
<span id="cb56-1316"><a href="#cb56-1316" aria-hidden="true" tabindex="-1"></a>    <span class="at">masspoints =</span> <span class="st">"off"</span></span>
<span id="cb56-1317"><a href="#cb56-1317" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb56-1318"><a href="#cb56-1318" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-1319"><a href="#cb56-1319" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bandweite 20</span></span>
<span id="cb56-1320"><a href="#cb56-1320" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_BW20 =</span> <span class="fu">rdplot</span>(</span>
<span id="cb56-1321"><a href="#cb56-1321" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> BastenBetz<span class="sc">$</span>prot, </span>
<span id="cb56-1322"><a href="#cb56-1322" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> BastenBetz<span class="sc">$</span>bord, </span>
<span id="cb56-1323"><a href="#cb56-1323" aria-hidden="true" tabindex="-1"></a>    <span class="at">h =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">20</span>), </span>
<span id="cb56-1324"><a href="#cb56-1324" aria-hidden="true" tabindex="-1"></a>    <span class="at">x.label =</span> <span class="st">"Distanz zur Grenze (bord)"</span>,</span>
<span id="cb56-1325"><a href="#cb56-1325" aria-hidden="true" tabindex="-1"></a>    <span class="at">y.label =</span> <span class="st">"Anteil Protestanten  (prot)"</span>, </span>
<span id="cb56-1326"><a href="#cb56-1326" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Bandweite = 20"</span>,</span>
<span id="cb56-1327"><a href="#cb56-1327" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="dv">1</span>, </span>
<span id="cb56-1328"><a href="#cb56-1328" aria-hidden="true" tabindex="-1"></a>    <span class="at">nbins =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">14</span>),</span>
<span id="cb56-1329"><a href="#cb56-1329" aria-hidden="true" tabindex="-1"></a>    <span class="at">masspoints =</span> <span class="st">"off"</span></span>
<span id="cb56-1330"><a href="#cb56-1330" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb56-1331"><a href="#cb56-1331" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-1332"><a href="#cb56-1332" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Gesamter Datensatz</span></span>
<span id="cb56-1333"><a href="#cb56-1333" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_G =</span> <span class="fu">rdplot</span>(</span>
<span id="cb56-1334"><a href="#cb56-1334" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> BastenBetz<span class="sc">$</span>prot, </span>
<span id="cb56-1335"><a href="#cb56-1335" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> BastenBetz<span class="sc">$</span>bord,</span>
<span id="cb56-1336"><a href="#cb56-1336" aria-hidden="true" tabindex="-1"></a>    <span class="at">x.label =</span> <span class="st">"Distanz zur Grenze (bord)"</span>,</span>
<span id="cb56-1337"><a href="#cb56-1337" aria-hidden="true" tabindex="-1"></a>    <span class="at">y.label =</span> <span class="st">"Anteil Protestanten"</span>, </span>
<span id="cb56-1338"><a href="#cb56-1338" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Ges. Datensatz"</span>,</span>
<span id="cb56-1339"><a href="#cb56-1339" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="dv">1</span>, </span>
<span id="cb56-1340"><a href="#cb56-1340" aria-hidden="true" tabindex="-1"></a>    <span class="at">nbins =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">14</span>),</span>
<span id="cb56-1341"><a href="#cb56-1341" aria-hidden="true" tabindex="-1"></a>    <span class="at">masspoints =</span> <span class="st">"off"</span></span>
<span id="cb56-1342"><a href="#cb56-1342" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-1343"><a href="#cb56-1343" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1344"><a href="#cb56-1344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1345"><a href="#cb56-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1346"><a href="#cb56-1346" aria-hidden="true" tabindex="-1"></a>Wir sammeln die Ergebnisse in einem Plot-Gitter mit <span class="in">`cowplot::plot_grid()`</span>.</span>
<span id="cb56-1347"><a href="#cb56-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1350"><a href="#cb56-1350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1351"><a href="#cb56-1351" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-BastenBetzFS</span></span>
<span id="cb56-1352"><a href="#cb56-1352" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: First-Stage-Regressionen</span></span>
<span id="cb56-1353"><a href="#cb56-1353" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap-location: margin</span></span>
<span id="cb56-1354"><a href="#cb56-1354" aria-hidden="true" tabindex="-1"></a><span class="co"># Reproduktion von Abbildung 3 in Basten und Betz (2013)</span></span>
<span id="cb56-1355"><a href="#cb56-1355" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(</span>
<span id="cb56-1356"><a href="#cb56-1356" aria-hidden="true" tabindex="-1"></a>  <span class="at">plotlist =</span> <span class="fu">map</span>(plots_BB, <span class="sc">~</span> .<span class="sc">$</span>rdplot), <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb56-1357"><a href="#cb56-1357" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1358"><a href="#cb56-1358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1359"><a href="#cb56-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1360"><a href="#cb56-1360" aria-hidden="true" tabindex="-1"></a>Die Grafiken in @fig-BastenBetzFS zeigen deutliche Hinweise auf die Diskontinuität in <span class="in">`prot`</span> nahe der Kantonsgrenze. Die Größe des geschätzten Sprungs scheint nur wenig sensitiv gegenüber der gewählten Bandweite zu sein. Die Signifikanz des Effekts können wir anhand der jeweiligen KQ-Regressionen beurteilen.^<span class="co">[</span><span class="ot">Wir nutzen `update()` um die Regression mit weniger Code für verschiedene Bandweiten zu schätzen.</span><span class="co">]</span> </span>
<span id="cb56-1361"><a href="#cb56-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1362"><a href="#cb56-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1365"><a href="#cb56-1365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1366"><a href="#cb56-1366" aria-hidden="true" tabindex="-1"></a><span class="co"># Reproduktion der First-Stage-Regressionen</span></span>
<span id="cb56-1367"><a href="#cb56-1367" aria-hidden="true" tabindex="-1"></a><span class="co"># s. Tabelle 2 in Basten und Betz (2013)</span></span>
<span id="cb56-1368"><a href="#cb56-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1369"><a href="#cb56-1369" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) BW = OB</span></span>
<span id="cb56-1370"><a href="#cb56-1370" aria-hidden="true" tabindex="-1"></a>FS1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb56-1371"><a href="#cb56-1371" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> prot <span class="sc">~</span> vaud <span class="sc">+</span> bord <span class="sc">+</span> vaud <span class="sc">*</span> bord, </span>
<span id="cb56-1372"><a href="#cb56-1372" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> BastenBetz <span class="sc">%&gt;%</span> </span>
<span id="cb56-1373"><a href="#cb56-1373" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb56-1374"><a href="#cb56-1374" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>(bord) <span class="sc">&lt;=</span> OB</span>
<span id="cb56-1375"><a href="#cb56-1375" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-1376"><a href="#cb56-1376" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1377"><a href="#cb56-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1378"><a href="#cb56-1378" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) BW = 10</span></span>
<span id="cb56-1379"><a href="#cb56-1379" aria-hidden="true" tabindex="-1"></a>FS2 <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb56-1380"><a href="#cb56-1380" aria-hidden="true" tabindex="-1"></a>  FS1,</span>
<span id="cb56-1381"><a href="#cb56-1381" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> BastenBetz <span class="sc">%&gt;%</span> </span>
<span id="cb56-1382"><a href="#cb56-1382" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb56-1383"><a href="#cb56-1383" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>(bord) <span class="sc">&lt;=</span> <span class="dv">10</span></span>
<span id="cb56-1384"><a href="#cb56-1384" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-1385"><a href="#cb56-1385" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1386"><a href="#cb56-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1387"><a href="#cb56-1387" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) BW = 20</span></span>
<span id="cb56-1388"><a href="#cb56-1388" aria-hidden="true" tabindex="-1"></a>FS3 <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb56-1389"><a href="#cb56-1389" aria-hidden="true" tabindex="-1"></a>  FS1,</span>
<span id="cb56-1390"><a href="#cb56-1390" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> BastenBetz <span class="sc">%&gt;%</span></span>
<span id="cb56-1391"><a href="#cb56-1391" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb56-1392"><a href="#cb56-1392" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>(bord) <span class="sc">&lt;=</span> <span class="dv">20</span></span>
<span id="cb56-1393"><a href="#cb56-1393" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-1394"><a href="#cb56-1394" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1395"><a href="#cb56-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1396"><a href="#cb56-1396" aria-hidden="true" tabindex="-1"></a><span class="co"># (4) Ges. Datensatz</span></span>
<span id="cb56-1397"><a href="#cb56-1397" aria-hidden="true" tabindex="-1"></a>FS4 <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb56-1398"><a href="#cb56-1398" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> FS1,</span>
<span id="cb56-1399"><a href="#cb56-1399" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> BastenBetz</span>
<span id="cb56-1400"><a href="#cb56-1400" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1401"><a href="#cb56-1401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1402"><a href="#cb56-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1405"><a href="#cb56-1405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1406"><a href="#cb56-1406" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "First-Stage-Regressionen"</span></span>
<span id="cb56-1407"><a href="#cb56-1407" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-BastenBetzFS</span></span>
<span id="cb56-1408"><a href="#cb56-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1409"><a href="#cb56-1409" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabellarische Darstellung</span></span>
<span id="cb56-1410"><a href="#cb56-1410" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb56-1411"><a href="#cb56-1411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb56-1412"><a href="#cb56-1412" aria-hidden="true" tabindex="-1"></a>    <span class="st">"BW = OB"</span><span class="ot">=</span> FS1, </span>
<span id="cb56-1413"><a href="#cb56-1413" aria-hidden="true" tabindex="-1"></a>    <span class="st">"BW = 10"</span> <span class="ot">=</span> FS2, </span>
<span id="cb56-1414"><a href="#cb56-1414" aria-hidden="true" tabindex="-1"></a>    <span class="st">"BW=20"</span> <span class="ot">=</span> FS3, </span>
<span id="cb56-1415"><a href="#cb56-1415" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ges. Datensatz"</span> <span class="ot">=</span> FS4</span>
<span id="cb56-1416"><a href="#cb56-1416" aria-hidden="true" tabindex="-1"></a>  ), </span>
<span id="cb56-1417"><a href="#cb56-1417" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov =</span> <span class="st">"HC1"</span>, </span>
<span id="cb56-1418"><a href="#cb56-1418" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> T, </span>
<span id="cb56-1419"><a href="#cb56-1419" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_map =</span> <span class="st">"nobs"</span>, </span>
<span id="cb56-1420"><a href="#cb56-1420" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"gt"</span></span>
<span id="cb56-1421"><a href="#cb56-1421" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb56-1422"><a href="#cb56-1422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabopts</span>()</span>
<span id="cb56-1423"><a href="#cb56-1423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1424"><a href="#cb56-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1425"><a href="#cb56-1425" aria-hidden="true" tabindex="-1"></a>Für die geschätze Bandweite schätzen wir einen hochsignifikanten Sprung in <span class="in">`prot`</span> von etwa 67\% an der Kantonsgrenze. Auch für größere Bandweiten von 10km und 20km sowie für den gesamten Datensatz finden wir vergleichbare signifikante Effekte, was eine bei zunehmender Distanz zur Grenze persistente Diskrepanz der Religionszugehörigkeit bestätigt. </span>
<span id="cb56-1426"><a href="#cb56-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1427"><a href="#cb56-1427" aria-hidden="true" tabindex="-1"></a><span class="fu">### Second-Stage-Ergebnisse</span></span>
<span id="cb56-1428"><a href="#cb56-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1429"><a href="#cb56-1429" aria-hidden="true" tabindex="-1"></a>Wir schätzen nun den LATE von Protestantismus für die Outcome-Variablen <span class="in">`gini`</span>, <span class="in">`pfl`</span>, <span class="in">`pfi`</span> und <span class="in">`pfr`</span>, vgl. @tbl-BastenBetzRed. Die Spezifikation für die Second-Stage-Regression der FRDD-Schätzung ist</span>
<span id="cb56-1430"><a href="#cb56-1430" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb56-1431"><a href="#cb56-1431" aria-hidden="true" tabindex="-1"></a>  \begin{split}</span>
<span id="cb56-1432"><a href="#cb56-1432" aria-hidden="true" tabindex="-1"></a>    Y_i = \gamma_0 + \gamma_1 \widehat{prot}_i +  \gamma_2 bord_i + \gamma_3 bord_i  \times vaud_i + e_i</span>
<span id="cb56-1433"><a href="#cb56-1433" aria-hidden="true" tabindex="-1"></a>  \end{split},</span>
<span id="cb56-1434"><a href="#cb56-1434" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb56-1435"><a href="#cb56-1435" aria-hidden="true" tabindex="-1"></a>wobei $\widehat{prot}_i$ angepasste Werte aus der KQ-Schätzung von \eqref{eq:BBFSR} mit Bandweite <span class="in">`OB`</span> sind. Dazu erzeugen wir zunächst eine angepasste Version des Objekts <span class="in">`BastenBetz`</span>, welche nur Gemeinden innerhalb der Bandweite enthält.</span>
<span id="cb56-1436"><a href="#cb56-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1439"><a href="#cb56-1439" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1440"><a href="#cb56-1440" aria-hidden="true" tabindex="-1"></a><span class="co"># Gemeinden innerhalb der Bandweite filtern</span></span>
<span id="cb56-1441"><a href="#cb56-1441" aria-hidden="true" tabindex="-1"></a>BastenBetz_OB <span class="ot">&lt;-</span> BastenBetz <span class="sc">%&gt;%</span> </span>
<span id="cb56-1442"><a href="#cb56-1442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb56-1443"><a href="#cb56-1443" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abs</span>(bord) <span class="sc">&lt;=</span> OB</span>
<span id="cb56-1444"><a href="#cb56-1444" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-1445"><a href="#cb56-1445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1446"><a href="#cb56-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1447"><a href="#cb56-1447" aria-hidden="true" tabindex="-1"></a>Zur Illustration schätzen wir nun die Second-Stage-Regression für $Y = pfl$. </span>
<span id="cb56-1448"><a href="#cb56-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1451"><a href="#cb56-1451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1452"><a href="#cb56-1452" aria-hidden="true" tabindex="-1"></a><span class="co"># Second-Stage-Regression für `pfl`</span></span>
<span id="cb56-1453"><a href="#cb56-1453" aria-hidden="true" tabindex="-1"></a>BastenBetz_OB <span class="sc">%&gt;%</span> </span>
<span id="cb56-1454"><a href="#cb56-1454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb56-1455"><a href="#cb56-1455" aria-hidden="true" tabindex="-1"></a>    <span class="at">prot_fitted =</span> <span class="fu">fitted</span>(FS1)</span>
<span id="cb56-1456"><a href="#cb56-1456" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb56-1457"><a href="#cb56-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1458"><a href="#cb56-1458" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(</span>
<span id="cb56-1459"><a href="#cb56-1459" aria-hidden="true" tabindex="-1"></a>  pfl <span class="sc">~</span> prot_fitted <span class="sc">+</span> bord <span class="sc">+</span> vaud<span class="sc">:</span>bord, </span>
<span id="cb56-1460"><a href="#cb56-1460" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> .</span>
<span id="cb56-1461"><a href="#cb56-1461" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-1462"><a href="#cb56-1462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb56-1463"><a href="#cb56-1463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1464"><a href="#cb56-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1465"><a href="#cb56-1465" aria-hidden="true" tabindex="-1"></a>Der Koeffizient <span class="in">`prot_fitted`</span> ist der gesuchte Behandlungseffekt. Beachte, dass die von <span class="in">`summary()`</span> berechneten Standardfehler ungültig sind, weil diese die zusätzliche Unsicherheit durch die Berechnung von $\widehat{prot}$ über die First-Stage-Regression nicht berücksichtigen. Nachfolgend nutzen wir <span class="in">`AER::ivreg()`</span>, um komfortabel gültige (heteroskedastie-robuste) Inferenz betreiben zu können.^[Die Autoren geben an, robuste SEs zu nutzen. Das scheint nicht der Fall zu sein, denn <span class="in">`vcov = "HC0"`</span> liefert die Ergebinsse im Paper. Die von Stata berechneten HC1-SEs weichen ab. Dies ändert allerdings nichts</span>
<span id="cb56-1466"><a href="#cb56-1466" aria-hidden="true" tabindex="-1"></a>an der Signifikanz der Koeffizienten. Wir nutzen <span class="in">`vcov = "HC1"`</span>.]</span>
<span id="cb56-1467"><a href="#cb56-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1470"><a href="#cb56-1470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1471"><a href="#cb56-1471" aria-hidden="true" tabindex="-1"></a><span class="co"># Schätzung mit 2SlS</span></span>
<span id="cb56-1472"><a href="#cb56-1472" aria-hidden="true" tabindex="-1"></a><span class="co"># s. Tabelle 4 in Basten und Betz (2013)</span></span>
<span id="cb56-1473"><a href="#cb56-1473" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-1474"><a href="#cb56-1474" aria-hidden="true" tabindex="-1"></a><span class="co"># Wir instrumentieren Treatment (`prot1980s`) mit dem Schwellenindikator (`vaud`)</span></span>
<span id="cb56-1475"><a href="#cb56-1475" aria-hidden="true" tabindex="-1"></a><span class="co"># ivreg: exogene Variablen instrumentieren sich selbst, daher</span></span>
<span id="cb56-1476"><a href="#cb56-1476" aria-hidden="true" tabindex="-1"></a><span class="co"># ' | vaud * borderdis '</span></span>
<span id="cb56-1477"><a href="#cb56-1477" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb56-1478"><a href="#cb56-1478" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) Präferenz für Freizeit</span></span>
<span id="cb56-1479"><a href="#cb56-1479" aria-hidden="true" tabindex="-1"></a>SS_pfl <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(</span>
<span id="cb56-1480"><a href="#cb56-1480" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> pfl <span class="sc">~</span> prot <span class="sc">+</span> bord<span class="sc">:</span>vaud <span class="sc">+</span> bord <span class="sc">|</span> vaud <span class="sc">*</span> bord,</span>
<span id="cb56-1481"><a href="#cb56-1481" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> BastenBetz_OB</span>
<span id="cb56-1482"><a href="#cb56-1482" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1483"><a href="#cb56-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1484"><a href="#cb56-1484" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) Präferenz für Umverteilung</span></span>
<span id="cb56-1485"><a href="#cb56-1485" aria-hidden="true" tabindex="-1"></a>SS_pfr <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb56-1486"><a href="#cb56-1486" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> SS_pfl,</span>
<span id="cb56-1487"><a href="#cb56-1487" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> pfr <span class="sc">~</span> prot <span class="sc">+</span> bord<span class="sc">:</span>vaud <span class="sc">+</span> bord <span class="sc">|</span> vaud <span class="sc">*</span> bord,</span>
<span id="cb56-1488"><a href="#cb56-1488" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1489"><a href="#cb56-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1490"><a href="#cb56-1490" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) Präferenz für Intervention</span></span>
<span id="cb56-1491"><a href="#cb56-1491" aria-hidden="true" tabindex="-1"></a>SS_pfi <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb56-1492"><a href="#cb56-1492" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> SS_pfl,</span>
<span id="cb56-1493"><a href="#cb56-1493" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> pfi <span class="sc">~</span> prot <span class="sc">+</span> bord<span class="sc">:</span>vaud <span class="sc">+</span> bord <span class="sc">|</span> vaud <span class="sc">*</span> bord,</span>
<span id="cb56-1494"><a href="#cb56-1494" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1495"><a href="#cb56-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1496"><a href="#cb56-1496" aria-hidden="true" tabindex="-1"></a><span class="co"># (4) Einkommensungleichheit</span></span>
<span id="cb56-1497"><a href="#cb56-1497" aria-hidden="true" tabindex="-1"></a>SS_gini <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb56-1498"><a href="#cb56-1498" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> SS_pfl,</span>
<span id="cb56-1499"><a href="#cb56-1499" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> pfi <span class="sc">~</span> prot <span class="sc">+</span> bord<span class="sc">:</span>vaud <span class="sc">+</span> bord <span class="sc">|</span> vaud <span class="sc">*</span> bord,</span>
<span id="cb56-1500"><a href="#cb56-1500" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-1501"><a href="#cb56-1501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1502"><a href="#cb56-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1505"><a href="#cb56-1505" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1506"><a href="#cb56-1506" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Ergebnisse der Second-Stage-Regressionen"</span></span>
<span id="cb56-1507"><a href="#cb56-1507" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-BastenBetzSS</span></span>
<span id="cb56-1508"><a href="#cb56-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1509"><a href="#cb56-1509" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabellarische Darstellung</span></span>
<span id="cb56-1510"><a href="#cb56-1510" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb56-1511"><a href="#cb56-1511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb56-1512"><a href="#cb56-1512" aria-hidden="true" tabindex="-1"></a>    <span class="st">"(1) Freizeit"</span><span class="ot">=</span> SS_pfl, </span>
<span id="cb56-1513"><a href="#cb56-1513" aria-hidden="true" tabindex="-1"></a>    <span class="st">"(2) Umverteilung"</span> <span class="ot">=</span> SS_pfr, </span>
<span id="cb56-1514"><a href="#cb56-1514" aria-hidden="true" tabindex="-1"></a>    <span class="st">"(3) Intervention"</span> <span class="ot">=</span> SS_pfi, </span>
<span id="cb56-1515"><a href="#cb56-1515" aria-hidden="true" tabindex="-1"></a>    <span class="st">"(4) Ungleichheit"</span> <span class="ot">=</span> SS_gini</span>
<span id="cb56-1516"><a href="#cb56-1516" aria-hidden="true" tabindex="-1"></a>  ), </span>
<span id="cb56-1517"><a href="#cb56-1517" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov =</span> <span class="st">"HC1"</span>, </span>
<span id="cb56-1518"><a href="#cb56-1518" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> T, </span>
<span id="cb56-1519"><a href="#cb56-1519" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_map =</span> <span class="st">"nobs"</span>, </span>
<span id="cb56-1520"><a href="#cb56-1520" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"gt"</span></span>
<span id="cb56-1521"><a href="#cb56-1521" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb56-1522"><a href="#cb56-1522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabopts</span>()</span>
<span id="cb56-1523"><a href="#cb56-1523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1524"><a href="#cb56-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1525"><a href="#cb56-1525" aria-hidden="true" tabindex="-1"></a>Die Koeffizienten von <span class="in">`prot`</span> in @tbl-BastenBetzSS sind die mit 2SLS ermittelten erwarteten Behandlungseffekte einer 100%-Reformation (d.h. von 100% katholisch zu 100% protestantisch) für eine durchschnittliche Gemeine nahe der Kantonsgrnze. Es handelt sich jeweils um einen lokalen durchschnittlichen Behandlungseffekt (LATE). Gem. der Definition der abhängigen Variablen, interpretieren wir die Koeffizienten von <span class="in">`prot`</span> in de Regressionen (1), (2) und (3) als erwartete Prozentänderung durch Reformation. Der Koeffizient in Regression (4) gibt die erwartete Änderung des Gini-Index an. Sämtliche geschätzte Effekte sind signifikant und haben ein mit der Hypothese der Autoren konsistentes negatives Vorzeichen. </span>
<span id="cb56-1526"><a href="#cb56-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1527"><a href="#cb56-1527" aria-hidden="true" tabindex="-1"></a>Die Ergebnisse sind Evidenz, dass Protestantismus zu verringerter Präferenz für Freizeit, Umverteilung sowie wirtschaftspolitische Intervention seitens des Staats führt. Auch die ökonomische Ungleichheit ist signifikant geringer, als in einer durchschnittlichen vollständig katholischen Gemeinde.</span>
<span id="cb56-1528"><a href="#cb56-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1529"><a href="#cb56-1529" aria-hidden="true" tabindex="-1"></a><span class="fu">### Addendum: FRDD-Schätzung mit `rdrobust()`</span></span>
<span id="cb56-1530"><a href="#cb56-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1531"><a href="#cb56-1531" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`rdrobust::rdrobust()`</span> erlaubt die Schätzung von SRDD und FRDD mit einer Vielzahl von Optionen, s. <span class="in">`?rdrobust`</span>. Dies erleichtert die Schätzung mehrerer Modellspezifikationenen und Bandweiten. Mit dem nachstehenden Befehl schätzen wir den LATE von Reformation auf die Präferenz für Umverteilung anhand lokaler quadratischer Regression. Der Output gibt einen Überblick der Bandweitenschätzung sowie der 2 Stufen des 2SLS-Schätzers, inkl. robuster Inferenzstatistiken.</span>
<span id="cb56-1532"><a href="#cb56-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1535"><a href="#cb56-1535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1536"><a href="#cb56-1536" aria-hidden="true" tabindex="-1"></a>pfr_rdr <span class="ot">&lt;-</span> <span class="fu">rdrobust</span>(</span>
<span id="cb56-1537"><a href="#cb56-1537" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> BastenBetz<span class="sc">$</span>pfr,</span>
<span id="cb56-1538"><a href="#cb56-1538" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> BastenBetz<span class="sc">$</span>bord,</span>
<span id="cb56-1539"><a href="#cb56-1539" aria-hidden="true" tabindex="-1"></a>  <span class="at">fuzzy =</span> BastenBetz<span class="sc">$</span>prot, </span>
<span id="cb56-1540"><a href="#cb56-1540" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="dv">2</span>,</span>
<span id="cb56-1541"><a href="#cb56-1541" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">"uniform"</span>,</span>
<span id="cb56-1542"><a href="#cb56-1542" aria-hidden="true" tabindex="-1"></a>  <span class="at">vce =</span> <span class="st">"HC1"</span></span>
<span id="cb56-1543"><a href="#cb56-1543" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb56-1544"><a href="#cb56-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1545"><a href="#cb56-1545" aria-hidden="true" tabindex="-1"></a>pfr_rdr <span class="sc">%&gt;%</span> </span>
<span id="cb56-1546"><a href="#cb56-1546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb56-1547"><a href="#cb56-1547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1548"><a href="#cb56-1548" aria-hidden="true" tabindex="-1"></a>Auch für die quadratische Spezifikation erhalten wir mit -5.047 ein vergleichbares signifikantes Ergebnis für den LATE von Protestantismus auf Umverteilung, vgl. Spalte (2) in @tbl-BastenBetzSS.</span>
<span id="cb56-1549"><a href="#cb56-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1550"><a href="#cb56-1550" aria-hidden="true" tabindex="-1"></a>Mit der Option <span class="in">`bwselect = "msetwo"`</span> kann die Bandweite jeweils für die lokale Regression links- und rechtssetig des Schwellenwerts geschätzt werden.</span>
<span id="cb56-1551"><a href="#cb56-1551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1554"><a href="#cb56-1554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-1555"><a href="#cb56-1555" aria-hidden="true" tabindex="-1"></a>pfr_rdr <span class="sc">%&gt;%</span> </span>
<span id="cb56-1556"><a href="#cb56-1556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(<span class="at">bwselect =</span> <span class="st">"msetwo"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-1557"><a href="#cb56-1557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb56-1558"><a href="#cb56-1558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-1559"><a href="#cb56-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1560"><a href="#cb56-1560" aria-hidden="true" tabindex="-1"></a>Trotz Diskrepanz der geschätzten Bandweiten erhalten wir eine größere aber vergleichbare Schätzung für einen negativen Effekt.</span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>